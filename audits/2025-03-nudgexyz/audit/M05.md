# Invariant rule broken: `NudgeCampaign.invalidateParticipations()` omits `totalReallocatedAmount` and fees

The invariant stated in the README `Ensures the sum of all participation amounts matches the tracked total reallocated amount` does not upheld.

## Finding description and impact

When a user participates, the contract immediately increases `totalReallocatedAmount`, `accumulatedFees`, and `pendingRewards`.

However, when the NudgeOperator calls `invalidateParticipations()` to remove users from participation, only the `pendingRewards` are reduced.

This discrepancy leads to inaccurate tracking:

- `totalReallocatedAmount` remains unchanged despite invalidations.
- `accumulatedFees` also continue to be tracked incorrectly.

### Impact

This issue has a medium impact because the contract does not behave as intended:

- **Incorrect Tracking:** The `totalReallocatedAmount` is overstated.
- **Fee Discrepancy:** The miscalculation of `accumulatedFees` could allow an admin to withdraw untracked rewards, potentially leading to a higher-severity problem.

## Proof of Concept

- **Participation Increase:**
  Users participating in a campaign increase `totalReallocatedAmount`. <https://github.com/code-423n4/2025-03-nudgexyz/blob/382a59c315b8a421f2acae5fd856bb9ca48a7a10/src/campaign/NudgeCampaign.sol#L208-L220>

- **Invalidation Issue:**
  When `invalidateParticipations()` is called, only the `pendingRewards` are removed. <https://github.com/code-423n4/2025-03-nudgexyz/blob/382a59c315b8a421f2acae5fd856bb9ca48a7a10/src/campaign/NudgeCampaign.sol#L316-L317>

## Recommended mitigation steps

Removing `totalReallocatedAmount` when invalidate users.
Only take fee when user claim rewards
