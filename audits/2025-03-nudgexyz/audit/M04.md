# Campaign Manager can launch malicious Token to force invalidate their own campaign users and steal back pending rewards

Nudge Campaign is like an open token launch pad.
The design of `NudgeCampaign.sol` makes it very easy for a malicious campaign manager to launch a scam token that automatically invalidates users' pending rewards.

## Finding description and impact

Consider a campaign that launches a token called SCAM with a 1:1 USDC exchange rate. The campaign is set up so that holding 1 SCAM token for 7 days yields 5 USDC in rewards.
This offer is highly attractive, as swapping 1 USDC for a chance to gain 5 USDC seems like a great deal.
According to Nudge’s documentation, users' rewards are considered safe as long as they [hold enough token balance to qualify for escrow](https://docs.nudge.xyz/for-users/frequently-asked-questions-by-users#id-10.-after-participating-in-a-nudge-campaign-a-user-became-eligible-but-forgot-to-claim-it.-what-will).

A malicious campaign manager controlling the SCAM token can force the invalidation of participating users’ rewards in multiple ways.

The easiest approaches include using an upgradable ERC20 contract (such as one based on UUPS) or incorporating a `burn()` function that resets a user's balance to 0.

Consequently, offchain bots will eventually check and detect that the user’s SCAM balance has dropped to 0, triggering the invalidation of the user's participation.
This causes the pending rewards to be reclaimed by the campaign, allowing the campaign manager to withdraw them and profit from users swapping their assets for SCAM.

### Impact

- **Malicious Campaigns:** Nudge could host campaigns that are intentionally malicious, leading users to make poor financial decisions.
- **Medium Impact:** Although there is a whitelist that likely restricts which campaigns appear on the frontend, a malicious campaign that passes this human check can still cause significant harm.

## Proof of Concept

For a malicious campaign convincing:

- The campaign must pass the whitelist check to appear on the Nudge frontend. (Currently, [anyone can create a new campaign](https://github.com/code-423n4/2025-03-nudgexyz/blob/382a59c315b8a421f2acae5fd856bb9ca48a7a10/src/campaign/NudgeCampaignFactory.sol#L68-L80).)
- The campaign manager deploys a valid ERC20 token that contains one of the following backdoors:
  - An admin-only `burn()` function.
  - An upgradable (UUPS) contract implementation.
  - A hidden transfer event that only the admin can emit.
  - An admin function to blacklist users, effectively resetting their balance to 0.

If the campaign manager convinces users to participate—by, for example, creating a Uniswap pool where users can buy SCAM at a favorable rate and depositing sufficient rewards into the campaign—the scam can proceed.
When exploiter decided to rugpull, the offchain bot eventually detects that users’ SCAM balances have been reset to 0, it invalidates their participation, and the pending rewards are reclaimed by the campaign manager.
Making profit from user swaps and reclaim original rewards.

## Recommended mitigation steps

`NudgeCampaignFactory.deployCampaign()` should be handled by Nudge admin directly.
