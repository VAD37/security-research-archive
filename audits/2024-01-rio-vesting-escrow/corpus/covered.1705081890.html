<style> code { white-space: pre-wrap; display: block; background-color: #eee; }.executed { background-color: #afa; }.reverted { background-color: #ffa; }.unexecuted { background-color: #faa; }.neutral { background-color: #eee; }</style><b>/mnt/f/Projects/audits/rio-vesting-escrow/lib/openzeppelin-contracts/contracts/access/Ownable.sol</b>
<code>
  1 |     | <span class='unexecuted'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (access/Ownable.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>import &quot;../utils/Context.sol&quot;;</span>
  7 |     | <span class='neutral'></span>
  8 |     | <span class='neutral'>/**</span>
  9 |     | <span class='neutral'> * @dev Contract module which provides a basic access control mechanism, where</span>
 10 |     | <span class='neutral'> * there is an account (an owner) that can be granted exclusive access to</span>
 11 |     | <span class='neutral'> * specific functions.</span>
 12 |     | <span class='neutral'> *</span>
 13 |     | <span class='neutral'> * By default, the owner account will be the one that deploys the contract. This</span>
 14 |     | <span class='neutral'> * can later be changed with {transferOwnership}.</span>
 15 |     | <span class='neutral'> *</span>
 16 |     | <span class='neutral'> * This module is used through inheritance. It will make available the modifier</span>
 17 |     | <span class='neutral'> * `onlyOwner`, which can be applied to your functions to restrict their use to</span>
 18 |     | <span class='neutral'> * the owner.</span>
 19 |     | <span class='neutral'> */</span>
 20 |     | <span class='neutral'>abstract contract Ownable is Context {</span>
 21 |     | <span class='neutral'>    address private _owner;</span>
 22 |     | <span class='neutral'></span>
 23 |     | <span class='neutral'>    event OwnershipTransferred(address indexed previousOwner, address indexed newOwner);</span>
 24 |     | <span class='neutral'></span>
 25 |     | <span class='neutral'>    /**</span>
 26 |     | <span class='neutral'>     * @dev Initializes the contract setting the deployer as the initial owner.</span>
 27 |     | <span class='neutral'>     */</span>
 28 |     | <span class='neutral'>    constructor() {</span>
 29 |     | <span class='unexecuted'>        _transferOwnership(_msgSender());</span>
 30 |     | <span class='neutral'>    }</span>
 31 |     | <span class='neutral'></span>
 32 |     | <span class='neutral'>    /**</span>
 33 |     | <span class='neutral'>     * @dev Throws if called by any account other than the owner.</span>
 34 |     | <span class='neutral'>     */</span>
 35 |     | <span class='neutral'>    modifier onlyOwner() {</span>
 36 |     | <span class='unexecuted'>        _checkOwner();</span>
 37 |     | <span class='neutral'>        _;</span>
 38 |     | <span class='neutral'>    }</span>
 39 |     | <span class='neutral'></span>
 40 |     | <span class='neutral'>    /**</span>
 41 |     | <span class='neutral'>     * @dev Returns the address of the current owner.</span>
 42 |     | <span class='neutral'>     */</span>
 43 |     | <span class='unexecuted'>    function owner() public view virtual returns (address) {</span>
 44 |     | <span class='unexecuted'>        return _owner;</span>
 45 |     | <span class='neutral'>    }</span>
 46 |     | <span class='neutral'></span>
 47 |     | <span class='neutral'>    /**</span>
 48 |     | <span class='neutral'>     * @dev Throws if the sender is not the owner.</span>
 49 |     | <span class='neutral'>     */</span>
 50 |     | <span class='unexecuted'>    function _checkOwner() internal view virtual {</span>
 51 |     | <span class='unexecuted'>        require(owner() == _msgSender(), &quot;Ownable: caller is not the owner&quot;);</span>
 52 |     | <span class='neutral'>    }</span>
 53 |     | <span class='neutral'></span>
 54 |     | <span class='neutral'>    /**</span>
 55 |     | <span class='neutral'>     * @dev Leaves the contract without owner. It will not be possible to call</span>
 56 |     | <span class='neutral'>     * `onlyOwner` functions. Can only be called by the current owner.</span>
 57 |     | <span class='neutral'>     *</span>
 58 |     | <span class='neutral'>     * NOTE: Renouncing ownership will leave the contract without an owner,</span>
 59 |     | <span class='neutral'>     * thereby disabling any functionality that is only available to the owner.</span>
 60 |     | <span class='neutral'>     */</span>
 61 |     | <span class='unexecuted'>    function renounceOwnership() public virtual onlyOwner {</span>
 62 |     | <span class='unexecuted'>        _transferOwnership(address(0));</span>
 63 |     | <span class='neutral'>    }</span>
 64 |     | <span class='neutral'></span>
 65 |     | <span class='neutral'>    /**</span>
 66 |     | <span class='neutral'>     * @dev Transfers ownership of the contract to a new account (`newOwner`).</span>
 67 |     | <span class='neutral'>     * Can only be called by the current owner.</span>
 68 |     | <span class='neutral'>     */</span>
 69 |     | <span class='unexecuted'>    function transferOwnership(address newOwner) public virtual onlyOwner {</span>
 70 |     | <span class='unexecuted'>        require(newOwner != address(0), &quot;Ownable: new owner is the zero address&quot;);</span>
 71 |     | <span class='unexecuted'>        _transferOwnership(newOwner);</span>
 72 |     | <span class='neutral'>    }</span>
 73 |     | <span class='neutral'></span>
 74 |     | <span class='neutral'>    /**</span>
 75 |     | <span class='neutral'>     * @dev Transfers ownership of the contract to a new account (`newOwner`).</span>
 76 |     | <span class='neutral'>     * Internal function without access restriction.</span>
 77 |     | <span class='neutral'>     */</span>
 78 |     | <span class='unexecuted'>    function _transferOwnership(address newOwner) internal virtual {</span>
 79 |     | <span class='unexecuted'>        address oldOwner = _owner;</span>
 80 |     | <span class='unexecuted'>        _owner = newOwner;</span>
 81 |     | <span class='unexecuted'>        emit OwnershipTransferred(oldOwner, newOwner);</span>
 82 |     | <span class='neutral'>    }</span>
 83 |     | <span class='neutral'>}</span>
 84 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/lib/openzeppelin-contracts/contracts/access/Ownable2Step.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (access/Ownable2Step.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>import &quot;./Ownable.sol&quot;;</span>
  7 |     | <span class='neutral'></span>
  8 |     | <span class='neutral'>/**</span>
  9 |     | <span class='neutral'> * @dev Contract module which provides access control mechanism, where</span>
 10 |     | <span class='neutral'> * there is an account (an owner) that can be granted exclusive access to</span>
 11 |     | <span class='neutral'> * specific functions.</span>
 12 |     | <span class='neutral'> *</span>
 13 |     | <span class='neutral'> * By default, the owner account will be the one that deploys the contract. This</span>
 14 |     | <span class='neutral'> * can later be changed with {transferOwnership} and {acceptOwnership}.</span>
 15 |     | <span class='neutral'> *</span>
 16 |     | <span class='neutral'> * This module is used through inheritance. It will make available all functions</span>
 17 |     | <span class='neutral'> * from parent (Ownable).</span>
 18 |     | <span class='neutral'> */</span>
 19 |     | <span class='neutral'>abstract contract Ownable2Step is Ownable {</span>
 20 |     | <span class='neutral'>    address private _pendingOwner;</span>
 21 |     | <span class='neutral'></span>
 22 |     | <span class='neutral'>    event OwnershipTransferStarted(address indexed previousOwner, address indexed newOwner);</span>
 23 |     | <span class='neutral'></span>
 24 |     | <span class='neutral'>    /**</span>
 25 |     | <span class='neutral'>     * @dev Returns the address of the pending owner.</span>
 26 |     | <span class='neutral'>     */</span>
 27 |     | <span class='unexecuted'>    function pendingOwner() public view virtual returns (address) {</span>
 28 |     | <span class='unexecuted'>        return _pendingOwner;</span>
 29 |     | <span class='neutral'>    }</span>
 30 |     | <span class='neutral'></span>
 31 |     | <span class='neutral'>    /**</span>
 32 |     | <span class='neutral'>     * @dev Starts the ownership transfer of the contract to a new account. Replaces the pending transfer if there is one.</span>
 33 |     | <span class='neutral'>     * Can only be called by the current owner.</span>
 34 |     | <span class='neutral'>     */</span>
 35 |     | <span class='unexecuted'>    function transferOwnership(address newOwner) public virtual override onlyOwner {</span>
 36 |     | <span class='unexecuted'>        _pendingOwner = newOwner;</span>
 37 |     | <span class='unexecuted'>        emit OwnershipTransferStarted(owner(), newOwner);</span>
 38 |     | <span class='neutral'>    }</span>
 39 |     | <span class='neutral'></span>
 40 |     | <span class='neutral'>    /**</span>
 41 |     | <span class='neutral'>     * @dev Transfers ownership of the contract to a new account (`newOwner`) and deletes any pending owner.</span>
 42 |     | <span class='neutral'>     * Internal function without access restriction.</span>
 43 |     | <span class='neutral'>     */</span>
 44 |     | <span class='unexecuted'>    function _transferOwnership(address newOwner) internal virtual override {</span>
 45 |     | <span class='unexecuted'>        delete _pendingOwner;</span>
 46 |     | <span class='unexecuted'>        super._transferOwnership(newOwner);</span>
 47 |     | <span class='neutral'>    }</span>
 48 |     | <span class='neutral'></span>
 49 |     | <span class='neutral'>    /**</span>
 50 |     | <span class='neutral'>     * @dev The new owner accepts the ownership transfer.</span>
 51 |     | <span class='neutral'>     */</span>
 52 |     | <span class='unexecuted'>    function acceptOwnership() public virtual {</span>
 53 |     | <span class='neutral'>        address sender = _msgSender();</span>
 54 |     | <span class='unexecuted'>        require(pendingOwner() == sender, &quot;Ownable2Step: caller is not the new owner&quot;);</span>
 55 |     | <span class='unexecuted'>        _transferOwnership(sender);</span>
 56 |     | <span class='neutral'>    }</span>
 57 |     | <span class='neutral'>}</span>
 58 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/lib/openzeppelin-contracts/contracts/governance/Governor.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.1) (governance/Governor.sol)</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
   5 |     | <span class='neutral'></span>
   6 |     | <span class='neutral'>import &quot;../token/ERC721/IERC721Receiver.sol&quot;;</span>
   7 |     | <span class='neutral'>import &quot;../token/ERC1155/IERC1155Receiver.sol&quot;;</span>
   8 |     | <span class='neutral'>import &quot;../utils/cryptography/ECDSA.sol&quot;;</span>
   9 |     | <span class='neutral'>import &quot;../utils/cryptography/EIP712.sol&quot;;</span>
  10 |     | <span class='neutral'>import &quot;../utils/introspection/ERC165.sol&quot;;</span>
  11 |     | <span class='neutral'>import &quot;../utils/math/SafeCast.sol&quot;;</span>
  12 |     | <span class='neutral'>import &quot;../utils/structs/DoubleEndedQueue.sol&quot;;</span>
  13 |     | <span class='neutral'>import &quot;../utils/Address.sol&quot;;</span>
  14 |     | <span class='neutral'>import &quot;../utils/Context.sol&quot;;</span>
  15 |     | <span class='neutral'>import &quot;./IGovernor.sol&quot;;</span>
  16 |     | <span class='neutral'></span>
  17 |     | <span class='neutral'>/**</span>
  18 |     | <span class='neutral'> * @dev Core of the governance system, designed to be extended though various modules.</span>
  19 |     | <span class='neutral'> *</span>
  20 |     | <span class='neutral'> * This contract is abstract and requires several functions to be implemented in various modules:</span>
  21 |     | <span class='neutral'> *</span>
  22 |     | <span class='neutral'> * - A counting module must implement {quorum}, {_quorumReached}, {_voteSucceeded} and {_countVote}</span>
  23 |     | <span class='neutral'> * - A voting module must implement {_getVotes}</span>
  24 |     | <span class='neutral'> * - Additionally, {votingPeriod} must also be implemented</span>
  25 |     | <span class='neutral'> *</span>
  26 |     | <span class='neutral'> * _Available since v4.3._</span>
  27 |     | <span class='neutral'> */</span>
  28 |     | <span class='neutral'>abstract contract Governor is Context, ERC165, EIP712, IGovernor, IERC721Receiver, IERC1155Receiver {</span>
  29 |     | <span class='neutral'>    using DoubleEndedQueue for DoubleEndedQueue.Bytes32Deque;</span>
  30 |     | <span class='neutral'></span>
  31 |     | <span class='unexecuted'>    bytes32 public constant BALLOT_TYPEHASH = keccak256(&quot;Ballot(uint256 proposalId,uint8 support)&quot;);</span>
  32 |     | <span class='unexecuted'>    bytes32 public constant EXTENDED_BALLOT_TYPEHASH =</span>
  33 |     | <span class='neutral'>        keccak256(&quot;ExtendedBallot(uint256 proposalId,uint8 support,string reason,bytes params)&quot;);</span>
  34 |     | <span class='neutral'></span>
  35 |     | <span class='neutral'>    // solhint-disable var-name-mixedcase</span>
  36 |     | <span class='neutral'>    struct ProposalCore {</span>
  37 |     | <span class='neutral'>        // --- start retyped from Timers.BlockNumber at offset 0x00 ---</span>
  38 |     | <span class='neutral'>        uint64 voteStart;</span>
  39 |     | <span class='neutral'>        address proposer;</span>
  40 |     | <span class='neutral'>        bytes4 __gap_unused0;</span>
  41 |     | <span class='neutral'>        // --- start retyped from Timers.BlockNumber at offset 0x20 ---</span>
  42 |     | <span class='neutral'>        uint64 voteEnd;</span>
  43 |     | <span class='neutral'>        bytes24 __gap_unused1;</span>
  44 |     | <span class='neutral'>        // --- Remaining fields starting at offset 0x40 ---------------</span>
  45 |     | <span class='neutral'>        bool executed;</span>
  46 |     | <span class='neutral'>        bool canceled;</span>
  47 |     | <span class='neutral'>    }</span>
  48 |     | <span class='neutral'>    // solhint-enable var-name-mixedcase</span>
  49 |     | <span class='neutral'></span>
  50 |     | <span class='neutral'>    string private _name;</span>
  51 |     | <span class='neutral'></span>
  52 |     | <span class='neutral'>    /// @custom:oz-retyped-from mapping(uint256 =&gt; Governor.ProposalCore)</span>
  53 |     | <span class='neutral'>    mapping(uint256 =&gt; ProposalCore) private _proposals;</span>
  54 |     | <span class='neutral'></span>
  55 |     | <span class='neutral'>    // This queue keeps track of the governor operating on itself. Calls to functions protected by the</span>
  56 |     | <span class='neutral'>    // {onlyGovernance} modifier needs to be whitelisted in this queue. Whitelisting is set in {_beforeExecute},</span>
  57 |     | <span class='neutral'>    // consumed by the {onlyGovernance} modifier and eventually reset in {_afterExecute}. This ensures that the</span>
  58 |     | <span class='neutral'>    // execution of {onlyGovernance} protected calls can only be achieved through successful proposals.</span>
  59 |     | <span class='neutral'>    DoubleEndedQueue.Bytes32Deque private _governanceCall;</span>
  60 |     | <span class='neutral'></span>
  61 |     | <span class='neutral'>    /**</span>
  62 |     | <span class='neutral'>     * @dev Restricts a function so it can only be executed through governance proposals. For example, governance</span>
  63 |     | <span class='neutral'>     * parameter setters in {GovernorSettings} are protected using this modifier.</span>
  64 |     | <span class='neutral'>     *</span>
  65 |     | <span class='neutral'>     * The governance executing address may be different from the Governor&#39;s own address, for example it could be a</span>
  66 |     | <span class='neutral'>     * timelock. This can be customized by modules by overriding {_executor}. The executor is only able to invoke these</span>
  67 |     | <span class='neutral'>     * functions during the execution of the governor&#39;s {execute} function, and not under any other circumstances. Thus,</span>
  68 |     | <span class='neutral'>     * for example, additional timelock proposers are not able to change governance parameters without going through the</span>
  69 |     | <span class='neutral'>     * governance protocol (since v4.6).</span>
  70 |     | <span class='neutral'>     */</span>
  71 |     | <span class='neutral'>    modifier onlyGovernance() {</span>
  72 |     | <span class='unexecuted'>        require(_msgSender() == _executor(), &quot;Governor: onlyGovernance&quot;);</span>
  73 |     | <span class='unexecuted'>        if (_executor() != address(this)) {</span>
  74 |     | <span class='neutral'>            bytes32 msgDataHash = keccak256(_msgData());</span>
  75 |     | <span class='neutral'>            // loop until popping the expected operation - throw if deque is empty (operation not authorized)</span>
  76 |     | <span class='unexecuted'>            while (_governanceCall.popFront() != msgDataHash) {}</span>
  77 |     | <span class='neutral'>        }</span>
  78 |     | <span class='neutral'>        _;</span>
  79 |     | <span class='neutral'>    }</span>
  80 |     | <span class='neutral'></span>
  81 |     | <span class='neutral'>    /**</span>
  82 |     | <span class='neutral'>     * @dev Sets the value for {name} and {version}</span>
  83 |     | <span class='neutral'>     */</span>
  84 |     | <span class='unexecuted'>    constructor(string memory name_) EIP712(name_, version()) {</span>
  85 |     | <span class='unexecuted'>        _name = name_;</span>
  86 |     | <span class='neutral'>    }</span>
  87 |     | <span class='neutral'></span>
  88 |     | <span class='neutral'>    /**</span>
  89 |     | <span class='neutral'>     * @dev Function to receive ETH that will be handled by the governor (disabled if executor is a third party contract)</span>
  90 |     | <span class='neutral'>     */</span>
  91 |     | <span class='neutral'>    receive() external payable virtual {</span>
  92 |     | <span class='unexecuted'>        require(_executor() == address(this), &quot;Governor: must send to executor&quot;);</span>
  93 |     | <span class='neutral'>    }</span>
  94 |     | <span class='neutral'></span>
  95 |     | <span class='neutral'>    /**</span>
  96 |     | <span class='neutral'>     * @dev See {IERC165-supportsInterface}.</span>
  97 |     | <span class='neutral'>     */</span>
  98 |     | <span class='unexecuted'>    function supportsInterface(bytes4 interfaceId) public view virtual override(IERC165, ERC165) returns (bool) {</span>
  99 |     | <span class='neutral'>        bytes4 governorCancelId = this.cancel.selector ^ this.proposalProposer.selector;</span>
 100 |     | <span class='neutral'></span>
 101 |     | <span class='neutral'>        bytes4 governorParamsId = this.castVoteWithReasonAndParams.selector ^</span>
 102 |     | <span class='neutral'>            this.castVoteWithReasonAndParamsBySig.selector ^</span>
 103 |     | <span class='neutral'>            this.getVotesWithParams.selector;</span>
 104 |     | <span class='neutral'></span>
 105 |     | <span class='neutral'>        // The original interface id in v4.3.</span>
 106 |     | <span class='neutral'>        bytes4 governor43Id = type(IGovernor).interfaceId ^</span>
 107 |     | <span class='neutral'>            type(IERC6372).interfaceId ^</span>
 108 |     | <span class='neutral'>            governorCancelId ^</span>
 109 |     | <span class='neutral'>            governorParamsId;</span>
 110 |     | <span class='neutral'></span>
 111 |     | <span class='neutral'>        // An updated interface id in v4.6, with params added.</span>
 112 |     | <span class='neutral'>        bytes4 governor46Id = type(IGovernor).interfaceId ^ type(IERC6372).interfaceId ^ governorCancelId;</span>
 113 |     | <span class='neutral'></span>
 114 |     | <span class='neutral'>        // For the updated interface id in v4.9, we use governorCancelId directly.</span>
 115 |     | <span class='neutral'></span>
 116 |     | <span class='unexecuted'>        return</span>
 117 |     | <span class='unexecuted'>            interfaceId == governor43Id ||</span>
 118 |     | <span class='unexecuted'>            interfaceId == governor46Id ||</span>
 119 |     | <span class='unexecuted'>            interfaceId == governorCancelId ||</span>
 120 |     | <span class='unexecuted'>            interfaceId == type(IERC1155Receiver).interfaceId ||</span>
 121 |     | <span class='unexecuted'>            super.supportsInterface(interfaceId);</span>
 122 |     | <span class='neutral'>    }</span>
 123 |     | <span class='neutral'></span>
 124 |     | <span class='neutral'>    /**</span>
 125 |     | <span class='neutral'>     * @dev See {IGovernor-name}.</span>
 126 |     | <span class='neutral'>     */</span>
 127 |     | <span class='unexecuted'>    function name() public view virtual override returns (string memory) {</span>
 128 |     | <span class='unexecuted'>        return _name;</span>
 129 |     | <span class='neutral'>    }</span>
 130 |     | <span class='neutral'></span>
 131 |     | <span class='neutral'>    /**</span>
 132 |     | <span class='neutral'>     * @dev See {IGovernor-version}.</span>
 133 |     | <span class='neutral'>     */</span>
 134 |     | <span class='unexecuted'>    function version() public view virtual override returns (string memory) {</span>
 135 |     | <span class='unexecuted'>        return &quot;1&quot;;</span>
 136 |     | <span class='neutral'>    }</span>
 137 |     | <span class='neutral'></span>
 138 |     | <span class='neutral'>    /**</span>
 139 |     | <span class='neutral'>     * @dev See {IGovernor-hashProposal}.</span>
 140 |     | <span class='neutral'>     *</span>
 141 |     | <span class='neutral'>     * The proposal id is produced by hashing the ABI encoded `targets` array, the `values` array, the `calldatas` array</span>
 142 |     | <span class='neutral'>     * and the descriptionHash (bytes32 which itself is the keccak256 hash of the description string). This proposal id</span>
 143 |     | <span class='neutral'>     * can be produced from the proposal data which is part of the {ProposalCreated} event. It can even be computed in</span>
 144 |     | <span class='neutral'>     * advance, before the proposal is submitted.</span>
 145 |     | <span class='neutral'>     *</span>
 146 |     | <span class='neutral'>     * Note that the chainId and the governor address are not part of the proposal id computation. Consequently, the</span>
 147 |     | <span class='neutral'>     * same proposal (with same operation and same description) will have the same id if submitted on multiple governors</span>
 148 |     | <span class='neutral'>     * across multiple networks. This also means that in order to execute the same operation twice (on the same</span>
 149 |     | <span class='neutral'>     * governor) the proposer will have to change the description in order to avoid proposal id conflicts.</span>
 150 |     | <span class='neutral'>     */</span>
 151 |     | <span class='unexecuted'>    function hashProposal(</span>
 152 |     | <span class='neutral'>        address[] memory targets,</span>
 153 |     | <span class='neutral'>        uint256[] memory values,</span>
 154 |     | <span class='neutral'>        bytes[] memory calldatas,</span>
 155 |     | <span class='neutral'>        bytes32 descriptionHash</span>
 156 |     | <span class='unexecuted'>    ) public pure virtual override returns (uint256) {</span>
 157 |     | <span class='unexecuted'>        return uint256(keccak256(abi.encode(targets, values, calldatas, descriptionHash)));</span>
 158 |     | <span class='neutral'>    }</span>
 159 |     | <span class='neutral'></span>
 160 |     | <span class='neutral'>    /**</span>
 161 |     | <span class='neutral'>     * @dev See {IGovernor-state}.</span>
 162 |     | <span class='neutral'>     */</span>
 163 |     | <span class='unexecuted'>    function state(uint256 proposalId) public view virtual override returns (ProposalState) {</span>
 164 |     | <span class='unexecuted'>        ProposalCore storage proposal = _proposals[proposalId];</span>
 165 |     | <span class='neutral'></span>
 166 |     | <span class='unexecuted'>        if (proposal.executed) {</span>
 167 |     | <span class='unexecuted'>            return ProposalState.Executed;</span>
 168 |     | <span class='neutral'>        }</span>
 169 |     | <span class='neutral'></span>
 170 |     | <span class='unexecuted'>        if (proposal.canceled) {</span>
 171 |     | <span class='unexecuted'>            return ProposalState.Canceled;</span>
 172 |     | <span class='neutral'>        }</span>
 173 |     | <span class='neutral'></span>
 174 |     | <span class='unexecuted'>        uint256 snapshot = proposalSnapshot(proposalId);</span>
 175 |     | <span class='neutral'></span>
 176 |     | <span class='unexecuted'>        if (snapshot == 0) {</span>
 177 |     | <span class='unexecuted'>            revert(&quot;Governor: unknown proposal id&quot;);</span>
 178 |     | <span class='neutral'>        }</span>
 179 |     | <span class='neutral'></span>
 180 |     | <span class='unexecuted'>        uint256 currentTimepoint = clock();</span>
 181 |     | <span class='neutral'></span>
 182 |     | <span class='unexecuted'>        if (snapshot &gt;= currentTimepoint) {</span>
 183 |     | <span class='unexecuted'>            return ProposalState.Pending;</span>
 184 |     | <span class='neutral'>        }</span>
 185 |     | <span class='neutral'></span>
 186 |     | <span class='unexecuted'>        uint256 deadline = proposalDeadline(proposalId);</span>
 187 |     | <span class='neutral'></span>
 188 |     | <span class='unexecuted'>        if (deadline &gt;= currentTimepoint) {</span>
 189 |     | <span class='unexecuted'>            return ProposalState.Active;</span>
 190 |     | <span class='neutral'>        }</span>
 191 |     | <span class='neutral'></span>
 192 |     | <span class='unexecuted'>        if (_quorumReached(proposalId) &amp;&amp; _voteSucceeded(proposalId)) {</span>
 193 |     | <span class='unexecuted'>            return ProposalState.Succeeded;</span>
 194 |     | <span class='neutral'>        } else {</span>
 195 |     | <span class='unexecuted'>            return ProposalState.Defeated;</span>
 196 |     | <span class='neutral'>        }</span>
 197 |     | <span class='neutral'>    }</span>
 198 |     | <span class='neutral'></span>
 199 |     | <span class='neutral'>    /**</span>
 200 |     | <span class='neutral'>     * @dev Part of the Governor Bravo&#39;s interface: _&quot;The number of votes required in order for a voter to become a proposer&quot;_.</span>
 201 |     | <span class='neutral'>     */</span>
 202 |     | <span class='neutral'>    function proposalThreshold() public view virtual returns (uint256) {</span>
 203 |     | <span class='neutral'>        return 0;</span>
 204 |     | <span class='neutral'>    }</span>
 205 |     | <span class='neutral'></span>
 206 |     | <span class='neutral'>    /**</span>
 207 |     | <span class='neutral'>     * @dev See {IGovernor-proposalSnapshot}.</span>
 208 |     | <span class='neutral'>     */</span>
 209 |     | <span class='unexecuted'>    function proposalSnapshot(uint256 proposalId) public view virtual override returns (uint256) {</span>
 210 |     | <span class='unexecuted'>        return _proposals[proposalId].voteStart;</span>
 211 |     | <span class='neutral'>    }</span>
 212 |     | <span class='neutral'></span>
 213 |     | <span class='neutral'>    /**</span>
 214 |     | <span class='neutral'>     * @dev See {IGovernor-proposalDeadline}.</span>
 215 |     | <span class='neutral'>     */</span>
 216 |     | <span class='unexecuted'>    function proposalDeadline(uint256 proposalId) public view virtual override returns (uint256) {</span>
 217 |     | <span class='unexecuted'>        return _proposals[proposalId].voteEnd;</span>
 218 |     | <span class='neutral'>    }</span>
 219 |     | <span class='neutral'></span>
 220 |     | <span class='neutral'>    /**</span>
 221 |     | <span class='neutral'>     * @dev Returns the account that created a given proposal.</span>
 222 |     | <span class='neutral'>     */</span>
 223 |     | <span class='unexecuted'>    function proposalProposer(uint256 proposalId) public view virtual override returns (address) {</span>
 224 |     | <span class='unexecuted'>        return _proposals[proposalId].proposer;</span>
 225 |     | <span class='neutral'>    }</span>
 226 |     | <span class='neutral'></span>
 227 |     | <span class='neutral'>    /**</span>
 228 |     | <span class='neutral'>     * @dev Amount of votes already cast passes the threshold limit.</span>
 229 |     | <span class='neutral'>     */</span>
 230 |     | <span class='neutral'>    function _quorumReached(uint256 proposalId) internal view virtual returns (bool);</span>
 231 |     | <span class='neutral'></span>
 232 |     | <span class='neutral'>    /**</span>
 233 |     | <span class='neutral'>     * @dev Is the proposal successful or not.</span>
 234 |     | <span class='neutral'>     */</span>
 235 |     | <span class='neutral'>    function _voteSucceeded(uint256 proposalId) internal view virtual returns (bool);</span>
 236 |     | <span class='neutral'></span>
 237 |     | <span class='neutral'>    /**</span>
 238 |     | <span class='neutral'>     * @dev Get the voting weight of `account` at a specific `timepoint`, for a vote as described by `params`.</span>
 239 |     | <span class='neutral'>     */</span>
 240 |     | <span class='neutral'>    function _getVotes(address account, uint256 timepoint, bytes memory params) internal view virtual returns (uint256);</span>
 241 |     | <span class='neutral'></span>
 242 |     | <span class='neutral'>    /**</span>
 243 |     | <span class='neutral'>     * @dev Register a vote for `proposalId` by `account` with a given `support`, voting `weight` and voting `params`.</span>
 244 |     | <span class='neutral'>     *</span>
 245 |     | <span class='neutral'>     * Note: Support is generic and can represent various things depending on the voting system used.</span>
 246 |     | <span class='neutral'>     */</span>
 247 |     | <span class='neutral'>    function _countVote(</span>
 248 |     | <span class='neutral'>        uint256 proposalId,</span>
 249 |     | <span class='neutral'>        address account,</span>
 250 |     | <span class='neutral'>        uint8 support,</span>
 251 |     | <span class='neutral'>        uint256 weight,</span>
 252 |     | <span class='neutral'>        bytes memory params</span>
 253 |     | <span class='neutral'>    ) internal virtual;</span>
 254 |     | <span class='neutral'></span>
 255 |     | <span class='neutral'>    /**</span>
 256 |     | <span class='neutral'>     * @dev Default additional encoded parameters used by castVote methods that don&#39;t include them</span>
 257 |     | <span class='neutral'>     *</span>
 258 |     | <span class='neutral'>     * Note: Should be overridden by specific implementations to use an appropriate value, the</span>
 259 |     | <span class='neutral'>     * meaning of the additional params, in the context of that implementation</span>
 260 |     | <span class='neutral'>     */</span>
 261 |     | <span class='unexecuted'>    function _defaultParams() internal view virtual returns (bytes memory) {</span>
 262 |     | <span class='unexecuted'>        return &quot;&quot;;</span>
 263 |     | <span class='neutral'>    }</span>
 264 |     | <span class='neutral'></span>
 265 |     | <span class='neutral'>    /**</span>
 266 |     | <span class='neutral'>     * @dev See {IGovernor-propose}. This function has opt-in frontrunning protection, described in {_isValidDescriptionForProposer}.</span>
 267 |     | <span class='neutral'>     */</span>
 268 |     | <span class='unexecuted'>    function propose(</span>
 269 |     | <span class='neutral'>        address[] memory targets,</span>
 270 |     | <span class='neutral'>        uint256[] memory values,</span>
 271 |     | <span class='neutral'>        bytes[] memory calldatas,</span>
 272 |     | <span class='neutral'>        string memory description</span>
 273 |     | <span class='unexecuted'>    ) public virtual override returns (uint256) {</span>
 274 |     | <span class='neutral'>        address proposer = _msgSender();</span>
 275 |     | <span class='unexecuted'>        require(_isValidDescriptionForProposer(proposer, description), &quot;Governor: proposer restricted&quot;);</span>
 276 |     | <span class='neutral'></span>
 277 |     | <span class='unexecuted'>        uint256 currentTimepoint = clock();</span>
 278 |     | <span class='unexecuted'>        require(</span>
 279 |     | <span class='unexecuted'>            getVotes(proposer, currentTimepoint - 1) &gt;= proposalThreshold(),</span>
 280 |     | <span class='neutral'>            &quot;Governor: proposer votes below proposal threshold&quot;</span>
 281 |     | <span class='neutral'>        );</span>
 282 |     | <span class='neutral'></span>
 283 |     | <span class='unexecuted'>        uint256 proposalId = hashProposal(targets, values, calldatas, keccak256(bytes(description)));</span>
 284 |     | <span class='neutral'></span>
 285 |     | <span class='unexecuted'>        require(targets.length == values.length, &quot;Governor: invalid proposal length&quot;);</span>
 286 |     | <span class='unexecuted'>        require(targets.length == calldatas.length, &quot;Governor: invalid proposal length&quot;);</span>
 287 |     | <span class='unexecuted'>        require(targets.length &gt; 0, &quot;Governor: empty proposal&quot;);</span>
 288 |     | <span class='unexecuted'>        require(_proposals[proposalId].voteStart == 0, &quot;Governor: proposal already exists&quot;);</span>
 289 |     | <span class='neutral'></span>
 290 |     | <span class='unexecuted'>        uint256 snapshot = currentTimepoint + votingDelay();</span>
 291 |     | <span class='unexecuted'>        uint256 deadline = snapshot + votingPeriod();</span>
 292 |     | <span class='neutral'></span>
 293 |     | <span class='unexecuted'>        _proposals[proposalId] = ProposalCore({</span>
 294 |     | <span class='neutral'>            proposer: proposer,</span>
 295 |     | <span class='unexecuted'>            voteStart: SafeCast.toUint64(snapshot),</span>
 296 |     | <span class='unexecuted'>            voteEnd: SafeCast.toUint64(deadline),</span>
 297 |     | <span class='neutral'>            executed: false,</span>
 298 |     | <span class='neutral'>            canceled: false,</span>
 299 |     | <span class='neutral'>            __gap_unused0: 0,</span>
 300 |     | <span class='unexecuted'>            __gap_unused1: 0</span>
 301 |     | <span class='neutral'>        });</span>
 302 |     | <span class='neutral'></span>
 303 |     | <span class='unexecuted'>        emit ProposalCreated(</span>
 304 |     | <span class='neutral'>            proposalId,</span>
 305 |     | <span class='unexecuted'>            proposer,</span>
 306 |     | <span class='neutral'>            targets,</span>
 307 |     | <span class='unexecuted'>            values,</span>
 308 |     | <span class='unexecuted'>            new string[](targets.length),</span>
 309 |     | <span class='unexecuted'>            calldatas,</span>
 310 |     | <span class='unexecuted'>            snapshot,</span>
 311 |     | <span class='unexecuted'>            deadline,</span>
 312 |     | <span class='unexecuted'>            description</span>
 313 |     | <span class='neutral'>        );</span>
 314 |     | <span class='neutral'></span>
 315 |     | <span class='unexecuted'>        return proposalId;</span>
 316 |     | <span class='neutral'>    }</span>
 317 |     | <span class='neutral'></span>
 318 |     | <span class='neutral'>    /**</span>
 319 |     | <span class='neutral'>     * @dev See {IGovernor-execute}.</span>
 320 |     | <span class='neutral'>     */</span>
 321 |     | <span class='unexecuted'>    function execute(</span>
 322 |     | <span class='neutral'>        address[] memory targets,</span>
 323 |     | <span class='neutral'>        uint256[] memory values,</span>
 324 |     | <span class='neutral'>        bytes[] memory calldatas,</span>
 325 |     | <span class='neutral'>        bytes32 descriptionHash</span>
 326 |     | <span class='unexecuted'>    ) public payable virtual override returns (uint256) {</span>
 327 |     | <span class='unexecuted'>        uint256 proposalId = hashProposal(targets, values, calldatas, descriptionHash);</span>
 328 |     | <span class='neutral'></span>
 329 |     | <span class='unexecuted'>        ProposalState currentState = state(proposalId);</span>
 330 |     | <span class='unexecuted'>        require(</span>
 331 |     | <span class='unexecuted'>            currentState == ProposalState.Succeeded || currentState == ProposalState.Queued,</span>
 332 |     | <span class='neutral'>            &quot;Governor: proposal not successful&quot;</span>
 333 |     | <span class='neutral'>        );</span>
 334 |     | <span class='unexecuted'>        _proposals[proposalId].executed = true;</span>
 335 |     | <span class='neutral'></span>
 336 |     | <span class='unexecuted'>        emit ProposalExecuted(proposalId);</span>
 337 |     | <span class='neutral'></span>
 338 |     | <span class='unexecuted'>        _beforeExecute(proposalId, targets, values, calldatas, descriptionHash);</span>
 339 |     | <span class='unexecuted'>        _execute(proposalId, targets, values, calldatas, descriptionHash);</span>
 340 |     | <span class='unexecuted'>        _afterExecute(proposalId, targets, values, calldatas, descriptionHash);</span>
 341 |     | <span class='neutral'></span>
 342 |     | <span class='unexecuted'>        return proposalId;</span>
 343 |     | <span class='neutral'>    }</span>
 344 |     | <span class='neutral'></span>
 345 |     | <span class='neutral'>    /**</span>
 346 |     | <span class='neutral'>     * @dev See {IGovernor-cancel}.</span>
 347 |     | <span class='neutral'>     */</span>
 348 |     | <span class='unexecuted'>    function cancel(</span>
 349 |     | <span class='neutral'>        address[] memory targets,</span>
 350 |     | <span class='neutral'>        uint256[] memory values,</span>
 351 |     | <span class='neutral'>        bytes[] memory calldatas,</span>
 352 |     | <span class='neutral'>        bytes32 descriptionHash</span>
 353 |     | <span class='unexecuted'>    ) public virtual override returns (uint256) {</span>
 354 |     | <span class='unexecuted'>        uint256 proposalId = hashProposal(targets, values, calldatas, descriptionHash);</span>
 355 |     | <span class='unexecuted'>        require(state(proposalId) == ProposalState.Pending, &quot;Governor: too late to cancel&quot;);</span>
 356 |     | <span class='unexecuted'>        require(_msgSender() == _proposals[proposalId].proposer, &quot;Governor: only proposer can cancel&quot;);</span>
 357 |     | <span class='unexecuted'>        return _cancel(targets, values, calldatas, descriptionHash);</span>
 358 |     | <span class='neutral'>    }</span>
 359 |     | <span class='neutral'></span>
 360 |     | <span class='neutral'>    /**</span>
 361 |     | <span class='neutral'>     * @dev Internal execution mechanism. Can be overridden to implement different execution mechanism</span>
 362 |     | <span class='neutral'>     */</span>
 363 |     | <span class='unexecuted'>    function _execute(</span>
 364 |     | <span class='neutral'>        uint256 /* proposalId */,</span>
 365 |     | <span class='neutral'>        address[] memory targets,</span>
 366 |     | <span class='neutral'>        uint256[] memory values,</span>
 367 |     | <span class='neutral'>        bytes[] memory calldatas,</span>
 368 |     | <span class='neutral'>        bytes32 /*descriptionHash*/</span>
 369 |     | <span class='neutral'>    ) internal virtual {</span>
 370 |     | <span class='unexecuted'>        string memory errorMessage = &quot;Governor: call reverted without message&quot;;</span>
 371 |     | <span class='unexecuted'>        for (uint256 i = 0; i &lt; targets.length; ++i) {</span>
 372 |     | <span class='unexecuted'>            (bool success, bytes memory returndata) = targets[i].call{value: values[i]}(calldatas[i]);</span>
 373 |     | <span class='unexecuted'>            Address.verifyCallResult(success, returndata, errorMessage);</span>
 374 |     | <span class='neutral'>        }</span>
 375 |     | <span class='neutral'>    }</span>
 376 |     | <span class='neutral'></span>
 377 |     | <span class='neutral'>    /**</span>
 378 |     | <span class='neutral'>     * @dev Hook before execution is triggered.</span>
 379 |     | <span class='neutral'>     */</span>
 380 |     | <span class='unexecuted'>    function _beforeExecute(</span>
 381 |     | <span class='neutral'>        uint256 /* proposalId */,</span>
 382 |     | <span class='neutral'>        address[] memory targets,</span>
 383 |     | <span class='neutral'>        uint256[] memory /* values */,</span>
 384 |     | <span class='neutral'>        bytes[] memory calldatas,</span>
 385 |     | <span class='neutral'>        bytes32 /*descriptionHash*/</span>
 386 |     | <span class='neutral'>    ) internal virtual {</span>
 387 |     | <span class='unexecuted'>        if (_executor() != address(this)) {</span>
 388 |     | <span class='unexecuted'>            for (uint256 i = 0; i &lt; targets.length; ++i) {</span>
 389 |     | <span class='unexecuted'>                if (targets[i] == address(this)) {</span>
 390 |     | <span class='unexecuted'>                    _governanceCall.pushBack(keccak256(calldatas[i]));</span>
 391 |     | <span class='neutral'>                }</span>
 392 |     | <span class='neutral'>            }</span>
 393 |     | <span class='neutral'>        }</span>
 394 |     | <span class='neutral'>    }</span>
 395 |     | <span class='neutral'></span>
 396 |     | <span class='neutral'>    /**</span>
 397 |     | <span class='neutral'>     * @dev Hook after execution is triggered.</span>
 398 |     | <span class='neutral'>     */</span>
 399 |     | <span class='neutral'>    function _afterExecute(</span>
 400 |     | <span class='neutral'>        uint256 /* proposalId */,</span>
 401 |     | <span class='neutral'>        address[] memory /* targets */,</span>
 402 |     | <span class='neutral'>        uint256[] memory /* values */,</span>
 403 |     | <span class='neutral'>        bytes[] memory /* calldatas */,</span>
 404 |     | <span class='neutral'>        bytes32 /*descriptionHash*/</span>
 405 |     | <span class='neutral'>    ) internal virtual {</span>
 406 |     | <span class='neutral'>        if (_executor() != address(this)) {</span>
 407 |     | <span class='neutral'>            if (!_governanceCall.empty()) {</span>
 408 |     | <span class='neutral'>                _governanceCall.clear();</span>
 409 |     | <span class='neutral'>            }</span>
 410 |     | <span class='neutral'>        }</span>
 411 |     | <span class='neutral'>    }</span>
 412 |     | <span class='neutral'></span>
 413 |     | <span class='neutral'>    /**</span>
 414 |     | <span class='neutral'>     * @dev Internal cancel mechanism: locks up the proposal timer, preventing it from being re-submitted. Marks it as</span>
 415 |     | <span class='neutral'>     * canceled to allow distinguishing it from executed proposals.</span>
 416 |     | <span class='neutral'>     *</span>
 417 |     | <span class='neutral'>     * Emits a {IGovernor-ProposalCanceled} event.</span>
 418 |     | <span class='neutral'>     */</span>
 419 |     | <span class='unexecuted'>    function _cancel(</span>
 420 |     | <span class='neutral'>        address[] memory targets,</span>
 421 |     | <span class='neutral'>        uint256[] memory values,</span>
 422 |     | <span class='neutral'>        bytes[] memory calldatas,</span>
 423 |     | <span class='neutral'>        bytes32 descriptionHash</span>
 424 |     | <span class='unexecuted'>    ) internal virtual returns (uint256) {</span>
 425 |     | <span class='unexecuted'>        uint256 proposalId = hashProposal(targets, values, calldatas, descriptionHash);</span>
 426 |     | <span class='neutral'></span>
 427 |     | <span class='unexecuted'>        ProposalState currentState = state(proposalId);</span>
 428 |     | <span class='neutral'></span>
 429 |     | <span class='unexecuted'>        require(</span>
 430 |     | <span class='unexecuted'>            currentState != ProposalState.Canceled &amp;&amp;</span>
 431 |     | <span class='unexecuted'>                currentState != ProposalState.Expired &amp;&amp;</span>
 432 |     | <span class='unexecuted'>                currentState != ProposalState.Executed,</span>
 433 |     | <span class='neutral'>            &quot;Governor: proposal not active&quot;</span>
 434 |     | <span class='neutral'>        );</span>
 435 |     | <span class='unexecuted'>        _proposals[proposalId].canceled = true;</span>
 436 |     | <span class='neutral'></span>
 437 |     | <span class='unexecuted'>        emit ProposalCanceled(proposalId);</span>
 438 |     | <span class='neutral'></span>
 439 |     | <span class='unexecuted'>        return proposalId;</span>
 440 |     | <span class='neutral'>    }</span>
 441 |     | <span class='neutral'></span>
 442 |     | <span class='neutral'>    /**</span>
 443 |     | <span class='neutral'>     * @dev See {IGovernor-getVotes}.</span>
 444 |     | <span class='neutral'>     */</span>
 445 |     | <span class='unexecuted'>    function getVotes(address account, uint256 timepoint) public view virtual override returns (uint256) {</span>
 446 |     | <span class='unexecuted'>        return _getVotes(account, timepoint, _defaultParams());</span>
 447 |     | <span class='neutral'>    }</span>
 448 |     | <span class='neutral'></span>
 449 |     | <span class='neutral'>    /**</span>
 450 |     | <span class='neutral'>     * @dev See {IGovernor-getVotesWithParams}.</span>
 451 |     | <span class='neutral'>     */</span>
 452 |     | <span class='unexecuted'>    function getVotesWithParams(</span>
 453 |     | <span class='neutral'>        address account,</span>
 454 |     | <span class='neutral'>        uint256 timepoint,</span>
 455 |     | <span class='neutral'>        bytes memory params</span>
 456 |     | <span class='unexecuted'>    ) public view virtual override returns (uint256) {</span>
 457 |     | <span class='unexecuted'>        return _getVotes(account, timepoint, params);</span>
 458 |     | <span class='neutral'>    }</span>
 459 |     | <span class='neutral'></span>
 460 |     | <span class='neutral'>    /**</span>
 461 |     | <span class='neutral'>     * @dev See {IGovernor-castVote}.</span>
 462 |     | <span class='neutral'>     */</span>
 463 |     | <span class='unexecuted'>    function castVote(uint256 proposalId, uint8 support) public virtual override returns (uint256) {</span>
 464 |     | <span class='unexecuted'>        address voter = _msgSender();</span>
 465 |     | <span class='unexecuted'>        return _castVote(proposalId, voter, support, &quot;&quot;);</span>
 466 |     | <span class='neutral'>    }</span>
 467 |     | <span class='neutral'></span>
 468 |     | <span class='neutral'>    /**</span>
 469 |     | <span class='neutral'>     * @dev See {IGovernor-castVoteWithReason}.</span>
 470 |     | <span class='neutral'>     */</span>
 471 |     | <span class='unexecuted'>    function castVoteWithReason(</span>
 472 |     | <span class='neutral'>        uint256 proposalId,</span>
 473 |     | <span class='neutral'>        uint8 support,</span>
 474 |     | <span class='neutral'>        string calldata reason</span>
 475 |     | <span class='unexecuted'>    ) public virtual override returns (uint256) {</span>
 476 |     | <span class='unexecuted'>        address voter = _msgSender();</span>
 477 |     | <span class='unexecuted'>        return _castVote(proposalId, voter, support, reason);</span>
 478 |     | <span class='neutral'>    }</span>
 479 |     | <span class='neutral'></span>
 480 |     | <span class='neutral'>    /**</span>
 481 |     | <span class='neutral'>     * @dev See {IGovernor-castVoteWithReasonAndParams}.</span>
 482 |     | <span class='neutral'>     */</span>
 483 |     | <span class='unexecuted'>    function castVoteWithReasonAndParams(</span>
 484 |     | <span class='neutral'>        uint256 proposalId,</span>
 485 |     | <span class='neutral'>        uint8 support,</span>
 486 |     | <span class='neutral'>        string calldata reason,</span>
 487 |     | <span class='neutral'>        bytes memory params</span>
 488 |     | <span class='unexecuted'>    ) public virtual override returns (uint256) {</span>
 489 |     | <span class='unexecuted'>        address voter = _msgSender();</span>
 490 |     | <span class='unexecuted'>        return _castVote(proposalId, voter, support, reason, params);</span>
 491 |     | <span class='neutral'>    }</span>
 492 |     | <span class='neutral'></span>
 493 |     | <span class='neutral'>    /**</span>
 494 |     | <span class='neutral'>     * @dev See {IGovernor-castVoteBySig}.</span>
 495 |     | <span class='neutral'>     */</span>
 496 |     | <span class='unexecuted'>    function castVoteBySig(</span>
 497 |     | <span class='neutral'>        uint256 proposalId,</span>
 498 |     | <span class='neutral'>        uint8 support,</span>
 499 |     | <span class='neutral'>        uint8 v,</span>
 500 |     | <span class='neutral'>        bytes32 r,</span>
 501 |     | <span class='neutral'>        bytes32 s</span>
 502 |     | <span class='unexecuted'>    ) public virtual override returns (uint256) {</span>
 503 |     | <span class='unexecuted'>        address voter = ECDSA.recover(</span>
 504 |     | <span class='unexecuted'>            _hashTypedDataV4(keccak256(abi.encode(BALLOT_TYPEHASH, proposalId, support))),</span>
 505 |     | <span class='neutral'>            v,</span>
 506 |     | <span class='neutral'>            r,</span>
 507 |     | <span class='neutral'>            s</span>
 508 |     | <span class='neutral'>        );</span>
 509 |     | <span class='unexecuted'>        return _castVote(proposalId, voter, support, &quot;&quot;);</span>
 510 |     | <span class='neutral'>    }</span>
 511 |     | <span class='neutral'></span>
 512 |     | <span class='neutral'>    /**</span>
 513 |     | <span class='neutral'>     * @dev See {IGovernor-castVoteWithReasonAndParamsBySig}.</span>
 514 |     | <span class='neutral'>     */</span>
 515 |     | <span class='unexecuted'>    function castVoteWithReasonAndParamsBySig(</span>
 516 |     | <span class='neutral'>        uint256 proposalId,</span>
 517 |     | <span class='neutral'>        uint8 support,</span>
 518 |     | <span class='neutral'>        string calldata reason,</span>
 519 |     | <span class='neutral'>        bytes memory params,</span>
 520 |     | <span class='neutral'>        uint8 v,</span>
 521 |     | <span class='neutral'>        bytes32 r,</span>
 522 |     | <span class='neutral'>        bytes32 s</span>
 523 |     | <span class='unexecuted'>    ) public virtual override returns (uint256) {</span>
 524 |     | <span class='unexecuted'>        address voter = ECDSA.recover(</span>
 525 |     | <span class='unexecuted'>            _hashTypedDataV4(</span>
 526 |     | <span class='unexecuted'>                keccak256(</span>
 527 |     | <span class='unexecuted'>                    abi.encode(</span>
 528 |     | <span class='neutral'>                        EXTENDED_BALLOT_TYPEHASH,</span>
 529 |     | <span class='unexecuted'>                        proposalId,</span>
 530 |     | <span class='unexecuted'>                        support,</span>
 531 |     | <span class='unexecuted'>                        keccak256(bytes(reason)),</span>
 532 |     | <span class='unexecuted'>                        keccak256(params)</span>
 533 |     | <span class='neutral'>                    )</span>
 534 |     | <span class='neutral'>                )</span>
 535 |     | <span class='neutral'>            ),</span>
 536 |     | <span class='unexecuted'>            v,</span>
 537 |     | <span class='unexecuted'>            r,</span>
 538 |     | <span class='unexecuted'>            s</span>
 539 |     | <span class='neutral'>        );</span>
 540 |     | <span class='neutral'></span>
 541 |     | <span class='unexecuted'>        return _castVote(proposalId, voter, support, reason, params);</span>
 542 |     | <span class='neutral'>    }</span>
 543 |     | <span class='neutral'></span>
 544 |     | <span class='neutral'>    /**</span>
 545 |     | <span class='neutral'>     * @dev Internal vote casting mechanism: Check that the vote is pending, that it has not been cast yet, retrieve</span>
 546 |     | <span class='neutral'>     * voting weight using {IGovernor-getVotes} and call the {_countVote} internal function. Uses the _defaultParams().</span>
 547 |     | <span class='neutral'>     *</span>
 548 |     | <span class='neutral'>     * Emits a {IGovernor-VoteCast} event.</span>
 549 |     | <span class='neutral'>     */</span>
 550 |     | <span class='unexecuted'>    function _castVote(</span>
 551 |     | <span class='neutral'>        uint256 proposalId,</span>
 552 |     | <span class='neutral'>        address account,</span>
 553 |     | <span class='neutral'>        uint8 support,</span>
 554 |     | <span class='neutral'>        string memory reason</span>
 555 |     | <span class='unexecuted'>    ) internal virtual returns (uint256) {</span>
 556 |     | <span class='unexecuted'>        return _castVote(proposalId, account, support, reason, _defaultParams());</span>
 557 |     | <span class='neutral'>    }</span>
 558 |     | <span class='neutral'></span>
 559 |     | <span class='neutral'>    /**</span>
 560 |     | <span class='neutral'>     * @dev Internal vote casting mechanism: Check that the vote is pending, that it has not been cast yet, retrieve</span>
 561 |     | <span class='neutral'>     * voting weight using {IGovernor-getVotes} and call the {_countVote} internal function.</span>
 562 |     | <span class='neutral'>     *</span>
 563 |     | <span class='neutral'>     * Emits a {IGovernor-VoteCast} event.</span>
 564 |     | <span class='neutral'>     */</span>
 565 |     | <span class='unexecuted'>    function _castVote(</span>
 566 |     | <span class='neutral'>        uint256 proposalId,</span>
 567 |     | <span class='neutral'>        address account,</span>
 568 |     | <span class='neutral'>        uint8 support,</span>
 569 |     | <span class='neutral'>        string memory reason,</span>
 570 |     | <span class='neutral'>        bytes memory params</span>
 571 |     | <span class='unexecuted'>    ) internal virtual returns (uint256) {</span>
 572 |     | <span class='unexecuted'>        ProposalCore storage proposal = _proposals[proposalId];</span>
 573 |     | <span class='unexecuted'>        require(state(proposalId) == ProposalState.Active, &quot;Governor: vote not currently active&quot;);</span>
 574 |     | <span class='neutral'></span>
 575 |     | <span class='unexecuted'>        uint256 weight = _getVotes(account, proposal.voteStart, params);</span>
 576 |     | <span class='unexecuted'>        _countVote(proposalId, account, support, weight, params);</span>
 577 |     | <span class='neutral'></span>
 578 |     | <span class='unexecuted'>        if (params.length == 0) {</span>
 579 |     | <span class='unexecuted'>            emit VoteCast(account, proposalId, support, weight, reason);</span>
 580 |     | <span class='neutral'>        } else {</span>
 581 |     | <span class='unexecuted'>            emit VoteCastWithParams(account, proposalId, support, weight, reason, params);</span>
 582 |     | <span class='neutral'>        }</span>
 583 |     | <span class='neutral'></span>
 584 |     | <span class='unexecuted'>        return weight;</span>
 585 |     | <span class='neutral'>    }</span>
 586 |     | <span class='neutral'></span>
 587 |     | <span class='neutral'>    /**</span>
 588 |     | <span class='neutral'>     * @dev Relays a transaction or function call to an arbitrary target. In cases where the governance executor</span>
 589 |     | <span class='neutral'>     * is some contract other than the governor itself, like when using a timelock, this function can be invoked</span>
 590 |     | <span class='neutral'>     * in a governance proposal to recover tokens or Ether that was sent to the governor contract by mistake.</span>
 591 |     | <span class='neutral'>     * Note that if the executor is simply the governor itself, use of `relay` is redundant.</span>
 592 |     | <span class='neutral'>     */</span>
 593 |     | <span class='unexecuted'>    function relay(address target, uint256 value, bytes calldata data) external payable virtual onlyGovernance {</span>
 594 |     | <span class='unexecuted'>        (bool success, bytes memory returndata) = target.call{value: value}(data);</span>
 595 |     | <span class='unexecuted'>        Address.verifyCallResult(success, returndata, &quot;Governor: relay reverted without message&quot;);</span>
 596 |     | <span class='neutral'>    }</span>
 597 |     | <span class='neutral'></span>
 598 |     | <span class='neutral'>    /**</span>
 599 |     | <span class='neutral'>     * @dev Address through which the governor executes action. Will be overloaded by module that execute actions</span>
 600 |     | <span class='neutral'>     * through another contract such as a timelock.</span>
 601 |     | <span class='neutral'>     */</span>
 602 |     | <span class='neutral'>    function _executor() internal view virtual returns (address) {</span>
 603 |     | <span class='unexecuted'>        return address(this);</span>
 604 |     | <span class='neutral'>    }</span>
 605 |     | <span class='neutral'></span>
 606 |     | <span class='neutral'>    /**</span>
 607 |     | <span class='neutral'>     * @dev See {IERC721Receiver-onERC721Received}.</span>
 608 |     | <span class='neutral'>     */</span>
 609 |     | <span class='unexecuted'>    function onERC721Received(address, address, uint256, bytes memory) public virtual override returns (bytes4) {</span>
 610 |     | <span class='neutral'>        return this.onERC721Received.selector;</span>
 611 |     | <span class='neutral'>    }</span>
 612 |     | <span class='neutral'></span>
 613 |     | <span class='neutral'>    /**</span>
 614 |     | <span class='neutral'>     * @dev See {IERC1155Receiver-onERC1155Received}.</span>
 615 |     | <span class='neutral'>     */</span>
 616 |     | <span class='unexecuted'>    function onERC1155Received(</span>
 617 |     | <span class='neutral'>        address,</span>
 618 |     | <span class='neutral'>        address,</span>
 619 |     | <span class='neutral'>        uint256,</span>
 620 |     | <span class='neutral'>        uint256,</span>
 621 |     | <span class='neutral'>        bytes memory</span>
 622 |     | <span class='neutral'>    ) public virtual override returns (bytes4) {</span>
 623 |     | <span class='neutral'>        return this.onERC1155Received.selector;</span>
 624 |     | <span class='neutral'>    }</span>
 625 |     | <span class='neutral'></span>
 626 |     | <span class='neutral'>    /**</span>
 627 |     | <span class='neutral'>     * @dev See {IERC1155Receiver-onERC1155BatchReceived}.</span>
 628 |     | <span class='neutral'>     */</span>
 629 |     | <span class='unexecuted'>    function onERC1155BatchReceived(</span>
 630 |     | <span class='neutral'>        address,</span>
 631 |     | <span class='neutral'>        address,</span>
 632 |     | <span class='neutral'>        uint256[] memory,</span>
 633 |     | <span class='neutral'>        uint256[] memory,</span>
 634 |     | <span class='neutral'>        bytes memory</span>
 635 |     | <span class='neutral'>    ) public virtual override returns (bytes4) {</span>
 636 |     | <span class='neutral'>        return this.onERC1155BatchReceived.selector;</span>
 637 |     | <span class='neutral'>    }</span>
 638 |     | <span class='neutral'></span>
 639 |     | <span class='neutral'>    /**</span>
 640 |     | <span class='neutral'>     * @dev Check if the proposer is authorized to submit a proposal with the given description.</span>
 641 |     | <span class='neutral'>     *</span>
 642 |     | <span class='neutral'>     * If the proposal description ends with `#proposer=0x???`, where `0x???` is an address written as a hex string</span>
 643 |     | <span class='neutral'>     * (case insensitive), then the submission of this proposal will only be authorized to said address.</span>
 644 |     | <span class='neutral'>     *</span>
 645 |     | <span class='neutral'>     * This is used for frontrunning protection. By adding this pattern at the end of their proposal, one can ensure</span>
 646 |     | <span class='neutral'>     * that no other address can submit the same proposal. An attacker would have to either remove or change that part,</span>
 647 |     | <span class='neutral'>     * which would result in a different proposal id.</span>
 648 |     | <span class='neutral'>     *</span>
 649 |     | <span class='neutral'>     * If the description does not match this pattern, it is unrestricted and anyone can submit it. This includes:</span>
 650 |     | <span class='neutral'>     * - If the `0x???` part is not a valid hex string.</span>
 651 |     | <span class='neutral'>     * - If the `0x???` part is a valid hex string, but does not contain exactly 40 hex digits.</span>
 652 |     | <span class='neutral'>     * - If it ends with the expected suffix followed by newlines or other whitespace.</span>
 653 |     | <span class='neutral'>     * - If it ends with some other similar suffix, e.g. `#other=abc`.</span>
 654 |     | <span class='neutral'>     * - If it does not end with any such suffix.</span>
 655 |     | <span class='neutral'>     */</span>
 656 |     | <span class='unexecuted'>    function _isValidDescriptionForProposer(</span>
 657 |     | <span class='neutral'>        address proposer,</span>
 658 |     | <span class='neutral'>        string memory description</span>
 659 |     | <span class='unexecuted'>    ) internal view virtual returns (bool) {</span>
 660 |     | <span class='unexecuted'>        uint256 len = bytes(description).length;</span>
 661 |     | <span class='neutral'></span>
 662 |     | <span class='neutral'>        // Length is too short to contain a valid proposer suffix</span>
 663 |     | <span class='unexecuted'>        if (len &lt; 52) {</span>
 664 |     | <span class='unexecuted'>            return true;</span>
 665 |     | <span class='neutral'>        }</span>
 666 |     | <span class='neutral'></span>
 667 |     | <span class='neutral'>        // Extract what would be the `#proposer=0x` marker beginning the suffix</span>
 668 |     | <span class='neutral'>        bytes12 marker;</span>
 669 |     | <span class='neutral'>        assembly {</span>
 670 |     | <span class='neutral'>            // - Start of the string contents in memory = description + 32</span>
 671 |     | <span class='neutral'>            // - First character of the marker = len - 52</span>
 672 |     | <span class='neutral'>            //   - Length of &quot;#proposer=0x0000000000000000000000000000000000000000&quot; = 52</span>
 673 |     | <span class='neutral'>            // - We read the memory word starting at the first character of the marker:</span>
 674 |     | <span class='neutral'>            //   - (description + 32) + (len - 52) = description + (len - 20)</span>
 675 |     | <span class='neutral'>            // - Note: Solidity will ignore anything past the first 12 bytes</span>
 676 |     | <span class='unexecuted'>            marker := mload(add(description, sub(len, 20)))</span>
 677 |     | <span class='neutral'>        }</span>
 678 |     | <span class='neutral'></span>
 679 |     | <span class='neutral'>        // If the marker is not found, there is no proposer suffix to check</span>
 680 |     | <span class='unexecuted'>        if (marker != bytes12(&quot;#proposer=0x&quot;)) {</span>
 681 |     | <span class='unexecuted'>            return true;</span>
 682 |     | <span class='neutral'>        }</span>
 683 |     | <span class='neutral'></span>
 684 |     | <span class='neutral'>        // Parse the 40 characters following the marker as uint160</span>
 685 |     | <span class='unexecuted'>        uint160 recovered = 0;</span>
 686 |     | <span class='unexecuted'>        for (uint256 i = len - 40; i &lt; len; ++i) {</span>
 687 |     | <span class='unexecuted'>            (bool isHex, uint8 value) = _tryHexToUint(bytes(description)[i]);</span>
 688 |     | <span class='neutral'>            // If any of the characters is not a hex digit, ignore the suffix entirely</span>
 689 |     | <span class='unexecuted'>            if (!isHex) {</span>
 690 |     | <span class='unexecuted'>                return true;</span>
 691 |     | <span class='neutral'>            }</span>
 692 |     | <span class='unexecuted'>            recovered = (recovered &lt;&lt; 4) | value;</span>
 693 |     | <span class='neutral'>        }</span>
 694 |     | <span class='neutral'></span>
 695 |     | <span class='unexecuted'>        return recovered == uint160(proposer);</span>
 696 |     | <span class='neutral'>    }</span>
 697 |     | <span class='neutral'></span>
 698 |     | <span class='neutral'>    /**</span>
 699 |     | <span class='neutral'>     * @dev Try to parse a character from a string as a hex value. Returns `(true, value)` if the char is in</span>
 700 |     | <span class='neutral'>     * `[0-9a-fA-F]` and `(false, 0)` otherwise. Value is guaranteed to be in the range `0 &lt;= value &lt; 16`</span>
 701 |     | <span class='neutral'>     */</span>
 702 |     | <span class='unexecuted'>    function _tryHexToUint(bytes1 char) private pure returns (bool, uint8) {</span>
 703 |     | <span class='unexecuted'>        uint8 c = uint8(char);</span>
 704 |     | <span class='neutral'>        unchecked {</span>
 705 |     | <span class='neutral'>            // Case 0-9</span>
 706 |     | <span class='unexecuted'>            if (47 &lt; c &amp;&amp; c &lt; 58) {</span>
 707 |     | <span class='unexecuted'>                return (true, c - 48);</span>
 708 |     | <span class='neutral'>            }</span>
 709 |     | <span class='neutral'>            // Case A-F</span>
 710 |     | <span class='unexecuted'>            else if (64 &lt; c &amp;&amp; c &lt; 71) {</span>
 711 |     | <span class='unexecuted'>                return (true, c - 55);</span>
 712 |     | <span class='neutral'>            }</span>
 713 |     | <span class='neutral'>            // Case a-f</span>
 714 |     | <span class='unexecuted'>            else if (96 &lt; c &amp;&amp; c &lt; 103) {</span>
 715 |     | <span class='unexecuted'>                return (true, c - 87);</span>
 716 |     | <span class='neutral'>            }</span>
 717 |     | <span class='neutral'>            // Else: not a hex char</span>
 718 |     | <span class='neutral'>            else {</span>
 719 |     | <span class='unexecuted'>                return (false, 0);</span>
 720 |     | <span class='neutral'>            }</span>
 721 |     | <span class='neutral'>        }</span>
 722 |     | <span class='neutral'>    }</span>
 723 |     | <span class='neutral'>}</span>
 724 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/lib/openzeppelin-contracts/contracts/governance/IGovernor.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (governance/IGovernor.sol)</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
   5 |     | <span class='neutral'></span>
   6 |     | <span class='neutral'>import &quot;../interfaces/IERC165.sol&quot;;</span>
   7 |     | <span class='neutral'>import &quot;../interfaces/IERC6372.sol&quot;;</span>
   8 |     | <span class='neutral'></span>
   9 |     | <span class='neutral'>/**</span>
  10 |     | <span class='neutral'> * @dev Interface of the {Governor} core.</span>
  11 |     | <span class='neutral'> *</span>
  12 |     | <span class='neutral'> * _Available since v4.3._</span>
  13 |     | <span class='neutral'> */</span>
  14 |     | <span class='neutral'>abstract contract IGovernor is IERC165, IERC6372 {</span>
  15 |     | <span class='neutral'>    enum ProposalState {</span>
  16 |     | <span class='neutral'>        Pending,</span>
  17 |     | <span class='neutral'>        Active,</span>
  18 |     | <span class='neutral'>        Canceled,</span>
  19 |     | <span class='neutral'>        Defeated,</span>
  20 |     | <span class='neutral'>        Succeeded,</span>
  21 |     | <span class='neutral'>        Queued,</span>
  22 |     | <span class='neutral'>        Expired,</span>
  23 |     | <span class='neutral'>        Executed</span>
  24 |     | <span class='neutral'>    }</span>
  25 |     | <span class='neutral'></span>
  26 |     | <span class='neutral'>    /**</span>
  27 |     | <span class='neutral'>     * @dev Emitted when a proposal is created.</span>
  28 |     | <span class='neutral'>     */</span>
  29 |     | <span class='neutral'>    event ProposalCreated(</span>
  30 |     | <span class='neutral'>        uint256 proposalId,</span>
  31 |     | <span class='neutral'>        address proposer,</span>
  32 |     | <span class='neutral'>        address[] targets,</span>
  33 |     | <span class='neutral'>        uint256[] values,</span>
  34 |     | <span class='neutral'>        string[] signatures,</span>
  35 |     | <span class='neutral'>        bytes[] calldatas,</span>
  36 |     | <span class='neutral'>        uint256 voteStart,</span>
  37 |     | <span class='neutral'>        uint256 voteEnd,</span>
  38 |     | <span class='neutral'>        string description</span>
  39 |     | <span class='neutral'>    );</span>
  40 |     | <span class='neutral'></span>
  41 |     | <span class='neutral'>    /**</span>
  42 |     | <span class='neutral'>     * @dev Emitted when a proposal is canceled.</span>
  43 |     | <span class='neutral'>     */</span>
  44 |     | <span class='neutral'>    event ProposalCanceled(uint256 proposalId);</span>
  45 |     | <span class='neutral'></span>
  46 |     | <span class='neutral'>    /**</span>
  47 |     | <span class='neutral'>     * @dev Emitted when a proposal is executed.</span>
  48 |     | <span class='neutral'>     */</span>
  49 |     | <span class='neutral'>    event ProposalExecuted(uint256 proposalId);</span>
  50 |     | <span class='neutral'></span>
  51 |     | <span class='neutral'>    /**</span>
  52 |     | <span class='neutral'>     * @dev Emitted when a vote is cast without params.</span>
  53 |     | <span class='neutral'>     *</span>
  54 |     | <span class='neutral'>     * Note: `support` values should be seen as buckets. Their interpretation depends on the voting module used.</span>
  55 |     | <span class='neutral'>     */</span>
  56 |     | <span class='neutral'>    event VoteCast(address indexed voter, uint256 proposalId, uint8 support, uint256 weight, string reason);</span>
  57 |     | <span class='neutral'></span>
  58 |     | <span class='neutral'>    /**</span>
  59 |     | <span class='neutral'>     * @dev Emitted when a vote is cast with params.</span>
  60 |     | <span class='neutral'>     *</span>
  61 |     | <span class='neutral'>     * Note: `support` values should be seen as buckets. Their interpretation depends on the voting module used.</span>
  62 |     | <span class='neutral'>     * `params` are additional encoded parameters. Their interpepretation also depends on the voting module used.</span>
  63 |     | <span class='neutral'>     */</span>
  64 |     | <span class='neutral'>    event VoteCastWithParams(</span>
  65 |     | <span class='neutral'>        address indexed voter,</span>
  66 |     | <span class='neutral'>        uint256 proposalId,</span>
  67 |     | <span class='neutral'>        uint8 support,</span>
  68 |     | <span class='neutral'>        uint256 weight,</span>
  69 |     | <span class='neutral'>        string reason,</span>
  70 |     | <span class='neutral'>        bytes params</span>
  71 |     | <span class='neutral'>    );</span>
  72 |     | <span class='neutral'></span>
  73 |     | <span class='neutral'>    /**</span>
  74 |     | <span class='neutral'>     * @notice module:core</span>
  75 |     | <span class='neutral'>     * @dev Name of the governor instance (used in building the ERC712 domain separator).</span>
  76 |     | <span class='neutral'>     */</span>
  77 |     | <span class='neutral'>    function name() public view virtual returns (string memory);</span>
  78 |     | <span class='neutral'></span>
  79 |     | <span class='neutral'>    /**</span>
  80 |     | <span class='neutral'>     * @notice module:core</span>
  81 |     | <span class='neutral'>     * @dev Version of the governor instance (used in building the ERC712 domain separator). Default: &quot;1&quot;</span>
  82 |     | <span class='neutral'>     */</span>
  83 |     | <span class='neutral'>    function version() public view virtual returns (string memory);</span>
  84 |     | <span class='neutral'></span>
  85 |     | <span class='neutral'>    /**</span>
  86 |     | <span class='neutral'>     * @notice module:core</span>
  87 |     | <span class='neutral'>     * @dev See {IERC6372}</span>
  88 |     | <span class='neutral'>     */</span>
  89 |     | <span class='neutral'>    function clock() public view virtual override returns (uint48);</span>
  90 |     | <span class='neutral'></span>
  91 |     | <span class='neutral'>    /**</span>
  92 |     | <span class='neutral'>     * @notice module:core</span>
  93 |     | <span class='neutral'>     * @dev See EIP-6372.</span>
  94 |     | <span class='neutral'>     */</span>
  95 |     | <span class='neutral'>    // solhint-disable-next-line func-name-mixedcase</span>
  96 |     | <span class='neutral'>    function CLOCK_MODE() public view virtual override returns (string memory);</span>
  97 |     | <span class='neutral'></span>
  98 |     | <span class='neutral'>    /**</span>
  99 |     | <span class='neutral'>     * @notice module:voting</span>
 100 |     | <span class='neutral'>     * @dev A description of the possible `support` values for {castVote} and the way these votes are counted, meant to</span>
 101 |     | <span class='neutral'>     * be consumed by UIs to show correct vote options and interpret the results. The string is a URL-encoded sequence of</span>
 102 |     | <span class='neutral'>     * key-value pairs that each describe one aspect, for example `support=bravo&amp;quorum=for,abstain`.</span>
 103 |     | <span class='neutral'>     *</span>
 104 |     | <span class='neutral'>     * There are 2 standard keys: `support` and `quorum`.</span>
 105 |     | <span class='neutral'>     *</span>
 106 |     | <span class='neutral'>     * - `support=bravo` refers to the vote options 0 = Against, 1 = For, 2 = Abstain, as in `GovernorBravo`.</span>
 107 |     | <span class='neutral'>     * - `quorum=bravo` means that only For votes are counted towards quorum.</span>
 108 |     | <span class='neutral'>     * - `quorum=for,abstain` means that both For and Abstain votes are counted towards quorum.</span>
 109 |     | <span class='neutral'>     *</span>
 110 |     | <span class='neutral'>     * If a counting module makes use of encoded `params`, it should  include this under a `params` key with a unique</span>
 111 |     | <span class='neutral'>     * name that describes the behavior. For example:</span>
 112 |     | <span class='neutral'>     *</span>
 113 |     | <span class='neutral'>     * - `params=fractional` might refer to a scheme where votes are divided fractionally between for/against/abstain.</span>
 114 |     | <span class='neutral'>     * - `params=erc721` might refer to a scheme where specific NFTs are delegated to vote.</span>
 115 |     | <span class='neutral'>     *</span>
 116 |     | <span class='neutral'>     * NOTE: The string can be decoded by the standard</span>
 117 |     | <span class='neutral'>     * https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams[`URLSearchParams`]</span>
 118 |     | <span class='neutral'>     * JavaScript class.</span>
 119 |     | <span class='neutral'>     */</span>
 120 |     | <span class='neutral'>    // solhint-disable-next-line func-name-mixedcase</span>
 121 |     | <span class='neutral'>    function COUNTING_MODE() public view virtual returns (string memory);</span>
 122 |     | <span class='neutral'></span>
 123 |     | <span class='neutral'>    /**</span>
 124 |     | <span class='neutral'>     * @notice module:core</span>
 125 |     | <span class='neutral'>     * @dev Hashing function used to (re)build the proposal id from the proposal details..</span>
 126 |     | <span class='neutral'>     */</span>
 127 |     | <span class='neutral'>    function hashProposal(</span>
 128 |     | <span class='neutral'>        address[] memory targets,</span>
 129 |     | <span class='neutral'>        uint256[] memory values,</span>
 130 |     | <span class='neutral'>        bytes[] memory calldatas,</span>
 131 |     | <span class='neutral'>        bytes32 descriptionHash</span>
 132 |     | <span class='neutral'>    ) public pure virtual returns (uint256);</span>
 133 |     | <span class='neutral'></span>
 134 |     | <span class='neutral'>    /**</span>
 135 |     | <span class='neutral'>     * @notice module:core</span>
 136 |     | <span class='neutral'>     * @dev Current state of a proposal, following Compound&#39;s convention</span>
 137 |     | <span class='neutral'>     */</span>
 138 |     | <span class='neutral'>    function state(uint256 proposalId) public view virtual returns (ProposalState);</span>
 139 |     | <span class='neutral'></span>
 140 |     | <span class='neutral'>    /**</span>
 141 |     | <span class='neutral'>     * @notice module:core</span>
 142 |     | <span class='neutral'>     * @dev Timepoint used to retrieve user&#39;s votes and quorum. If using block number (as per Compound&#39;s Comp), the</span>
 143 |     | <span class='neutral'>     * snapshot is performed at the end of this block. Hence, voting for this proposal starts at the beginning of the</span>
 144 |     | <span class='neutral'>     * following block.</span>
 145 |     | <span class='neutral'>     */</span>
 146 |     | <span class='neutral'>    function proposalSnapshot(uint256 proposalId) public view virtual returns (uint256);</span>
 147 |     | <span class='neutral'></span>
 148 |     | <span class='neutral'>    /**</span>
 149 |     | <span class='neutral'>     * @notice module:core</span>
 150 |     | <span class='neutral'>     * @dev Timepoint at which votes close. If using block number, votes close at the end of this block, so it is</span>
 151 |     | <span class='neutral'>     * possible to cast a vote during this block.</span>
 152 |     | <span class='neutral'>     */</span>
 153 |     | <span class='neutral'>    function proposalDeadline(uint256 proposalId) public view virtual returns (uint256);</span>
 154 |     | <span class='neutral'></span>
 155 |     | <span class='neutral'>    /**</span>
 156 |     | <span class='neutral'>     * @notice module:core</span>
 157 |     | <span class='neutral'>     * @dev The account that created a proposal.</span>
 158 |     | <span class='neutral'>     */</span>
 159 |     | <span class='neutral'>    function proposalProposer(uint256 proposalId) public view virtual returns (address);</span>
 160 |     | <span class='neutral'></span>
 161 |     | <span class='neutral'>    /**</span>
 162 |     | <span class='neutral'>     * @notice module:user-config</span>
 163 |     | <span class='neutral'>     * @dev Delay, between the proposal is created and the vote starts. The unit this duration is expressed in depends</span>
 164 |     | <span class='neutral'>     * on the clock (see EIP-6372) this contract uses.</span>
 165 |     | <span class='neutral'>     *</span>
 166 |     | <span class='neutral'>     * This can be increased to leave time for users to buy voting power, or delegate it, before the voting of a</span>
 167 |     | <span class='neutral'>     * proposal starts.</span>
 168 |     | <span class='neutral'>     */</span>
 169 |     | <span class='neutral'>    function votingDelay() public view virtual returns (uint256);</span>
 170 |     | <span class='neutral'></span>
 171 |     | <span class='neutral'>    /**</span>
 172 |     | <span class='neutral'>     * @notice module:user-config</span>
 173 |     | <span class='neutral'>     * @dev Delay between the vote start and vote end. The unit this duration is expressed in depends on the clock</span>
 174 |     | <span class='neutral'>     * (see EIP-6372) this contract uses.</span>
 175 |     | <span class='neutral'>     *</span>
 176 |     | <span class='neutral'>     * NOTE: The {votingDelay} can delay the start of the vote. This must be considered when setting the voting</span>
 177 |     | <span class='neutral'>     * duration compared to the voting delay.</span>
 178 |     | <span class='neutral'>     */</span>
 179 |     | <span class='neutral'>    function votingPeriod() public view virtual returns (uint256);</span>
 180 |     | <span class='neutral'></span>
 181 |     | <span class='neutral'>    /**</span>
 182 |     | <span class='neutral'>     * @notice module:user-config</span>
 183 |     | <span class='neutral'>     * @dev Minimum number of cast voted required for a proposal to be successful.</span>
 184 |     | <span class='neutral'>     *</span>
 185 |     | <span class='neutral'>     * NOTE: The `timepoint` parameter corresponds to the snapshot used for counting vote. This allows to scale the</span>
 186 |     | <span class='neutral'>     * quorum depending on values such as the totalSupply of a token at this timepoint (see {ERC20Votes}).</span>
 187 |     | <span class='neutral'>     */</span>
 188 |     | <span class='neutral'>    function quorum(uint256 timepoint) public view virtual returns (uint256);</span>
 189 |     | <span class='neutral'></span>
 190 |     | <span class='neutral'>    /**</span>
 191 |     | <span class='neutral'>     * @notice module:reputation</span>
 192 |     | <span class='neutral'>     * @dev Voting power of an `account` at a specific `timepoint`.</span>
 193 |     | <span class='neutral'>     *</span>
 194 |     | <span class='neutral'>     * Note: this can be implemented in a number of ways, for example by reading the delegated balance from one (or</span>
 195 |     | <span class='neutral'>     * multiple), {ERC20Votes} tokens.</span>
 196 |     | <span class='neutral'>     */</span>
 197 |     | <span class='neutral'>    function getVotes(address account, uint256 timepoint) public view virtual returns (uint256);</span>
 198 |     | <span class='neutral'></span>
 199 |     | <span class='neutral'>    /**</span>
 200 |     | <span class='neutral'>     * @notice module:reputation</span>
 201 |     | <span class='neutral'>     * @dev Voting power of an `account` at a specific `timepoint` given additional encoded parameters.</span>
 202 |     | <span class='neutral'>     */</span>
 203 |     | <span class='neutral'>    function getVotesWithParams(</span>
 204 |     | <span class='neutral'>        address account,</span>
 205 |     | <span class='neutral'>        uint256 timepoint,</span>
 206 |     | <span class='neutral'>        bytes memory params</span>
 207 |     | <span class='neutral'>    ) public view virtual returns (uint256);</span>
 208 |     | <span class='neutral'></span>
 209 |     | <span class='neutral'>    /**</span>
 210 |     | <span class='neutral'>     * @notice module:voting</span>
 211 |     | <span class='neutral'>     * @dev Returns whether `account` has cast a vote on `proposalId`.</span>
 212 |     | <span class='neutral'>     */</span>
 213 |     | <span class='neutral'>    function hasVoted(uint256 proposalId, address account) public view virtual returns (bool);</span>
 214 |     | <span class='neutral'></span>
 215 |     | <span class='neutral'>    /**</span>
 216 |     | <span class='neutral'>     * @dev Create a new proposal. Vote start after a delay specified by {IGovernor-votingDelay} and lasts for a</span>
 217 |     | <span class='neutral'>     * duration specified by {IGovernor-votingPeriod}.</span>
 218 |     | <span class='neutral'>     *</span>
 219 |     | <span class='neutral'>     * Emits a {ProposalCreated} event.</span>
 220 |     | <span class='neutral'>     */</span>
 221 |     | <span class='neutral'>    function propose(</span>
 222 |     | <span class='neutral'>        address[] memory targets,</span>
 223 |     | <span class='neutral'>        uint256[] memory values,</span>
 224 |     | <span class='neutral'>        bytes[] memory calldatas,</span>
 225 |     | <span class='neutral'>        string memory description</span>
 226 |     | <span class='neutral'>    ) public virtual returns (uint256 proposalId);</span>
 227 |     | <span class='neutral'></span>
 228 |     | <span class='neutral'>    /**</span>
 229 |     | <span class='neutral'>     * @dev Execute a successful proposal. This requires the quorum to be reached, the vote to be successful, and the</span>
 230 |     | <span class='neutral'>     * deadline to be reached.</span>
 231 |     | <span class='neutral'>     *</span>
 232 |     | <span class='neutral'>     * Emits a {ProposalExecuted} event.</span>
 233 |     | <span class='neutral'>     *</span>
 234 |     | <span class='neutral'>     * Note: some module can modify the requirements for execution, for example by adding an additional timelock.</span>
 235 |     | <span class='neutral'>     */</span>
 236 |     | <span class='neutral'>    function execute(</span>
 237 |     | <span class='neutral'>        address[] memory targets,</span>
 238 |     | <span class='neutral'>        uint256[] memory values,</span>
 239 |     | <span class='neutral'>        bytes[] memory calldatas,</span>
 240 |     | <span class='neutral'>        bytes32 descriptionHash</span>
 241 |     | <span class='neutral'>    ) public payable virtual returns (uint256 proposalId);</span>
 242 |     | <span class='neutral'></span>
 243 |     | <span class='neutral'>    /**</span>
 244 |     | <span class='neutral'>     * @dev Cancel a proposal. A proposal is cancellable by the proposer, but only while it is Pending state, i.e.</span>
 245 |     | <span class='neutral'>     * before the vote starts.</span>
 246 |     | <span class='neutral'>     *</span>
 247 |     | <span class='neutral'>     * Emits a {ProposalCanceled} event.</span>
 248 |     | <span class='neutral'>     */</span>
 249 |     | <span class='neutral'>    function cancel(</span>
 250 |     | <span class='neutral'>        address[] memory targets,</span>
 251 |     | <span class='neutral'>        uint256[] memory values,</span>
 252 |     | <span class='neutral'>        bytes[] memory calldatas,</span>
 253 |     | <span class='neutral'>        bytes32 descriptionHash</span>
 254 |     | <span class='neutral'>    ) public virtual returns (uint256 proposalId);</span>
 255 |     | <span class='neutral'></span>
 256 |     | <span class='neutral'>    /**</span>
 257 |     | <span class='neutral'>     * @dev Cast a vote</span>
 258 |     | <span class='neutral'>     *</span>
 259 |     | <span class='neutral'>     * Emits a {VoteCast} event.</span>
 260 |     | <span class='neutral'>     */</span>
 261 |     | <span class='neutral'>    function castVote(uint256 proposalId, uint8 support) public virtual returns (uint256 balance);</span>
 262 |     | <span class='neutral'></span>
 263 |     | <span class='neutral'>    /**</span>
 264 |     | <span class='neutral'>     * @dev Cast a vote with a reason</span>
 265 |     | <span class='neutral'>     *</span>
 266 |     | <span class='neutral'>     * Emits a {VoteCast} event.</span>
 267 |     | <span class='neutral'>     */</span>
 268 |     | <span class='neutral'>    function castVoteWithReason(</span>
 269 |     | <span class='neutral'>        uint256 proposalId,</span>
 270 |     | <span class='neutral'>        uint8 support,</span>
 271 |     | <span class='neutral'>        string calldata reason</span>
 272 |     | <span class='neutral'>    ) public virtual returns (uint256 balance);</span>
 273 |     | <span class='neutral'></span>
 274 |     | <span class='neutral'>    /**</span>
 275 |     | <span class='neutral'>     * @dev Cast a vote with a reason and additional encoded parameters</span>
 276 |     | <span class='neutral'>     *</span>
 277 |     | <span class='neutral'>     * Emits a {VoteCast} or {VoteCastWithParams} event depending on the length of params.</span>
 278 |     | <span class='neutral'>     */</span>
 279 |     | <span class='neutral'>    function castVoteWithReasonAndParams(</span>
 280 |     | <span class='neutral'>        uint256 proposalId,</span>
 281 |     | <span class='neutral'>        uint8 support,</span>
 282 |     | <span class='neutral'>        string calldata reason,</span>
 283 |     | <span class='neutral'>        bytes memory params</span>
 284 |     | <span class='neutral'>    ) public virtual returns (uint256 balance);</span>
 285 |     | <span class='neutral'></span>
 286 |     | <span class='neutral'>    /**</span>
 287 |     | <span class='neutral'>     * @dev Cast a vote using the user&#39;s cryptographic signature.</span>
 288 |     | <span class='neutral'>     *</span>
 289 |     | <span class='neutral'>     * Emits a {VoteCast} event.</span>
 290 |     | <span class='neutral'>     */</span>
 291 |     | <span class='neutral'>    function castVoteBySig(</span>
 292 |     | <span class='neutral'>        uint256 proposalId,</span>
 293 |     | <span class='neutral'>        uint8 support,</span>
 294 |     | <span class='neutral'>        uint8 v,</span>
 295 |     | <span class='neutral'>        bytes32 r,</span>
 296 |     | <span class='neutral'>        bytes32 s</span>
 297 |     | <span class='neutral'>    ) public virtual returns (uint256 balance);</span>
 298 |     | <span class='neutral'></span>
 299 |     | <span class='neutral'>    /**</span>
 300 |     | <span class='neutral'>     * @dev Cast a vote with a reason and additional encoded parameters using the user&#39;s cryptographic signature.</span>
 301 |     | <span class='neutral'>     *</span>
 302 |     | <span class='neutral'>     * Emits a {VoteCast} or {VoteCastWithParams} event depending on the length of params.</span>
 303 |     | <span class='neutral'>     */</span>
 304 |     | <span class='neutral'>    function castVoteWithReasonAndParamsBySig(</span>
 305 |     | <span class='neutral'>        uint256 proposalId,</span>
 306 |     | <span class='neutral'>        uint8 support,</span>
 307 |     | <span class='neutral'>        string calldata reason,</span>
 308 |     | <span class='neutral'>        bytes memory params,</span>
 309 |     | <span class='neutral'>        uint8 v,</span>
 310 |     | <span class='neutral'>        bytes32 r,</span>
 311 |     | <span class='neutral'>        bytes32 s</span>
 312 |     | <span class='neutral'>    ) public virtual returns (uint256 balance);</span>
 313 |     | <span class='neutral'>}</span>
 314 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/lib/openzeppelin-contracts/contracts/governance/extensions/GovernorCountingSimple.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (governance/extensions/GovernorCountingSimple.sol)</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
   5 |     | <span class='neutral'></span>
   6 |     | <span class='neutral'>import &quot;../Governor.sol&quot;;</span>
   7 |     | <span class='neutral'></span>
   8 |     | <span class='neutral'>/**</span>
   9 |     | <span class='neutral'> * @dev Extension of {Governor} for simple, 3 options, vote counting.</span>
  10 |     | <span class='neutral'> *</span>
  11 |     | <span class='neutral'> * _Available since v4.3._</span>
  12 |     | <span class='neutral'> */</span>
  13 |     | <span class='neutral'>abstract contract GovernorCountingSimple is Governor {</span>
  14 |     | <span class='neutral'>    /**</span>
  15 |     | <span class='neutral'>     * @dev Supported vote types. Matches Governor Bravo ordering.</span>
  16 |     | <span class='neutral'>     */</span>
  17 |     | <span class='neutral'>    enum VoteType {</span>
  18 |     | <span class='neutral'>        Against,</span>
  19 |     | <span class='neutral'>        For,</span>
  20 |     | <span class='neutral'>        Abstain</span>
  21 |     | <span class='neutral'>    }</span>
  22 |     | <span class='neutral'></span>
  23 |     | <span class='neutral'>    struct ProposalVote {</span>
  24 |     | <span class='neutral'>        uint256 againstVotes;</span>
  25 |     | <span class='neutral'>        uint256 forVotes;</span>
  26 |     | <span class='neutral'>        uint256 abstainVotes;</span>
  27 |     | <span class='neutral'>        mapping(address =&gt; bool) hasVoted;</span>
  28 |     | <span class='neutral'>    }</span>
  29 |     | <span class='neutral'></span>
  30 |     | <span class='neutral'>    mapping(uint256 =&gt; ProposalVote) private _proposalVotes;</span>
  31 |     | <span class='neutral'></span>
  32 |     | <span class='neutral'>    /**</span>
  33 |     | <span class='neutral'>     * @dev See {IGovernor-COUNTING_MODE}.</span>
  34 |     | <span class='neutral'>     */</span>
  35 |     | <span class='neutral'>    // solhint-disable-next-line func-name-mixedcase</span>
  36 |     | <span class='unexecuted'>    function COUNTING_MODE() public pure virtual override returns (string memory) {</span>
  37 |     | <span class='unexecuted'>        return &quot;support=bravo&amp;quorum=for,abstain&quot;;</span>
  38 |     | <span class='neutral'>    }</span>
  39 |     | <span class='neutral'></span>
  40 |     | <span class='neutral'>    /**</span>
  41 |     | <span class='neutral'>     * @dev See {IGovernor-hasVoted}.</span>
  42 |     | <span class='neutral'>     */</span>
  43 |     | <span class='unexecuted'>    function hasVoted(uint256 proposalId, address account) public view virtual override returns (bool) {</span>
  44 |     | <span class='unexecuted'>        return _proposalVotes[proposalId].hasVoted[account];</span>
  45 |     | <span class='neutral'>    }</span>
  46 |     | <span class='neutral'></span>
  47 |     | <span class='neutral'>    /**</span>
  48 |     | <span class='neutral'>     * @dev Accessor to the internal vote counts.</span>
  49 |     | <span class='neutral'>     */</span>
  50 |     | <span class='unexecuted'>    function proposalVotes(</span>
  51 |     | <span class='neutral'>        uint256 proposalId</span>
  52 |     | <span class='unexecuted'>    ) public view virtual returns (uint256 againstVotes, uint256 forVotes, uint256 abstainVotes) {</span>
  53 |     | <span class='unexecuted'>        ProposalVote storage proposalVote = _proposalVotes[proposalId];</span>
  54 |     | <span class='unexecuted'>        return (proposalVote.againstVotes, proposalVote.forVotes, proposalVote.abstainVotes);</span>
  55 |     | <span class='neutral'>    }</span>
  56 |     | <span class='neutral'></span>
  57 |     | <span class='neutral'>    /**</span>
  58 |     | <span class='neutral'>     * @dev See {Governor-_quorumReached}.</span>
  59 |     | <span class='neutral'>     */</span>
  60 |     | <span class='unexecuted'>    function _quorumReached(uint256 proposalId) internal view virtual override returns (bool) {</span>
  61 |     | <span class='unexecuted'>        ProposalVote storage proposalVote = _proposalVotes[proposalId];</span>
  62 |     | <span class='neutral'></span>
  63 |     | <span class='unexecuted'>        return quorum(proposalSnapshot(proposalId)) &lt;= proposalVote.forVotes + proposalVote.abstainVotes;</span>
  64 |     | <span class='neutral'>    }</span>
  65 |     | <span class='neutral'></span>
  66 |     | <span class='neutral'>    /**</span>
  67 |     | <span class='neutral'>     * @dev See {Governor-_voteSucceeded}. In this module, the forVotes must be strictly over the againstVotes.</span>
  68 |     | <span class='neutral'>     */</span>
  69 |     | <span class='unexecuted'>    function _voteSucceeded(uint256 proposalId) internal view virtual override returns (bool) {</span>
  70 |     | <span class='unexecuted'>        ProposalVote storage proposalVote = _proposalVotes[proposalId];</span>
  71 |     | <span class='neutral'></span>
  72 |     | <span class='unexecuted'>        return proposalVote.forVotes &gt; proposalVote.againstVotes;</span>
  73 |     | <span class='neutral'>    }</span>
  74 |     | <span class='neutral'></span>
  75 |     | <span class='neutral'>    /**</span>
  76 |     | <span class='neutral'>     * @dev See {Governor-_countVote}. In this module, the support follows the `VoteType` enum (from Governor Bravo).</span>
  77 |     | <span class='neutral'>     */</span>
  78 |     | <span class='unexecuted'>    function _countVote(</span>
  79 |     | <span class='neutral'>        uint256 proposalId,</span>
  80 |     | <span class='neutral'>        address account,</span>
  81 |     | <span class='neutral'>        uint8 support,</span>
  82 |     | <span class='neutral'>        uint256 weight,</span>
  83 |     | <span class='neutral'>        bytes memory // params</span>
  84 |     | <span class='neutral'>    ) internal virtual override {</span>
  85 |     | <span class='unexecuted'>        ProposalVote storage proposalVote = _proposalVotes[proposalId];</span>
  86 |     | <span class='neutral'></span>
  87 |     | <span class='unexecuted'>        require(!proposalVote.hasVoted[account], &quot;GovernorVotingSimple: vote already cast&quot;);</span>
  88 |     | <span class='unexecuted'>        proposalVote.hasVoted[account] = true;</span>
  89 |     | <span class='neutral'></span>
  90 |     | <span class='unexecuted'>        if (support == uint8(VoteType.Against)) {</span>
  91 |     | <span class='unexecuted'>            proposalVote.againstVotes += weight;</span>
  92 |     | <span class='unexecuted'>        } else if (support == uint8(VoteType.For)) {</span>
  93 |     | <span class='unexecuted'>            proposalVote.forVotes += weight;</span>
  94 |     | <span class='unexecuted'>        } else if (support == uint8(VoteType.Abstain)) {</span>
  95 |     | <span class='unexecuted'>            proposalVote.abstainVotes += weight;</span>
  96 |     | <span class='neutral'>        } else {</span>
  97 |     | <span class='unexecuted'>            revert(&quot;GovernorVotingSimple: invalid value for enum VoteType&quot;);</span>
  98 |     | <span class='neutral'>        }</span>
  99 |     | <span class='neutral'>    }</span>
 100 |     | <span class='neutral'>}</span>
 101 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/lib/openzeppelin-contracts/contracts/governance/extensions/GovernorVotes.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (governance/extensions/GovernorVotes.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>import &quot;../Governor.sol&quot;;</span>
  7 |     | <span class='neutral'>import &quot;../../interfaces/IERC5805.sol&quot;;</span>
  8 |     | <span class='neutral'></span>
  9 |     | <span class='neutral'>/**</span>
 10 |     | <span class='neutral'> * @dev Extension of {Governor} for voting weight extraction from an {ERC20Votes} token, or since v4.5 an {ERC721Votes} token.</span>
 11 |     | <span class='neutral'> *</span>
 12 |     | <span class='neutral'> * _Available since v4.3._</span>
 13 |     | <span class='neutral'> */</span>
 14 |     | <span class='neutral'>abstract contract GovernorVotes is Governor {</span>
 15 |     | <span class='unexecuted'>    IERC5805 public immutable token;</span>
 16 |     | <span class='neutral'></span>
 17 |     | <span class='neutral'>    constructor(IVotes tokenAddress) {</span>
 18 |     | <span class='unexecuted'>        token = IERC5805(address(tokenAddress));</span>
 19 |     | <span class='neutral'>    }</span>
 20 |     | <span class='neutral'></span>
 21 |     | <span class='neutral'>    /**</span>
 22 |     | <span class='neutral'>     * @dev Clock (as specified in EIP-6372) is set to match the token&#39;s clock. Fallback to block numbers if the token</span>
 23 |     | <span class='neutral'>     * does not implement EIP-6372.</span>
 24 |     | <span class='neutral'>     */</span>
 25 |     | <span class='unexecuted'>    function clock() public view virtual override returns (uint48) {</span>
 26 |     | <span class='unexecuted'>        try token.clock() returns (uint48 timepoint) {</span>
 27 |     | <span class='neutral'>            return timepoint;</span>
 28 |     | <span class='neutral'>        } catch {</span>
 29 |     | <span class='unexecuted'>            return SafeCast.toUint48(block.number);</span>
 30 |     | <span class='neutral'>        }</span>
 31 |     | <span class='neutral'>    }</span>
 32 |     | <span class='neutral'></span>
 33 |     | <span class='neutral'>    /**</span>
 34 |     | <span class='neutral'>     * @dev Machine-readable description of the clock as specified in EIP-6372.</span>
 35 |     | <span class='neutral'>     */</span>
 36 |     | <span class='neutral'>    // solhint-disable-next-line func-name-mixedcase</span>
 37 |     | <span class='unexecuted'>    function CLOCK_MODE() public view virtual override returns (string memory) {</span>
 38 |     | <span class='unexecuted'>        try token.CLOCK_MODE() returns (string memory clockmode) {</span>
 39 |     | <span class='unexecuted'>            return clockmode;</span>
 40 |     | <span class='neutral'>        } catch {</span>
 41 |     | <span class='unexecuted'>            return &quot;mode=blocknumber&amp;from=default&quot;;</span>
 42 |     | <span class='neutral'>        }</span>
 43 |     | <span class='neutral'>    }</span>
 44 |     | <span class='neutral'></span>
 45 |     | <span class='neutral'>    /**</span>
 46 |     | <span class='neutral'>     * Read the voting weight from the token&#39;s built in snapshot mechanism (see {Governor-_getVotes}).</span>
 47 |     | <span class='neutral'>     */</span>
 48 |     | <span class='unexecuted'>    function _getVotes(</span>
 49 |     | <span class='neutral'>        address account,</span>
 50 |     | <span class='neutral'>        uint256 timepoint,</span>
 51 |     | <span class='neutral'>        bytes memory /*params*/</span>
 52 |     | <span class='unexecuted'>    ) internal view virtual override returns (uint256) {</span>
 53 |     | <span class='unexecuted'>        return token.getPastVotes(account, timepoint);</span>
 54 |     | <span class='neutral'>    }</span>
 55 |     | <span class='neutral'>}</span>
 56 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/lib/openzeppelin-contracts/contracts/governance/utils/IVotes.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (governance/utils/IVotes.sol)</span>
  3 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  4 |     | <span class='neutral'></span>
  5 |     | <span class='neutral'>/**</span>
  6 |     | <span class='neutral'> * @dev Common interface for {ERC20Votes}, {ERC721Votes}, and other {Votes}-enabled contracts.</span>
  7 |     | <span class='neutral'> *</span>
  8 |     | <span class='neutral'> * _Available since v4.5._</span>
  9 |     | <span class='neutral'> */</span>
 10 |     | <span class='neutral'>interface IVotes {</span>
 11 |     | <span class='neutral'>    /**</span>
 12 |     | <span class='neutral'>     * @dev Emitted when an account changes their delegate.</span>
 13 |     | <span class='neutral'>     */</span>
 14 |     | <span class='neutral'>    event DelegateChanged(address indexed delegator, address indexed fromDelegate, address indexed toDelegate);</span>
 15 |     | <span class='neutral'></span>
 16 |     | <span class='neutral'>    /**</span>
 17 |     | <span class='neutral'>     * @dev Emitted when a token transfer or delegate change results in changes to a delegate&#39;s number of votes.</span>
 18 |     | <span class='neutral'>     */</span>
 19 |     | <span class='neutral'>    event DelegateVotesChanged(address indexed delegate, uint256 previousBalance, uint256 newBalance);</span>
 20 |     | <span class='neutral'></span>
 21 |     | <span class='neutral'>    /**</span>
 22 |     | <span class='neutral'>     * @dev Returns the current amount of votes that `account` has.</span>
 23 |     | <span class='neutral'>     */</span>
 24 |     | <span class='neutral'>    function getVotes(address account) external view returns (uint256);</span>
 25 |     | <span class='neutral'></span>
 26 |     | <span class='neutral'>    /**</span>
 27 |     | <span class='neutral'>     * @dev Returns the amount of votes that `account` had at a specific moment in the past. If the `clock()` is</span>
 28 |     | <span class='neutral'>     * configured to use block numbers, this will return the value at the end of the corresponding block.</span>
 29 |     | <span class='neutral'>     */</span>
 30 |     | <span class='neutral'>    function getPastVotes(address account, uint256 timepoint) external view returns (uint256);</span>
 31 |     | <span class='neutral'></span>
 32 |     | <span class='neutral'>    /**</span>
 33 |     | <span class='neutral'>     * @dev Returns the total supply of votes available at a specific moment in the past. If the `clock()` is</span>
 34 |     | <span class='neutral'>     * configured to use block numbers, this will return the value at the end of the corresponding block.</span>
 35 |     | <span class='neutral'>     *</span>
 36 |     | <span class='neutral'>     * NOTE: This value is the sum of all available votes, which is not necessarily the sum of all delegated votes.</span>
 37 |     | <span class='neutral'>     * Votes that have not been delegated are still part of total supply, even though they would not participate in a</span>
 38 |     | <span class='neutral'>     * vote.</span>
 39 |     | <span class='neutral'>     */</span>
 40 |     | <span class='neutral'>    function getPastTotalSupply(uint256 timepoint) external view returns (uint256);</span>
 41 |     | <span class='neutral'></span>
 42 |     | <span class='neutral'>    /**</span>
 43 |     | <span class='neutral'>     * @dev Returns the delegate that `account` has chosen.</span>
 44 |     | <span class='neutral'>     */</span>
 45 |     | <span class='neutral'>    function delegates(address account) external view returns (address);</span>
 46 |     | <span class='neutral'></span>
 47 |     | <span class='neutral'>    /**</span>
 48 |     | <span class='neutral'>     * @dev Delegates votes from the sender to `delegatee`.</span>
 49 |     | <span class='neutral'>     */</span>
 50 |     | <span class='neutral'>    function delegate(address delegatee) external;</span>
 51 |     | <span class='neutral'></span>
 52 |     | <span class='neutral'>    /**</span>
 53 |     | <span class='neutral'>     * @dev Delegates votes from signer to `delegatee`.</span>
 54 |     | <span class='neutral'>     */</span>
 55 |     | <span class='neutral'>    function delegateBySig(address delegatee, uint256 nonce, uint256 expiry, uint8 v, bytes32 r, bytes32 s) external;</span>
 56 |     | <span class='neutral'>}</span>
 57 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/lib/openzeppelin-contracts/contracts/interfaces/IERC165.sol</b>
<code>
 1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
 2 |     | <span class='neutral'>// OpenZeppelin Contracts v4.4.1 (interfaces/IERC165.sol)</span>
 3 |     | <span class='neutral'></span>
 4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
 5 |     | <span class='neutral'></span>
 6 |     | <span class='neutral'>import &quot;../utils/introspection/IERC165.sol&quot;;</span>
 7 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/lib/openzeppelin-contracts/contracts/interfaces/IERC5267.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (interfaces/IERC5267.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>interface IERC5267 {</span>
  7 |     | <span class='neutral'>    /**</span>
  8 |     | <span class='neutral'>     * @dev MAY be emitted to signal that the domain could have changed.</span>
  9 |     | <span class='neutral'>     */</span>
 10 |     | <span class='neutral'>    event EIP712DomainChanged();</span>
 11 |     | <span class='neutral'></span>
 12 |     | <span class='neutral'>    /**</span>
 13 |     | <span class='neutral'>     * @dev returns the fields and values that describe the domain separator used by this contract for EIP-712</span>
 14 |     | <span class='neutral'>     * signature.</span>
 15 |     | <span class='neutral'>     */</span>
 16 |     | <span class='neutral'>    function eip712Domain()</span>
 17 |     | <span class='neutral'>        external</span>
 18 |     | <span class='neutral'>        view</span>
 19 |     | <span class='neutral'>        returns (</span>
 20 |     | <span class='neutral'>            bytes1 fields,</span>
 21 |     | <span class='neutral'>            string memory name,</span>
 22 |     | <span class='neutral'>            string memory version,</span>
 23 |     | <span class='neutral'>            uint256 chainId,</span>
 24 |     | <span class='neutral'>            address verifyingContract,</span>
 25 |     | <span class='neutral'>            bytes32 salt,</span>
 26 |     | <span class='neutral'>            uint256[] memory extensions</span>
 27 |     | <span class='neutral'>        );</span>
 28 |     | <span class='neutral'>}</span>
 29 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/lib/openzeppelin-contracts/contracts/interfaces/IERC5805.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (interfaces/IERC5805.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>import &quot;../governance/utils/IVotes.sol&quot;;</span>
  7 |     | <span class='neutral'>import &quot;./IERC6372.sol&quot;;</span>
  8 |     | <span class='neutral'></span>
  9 |     | <span class='neutral'>interface IERC5805 is IERC6372, IVotes {}</span>
 10 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/lib/openzeppelin-contracts/contracts/interfaces/IERC6372.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (interfaces/IERC6372.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>interface IERC6372 {</span>
  7 |     | <span class='neutral'>    /**</span>
  8 |     | <span class='neutral'>     * @dev Clock used for flagging checkpoints. Can be overridden to implement timestamp based checkpoints (and voting).</span>
  9 |     | <span class='neutral'>     */</span>
 10 |     | <span class='neutral'>    function clock() external view returns (uint48);</span>
 11 |     | <span class='neutral'></span>
 12 |     | <span class='neutral'>    /**</span>
 13 |     | <span class='neutral'>     * @dev Description of the clock</span>
 14 |     | <span class='neutral'>     */</span>
 15 |     | <span class='neutral'>    // solhint-disable-next-line func-name-mixedcase</span>
 16 |     | <span class='neutral'>    function CLOCK_MODE() external view returns (string memory);</span>
 17 |     | <span class='neutral'>}</span>
 18 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/lib/openzeppelin-contracts/contracts/token/ERC1155/IERC1155Receiver.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.5.0) (token/ERC1155/IERC1155Receiver.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>import &quot;../../utils/introspection/IERC165.sol&quot;;</span>
  7 |     | <span class='neutral'></span>
  8 |     | <span class='neutral'>/**</span>
  9 |     | <span class='neutral'> * @dev _Available since v3.1._</span>
 10 |     | <span class='neutral'> */</span>
 11 |     | <span class='neutral'>interface IERC1155Receiver is IERC165 {</span>
 12 |     | <span class='neutral'>    /**</span>
 13 |     | <span class='neutral'>     * @dev Handles the receipt of a single ERC1155 token type. This function is</span>
 14 |     | <span class='neutral'>     * called at the end of a `safeTransferFrom` after the balance has been updated.</span>
 15 |     | <span class='neutral'>     *</span>
 16 |     | <span class='neutral'>     * NOTE: To accept the transfer, this must return</span>
 17 |     | <span class='neutral'>     * `bytes4(keccak256(&quot;onERC1155Received(address,address,uint256,uint256,bytes)&quot;))`</span>
 18 |     | <span class='neutral'>     * (i.e. 0xf23a6e61, or its own function selector).</span>
 19 |     | <span class='neutral'>     *</span>
 20 |     | <span class='neutral'>     * @param operator The address which initiated the transfer (i.e. msg.sender)</span>
 21 |     | <span class='neutral'>     * @param from The address which previously owned the token</span>
 22 |     | <span class='neutral'>     * @param id The ID of the token being transferred</span>
 23 |     | <span class='neutral'>     * @param value The amount of tokens being transferred</span>
 24 |     | <span class='neutral'>     * @param data Additional data with no specified format</span>
 25 |     | <span class='neutral'>     * @return `bytes4(keccak256(&quot;onERC1155Received(address,address,uint256,uint256,bytes)&quot;))` if transfer is allowed</span>
 26 |     | <span class='neutral'>     */</span>
 27 |     | <span class='neutral'>    function onERC1155Received(</span>
 28 |     | <span class='neutral'>        address operator,</span>
 29 |     | <span class='neutral'>        address from,</span>
 30 |     | <span class='neutral'>        uint256 id,</span>
 31 |     | <span class='neutral'>        uint256 value,</span>
 32 |     | <span class='neutral'>        bytes calldata data</span>
 33 |     | <span class='neutral'>    ) external returns (bytes4);</span>
 34 |     | <span class='neutral'></span>
 35 |     | <span class='neutral'>    /**</span>
 36 |     | <span class='neutral'>     * @dev Handles the receipt of a multiple ERC1155 token types. This function</span>
 37 |     | <span class='neutral'>     * is called at the end of a `safeBatchTransferFrom` after the balances have</span>
 38 |     | <span class='neutral'>     * been updated.</span>
 39 |     | <span class='neutral'>     *</span>
 40 |     | <span class='neutral'>     * NOTE: To accept the transfer(s), this must return</span>
 41 |     | <span class='neutral'>     * `bytes4(keccak256(&quot;onERC1155BatchReceived(address,address,uint256[],uint256[],bytes)&quot;))`</span>
 42 |     | <span class='neutral'>     * (i.e. 0xbc197c81, or its own function selector).</span>
 43 |     | <span class='neutral'>     *</span>
 44 |     | <span class='neutral'>     * @param operator The address which initiated the batch transfer (i.e. msg.sender)</span>
 45 |     | <span class='neutral'>     * @param from The address which previously owned the token</span>
 46 |     | <span class='neutral'>     * @param ids An array containing ids of each token being transferred (order and length must match values array)</span>
 47 |     | <span class='neutral'>     * @param values An array containing amounts of each token being transferred (order and length must match ids array)</span>
 48 |     | <span class='neutral'>     * @param data Additional data with no specified format</span>
 49 |     | <span class='neutral'>     * @return `bytes4(keccak256(&quot;onERC1155BatchReceived(address,address,uint256[],uint256[],bytes)&quot;))` if transfer is allowed</span>
 50 |     | <span class='neutral'>     */</span>
 51 |     | <span class='neutral'>    function onERC1155BatchReceived(</span>
 52 |     | <span class='neutral'>        address operator,</span>
 53 |     | <span class='neutral'>        address from,</span>
 54 |     | <span class='neutral'>        uint256[] calldata ids,</span>
 55 |     | <span class='neutral'>        uint256[] calldata values,</span>
 56 |     | <span class='neutral'>        bytes calldata data</span>
 57 |     | <span class='neutral'>    ) external returns (bytes4);</span>
 58 |     | <span class='neutral'>}</span>
 59 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/lib/openzeppelin-contracts/contracts/token/ERC20/ERC20.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (token/ERC20/ERC20.sol)</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
   5 |     | <span class='neutral'></span>
   6 |     | <span class='neutral'>import &quot;./IERC20.sol&quot;;</span>
   7 |     | <span class='neutral'>import &quot;./extensions/IERC20Metadata.sol&quot;;</span>
   8 |     | <span class='neutral'>import &quot;../../utils/Context.sol&quot;;</span>
   9 |     | <span class='neutral'></span>
  10 |     | <span class='neutral'>/**</span>
  11 |     | <span class='neutral'> * @dev Implementation of the {IERC20} interface.</span>
  12 |     | <span class='neutral'> *</span>
  13 |     | <span class='neutral'> * This implementation is agnostic to the way tokens are created. This means</span>
  14 |     | <span class='neutral'> * that a supply mechanism has to be added in a derived contract using {_mint}.</span>
  15 |     | <span class='neutral'> * For a generic mechanism see {ERC20PresetMinterPauser}.</span>
  16 |     | <span class='neutral'> *</span>
  17 |     | <span class='neutral'> * TIP: For a detailed writeup see our guide</span>
  18 |     | <span class='neutral'> * https://forum.openzeppelin.com/t/how-to-implement-erc20-supply-mechanisms/226[How</span>
  19 |     | <span class='neutral'> * to implement supply mechanisms].</span>
  20 |     | <span class='neutral'> *</span>
  21 |     | <span class='neutral'> * The default value of {decimals} is 18. To change this, you should override</span>
  22 |     | <span class='neutral'> * this function so it returns a different value.</span>
  23 |     | <span class='neutral'> *</span>
  24 |     | <span class='neutral'> * We have followed general OpenZeppelin Contracts guidelines: functions revert</span>
  25 |     | <span class='neutral'> * instead returning `false` on failure. This behavior is nonetheless</span>
  26 |     | <span class='neutral'> * conventional and does not conflict with the expectations of ERC20</span>
  27 |     | <span class='neutral'> * applications.</span>
  28 |     | <span class='neutral'> *</span>
  29 |     | <span class='neutral'> * Additionally, an {Approval} event is emitted on calls to {transferFrom}.</span>
  30 |     | <span class='neutral'> * This allows applications to reconstruct the allowance for all accounts just</span>
  31 |     | <span class='neutral'> * by listening to said events. Other implementations of the EIP may not emit</span>
  32 |     | <span class='neutral'> * these events, as it isn&#39;t required by the specification.</span>
  33 |     | <span class='neutral'> *</span>
  34 |     | <span class='neutral'> * Finally, the non-standard {decreaseAllowance} and {increaseAllowance}</span>
  35 |     | <span class='neutral'> * functions have been added to mitigate the well-known issues around setting</span>
  36 |     | <span class='neutral'> * allowances. See {IERC20-approve}.</span>
  37 |     | <span class='neutral'> */</span>
  38 |     | <span class='unexecuted'>contract ERC20 is Context, IERC20, IERC20Metadata {</span>
  39 |     | <span class='neutral'>    mapping(address =&gt; uint256) private _balances;</span>
  40 |     | <span class='neutral'></span>
  41 |     | <span class='neutral'>    mapping(address =&gt; mapping(address =&gt; uint256)) private _allowances;</span>
  42 |     | <span class='neutral'></span>
  43 |     | <span class='neutral'>    uint256 private _totalSupply;</span>
  44 |     | <span class='neutral'></span>
  45 |     | <span class='neutral'>    string private _name;</span>
  46 |     | <span class='neutral'>    string private _symbol;</span>
  47 |     | <span class='neutral'></span>
  48 |     | <span class='neutral'>    /**</span>
  49 |     | <span class='neutral'>     * @dev Sets the values for {name} and {symbol}.</span>
  50 |     | <span class='neutral'>     *</span>
  51 |     | <span class='neutral'>     * All two of these values are immutable: they can only be set once during</span>
  52 |     | <span class='neutral'>     * construction.</span>
  53 |     | <span class='neutral'>     */</span>
  54 |     | <span class='unexecuted'>    constructor(string memory name_, string memory symbol_) {</span>
  55 |     | <span class='unexecuted'>        _name = name_;</span>
  56 |     | <span class='unexecuted'>        _symbol = symbol_;</span>
  57 |     | <span class='neutral'>    }</span>
  58 |     | <span class='neutral'></span>
  59 |     | <span class='neutral'>    /**</span>
  60 |     | <span class='neutral'>     * @dev Returns the name of the token.</span>
  61 |     | <span class='neutral'>     */</span>
  62 |     | <span class='unexecuted'>    function name() public view virtual override returns (string memory) {</span>
  63 |     | <span class='unexecuted'>        return _name;</span>
  64 |     | <span class='neutral'>    }</span>
  65 |     | <span class='neutral'></span>
  66 |     | <span class='neutral'>    /**</span>
  67 |     | <span class='neutral'>     * @dev Returns the symbol of the token, usually a shorter version of the</span>
  68 |     | <span class='neutral'>     * name.</span>
  69 |     | <span class='neutral'>     */</span>
  70 |     | <span class='unexecuted'>    function symbol() public view virtual override returns (string memory) {</span>
  71 |     | <span class='unexecuted'>        return _symbol;</span>
  72 |     | <span class='neutral'>    }</span>
  73 |     | <span class='neutral'></span>
  74 |     | <span class='neutral'>    /**</span>
  75 |     | <span class='neutral'>     * @dev Returns the number of decimals used to get its user representation.</span>
  76 |     | <span class='neutral'>     * For example, if `decimals` equals `2`, a balance of `505` tokens should</span>
  77 |     | <span class='neutral'>     * be displayed to a user as `5.05` (`505 / 10 ** 2`).</span>
  78 |     | <span class='neutral'>     *</span>
  79 |     | <span class='neutral'>     * Tokens usually opt for a value of 18, imitating the relationship between</span>
  80 |     | <span class='neutral'>     * Ether and Wei. This is the default value returned by this function, unless</span>
  81 |     | <span class='neutral'>     * it&#39;s overridden.</span>
  82 |     | <span class='neutral'>     *</span>
  83 |     | <span class='neutral'>     * NOTE: This information is only used for _display_ purposes: it in</span>
  84 |     | <span class='neutral'>     * no way affects any of the arithmetic of the contract, including</span>
  85 |     | <span class='neutral'>     * {IERC20-balanceOf} and {IERC20-transfer}.</span>
  86 |     | <span class='neutral'>     */</span>
  87 |     | <span class='unexecuted'>    function decimals() public view virtual override returns (uint8) {</span>
  88 |     | <span class='unexecuted'>        return 18;</span>
  89 |     | <span class='neutral'>    }</span>
  90 |     | <span class='neutral'></span>
  91 |     | <span class='neutral'>    /**</span>
  92 |     | <span class='neutral'>     * @dev See {IERC20-totalSupply}.</span>
  93 |     | <span class='neutral'>     */</span>
  94 |     | <span class='unexecuted'>    function totalSupply() public view virtual override returns (uint256) {</span>
  95 |     | <span class='unexecuted'>        return _totalSupply;</span>
  96 |     | <span class='neutral'>    }</span>
  97 |     | <span class='neutral'></span>
  98 |     | <span class='neutral'>    /**</span>
  99 |     | <span class='neutral'>     * @dev See {IERC20-balanceOf}.</span>
 100 |     | <span class='neutral'>     */</span>
 101 |     | <span class='unexecuted'>    function balanceOf(address account) public view virtual override returns (uint256) {</span>
 102 |     | <span class='unexecuted'>        return _balances[account];</span>
 103 |     | <span class='neutral'>    }</span>
 104 |     | <span class='neutral'></span>
 105 |     | <span class='neutral'>    /**</span>
 106 |     | <span class='neutral'>     * @dev See {IERC20-transfer}.</span>
 107 |     | <span class='neutral'>     *</span>
 108 |     | <span class='neutral'>     * Requirements:</span>
 109 |     | <span class='neutral'>     *</span>
 110 |     | <span class='neutral'>     * - `to` cannot be the zero address.</span>
 111 |     | <span class='neutral'>     * - the caller must have a balance of at least `amount`.</span>
 112 |     | <span class='neutral'>     */</span>
 113 |     | <span class='unexecuted'>    function transfer(address to, uint256 amount) public virtual override returns (bool) {</span>
 114 |     | <span class='neutral'>        address owner = _msgSender();</span>
 115 |     | <span class='unexecuted'>        _transfer(owner, to, amount);</span>
 116 |     | <span class='neutral'>        return true;</span>
 117 |     | <span class='neutral'>    }</span>
 118 |     | <span class='neutral'></span>
 119 |     | <span class='neutral'>    /**</span>
 120 |     | <span class='neutral'>     * @dev See {IERC20-allowance}.</span>
 121 |     | <span class='neutral'>     */</span>
 122 |     | <span class='unexecuted'>    function allowance(address owner, address spender) public view virtual override returns (uint256) {</span>
 123 |     | <span class='unexecuted'>        return _allowances[owner][spender];</span>
 124 |     | <span class='neutral'>    }</span>
 125 |     | <span class='neutral'></span>
 126 |     | <span class='neutral'>    /**</span>
 127 |     | <span class='neutral'>     * @dev See {IERC20-approve}.</span>
 128 |     | <span class='neutral'>     *</span>
 129 |     | <span class='neutral'>     * NOTE: If `amount` is the maximum `uint256`, the allowance is not updated on</span>
 130 |     | <span class='neutral'>     * `transferFrom`. This is semantically equivalent to an infinite approval.</span>
 131 |     | <span class='neutral'>     *</span>
 132 |     | <span class='neutral'>     * Requirements:</span>
 133 |     | <span class='neutral'>     *</span>
 134 |     | <span class='neutral'>     * - `spender` cannot be the zero address.</span>
 135 |     | <span class='neutral'>     */</span>
 136 |     | <span class='unexecuted'>    function approve(address spender, uint256 amount) public virtual override returns (bool) {</span>
 137 |     | <span class='neutral'>        address owner = _msgSender();</span>
 138 |     | <span class='unexecuted'>        _approve(owner, spender, amount);</span>
 139 |     | <span class='unexecuted'>        return true;</span>
 140 |     | <span class='neutral'>    }</span>
 141 |     | <span class='neutral'></span>
 142 |     | <span class='neutral'>    /**</span>
 143 |     | <span class='neutral'>     * @dev See {IERC20-transferFrom}.</span>
 144 |     | <span class='neutral'>     *</span>
 145 |     | <span class='neutral'>     * Emits an {Approval} event indicating the updated allowance. This is not</span>
 146 |     | <span class='neutral'>     * required by the EIP. See the note at the beginning of {ERC20}.</span>
 147 |     | <span class='neutral'>     *</span>
 148 |     | <span class='neutral'>     * NOTE: Does not update the allowance if the current allowance</span>
 149 |     | <span class='neutral'>     * is the maximum `uint256`.</span>
 150 |     | <span class='neutral'>     *</span>
 151 |     | <span class='neutral'>     * Requirements:</span>
 152 |     | <span class='neutral'>     *</span>
 153 |     | <span class='neutral'>     * - `from` and `to` cannot be the zero address.</span>
 154 |     | <span class='neutral'>     * - `from` must have a balance of at least `amount`.</span>
 155 |     | <span class='neutral'>     * - the caller must have allowance for ``from``&#39;s tokens of at least</span>
 156 |     | <span class='neutral'>     * `amount`.</span>
 157 |     | <span class='neutral'>     */</span>
 158 |     | <span class='unexecuted'>    function transferFrom(address from, address to, uint256 amount) public virtual override returns (bool) {</span>
 159 |     | <span class='neutral'>        address spender = _msgSender();</span>
 160 |     | <span class='unexecuted'>        _spendAllowance(from, spender, amount);</span>
 161 |     | <span class='unexecuted'>        _transfer(from, to, amount);</span>
 162 |     | <span class='unexecuted'>        return true;</span>
 163 |     | <span class='neutral'>    }</span>
 164 |     | <span class='neutral'></span>
 165 |     | <span class='neutral'>    /**</span>
 166 |     | <span class='neutral'>     * @dev Atomically increases the allowance granted to `spender` by the caller.</span>
 167 |     | <span class='neutral'>     *</span>
 168 |     | <span class='neutral'>     * This is an alternative to {approve} that can be used as a mitigation for</span>
 169 |     | <span class='neutral'>     * problems described in {IERC20-approve}.</span>
 170 |     | <span class='neutral'>     *</span>
 171 |     | <span class='neutral'>     * Emits an {Approval} event indicating the updated allowance.</span>
 172 |     | <span class='neutral'>     *</span>
 173 |     | <span class='neutral'>     * Requirements:</span>
 174 |     | <span class='neutral'>     *</span>
 175 |     | <span class='neutral'>     * - `spender` cannot be the zero address.</span>
 176 |     | <span class='neutral'>     */</span>
 177 |     | <span class='unexecuted'>    function increaseAllowance(address spender, uint256 addedValue) public virtual returns (bool) {</span>
 178 |     | <span class='neutral'>        address owner = _msgSender();</span>
 179 |     | <span class='unexecuted'>        _approve(owner, spender, allowance(owner, spender) + addedValue);</span>
 180 |     | <span class='unexecuted'>        return true;</span>
 181 |     | <span class='neutral'>    }</span>
 182 |     | <span class='neutral'></span>
 183 |     | <span class='neutral'>    /**</span>
 184 |     | <span class='neutral'>     * @dev Atomically decreases the allowance granted to `spender` by the caller.</span>
 185 |     | <span class='neutral'>     *</span>
 186 |     | <span class='neutral'>     * This is an alternative to {approve} that can be used as a mitigation for</span>
 187 |     | <span class='neutral'>     * problems described in {IERC20-approve}.</span>
 188 |     | <span class='neutral'>     *</span>
 189 |     | <span class='neutral'>     * Emits an {Approval} event indicating the updated allowance.</span>
 190 |     | <span class='neutral'>     *</span>
 191 |     | <span class='neutral'>     * Requirements:</span>
 192 |     | <span class='neutral'>     *</span>
 193 |     | <span class='neutral'>     * - `spender` cannot be the zero address.</span>
 194 |     | <span class='neutral'>     * - `spender` must have allowance for the caller of at least</span>
 195 |     | <span class='neutral'>     * `subtractedValue`.</span>
 196 |     | <span class='neutral'>     */</span>
 197 |     | <span class='unexecuted'>    function decreaseAllowance(address spender, uint256 subtractedValue) public virtual returns (bool) {</span>
 198 |     | <span class='neutral'>        address owner = _msgSender();</span>
 199 |     | <span class='unexecuted'>        uint256 currentAllowance = allowance(owner, spender);</span>
 200 |     | <span class='unexecuted'>        require(currentAllowance &gt;= subtractedValue, &quot;ERC20: decreased allowance below zero&quot;);</span>
 201 |     | <span class='neutral'>        unchecked {</span>
 202 |     | <span class='unexecuted'>            _approve(owner, spender, currentAllowance - subtractedValue);</span>
 203 |     | <span class='neutral'>        }</span>
 204 |     | <span class='neutral'></span>
 205 |     | <span class='unexecuted'>        return true;</span>
 206 |     | <span class='neutral'>    }</span>
 207 |     | <span class='neutral'></span>
 208 |     | <span class='neutral'>    /**</span>
 209 |     | <span class='neutral'>     * @dev Moves `amount` of tokens from `from` to `to`.</span>
 210 |     | <span class='neutral'>     *</span>
 211 |     | <span class='neutral'>     * This internal function is equivalent to {transfer}, and can be used to</span>
 212 |     | <span class='neutral'>     * e.g. implement automatic token fees, slashing mechanisms, etc.</span>
 213 |     | <span class='neutral'>     *</span>
 214 |     | <span class='neutral'>     * Emits a {Transfer} event.</span>
 215 |     | <span class='neutral'>     *</span>
 216 |     | <span class='neutral'>     * Requirements:</span>
 217 |     | <span class='neutral'>     *</span>
 218 |     | <span class='neutral'>     * - `from` cannot be the zero address.</span>
 219 |     | <span class='neutral'>     * - `to` cannot be the zero address.</span>
 220 |     | <span class='neutral'>     * - `from` must have a balance of at least `amount`.</span>
 221 |     | <span class='neutral'>     */</span>
 222 |     | <span class='unexecuted'>    function _transfer(address from, address to, uint256 amount) internal virtual {</span>
 223 |     | <span class='unexecuted'>        require(from != address(0), &quot;ERC20: transfer from the zero address&quot;);</span>
 224 |     | <span class='unexecuted'>        require(to != address(0), &quot;ERC20: transfer to the zero address&quot;);</span>
 225 |     | <span class='neutral'></span>
 226 |     | <span class='neutral'>        _beforeTokenTransfer(from, to, amount);</span>
 227 |     | <span class='neutral'></span>
 228 |     | <span class='unexecuted'>        uint256 fromBalance = _balances[from];</span>
 229 |     | <span class='unexecuted'>        require(fromBalance &gt;= amount, &quot;ERC20: transfer amount exceeds balance&quot;);</span>
 230 |     | <span class='neutral'>        unchecked {</span>
 231 |     | <span class='unexecuted'>            _balances[from] = fromBalance - amount;</span>
 232 |     | <span class='neutral'>            // Overflow not possible: the sum of all balances is capped by totalSupply, and the sum is preserved by</span>
 233 |     | <span class='neutral'>            // decrementing then incrementing.</span>
 234 |     | <span class='unexecuted'>            _balances[to] += amount;</span>
 235 |     | <span class='neutral'>        }</span>
 236 |     | <span class='neutral'></span>
 237 |     | <span class='unexecuted'>        emit Transfer(from, to, amount);</span>
 238 |     | <span class='neutral'></span>
 239 |     | <span class='unexecuted'>        _afterTokenTransfer(from, to, amount);</span>
 240 |     | <span class='neutral'>    }</span>
 241 |     | <span class='neutral'></span>
 242 |     | <span class='neutral'>    /** @dev Creates `amount` tokens and assigns them to `account`, increasing</span>
 243 |     | <span class='neutral'>     * the total supply.</span>
 244 |     | <span class='neutral'>     *</span>
 245 |     | <span class='neutral'>     * Emits a {Transfer} event with `from` set to the zero address.</span>
 246 |     | <span class='neutral'>     *</span>
 247 |     | <span class='neutral'>     * Requirements:</span>
 248 |     | <span class='neutral'>     *</span>
 249 |     | <span class='neutral'>     * - `account` cannot be the zero address.</span>
 250 |     | <span class='neutral'>     */</span>
 251 |     | <span class='unexecuted'>    function _mint(address account, uint256 amount) internal virtual {</span>
 252 |     | <span class='unexecuted'>        require(account != address(0), &quot;ERC20: mint to the zero address&quot;);</span>
 253 |     | <span class='neutral'></span>
 254 |     | <span class='neutral'>        _beforeTokenTransfer(address(0), account, amount);</span>
 255 |     | <span class='neutral'></span>
 256 |     | <span class='unexecuted'>        _totalSupply += amount;</span>
 257 |     | <span class='neutral'>        unchecked {</span>
 258 |     | <span class='neutral'>            // Overflow not possible: balance + amount is at most totalSupply + amount, which is checked above.</span>
 259 |     | <span class='unexecuted'>            _balances[account] += amount;</span>
 260 |     | <span class='neutral'>        }</span>
 261 |     | <span class='unexecuted'>        emit Transfer(address(0), account, amount);</span>
 262 |     | <span class='neutral'></span>
 263 |     | <span class='unexecuted'>        _afterTokenTransfer(address(0), account, amount);</span>
 264 |     | <span class='neutral'>    }</span>
 265 |     | <span class='neutral'></span>
 266 |     | <span class='neutral'>    /**</span>
 267 |     | <span class='neutral'>     * @dev Destroys `amount` tokens from `account`, reducing the</span>
 268 |     | <span class='neutral'>     * total supply.</span>
 269 |     | <span class='neutral'>     *</span>
 270 |     | <span class='neutral'>     * Emits a {Transfer} event with `to` set to the zero address.</span>
 271 |     | <span class='neutral'>     *</span>
 272 |     | <span class='neutral'>     * Requirements:</span>
 273 |     | <span class='neutral'>     *</span>
 274 |     | <span class='neutral'>     * - `account` cannot be the zero address.</span>
 275 |     | <span class='neutral'>     * - `account` must have at least `amount` tokens.</span>
 276 |     | <span class='neutral'>     */</span>
 277 |     | <span class='neutral'>    function _burn(address account, uint256 amount) internal virtual {</span>
 278 |     | <span class='neutral'>        require(account != address(0), &quot;ERC20: burn from the zero address&quot;);</span>
 279 |     | <span class='neutral'></span>
 280 |     | <span class='neutral'>        _beforeTokenTransfer(account, address(0), amount);</span>
 281 |     | <span class='neutral'></span>
 282 |     | <span class='neutral'>        uint256 accountBalance = _balances[account];</span>
 283 |     | <span class='neutral'>        require(accountBalance &gt;= amount, &quot;ERC20: burn amount exceeds balance&quot;);</span>
 284 |     | <span class='neutral'>        unchecked {</span>
 285 |     | <span class='neutral'>            _balances[account] = accountBalance - amount;</span>
 286 |     | <span class='neutral'>            // Overflow not possible: amount &lt;= accountBalance &lt;= totalSupply.</span>
 287 |     | <span class='neutral'>            _totalSupply -= amount;</span>
 288 |     | <span class='neutral'>        }</span>
 289 |     | <span class='neutral'></span>
 290 |     | <span class='neutral'>        emit Transfer(account, address(0), amount);</span>
 291 |     | <span class='neutral'></span>
 292 |     | <span class='neutral'>        _afterTokenTransfer(account, address(0), amount);</span>
 293 |     | <span class='neutral'>    }</span>
 294 |     | <span class='neutral'></span>
 295 |     | <span class='neutral'>    /**</span>
 296 |     | <span class='neutral'>     * @dev Sets `amount` as the allowance of `spender` over the `owner` s tokens.</span>
 297 |     | <span class='neutral'>     *</span>
 298 |     | <span class='neutral'>     * This internal function is equivalent to `approve`, and can be used to</span>
 299 |     | <span class='neutral'>     * e.g. set automatic allowances for certain subsystems, etc.</span>
 300 |     | <span class='neutral'>     *</span>
 301 |     | <span class='neutral'>     * Emits an {Approval} event.</span>
 302 |     | <span class='neutral'>     *</span>
 303 |     | <span class='neutral'>     * Requirements:</span>
 304 |     | <span class='neutral'>     *</span>
 305 |     | <span class='neutral'>     * - `owner` cannot be the zero address.</span>
 306 |     | <span class='neutral'>     * - `spender` cannot be the zero address.</span>
 307 |     | <span class='neutral'>     */</span>
 308 |     | <span class='unexecuted'>    function _approve(address owner, address spender, uint256 amount) internal virtual {</span>
 309 |     | <span class='unexecuted'>        require(owner != address(0), &quot;ERC20: approve from the zero address&quot;);</span>
 310 |     | <span class='unexecuted'>        require(spender != address(0), &quot;ERC20: approve to the zero address&quot;);</span>
 311 |     | <span class='neutral'></span>
 312 |     | <span class='unexecuted'>        _allowances[owner][spender] = amount;</span>
 313 |     | <span class='unexecuted'>        emit Approval(owner, spender, amount);</span>
 314 |     | <span class='neutral'>    }</span>
 315 |     | <span class='neutral'></span>
 316 |     | <span class='neutral'>    /**</span>
 317 |     | <span class='neutral'>     * @dev Updates `owner` s allowance for `spender` based on spent `amount`.</span>
 318 |     | <span class='neutral'>     *</span>
 319 |     | <span class='neutral'>     * Does not update the allowance amount in case of infinite allowance.</span>
 320 |     | <span class='neutral'>     * Revert if not enough allowance is available.</span>
 321 |     | <span class='neutral'>     *</span>
 322 |     | <span class='neutral'>     * Might emit an {Approval} event.</span>
 323 |     | <span class='neutral'>     */</span>
 324 |     | <span class='unexecuted'>    function _spendAllowance(address owner, address spender, uint256 amount) internal virtual {</span>
 325 |     | <span class='unexecuted'>        uint256 currentAllowance = allowance(owner, spender);</span>
 326 |     | <span class='unexecuted'>        if (currentAllowance != type(uint256).max) {</span>
 327 |     | <span class='unexecuted'>            require(currentAllowance &gt;= amount, &quot;ERC20: insufficient allowance&quot;);</span>
 328 |     | <span class='neutral'>            unchecked {</span>
 329 |     | <span class='unexecuted'>                _approve(owner, spender, currentAllowance - amount);</span>
 330 |     | <span class='neutral'>            }</span>
 331 |     | <span class='neutral'>        }</span>
 332 |     | <span class='neutral'>    }</span>
 333 |     | <span class='neutral'></span>
 334 |     | <span class='neutral'>    /**</span>
 335 |     | <span class='neutral'>     * @dev Hook that is called before any transfer of tokens. This includes</span>
 336 |     | <span class='neutral'>     * minting and burning.</span>
 337 |     | <span class='neutral'>     *</span>
 338 |     | <span class='neutral'>     * Calling conditions:</span>
 339 |     | <span class='neutral'>     *</span>
 340 |     | <span class='neutral'>     * - when `from` and `to` are both non-zero, `amount` of ``from``&#39;s tokens</span>
 341 |     | <span class='neutral'>     * will be transferred to `to`.</span>
 342 |     | <span class='neutral'>     * - when `from` is zero, `amount` tokens will be minted for `to`.</span>
 343 |     | <span class='neutral'>     * - when `to` is zero, `amount` of ``from``&#39;s tokens will be burned.</span>
 344 |     | <span class='neutral'>     * - `from` and `to` are never both zero.</span>
 345 |     | <span class='neutral'>     *</span>
 346 |     | <span class='neutral'>     * To learn more about hooks, head to xref:ROOT:extending-contracts.adoc#using-hooks[Using Hooks].</span>
 347 |     | <span class='neutral'>     */</span>
 348 |     | <span class='unexecuted'>    function _beforeTokenTransfer(address from, address to, uint256 amount) internal virtual {}</span>
 349 |     | <span class='neutral'></span>
 350 |     | <span class='neutral'>    /**</span>
 351 |     | <span class='neutral'>     * @dev Hook that is called after any transfer of tokens. This includes</span>
 352 |     | <span class='neutral'>     * minting and burning.</span>
 353 |     | <span class='neutral'>     *</span>
 354 |     | <span class='neutral'>     * Calling conditions:</span>
 355 |     | <span class='neutral'>     *</span>
 356 |     | <span class='neutral'>     * - when `from` and `to` are both non-zero, `amount` of ``from``&#39;s tokens</span>
 357 |     | <span class='neutral'>     * has been transferred to `to`.</span>
 358 |     | <span class='neutral'>     * - when `from` is zero, `amount` tokens have been minted for `to`.</span>
 359 |     | <span class='neutral'>     * - when `to` is zero, `amount` of ``from``&#39;s tokens have been burned.</span>
 360 |     | <span class='neutral'>     * - `from` and `to` are never both zero.</span>
 361 |     | <span class='neutral'>     *</span>
 362 |     | <span class='neutral'>     * To learn more about hooks, head to xref:ROOT:extending-contracts.adoc#using-hooks[Using Hooks].</span>
 363 |     | <span class='neutral'>     */</span>
 364 |     | <span class='neutral'>    function _afterTokenTransfer(address from, address to, uint256 amount) internal virtual {}</span>
 365 |     | <span class='neutral'>}</span>
 366 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/lib/openzeppelin-contracts/contracts/token/ERC20/IERC20.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (token/ERC20/IERC20.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>/**</span>
  7 |     | <span class='neutral'> * @dev Interface of the ERC20 standard as defined in the EIP.</span>
  8 |     | <span class='neutral'> */</span>
  9 |     | <span class='neutral'>interface IERC20 {</span>
 10 |     | <span class='neutral'>    /**</span>
 11 |     | <span class='neutral'>     * @dev Emitted when `value` tokens are moved from one account (`from`) to</span>
 12 |     | <span class='neutral'>     * another (`to`).</span>
 13 |     | <span class='neutral'>     *</span>
 14 |     | <span class='neutral'>     * Note that `value` may be zero.</span>
 15 |     | <span class='neutral'>     */</span>
 16 |     | <span class='neutral'>    event Transfer(address indexed from, address indexed to, uint256 value);</span>
 17 |     | <span class='neutral'></span>
 18 |     | <span class='neutral'>    /**</span>
 19 |     | <span class='neutral'>     * @dev Emitted when the allowance of a `spender` for an `owner` is set by</span>
 20 |     | <span class='neutral'>     * a call to {approve}. `value` is the new allowance.</span>
 21 |     | <span class='neutral'>     */</span>
 22 |     | <span class='neutral'>    event Approval(address indexed owner, address indexed spender, uint256 value);</span>
 23 |     | <span class='neutral'></span>
 24 |     | <span class='neutral'>    /**</span>
 25 |     | <span class='neutral'>     * @dev Returns the amount of tokens in existence.</span>
 26 |     | <span class='neutral'>     */</span>
 27 |     | <span class='neutral'>    function totalSupply() external view returns (uint256);</span>
 28 |     | <span class='neutral'></span>
 29 |     | <span class='neutral'>    /**</span>
 30 |     | <span class='neutral'>     * @dev Returns the amount of tokens owned by `account`.</span>
 31 |     | <span class='neutral'>     */</span>
 32 |     | <span class='neutral'>    function balanceOf(address account) external view returns (uint256);</span>
 33 |     | <span class='neutral'></span>
 34 |     | <span class='neutral'>    /**</span>
 35 |     | <span class='neutral'>     * @dev Moves `amount` tokens from the caller&#39;s account to `to`.</span>
 36 |     | <span class='neutral'>     *</span>
 37 |     | <span class='neutral'>     * Returns a boolean value indicating whether the operation succeeded.</span>
 38 |     | <span class='neutral'>     *</span>
 39 |     | <span class='neutral'>     * Emits a {Transfer} event.</span>
 40 |     | <span class='neutral'>     */</span>
 41 |     | <span class='neutral'>    function transfer(address to, uint256 amount) external returns (bool);</span>
 42 |     | <span class='neutral'></span>
 43 |     | <span class='neutral'>    /**</span>
 44 |     | <span class='neutral'>     * @dev Returns the remaining number of tokens that `spender` will be</span>
 45 |     | <span class='neutral'>     * allowed to spend on behalf of `owner` through {transferFrom}. This is</span>
 46 |     | <span class='neutral'>     * zero by default.</span>
 47 |     | <span class='neutral'>     *</span>
 48 |     | <span class='neutral'>     * This value changes when {approve} or {transferFrom} are called.</span>
 49 |     | <span class='neutral'>     */</span>
 50 |     | <span class='neutral'>    function allowance(address owner, address spender) external view returns (uint256);</span>
 51 |     | <span class='neutral'></span>
 52 |     | <span class='neutral'>    /**</span>
 53 |     | <span class='neutral'>     * @dev Sets `amount` as the allowance of `spender` over the caller&#39;s tokens.</span>
 54 |     | <span class='neutral'>     *</span>
 55 |     | <span class='neutral'>     * Returns a boolean value indicating whether the operation succeeded.</span>
 56 |     | <span class='neutral'>     *</span>
 57 |     | <span class='neutral'>     * IMPORTANT: Beware that changing an allowance with this method brings the risk</span>
 58 |     | <span class='neutral'>     * that someone may use both the old and the new allowance by unfortunate</span>
 59 |     | <span class='neutral'>     * transaction ordering. One possible solution to mitigate this race</span>
 60 |     | <span class='neutral'>     * condition is to first reduce the spender&#39;s allowance to 0 and set the</span>
 61 |     | <span class='neutral'>     * desired value afterwards:</span>
 62 |     | <span class='neutral'>     * https://github.com/ethereum/EIPs/issues/20#issuecomment-263524729</span>
 63 |     | <span class='neutral'>     *</span>
 64 |     | <span class='neutral'>     * Emits an {Approval} event.</span>
 65 |     | <span class='neutral'>     */</span>
 66 |     | <span class='neutral'>    function approve(address spender, uint256 amount) external returns (bool);</span>
 67 |     | <span class='neutral'></span>
 68 |     | <span class='neutral'>    /**</span>
 69 |     | <span class='neutral'>     * @dev Moves `amount` tokens from `from` to `to` using the</span>
 70 |     | <span class='neutral'>     * allowance mechanism. `amount` is then deducted from the caller&#39;s</span>
 71 |     | <span class='neutral'>     * allowance.</span>
 72 |     | <span class='neutral'>     *</span>
 73 |     | <span class='neutral'>     * Returns a boolean value indicating whether the operation succeeded.</span>
 74 |     | <span class='neutral'>     *</span>
 75 |     | <span class='neutral'>     * Emits a {Transfer} event.</span>
 76 |     | <span class='neutral'>     */</span>
 77 |     | <span class='neutral'>    function transferFrom(address from, address to, uint256 amount) external returns (bool);</span>
 78 |     | <span class='neutral'>}</span>
 79 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Permit.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (token/ERC20/extensions/ERC20Permit.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>import &quot;./IERC20Permit.sol&quot;;</span>
  7 |     | <span class='neutral'>import &quot;../ERC20.sol&quot;;</span>
  8 |     | <span class='neutral'>import &quot;../../../utils/cryptography/ECDSA.sol&quot;;</span>
  9 |     | <span class='neutral'>import &quot;../../../utils/cryptography/EIP712.sol&quot;;</span>
 10 |     | <span class='neutral'>import &quot;../../../utils/Counters.sol&quot;;</span>
 11 |     | <span class='neutral'></span>
 12 |     | <span class='neutral'>/**</span>
 13 |     | <span class='neutral'> * @dev Implementation of the ERC20 Permit extension allowing approvals to be made via signatures, as defined in</span>
 14 |     | <span class='neutral'> * https://eips.ethereum.org/EIPS/eip-2612[EIP-2612].</span>
 15 |     | <span class='neutral'> *</span>
 16 |     | <span class='neutral'> * Adds the {permit} method, which can be used to change an account&#39;s ERC20 allowance (see {IERC20-allowance}) by</span>
 17 |     | <span class='neutral'> * presenting a message signed by the account. By not relying on `{IERC20-approve}`, the token holder account doesn&#39;t</span>
 18 |     | <span class='neutral'> * need to send a transaction, and thus is not required to hold Ether at all.</span>
 19 |     | <span class='neutral'> *</span>
 20 |     | <span class='neutral'> * _Available since v3.4._</span>
 21 |     | <span class='neutral'> */</span>
 22 |     | <span class='neutral'>abstract contract ERC20Permit is ERC20, IERC20Permit, EIP712 {</span>
 23 |     | <span class='neutral'>    using Counters for Counters.Counter;</span>
 24 |     | <span class='neutral'></span>
 25 |     | <span class='neutral'>    mapping(address =&gt; Counters.Counter) private _nonces;</span>
 26 |     | <span class='neutral'></span>
 27 |     | <span class='neutral'>    // solhint-disable-next-line var-name-mixedcase</span>
 28 |     | <span class='neutral'>    bytes32 private constant _PERMIT_TYPEHASH =</span>
 29 |     | <span class='unexecuted'>        keccak256(&quot;Permit(address owner,address spender,uint256 value,uint256 nonce,uint256 deadline)&quot;);</span>
 30 |     | <span class='neutral'>    /**</span>
 31 |     | <span class='neutral'>     * @dev In previous versions `_PERMIT_TYPEHASH` was declared as `immutable`.</span>
 32 |     | <span class='neutral'>     * However, to ensure consistency with the upgradeable transpiler, we will continue</span>
 33 |     | <span class='neutral'>     * to reserve a slot.</span>
 34 |     | <span class='neutral'>     * @custom:oz-renamed-from _PERMIT_TYPEHASH</span>
 35 |     | <span class='neutral'>     */</span>
 36 |     | <span class='neutral'>    // solhint-disable-next-line var-name-mixedcase</span>
 37 |     | <span class='neutral'>    bytes32 private _PERMIT_TYPEHASH_DEPRECATED_SLOT;</span>
 38 |     | <span class='neutral'></span>
 39 |     | <span class='neutral'>    /**</span>
 40 |     | <span class='neutral'>     * @dev Initializes the {EIP712} domain separator using the `name` parameter, and setting `version` to `&quot;1&quot;`.</span>
 41 |     | <span class='neutral'>     *</span>
 42 |     | <span class='neutral'>     * It&#39;s a good idea to use the same `name` that is defined as the ERC20 token name.</span>
 43 |     | <span class='neutral'>     */</span>
 44 |     | <span class='unexecuted'>    constructor(string memory name) EIP712(name, &quot;1&quot;) {}</span>
 45 |     | <span class='neutral'></span>
 46 |     | <span class='neutral'>    /**</span>
 47 |     | <span class='neutral'>     * @dev See {IERC20Permit-permit}.</span>
 48 |     | <span class='neutral'>     */</span>
 49 |     | <span class='unexecuted'>    function permit(</span>
 50 |     | <span class='neutral'>        address owner,</span>
 51 |     | <span class='neutral'>        address spender,</span>
 52 |     | <span class='neutral'>        uint256 value,</span>
 53 |     | <span class='neutral'>        uint256 deadline,</span>
 54 |     | <span class='neutral'>        uint8 v,</span>
 55 |     | <span class='neutral'>        bytes32 r,</span>
 56 |     | <span class='neutral'>        bytes32 s</span>
 57 |     | <span class='unexecuted'>    ) public virtual override {</span>
 58 |     | <span class='unexecuted'>        require(block.timestamp &lt;= deadline, &quot;ERC20Permit: expired deadline&quot;);</span>
 59 |     | <span class='neutral'></span>
 60 |     | <span class='unexecuted'>        bytes32 structHash = keccak256(abi.encode(_PERMIT_TYPEHASH, owner, spender, value, _useNonce(owner), deadline));</span>
 61 |     | <span class='neutral'></span>
 62 |     | <span class='unexecuted'>        bytes32 hash = _hashTypedDataV4(structHash);</span>
 63 |     | <span class='neutral'></span>
 64 |     | <span class='unexecuted'>        address signer = ECDSA.recover(hash, v, r, s);</span>
 65 |     | <span class='unexecuted'>        require(signer == owner, &quot;ERC20Permit: invalid signature&quot;);</span>
 66 |     | <span class='neutral'></span>
 67 |     | <span class='unexecuted'>        _approve(owner, spender, value);</span>
 68 |     | <span class='neutral'>    }</span>
 69 |     | <span class='neutral'></span>
 70 |     | <span class='neutral'>    /**</span>
 71 |     | <span class='neutral'>     * @dev See {IERC20Permit-nonces}.</span>
 72 |     | <span class='neutral'>     */</span>
 73 |     | <span class='unexecuted'>    function nonces(address owner) public view virtual override returns (uint256) {</span>
 74 |     | <span class='unexecuted'>        return _nonces[owner].current();</span>
 75 |     | <span class='neutral'>    }</span>
 76 |     | <span class='neutral'></span>
 77 |     | <span class='neutral'>    /**</span>
 78 |     | <span class='neutral'>     * @dev See {IERC20Permit-DOMAIN_SEPARATOR}.</span>
 79 |     | <span class='neutral'>     */</span>
 80 |     | <span class='neutral'>    // solhint-disable-next-line func-name-mixedcase</span>
 81 |     | <span class='unexecuted'>    function DOMAIN_SEPARATOR() external view override returns (bytes32) {</span>
 82 |     | <span class='unexecuted'>        return _domainSeparatorV4();</span>
 83 |     | <span class='neutral'>    }</span>
 84 |     | <span class='neutral'></span>
 85 |     | <span class='neutral'>    /**</span>
 86 |     | <span class='neutral'>     * @dev &quot;Consume a nonce&quot;: return the current value and increment.</span>
 87 |     | <span class='neutral'>     *</span>
 88 |     | <span class='neutral'>     * _Available since v4.1._</span>
 89 |     | <span class='neutral'>     */</span>
 90 |     | <span class='unexecuted'>    function _useNonce(address owner) internal virtual returns (uint256 current) {</span>
 91 |     | <span class='unexecuted'>        Counters.Counter storage nonce = _nonces[owner];</span>
 92 |     | <span class='neutral'>        current = nonce.current();</span>
 93 |     | <span class='unexecuted'>        nonce.increment();</span>
 94 |     | <span class='neutral'>    }</span>
 95 |     | <span class='neutral'>}</span>
 96 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/lib/openzeppelin-contracts/contracts/token/ERC20/extensions/ERC20Votes.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (token/ERC20/extensions/ERC20Votes.sol)</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
   5 |     | <span class='neutral'></span>
   6 |     | <span class='neutral'>import &quot;./ERC20Permit.sol&quot;;</span>
   7 |     | <span class='neutral'>import &quot;../../../interfaces/IERC5805.sol&quot;;</span>
   8 |     | <span class='neutral'>import &quot;../../../utils/math/Math.sol&quot;;</span>
   9 |     | <span class='neutral'>import &quot;../../../utils/math/SafeCast.sol&quot;;</span>
  10 |     | <span class='neutral'>import &quot;../../../utils/cryptography/ECDSA.sol&quot;;</span>
  11 |     | <span class='neutral'></span>
  12 |     | <span class='neutral'>/**</span>
  13 |     | <span class='neutral'> * @dev Extension of ERC20 to support Compound-like voting and delegation. This version is more generic than Compound&#39;s,</span>
  14 |     | <span class='neutral'> * and supports token supply up to 2^224^ - 1, while COMP is limited to 2^96^ - 1.</span>
  15 |     | <span class='neutral'> *</span>
  16 |     | <span class='neutral'> * NOTE: If exact COMP compatibility is required, use the {ERC20VotesComp} variant of this module.</span>
  17 |     | <span class='neutral'> *</span>
  18 |     | <span class='neutral'> * This extension keeps a history (checkpoints) of each account&#39;s vote power. Vote power can be delegated either</span>
  19 |     | <span class='neutral'> * by calling the {delegate} function directly, or by providing a signature to be used with {delegateBySig}. Voting</span>
  20 |     | <span class='neutral'> * power can be queried through the public accessors {getVotes} and {getPastVotes}.</span>
  21 |     | <span class='neutral'> *</span>
  22 |     | <span class='neutral'> * By default, token balance does not account for voting power. This makes transfers cheaper. The downside is that it</span>
  23 |     | <span class='neutral'> * requires users to delegate to themselves in order to activate checkpoints and have their voting power tracked.</span>
  24 |     | <span class='neutral'> *</span>
  25 |     | <span class='neutral'> * _Available since v4.2._</span>
  26 |     | <span class='neutral'> */</span>
  27 |     | <span class='neutral'>abstract contract ERC20Votes is ERC20Permit, IERC5805 {</span>
  28 |     | <span class='neutral'>    struct Checkpoint {</span>
  29 |     | <span class='neutral'>        uint32 fromBlock;</span>
  30 |     | <span class='neutral'>        uint224 votes;</span>
  31 |     | <span class='neutral'>    }</span>
  32 |     | <span class='neutral'></span>
  33 |     | <span class='neutral'>    bytes32 private constant _DELEGATION_TYPEHASH =</span>
  34 |     | <span class='unexecuted'>        keccak256(&quot;Delegation(address delegatee,uint256 nonce,uint256 expiry)&quot;);</span>
  35 |     | <span class='neutral'></span>
  36 |     | <span class='neutral'>    mapping(address =&gt; address) private _delegates;</span>
  37 |     | <span class='neutral'>    mapping(address =&gt; Checkpoint[]) private _checkpoints;</span>
  38 |     | <span class='neutral'>    Checkpoint[] private _totalSupplyCheckpoints;</span>
  39 |     | <span class='neutral'></span>
  40 |     | <span class='neutral'>    /**</span>
  41 |     | <span class='neutral'>     * @dev Clock used for flagging checkpoints. Can be overridden to implement timestamp based checkpoints (and voting).</span>
  42 |     | <span class='neutral'>     */</span>
  43 |     | <span class='unexecuted'>    function clock() public view virtual override returns (uint48) {</span>
  44 |     | <span class='unexecuted'>        return SafeCast.toUint48(block.number);</span>
  45 |     | <span class='neutral'>    }</span>
  46 |     | <span class='neutral'></span>
  47 |     | <span class='neutral'>    /**</span>
  48 |     | <span class='neutral'>     * @dev Description of the clock</span>
  49 |     | <span class='neutral'>     */</span>
  50 |     | <span class='neutral'>    // solhint-disable-next-line func-name-mixedcase</span>
  51 |     | <span class='unexecuted'>    function CLOCK_MODE() public view virtual override returns (string memory) {</span>
  52 |     | <span class='neutral'>        // Check that the clock was not modified</span>
  53 |     | <span class='unexecuted'>        require(clock() == block.number, &quot;ERC20Votes: broken clock mode&quot;);</span>
  54 |     | <span class='unexecuted'>        return &quot;mode=blocknumber&amp;from=default&quot;;</span>
  55 |     | <span class='neutral'>    }</span>
  56 |     | <span class='neutral'></span>
  57 |     | <span class='neutral'>    /**</span>
  58 |     | <span class='neutral'>     * @dev Get the `pos`-th checkpoint for `account`.</span>
  59 |     | <span class='neutral'>     */</span>
  60 |     | <span class='unexecuted'>    function checkpoints(address account, uint32 pos) public view virtual returns (Checkpoint memory) {</span>
  61 |     | <span class='unexecuted'>        return _checkpoints[account][pos];</span>
  62 |     | <span class='neutral'>    }</span>
  63 |     | <span class='neutral'></span>
  64 |     | <span class='neutral'>    /**</span>
  65 |     | <span class='neutral'>     * @dev Get number of checkpoints for `account`.</span>
  66 |     | <span class='neutral'>     */</span>
  67 |     | <span class='unexecuted'>    function numCheckpoints(address account) public view virtual returns (uint32) {</span>
  68 |     | <span class='unexecuted'>        return SafeCast.toUint32(_checkpoints[account].length);</span>
  69 |     | <span class='neutral'>    }</span>
  70 |     | <span class='neutral'></span>
  71 |     | <span class='neutral'>    /**</span>
  72 |     | <span class='neutral'>     * @dev Get the address `account` is currently delegating to.</span>
  73 |     | <span class='neutral'>     */</span>
  74 |     | <span class='unexecuted'>    function delegates(address account) public view virtual override returns (address) {</span>
  75 |     | <span class='unexecuted'>        return _delegates[account];</span>
  76 |     | <span class='neutral'>    }</span>
  77 |     | <span class='neutral'></span>
  78 |     | <span class='neutral'>    /**</span>
  79 |     | <span class='neutral'>     * @dev Gets the current votes balance for `account`</span>
  80 |     | <span class='neutral'>     */</span>
  81 |     | <span class='unexecuted'>    function getVotes(address account) public view virtual override returns (uint256) {</span>
  82 |     | <span class='unexecuted'>        uint256 pos = _checkpoints[account].length;</span>
  83 |     | <span class='neutral'>        unchecked {</span>
  84 |     | <span class='unexecuted'>            return pos == 0 ? 0 : _checkpoints[account][pos - 1].votes;</span>
  85 |     | <span class='neutral'>        }</span>
  86 |     | <span class='neutral'>    }</span>
  87 |     | <span class='neutral'></span>
  88 |     | <span class='neutral'>    /**</span>
  89 |     | <span class='neutral'>     * @dev Retrieve the number of votes for `account` at the end of `timepoint`.</span>
  90 |     | <span class='neutral'>     *</span>
  91 |     | <span class='neutral'>     * Requirements:</span>
  92 |     | <span class='neutral'>     *</span>
  93 |     | <span class='neutral'>     * - `timepoint` must be in the past</span>
  94 |     | <span class='neutral'>     */</span>
  95 |     | <span class='unexecuted'>    function getPastVotes(address account, uint256 timepoint) public view virtual override returns (uint256) {</span>
  96 |     | <span class='unexecuted'>        require(timepoint &lt; clock(), &quot;ERC20Votes: future lookup&quot;);</span>
  97 |     | <span class='unexecuted'>        return _checkpointsLookup(_checkpoints[account], timepoint);</span>
  98 |     | <span class='neutral'>    }</span>
  99 |     | <span class='neutral'></span>
 100 |     | <span class='neutral'>    /**</span>
 101 |     | <span class='neutral'>     * @dev Retrieve the `totalSupply` at the end of `timepoint`. Note, this value is the sum of all balances.</span>
 102 |     | <span class='neutral'>     * It is NOT the sum of all the delegated votes!</span>
 103 |     | <span class='neutral'>     *</span>
 104 |     | <span class='neutral'>     * Requirements:</span>
 105 |     | <span class='neutral'>     *</span>
 106 |     | <span class='neutral'>     * - `timepoint` must be in the past</span>
 107 |     | <span class='neutral'>     */</span>
 108 |     | <span class='unexecuted'>    function getPastTotalSupply(uint256 timepoint) public view virtual override returns (uint256) {</span>
 109 |     | <span class='unexecuted'>        require(timepoint &lt; clock(), &quot;ERC20Votes: future lookup&quot;);</span>
 110 |     | <span class='unexecuted'>        return _checkpointsLookup(_totalSupplyCheckpoints, timepoint);</span>
 111 |     | <span class='neutral'>    }</span>
 112 |     | <span class='neutral'></span>
 113 |     | <span class='neutral'>    /**</span>
 114 |     | <span class='neutral'>     * @dev Lookup a value in a list of (sorted) checkpoints.</span>
 115 |     | <span class='neutral'>     */</span>
 116 |     | <span class='unexecuted'>    function _checkpointsLookup(Checkpoint[] storage ckpts, uint256 timepoint) private view returns (uint256) {</span>
 117 |     | <span class='neutral'>        // We run a binary search to look for the last (most recent) checkpoint taken before (or at) `timepoint`.</span>
 118 |     | <span class='neutral'>        //</span>
 119 |     | <span class='neutral'>        // Initially we check if the block is recent to narrow the search range.</span>
 120 |     | <span class='neutral'>        // During the loop, the index of the wanted checkpoint remains in the range [low-1, high).</span>
 121 |     | <span class='neutral'>        // With each iteration, either `low` or `high` is moved towards the middle of the range to maintain the invariant.</span>
 122 |     | <span class='neutral'>        // - If the middle checkpoint is after `timepoint`, we look in [low, mid)</span>
 123 |     | <span class='neutral'>        // - If the middle checkpoint is before or equal to `timepoint`, we look in [mid+1, high)</span>
 124 |     | <span class='neutral'>        // Once we reach a single value (when low == high), we&#39;ve found the right checkpoint at the index high-1, if not</span>
 125 |     | <span class='neutral'>        // out of bounds (in which case we&#39;re looking too far in the past and the result is 0).</span>
 126 |     | <span class='neutral'>        // Note that if the latest checkpoint available is exactly for `timepoint`, we end up with an index that is</span>
 127 |     | <span class='neutral'>        // past the end of the array, so we technically don&#39;t find a checkpoint after `timepoint`, but it works out</span>
 128 |     | <span class='neutral'>        // the same.</span>
 129 |     | <span class='unexecuted'>        uint256 length = ckpts.length;</span>
 130 |     | <span class='neutral'></span>
 131 |     | <span class='neutral'>        uint256 low = 0;</span>
 132 |     | <span class='neutral'>        uint256 high = length;</span>
 133 |     | <span class='neutral'></span>
 134 |     | <span class='unexecuted'>        if (length &gt; 5) {</span>
 135 |     | <span class='unexecuted'>            uint256 mid = length - Math.sqrt(length);</span>
 136 |     | <span class='unexecuted'>            if (_unsafeAccess(ckpts, mid).fromBlock &gt; timepoint) {</span>
 137 |     | <span class='unexecuted'>                high = mid;</span>
 138 |     | <span class='neutral'>            } else {</span>
 139 |     | <span class='unexecuted'>                low = mid + 1;</span>
 140 |     | <span class='neutral'>            }</span>
 141 |     | <span class='neutral'>        }</span>
 142 |     | <span class='neutral'></span>
 143 |     | <span class='unexecuted'>        while (low &lt; high) {</span>
 144 |     | <span class='unexecuted'>            uint256 mid = Math.average(low, high);</span>
 145 |     | <span class='unexecuted'>            if (_unsafeAccess(ckpts, mid).fromBlock &gt; timepoint) {</span>
 146 |     | <span class='unexecuted'>                high = mid;</span>
 147 |     | <span class='neutral'>            } else {</span>
 148 |     | <span class='unexecuted'>                low = mid + 1;</span>
 149 |     | <span class='neutral'>            }</span>
 150 |     | <span class='neutral'>        }</span>
 151 |     | <span class='neutral'></span>
 152 |     | <span class='neutral'>        unchecked {</span>
 153 |     | <span class='unexecuted'>            return high == 0 ? 0 : _unsafeAccess(ckpts, high - 1).votes;</span>
 154 |     | <span class='neutral'>        }</span>
 155 |     | <span class='neutral'>    }</span>
 156 |     | <span class='neutral'></span>
 157 |     | <span class='neutral'>    /**</span>
 158 |     | <span class='neutral'>     * @dev Delegate votes from the sender to `delegatee`.</span>
 159 |     | <span class='neutral'>     */</span>
 160 |     | <span class='unexecuted'>    function delegate(address delegatee) public virtual override {</span>
 161 |     | <span class='unexecuted'>        _delegate(_msgSender(), delegatee);</span>
 162 |     | <span class='neutral'>    }</span>
 163 |     | <span class='neutral'></span>
 164 |     | <span class='neutral'>    /**</span>
 165 |     | <span class='neutral'>     * @dev Delegates votes from signer to `delegatee`</span>
 166 |     | <span class='neutral'>     */</span>
 167 |     | <span class='unexecuted'>    function delegateBySig(</span>
 168 |     | <span class='neutral'>        address delegatee,</span>
 169 |     | <span class='neutral'>        uint256 nonce,</span>
 170 |     | <span class='neutral'>        uint256 expiry,</span>
 171 |     | <span class='neutral'>        uint8 v,</span>
 172 |     | <span class='neutral'>        bytes32 r,</span>
 173 |     | <span class='neutral'>        bytes32 s</span>
 174 |     | <span class='unexecuted'>    ) public virtual override {</span>
 175 |     | <span class='unexecuted'>        require(block.timestamp &lt;= expiry, &quot;ERC20Votes: signature expired&quot;);</span>
 176 |     | <span class='unexecuted'>        address signer = ECDSA.recover(</span>
 177 |     | <span class='unexecuted'>            _hashTypedDataV4(keccak256(abi.encode(_DELEGATION_TYPEHASH, delegatee, nonce, expiry))),</span>
 178 |     | <span class='unexecuted'>            v,</span>
 179 |     | <span class='unexecuted'>            r,</span>
 180 |     | <span class='unexecuted'>            s</span>
 181 |     | <span class='neutral'>        );</span>
 182 |     | <span class='unexecuted'>        require(nonce == _useNonce(signer), &quot;ERC20Votes: invalid nonce&quot;);</span>
 183 |     | <span class='unexecuted'>        _delegate(signer, delegatee);</span>
 184 |     | <span class='neutral'>    }</span>
 185 |     | <span class='neutral'></span>
 186 |     | <span class='neutral'>    /**</span>
 187 |     | <span class='neutral'>     * @dev Maximum token supply. Defaults to `type(uint224).max` (2^224^ - 1).</span>
 188 |     | <span class='neutral'>     */</span>
 189 |     | <span class='neutral'>    function _maxSupply() internal view virtual returns (uint224) {</span>
 190 |     | <span class='neutral'>        return type(uint224).max;</span>
 191 |     | <span class='neutral'>    }</span>
 192 |     | <span class='neutral'></span>
 193 |     | <span class='neutral'>    /**</span>
 194 |     | <span class='neutral'>     * @dev Snapshots the totalSupply after it has been increased.</span>
 195 |     | <span class='neutral'>     */</span>
 196 |     | <span class='unexecuted'>    function _mint(address account, uint256 amount) internal virtual override {</span>
 197 |     | <span class='unexecuted'>        super._mint(account, amount);</span>
 198 |     | <span class='unexecuted'>        require(totalSupply() &lt;= _maxSupply(), &quot;ERC20Votes: total supply risks overflowing votes&quot;);</span>
 199 |     | <span class='neutral'></span>
 200 |     | <span class='unexecuted'>        _writeCheckpoint(_totalSupplyCheckpoints, _add, amount);</span>
 201 |     | <span class='neutral'>    }</span>
 202 |     | <span class='neutral'></span>
 203 |     | <span class='neutral'>    /**</span>
 204 |     | <span class='neutral'>     * @dev Snapshots the totalSupply after it has been decreased.</span>
 205 |     | <span class='neutral'>     */</span>
 206 |     | <span class='neutral'>    function _burn(address account, uint256 amount) internal virtual override {</span>
 207 |     | <span class='neutral'>        super._burn(account, amount);</span>
 208 |     | <span class='neutral'></span>
 209 |     | <span class='neutral'>        _writeCheckpoint(_totalSupplyCheckpoints, _subtract, amount);</span>
 210 |     | <span class='neutral'>    }</span>
 211 |     | <span class='neutral'></span>
 212 |     | <span class='neutral'>    /**</span>
 213 |     | <span class='neutral'>     * @dev Move voting power when tokens are transferred.</span>
 214 |     | <span class='neutral'>     *</span>
 215 |     | <span class='neutral'>     * Emits a {IVotes-DelegateVotesChanged} event.</span>
 216 |     | <span class='neutral'>     */</span>
 217 |     | <span class='unexecuted'>    function _afterTokenTransfer(address from, address to, uint256 amount) internal virtual override {</span>
 218 |     | <span class='neutral'>        super._afterTokenTransfer(from, to, amount);</span>
 219 |     | <span class='neutral'></span>
 220 |     | <span class='unexecuted'>        _moveVotingPower(delegates(from), delegates(to), amount);</span>
 221 |     | <span class='neutral'>    }</span>
 222 |     | <span class='neutral'></span>
 223 |     | <span class='neutral'>    /**</span>
 224 |     | <span class='neutral'>     * @dev Change delegation for `delegator` to `delegatee`.</span>
 225 |     | <span class='neutral'>     *</span>
 226 |     | <span class='neutral'>     * Emits events {IVotes-DelegateChanged} and {IVotes-DelegateVotesChanged}.</span>
 227 |     | <span class='neutral'>     */</span>
 228 |     | <span class='unexecuted'>    function _delegate(address delegator, address delegatee) internal virtual {</span>
 229 |     | <span class='unexecuted'>        address currentDelegate = delegates(delegator);</span>
 230 |     | <span class='unexecuted'>        uint256 delegatorBalance = balanceOf(delegator);</span>
 231 |     | <span class='unexecuted'>        _delegates[delegator] = delegatee;</span>
 232 |     | <span class='neutral'></span>
 233 |     | <span class='unexecuted'>        emit DelegateChanged(delegator, currentDelegate, delegatee);</span>
 234 |     | <span class='neutral'></span>
 235 |     | <span class='unexecuted'>        _moveVotingPower(currentDelegate, delegatee, delegatorBalance);</span>
 236 |     | <span class='neutral'>    }</span>
 237 |     | <span class='neutral'></span>
 238 |     | <span class='unexecuted'>    function _moveVotingPower(address src, address dst, uint256 amount) private {</span>
 239 |     | <span class='unexecuted'>        if (src != dst &amp;&amp; amount &gt; 0) {</span>
 240 |     | <span class='unexecuted'>            if (src != address(0)) {</span>
 241 |     | <span class='unexecuted'>                (uint256 oldWeight, uint256 newWeight) = _writeCheckpoint(_checkpoints[src], _subtract, amount);</span>
 242 |     | <span class='unexecuted'>                emit DelegateVotesChanged(src, oldWeight, newWeight);</span>
 243 |     | <span class='neutral'>            }</span>
 244 |     | <span class='neutral'></span>
 245 |     | <span class='unexecuted'>            if (dst != address(0)) {</span>
 246 |     | <span class='unexecuted'>                (uint256 oldWeight, uint256 newWeight) = _writeCheckpoint(_checkpoints[dst], _add, amount);</span>
 247 |     | <span class='unexecuted'>                emit DelegateVotesChanged(dst, oldWeight, newWeight);</span>
 248 |     | <span class='neutral'>            }</span>
 249 |     | <span class='neutral'>        }</span>
 250 |     | <span class='neutral'>    }</span>
 251 |     | <span class='neutral'></span>
 252 |     | <span class='unexecuted'>    function _writeCheckpoint(</span>
 253 |     | <span class='neutral'>        Checkpoint[] storage ckpts,</span>
 254 |     | <span class='neutral'>        function(uint256, uint256) view returns (uint256) op,</span>
 255 |     | <span class='neutral'>        uint256 delta</span>
 256 |     | <span class='unexecuted'>    ) private returns (uint256 oldWeight, uint256 newWeight) {</span>
 257 |     | <span class='unexecuted'>        uint256 pos = ckpts.length;</span>
 258 |     | <span class='neutral'></span>
 259 |     | <span class='unexecuted'>        unchecked {</span>
 260 |     | <span class='unexecuted'>            Checkpoint memory oldCkpt = pos == 0 ? Checkpoint(0, 0) : _unsafeAccess(ckpts, pos - 1);</span>
 261 |     | <span class='neutral'></span>
 262 |     | <span class='unexecuted'>            oldWeight = oldCkpt.votes;</span>
 263 |     | <span class='unexecuted'>            newWeight = op(oldWeight, delta);</span>
 264 |     | <span class='neutral'></span>
 265 |     | <span class='unexecuted'>            if (pos &gt; 0 &amp;&amp; oldCkpt.fromBlock == clock()) {</span>
 266 |     | <span class='unexecuted'>                _unsafeAccess(ckpts, pos - 1).votes = SafeCast.toUint224(newWeight);</span>
 267 |     | <span class='neutral'>            } else {</span>
 268 |     | <span class='unexecuted'>                ckpts.push(Checkpoint({fromBlock: SafeCast.toUint32(clock()), votes: SafeCast.toUint224(newWeight)}));</span>
 269 |     | <span class='neutral'>            }</span>
 270 |     | <span class='neutral'>        }</span>
 271 |     | <span class='neutral'>    }</span>
 272 |     | <span class='neutral'></span>
 273 |     | <span class='unexecuted'>    function _add(uint256 a, uint256 b) private pure returns (uint256) {</span>
 274 |     | <span class='unexecuted'>        return a + b;</span>
 275 |     | <span class='neutral'>    }</span>
 276 |     | <span class='neutral'></span>
 277 |     | <span class='unexecuted'>    function _subtract(uint256 a, uint256 b) private pure returns (uint256) {</span>
 278 |     | <span class='unexecuted'>        return a - b;</span>
 279 |     | <span class='neutral'>    }</span>
 280 |     | <span class='neutral'></span>
 281 |     | <span class='neutral'>    /**</span>
 282 |     | <span class='neutral'>     * @dev Access an element of the array without performing bounds check. The position is assumed to be within bounds.</span>
 283 |     | <span class='neutral'>     */</span>
 284 |     | <span class='unexecuted'>    function _unsafeAccess(Checkpoint[] storage ckpts, uint256 pos) private pure returns (Checkpoint storage result) {</span>
 285 |     | <span class='neutral'>        assembly {</span>
 286 |     | <span class='unexecuted'>            mstore(0, ckpts.slot)</span>
 287 |     | <span class='unexecuted'>            result.slot := add(keccak256(0, 0x20), pos)</span>
 288 |     | <span class='neutral'>        }</span>
 289 |     | <span class='neutral'>    }</span>
 290 |     | <span class='neutral'>}</span>
 291 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/lib/openzeppelin-contracts/contracts/token/ERC20/extensions/IERC20Metadata.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts v4.4.1 (token/ERC20/extensions/IERC20Metadata.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>import &quot;../IERC20.sol&quot;;</span>
  7 |     | <span class='neutral'></span>
  8 |     | <span class='neutral'>/**</span>
  9 |     | <span class='neutral'> * @dev Interface for the optional metadata functions from the ERC20 standard.</span>
 10 |     | <span class='neutral'> *</span>
 11 |     | <span class='neutral'> * _Available since v4.1._</span>
 12 |     | <span class='neutral'> */</span>
 13 |     | <span class='neutral'>interface IERC20Metadata is IERC20 {</span>
 14 |     | <span class='neutral'>    /**</span>
 15 |     | <span class='neutral'>     * @dev Returns the name of the token.</span>
 16 |     | <span class='neutral'>     */</span>
 17 |     | <span class='neutral'>    function name() external view returns (string memory);</span>
 18 |     | <span class='neutral'></span>
 19 |     | <span class='neutral'>    /**</span>
 20 |     | <span class='neutral'>     * @dev Returns the symbol of the token.</span>
 21 |     | <span class='neutral'>     */</span>
 22 |     | <span class='neutral'>    function symbol() external view returns (string memory);</span>
 23 |     | <span class='neutral'></span>
 24 |     | <span class='neutral'>    /**</span>
 25 |     | <span class='neutral'>     * @dev Returns the decimals places of the token.</span>
 26 |     | <span class='neutral'>     */</span>
 27 |     | <span class='neutral'>    function decimals() external view returns (uint8);</span>
 28 |     | <span class='neutral'>}</span>
 29 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/lib/openzeppelin-contracts/contracts/token/ERC20/extensions/IERC20Permit.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (token/ERC20/extensions/IERC20Permit.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>/**</span>
  7 |     | <span class='neutral'> * @dev Interface of the ERC20 Permit extension allowing approvals to be made via signatures, as defined in</span>
  8 |     | <span class='neutral'> * https://eips.ethereum.org/EIPS/eip-2612[EIP-2612].</span>
  9 |     | <span class='neutral'> *</span>
 10 |     | <span class='neutral'> * Adds the {permit} method, which can be used to change an account&#39;s ERC20 allowance (see {IERC20-allowance}) by</span>
 11 |     | <span class='neutral'> * presenting a message signed by the account. By not relying on {IERC20-approve}, the token holder account doesn&#39;t</span>
 12 |     | <span class='neutral'> * need to send a transaction, and thus is not required to hold Ether at all.</span>
 13 |     | <span class='neutral'> */</span>
 14 |     | <span class='neutral'>interface IERC20Permit {</span>
 15 |     | <span class='neutral'>    /**</span>
 16 |     | <span class='neutral'>     * @dev Sets `value` as the allowance of `spender` over ``owner``&#39;s tokens,</span>
 17 |     | <span class='neutral'>     * given ``owner``&#39;s signed approval.</span>
 18 |     | <span class='neutral'>     *</span>
 19 |     | <span class='neutral'>     * IMPORTANT: The same issues {IERC20-approve} has related to transaction</span>
 20 |     | <span class='neutral'>     * ordering also apply here.</span>
 21 |     | <span class='neutral'>     *</span>
 22 |     | <span class='neutral'>     * Emits an {Approval} event.</span>
 23 |     | <span class='neutral'>     *</span>
 24 |     | <span class='neutral'>     * Requirements:</span>
 25 |     | <span class='neutral'>     *</span>
 26 |     | <span class='neutral'>     * - `spender` cannot be the zero address.</span>
 27 |     | <span class='neutral'>     * - `deadline` must be a timestamp in the future.</span>
 28 |     | <span class='neutral'>     * - `v`, `r` and `s` must be a valid `secp256k1` signature from `owner`</span>
 29 |     | <span class='neutral'>     * over the EIP712-formatted function arguments.</span>
 30 |     | <span class='neutral'>     * - the signature must use ``owner``&#39;s current nonce (see {nonces}).</span>
 31 |     | <span class='neutral'>     *</span>
 32 |     | <span class='neutral'>     * For more information on the signature format, see the</span>
 33 |     | <span class='neutral'>     * https://eips.ethereum.org/EIPS/eip-2612#specification[relevant EIP</span>
 34 |     | <span class='neutral'>     * section].</span>
 35 |     | <span class='neutral'>     */</span>
 36 |     | <span class='neutral'>    function permit(</span>
 37 |     | <span class='neutral'>        address owner,</span>
 38 |     | <span class='neutral'>        address spender,</span>
 39 |     | <span class='neutral'>        uint256 value,</span>
 40 |     | <span class='neutral'>        uint256 deadline,</span>
 41 |     | <span class='neutral'>        uint8 v,</span>
 42 |     | <span class='neutral'>        bytes32 r,</span>
 43 |     | <span class='neutral'>        bytes32 s</span>
 44 |     | <span class='neutral'>    ) external;</span>
 45 |     | <span class='neutral'></span>
 46 |     | <span class='neutral'>    /**</span>
 47 |     | <span class='neutral'>     * @dev Returns the current nonce for `owner`. This value must be</span>
 48 |     | <span class='neutral'>     * included whenever a signature is generated for {permit}.</span>
 49 |     | <span class='neutral'>     *</span>
 50 |     | <span class='neutral'>     * Every successful call to {permit} increases ``owner``&#39;s nonce by one. This</span>
 51 |     | <span class='neutral'>     * prevents a signature from being used multiple times.</span>
 52 |     | <span class='neutral'>     */</span>
 53 |     | <span class='neutral'>    function nonces(address owner) external view returns (uint256);</span>
 54 |     | <span class='neutral'></span>
 55 |     | <span class='neutral'>    /**</span>
 56 |     | <span class='neutral'>     * @dev Returns the domain separator used in the encoding of the signature for {permit}, as defined by {EIP712}.</span>
 57 |     | <span class='neutral'>     */</span>
 58 |     | <span class='neutral'>    // solhint-disable-next-line func-name-mixedcase</span>
 59 |     | <span class='neutral'>    function DOMAIN_SEPARATOR() external view returns (bytes32);</span>
 60 |     | <span class='neutral'>}</span>
 61 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/lib/openzeppelin-contracts/contracts/token/ERC20/utils/SafeERC20.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.3) (token/ERC20/utils/SafeERC20.sol)</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
   5 |     | <span class='neutral'></span>
   6 |     | <span class='neutral'>import &quot;../IERC20.sol&quot;;</span>
   7 |     | <span class='neutral'>import &quot;../extensions/IERC20Permit.sol&quot;;</span>
   8 |     | <span class='neutral'>import &quot;../../../utils/Address.sol&quot;;</span>
   9 |     | <span class='neutral'></span>
  10 |     | <span class='neutral'>/**</span>
  11 |     | <span class='neutral'> * @title SafeERC20</span>
  12 |     | <span class='neutral'> * @dev Wrappers around ERC20 operations that throw on failure (when the token</span>
  13 |     | <span class='neutral'> * contract returns false). Tokens that return no value (and instead revert or</span>
  14 |     | <span class='neutral'> * throw on failure) are also supported, non-reverting calls are assumed to be</span>
  15 |     | <span class='neutral'> * successful.</span>
  16 |     | <span class='neutral'> * To use this library you can add a `using SafeERC20 for IERC20;` statement to your contract,</span>
  17 |     | <span class='neutral'> * which allows you to call the safe operations as `token.safeTransfer(...)`, etc.</span>
  18 |     | <span class='neutral'> */</span>
  19 |     | <span class='unexecuted'>library SafeERC20 {</span>
  20 |     | <span class='neutral'>    using Address for address;</span>
  21 |     | <span class='neutral'></span>
  22 |     | <span class='neutral'>    /**</span>
  23 |     | <span class='neutral'>     * @dev Transfer `value` amount of `token` from the calling contract to `to`. If `token` returns no value,</span>
  24 |     | <span class='neutral'>     * non-reverting calls are assumed to be successful.</span>
  25 |     | <span class='neutral'>     */</span>
  26 | *   | <span class='executed'>    function safeTransfer(IERC20 token, address to, uint256 value) internal {</span>
  27 | *   | <span class='executed'>        _callOptionalReturn(token, abi.encodeWithSelector(token.transfer.selector, to, value));</span>
  28 |     | <span class='neutral'>    }</span>
  29 |     | <span class='neutral'></span>
  30 |     | <span class='neutral'>    /**</span>
  31 |     | <span class='neutral'>     * @dev Transfer `value` amount of `token` from `from` to `to`, spending the approval given by `from` to the</span>
  32 |     | <span class='neutral'>     * calling contract. If `token` returns no value, non-reverting calls are assumed to be successful.</span>
  33 |     | <span class='neutral'>     */</span>
  34 |     | <span class='unexecuted'>    function safeTransferFrom(IERC20 token, address from, address to, uint256 value) internal {</span>
  35 |     | <span class='unexecuted'>        _callOptionalReturn(token, abi.encodeWithSelector(token.transferFrom.selector, from, to, value));</span>
  36 |     | <span class='neutral'>    }</span>
  37 |     | <span class='neutral'></span>
  38 |     | <span class='neutral'>    /**</span>
  39 |     | <span class='neutral'>     * @dev Deprecated. This function has issues similar to the ones found in</span>
  40 |     | <span class='neutral'>     * {IERC20-approve}, and its usage is discouraged.</span>
  41 |     | <span class='neutral'>     *</span>
  42 |     | <span class='neutral'>     * Whenever possible, use {safeIncreaseAllowance} and</span>
  43 |     | <span class='neutral'>     * {safeDecreaseAllowance} instead.</span>
  44 |     | <span class='neutral'>     */</span>
  45 |     | <span class='neutral'>    function safeApprove(IERC20 token, address spender, uint256 value) internal {</span>
  46 |     | <span class='neutral'>        // safeApprove should only be called when setting an initial allowance,</span>
  47 |     | <span class='neutral'>        // or when resetting it to zero. To increase and decrease it, use</span>
  48 |     | <span class='neutral'>        // &#39;safeIncreaseAllowance&#39; and &#39;safeDecreaseAllowance&#39;</span>
  49 |     | <span class='neutral'>        require(</span>
  50 |     | <span class='neutral'>            (value == 0) || (token.allowance(address(this), spender) == 0),</span>
  51 |     | <span class='neutral'>            &quot;SafeERC20: approve from non-zero to non-zero allowance&quot;</span>
  52 |     | <span class='neutral'>        );</span>
  53 |     | <span class='neutral'>        _callOptionalReturn(token, abi.encodeWithSelector(token.approve.selector, spender, value));</span>
  54 |     | <span class='neutral'>    }</span>
  55 |     | <span class='neutral'></span>
  56 |     | <span class='neutral'>    /**</span>
  57 |     | <span class='neutral'>     * @dev Increase the calling contract&#39;s allowance toward `spender` by `value`. If `token` returns no value,</span>
  58 |     | <span class='neutral'>     * non-reverting calls are assumed to be successful.</span>
  59 |     | <span class='neutral'>     */</span>
  60 |     | <span class='neutral'>    function safeIncreaseAllowance(IERC20 token, address spender, uint256 value) internal {</span>
  61 |     | <span class='neutral'>        uint256 oldAllowance = token.allowance(address(this), spender);</span>
  62 |     | <span class='neutral'>        _callOptionalReturn(token, abi.encodeWithSelector(token.approve.selector, spender, oldAllowance + value));</span>
  63 |     | <span class='neutral'>    }</span>
  64 |     | <span class='neutral'></span>
  65 |     | <span class='neutral'>    /**</span>
  66 |     | <span class='neutral'>     * @dev Decrease the calling contract&#39;s allowance toward `spender` by `value`. If `token` returns no value,</span>
  67 |     | <span class='neutral'>     * non-reverting calls are assumed to be successful.</span>
  68 |     | <span class='neutral'>     */</span>
  69 |     | <span class='neutral'>    function safeDecreaseAllowance(IERC20 token, address spender, uint256 value) internal {</span>
  70 |     | <span class='neutral'>        unchecked {</span>
  71 |     | <span class='neutral'>            uint256 oldAllowance = token.allowance(address(this), spender);</span>
  72 |     | <span class='neutral'>            require(oldAllowance &gt;= value, &quot;SafeERC20: decreased allowance below zero&quot;);</span>
  73 |     | <span class='neutral'>            _callOptionalReturn(token, abi.encodeWithSelector(token.approve.selector, spender, oldAllowance - value));</span>
  74 |     | <span class='neutral'>        }</span>
  75 |     | <span class='neutral'>    }</span>
  76 |     | <span class='neutral'></span>
  77 |     | <span class='neutral'>    /**</span>
  78 |     | <span class='neutral'>     * @dev Set the calling contract&#39;s allowance toward `spender` to `value`. If `token` returns no value,</span>
  79 |     | <span class='neutral'>     * non-reverting calls are assumed to be successful. Meant to be used with tokens that require the approval</span>
  80 |     | <span class='neutral'>     * to be set to zero before setting it to a non-zero value, such as USDT.</span>
  81 |     | <span class='neutral'>     */</span>
  82 |     | <span class='neutral'>    function forceApprove(IERC20 token, address spender, uint256 value) internal {</span>
  83 |     | <span class='neutral'>        bytes memory approvalCall = abi.encodeWithSelector(token.approve.selector, spender, value);</span>
  84 |     | <span class='neutral'></span>
  85 |     | <span class='neutral'>        if (!_callOptionalReturnBool(token, approvalCall)) {</span>
  86 |     | <span class='neutral'>            _callOptionalReturn(token, abi.encodeWithSelector(token.approve.selector, spender, 0));</span>
  87 |     | <span class='neutral'>            _callOptionalReturn(token, approvalCall);</span>
  88 |     | <span class='neutral'>        }</span>
  89 |     | <span class='neutral'>    }</span>
  90 |     | <span class='neutral'></span>
  91 |     | <span class='neutral'>    /**</span>
  92 |     | <span class='neutral'>     * @dev Use a ERC-2612 signature to set the `owner` approval toward `spender` on `token`.</span>
  93 |     | <span class='neutral'>     * Revert on invalid signature.</span>
  94 |     | <span class='neutral'>     */</span>
  95 |     | <span class='neutral'>    function safePermit(</span>
  96 |     | <span class='neutral'>        IERC20Permit token,</span>
  97 |     | <span class='neutral'>        address owner,</span>
  98 |     | <span class='neutral'>        address spender,</span>
  99 |     | <span class='neutral'>        uint256 value,</span>
 100 |     | <span class='neutral'>        uint256 deadline,</span>
 101 |     | <span class='neutral'>        uint8 v,</span>
 102 |     | <span class='neutral'>        bytes32 r,</span>
 103 |     | <span class='neutral'>        bytes32 s</span>
 104 |     | <span class='neutral'>    ) internal {</span>
 105 |     | <span class='neutral'>        uint256 nonceBefore = token.nonces(owner);</span>
 106 |     | <span class='neutral'>        token.permit(owner, spender, value, deadline, v, r, s);</span>
 107 |     | <span class='neutral'>        uint256 nonceAfter = token.nonces(owner);</span>
 108 |     | <span class='neutral'>        require(nonceAfter == nonceBefore + 1, &quot;SafeERC20: permit did not succeed&quot;);</span>
 109 |     | <span class='neutral'>    }</span>
 110 |     | <span class='neutral'></span>
 111 |     | <span class='neutral'>    /**</span>
 112 |     | <span class='neutral'>     * @dev Imitates a Solidity high-level call (i.e. a regular function call to a contract), relaxing the requirement</span>
 113 |     | <span class='neutral'>     * on the return value: the return value is optional (but if data is returned, it must not be false).</span>
 114 |     | <span class='neutral'>     * @param token The token targeted by the call.</span>
 115 |     | <span class='neutral'>     * @param data The call data (encoded using abi.encode or one of its variants).</span>
 116 |     | <span class='neutral'>     */</span>
 117 | *   | <span class='executed'>    function _callOptionalReturn(IERC20 token, bytes memory data) private {</span>
 118 |     | <span class='neutral'>        // We need to perform a low level call here, to bypass Solidity&#39;s return data size checking mechanism, since</span>
 119 |     | <span class='neutral'>        // we&#39;re implementing it ourselves. We use {Address-functionCall} to perform this call, which verifies that</span>
 120 |     | <span class='neutral'>        // the target address contains contract code and also asserts for success in the low-level call.</span>
 121 |     | <span class='neutral'></span>
 122 | *   | <span class='executed'>        bytes memory returndata = address(token).functionCall(data, &quot;SafeERC20: low-level call failed&quot;);</span>
 123 | *   | <span class='executed'>        require(returndata.length == 0 || abi.decode(returndata, (bool)), &quot;SafeERC20: ERC20 operation did not succeed&quot;);</span>
 124 |     | <span class='neutral'>    }</span>
 125 |     | <span class='neutral'></span>
 126 |     | <span class='neutral'>    /**</span>
 127 |     | <span class='neutral'>     * @dev Imitates a Solidity high-level call (i.e. a regular function call to a contract), relaxing the requirement</span>
 128 |     | <span class='neutral'>     * on the return value: the return value is optional (but if data is returned, it must not be false).</span>
 129 |     | <span class='neutral'>     * @param token The token targeted by the call.</span>
 130 |     | <span class='neutral'>     * @param data The call data (encoded using abi.encode or one of its variants).</span>
 131 |     | <span class='neutral'>     *</span>
 132 |     | <span class='neutral'>     * This is a variant of {_callOptionalReturn} that silents catches all reverts and returns a bool instead.</span>
 133 |     | <span class='neutral'>     */</span>
 134 |     | <span class='neutral'>    function _callOptionalReturnBool(IERC20 token, bytes memory data) private returns (bool) {</span>
 135 |     | <span class='neutral'>        // We need to perform a low level call here, to bypass Solidity&#39;s return data size checking mechanism, since</span>
 136 |     | <span class='neutral'>        // we&#39;re implementing it ourselves. We cannot use {Address-functionCall} here since this should return false</span>
 137 |     | <span class='neutral'>        // and not revert is the subcall reverts.</span>
 138 |     | <span class='neutral'></span>
 139 |     | <span class='neutral'>        (bool success, bytes memory returndata) = address(token).call(data);</span>
 140 |     | <span class='neutral'>        return</span>
 141 |     | <span class='neutral'>            success &amp;&amp; (returndata.length == 0 || abi.decode(returndata, (bool))) &amp;&amp; Address.isContract(address(token));</span>
 142 |     | <span class='neutral'>    }</span>
 143 |     | <span class='neutral'>}</span>
 144 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/lib/openzeppelin-contracts/contracts/token/ERC721/IERC721Receiver.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.6.0) (token/ERC721/IERC721Receiver.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>/**</span>
  7 |     | <span class='neutral'> * @title ERC721 token receiver interface</span>
  8 |     | <span class='neutral'> * @dev Interface for any contract that wants to support safeTransfers</span>
  9 |     | <span class='neutral'> * from ERC721 asset contracts.</span>
 10 |     | <span class='neutral'> */</span>
 11 |     | <span class='neutral'>interface IERC721Receiver {</span>
 12 |     | <span class='neutral'>    /**</span>
 13 |     | <span class='neutral'>     * @dev Whenever an {IERC721} `tokenId` token is transferred to this contract via {IERC721-safeTransferFrom}</span>
 14 |     | <span class='neutral'>     * by `operator` from `from`, this function is called.</span>
 15 |     | <span class='neutral'>     *</span>
 16 |     | <span class='neutral'>     * It must return its Solidity selector to confirm the token transfer.</span>
 17 |     | <span class='neutral'>     * If any other value is returned or the interface is not implemented by the recipient, the transfer will be reverted.</span>
 18 |     | <span class='neutral'>     *</span>
 19 |     | <span class='neutral'>     * The selector can be obtained in Solidity with `IERC721Receiver.onERC721Received.selector`.</span>
 20 |     | <span class='neutral'>     */</span>
 21 |     | <span class='neutral'>    function onERC721Received(</span>
 22 |     | <span class='neutral'>        address operator,</span>
 23 |     | <span class='neutral'>        address from,</span>
 24 |     | <span class='neutral'>        uint256 tokenId,</span>
 25 |     | <span class='neutral'>        bytes calldata data</span>
 26 |     | <span class='neutral'>    ) external returns (bytes4);</span>
 27 |     | <span class='neutral'>}</span>
 28 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/lib/openzeppelin-contracts/contracts/utils/Address.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (utils/Address.sol)</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>pragma solidity ^0.8.1;</span>
   5 |     | <span class='neutral'></span>
   6 |     | <span class='neutral'>/**</span>
   7 |     | <span class='neutral'> * @dev Collection of functions related to the address type</span>
   8 |     | <span class='neutral'> */</span>
   9 |     | <span class='unexecuted'>library Address {</span>
  10 |     | <span class='neutral'>    /**</span>
  11 |     | <span class='neutral'>     * @dev Returns true if `account` is a contract.</span>
  12 |     | <span class='neutral'>     *</span>
  13 |     | <span class='neutral'>     * [IMPORTANT]</span>
  14 |     | <span class='neutral'>     * ====</span>
  15 |     | <span class='neutral'>     * It is unsafe to assume that an address for which this function returns</span>
  16 |     | <span class='neutral'>     * false is an externally-owned account (EOA) and not a contract.</span>
  17 |     | <span class='neutral'>     *</span>
  18 |     | <span class='neutral'>     * Among others, `isContract` will return false for the following</span>
  19 |     | <span class='neutral'>     * types of addresses:</span>
  20 |     | <span class='neutral'>     *</span>
  21 |     | <span class='neutral'>     *  - an externally-owned account</span>
  22 |     | <span class='neutral'>     *  - a contract in construction</span>
  23 |     | <span class='neutral'>     *  - an address where a contract will be created</span>
  24 |     | <span class='neutral'>     *  - an address where a contract lived, but was destroyed</span>
  25 |     | <span class='neutral'>     *</span>
  26 |     | <span class='neutral'>     * Furthermore, `isContract` will also return true if the target contract within</span>
  27 |     | <span class='neutral'>     * the same transaction is already scheduled for destruction by `SELFDESTRUCT`,</span>
  28 |     | <span class='neutral'>     * which only has an effect at the end of a transaction.</span>
  29 |     | <span class='neutral'>     * ====</span>
  30 |     | <span class='neutral'>     *</span>
  31 |     | <span class='neutral'>     * [IMPORTANT]</span>
  32 |     | <span class='neutral'>     * ====</span>
  33 |     | <span class='neutral'>     * You shouldn&#39;t rely on `isContract` to protect against flash loan attacks!</span>
  34 |     | <span class='neutral'>     *</span>
  35 |     | <span class='neutral'>     * Preventing calls from contracts is highly discouraged. It breaks composability, breaks support for smart wallets</span>
  36 |     | <span class='neutral'>     * like Gnosis Safe, and does not provide security since it can be circumvented by calling from a contract</span>
  37 |     | <span class='neutral'>     * constructor.</span>
  38 |     | <span class='neutral'>     * ====</span>
  39 |     | <span class='neutral'>     */</span>
  40 |     | <span class='neutral'>    function isContract(address account) internal view returns (bool) {</span>
  41 |     | <span class='neutral'>        // This method relies on extcodesize/address.code.length, which returns 0</span>
  42 |     | <span class='neutral'>        // for contracts in construction, since the code is only stored at the end</span>
  43 |     | <span class='neutral'>        // of the constructor execution.</span>
  44 |     | <span class='neutral'></span>
  45 | *   | <span class='executed'>        return account.code.length &gt; 0;</span>
  46 |     | <span class='neutral'>    }</span>
  47 |     | <span class='neutral'></span>
  48 |     | <span class='neutral'>    /**</span>
  49 |     | <span class='neutral'>     * @dev Replacement for Solidity&#39;s `transfer`: sends `amount` wei to</span>
  50 |     | <span class='neutral'>     * `recipient`, forwarding all available gas and reverting on errors.</span>
  51 |     | <span class='neutral'>     *</span>
  52 |     | <span class='neutral'>     * https://eips.ethereum.org/EIPS/eip-1884[EIP1884] increases the gas cost</span>
  53 |     | <span class='neutral'>     * of certain opcodes, possibly making contracts go over the 2300 gas limit</span>
  54 |     | <span class='neutral'>     * imposed by `transfer`, making them unable to receive funds via</span>
  55 |     | <span class='neutral'>     * `transfer`. {sendValue} removes this limitation.</span>
  56 |     | <span class='neutral'>     *</span>
  57 |     | <span class='neutral'>     * https://consensys.net/diligence/blog/2019/09/stop-using-soliditys-transfer-now/[Learn more].</span>
  58 |     | <span class='neutral'>     *</span>
  59 |     | <span class='neutral'>     * IMPORTANT: because control is transferred to `recipient`, care must be</span>
  60 |     | <span class='neutral'>     * taken to not create reentrancy vulnerabilities. Consider using</span>
  61 |     | <span class='neutral'>     * {ReentrancyGuard} or the</span>
  62 |     | <span class='neutral'>     * https://solidity.readthedocs.io/en/v0.8.0/security-considerations.html#use-the-checks-effects-interactions-pattern[checks-effects-interactions pattern].</span>
  63 |     | <span class='neutral'>     */</span>
  64 |     | <span class='unexecuted'>    function sendValue(address payable recipient, uint256 amount) internal {</span>
  65 |     | <span class='unexecuted'>        require(address(this).balance &gt;= amount, &quot;Address: insufficient balance&quot;);</span>
  66 |     | <span class='neutral'></span>
  67 |     | <span class='unexecuted'>        (bool success, ) = recipient.call{value: amount}(&quot;&quot;);</span>
  68 |     | <span class='unexecuted'>        require(success, &quot;Address: unable to send value, recipient may have reverted&quot;);</span>
  69 |     | <span class='neutral'>    }</span>
  70 |     | <span class='neutral'></span>
  71 |     | <span class='neutral'>    /**</span>
  72 |     | <span class='neutral'>     * @dev Performs a Solidity function call using a low level `call`. A</span>
  73 |     | <span class='neutral'>     * plain `call` is an unsafe replacement for a function call: use this</span>
  74 |     | <span class='neutral'>     * function instead.</span>
  75 |     | <span class='neutral'>     *</span>
  76 |     | <span class='neutral'>     * If `target` reverts with a revert reason, it is bubbled up by this</span>
  77 |     | <span class='neutral'>     * function (like regular Solidity function calls).</span>
  78 |     | <span class='neutral'>     *</span>
  79 |     | <span class='neutral'>     * Returns the raw returned data. To convert to the expected return value,</span>
  80 |     | <span class='neutral'>     * use https://solidity.readthedocs.io/en/latest/units-and-global-variables.html?highlight=abi.decode#abi-encoding-and-decoding-functions[`abi.decode`].</span>
  81 |     | <span class='neutral'>     *</span>
  82 |     | <span class='neutral'>     * Requirements:</span>
  83 |     | <span class='neutral'>     *</span>
  84 |     | <span class='neutral'>     * - `target` must be a contract.</span>
  85 |     | <span class='neutral'>     * - calling `target` with `data` must not revert.</span>
  86 |     | <span class='neutral'>     *</span>
  87 |     | <span class='neutral'>     * _Available since v3.1._</span>
  88 |     | <span class='neutral'>     */</span>
  89 |     | <span class='neutral'>    function functionCall(address target, bytes memory data) internal returns (bytes memory) {</span>
  90 |     | <span class='neutral'>        return functionCallWithValue(target, data, 0, &quot;Address: low-level call failed&quot;);</span>
  91 |     | <span class='neutral'>    }</span>
  92 |     | <span class='neutral'></span>
  93 |     | <span class='neutral'>    /**</span>
  94 |     | <span class='neutral'>     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`], but with</span>
  95 |     | <span class='neutral'>     * `errorMessage` as a fallback revert reason when `target` reverts.</span>
  96 |     | <span class='neutral'>     *</span>
  97 |     | <span class='neutral'>     * _Available since v3.1._</span>
  98 |     | <span class='neutral'>     */</span>
  99 | *   | <span class='executed'>    function functionCall(</span>
 100 |     | <span class='neutral'>        address target,</span>
 101 |     | <span class='neutral'>        bytes memory data,</span>
 102 |     | <span class='neutral'>        string memory errorMessage</span>
 103 | *   | <span class='executed'>    ) internal returns (bytes memory) {</span>
 104 | *   | <span class='executed'>        return functionCallWithValue(target, data, 0, errorMessage);</span>
 105 |     | <span class='neutral'>    }</span>
 106 |     | <span class='neutral'></span>
 107 |     | <span class='neutral'>    /**</span>
 108 |     | <span class='neutral'>     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],</span>
 109 |     | <span class='neutral'>     * but also transferring `value` wei to `target`.</span>
 110 |     | <span class='neutral'>     *</span>
 111 |     | <span class='neutral'>     * Requirements:</span>
 112 |     | <span class='neutral'>     *</span>
 113 |     | <span class='neutral'>     * - the calling contract must have an ETH balance of at least `value`.</span>
 114 |     | <span class='neutral'>     * - the called Solidity function must be `payable`.</span>
 115 |     | <span class='neutral'>     *</span>
 116 |     | <span class='neutral'>     * _Available since v3.1._</span>
 117 |     | <span class='neutral'>     */</span>
 118 |     | <span class='neutral'>    function functionCallWithValue(address target, bytes memory data, uint256 value) internal returns (bytes memory) {</span>
 119 |     | <span class='neutral'>        return functionCallWithValue(target, data, value, &quot;Address: low-level call with value failed&quot;);</span>
 120 |     | <span class='neutral'>    }</span>
 121 |     | <span class='neutral'></span>
 122 |     | <span class='neutral'>    /**</span>
 123 |     | <span class='neutral'>     * @dev Same as {xref-Address-functionCallWithValue-address-bytes-uint256-}[`functionCallWithValue`], but</span>
 124 |     | <span class='neutral'>     * with `errorMessage` as a fallback revert reason when `target` reverts.</span>
 125 |     | <span class='neutral'>     *</span>
 126 |     | <span class='neutral'>     * _Available since v3.1._</span>
 127 |     | <span class='neutral'>     */</span>
 128 | *   | <span class='executed'>    function functionCallWithValue(</span>
 129 |     | <span class='neutral'>        address target,</span>
 130 |     | <span class='neutral'>        bytes memory data,</span>
 131 |     | <span class='neutral'>        uint256 value,</span>
 132 |     | <span class='neutral'>        string memory errorMessage</span>
 133 | *   | <span class='executed'>    ) internal returns (bytes memory) {</span>
 134 | *   | <span class='executed'>        require(address(this).balance &gt;= value, &quot;Address: insufficient balance for call&quot;);</span>
 135 | *   | <span class='executed'>        (bool success, bytes memory returndata) = target.call{value: value}(data);</span>
 136 | *   | <span class='executed'>        return verifyCallResultFromTarget(target, success, returndata, errorMessage);</span>
 137 |     | <span class='neutral'>    }</span>
 138 |     | <span class='neutral'></span>
 139 |     | <span class='neutral'>    /**</span>
 140 |     | <span class='neutral'>     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],</span>
 141 |     | <span class='neutral'>     * but performing a static call.</span>
 142 |     | <span class='neutral'>     *</span>
 143 |     | <span class='neutral'>     * _Available since v3.3._</span>
 144 |     | <span class='neutral'>     */</span>
 145 |     | <span class='neutral'>    function functionStaticCall(address target, bytes memory data) internal view returns (bytes memory) {</span>
 146 |     | <span class='neutral'>        return functionStaticCall(target, data, &quot;Address: low-level static call failed&quot;);</span>
 147 |     | <span class='neutral'>    }</span>
 148 |     | <span class='neutral'></span>
 149 |     | <span class='neutral'>    /**</span>
 150 |     | <span class='neutral'>     * @dev Same as {xref-Address-functionCall-address-bytes-string-}[`functionCall`],</span>
 151 |     | <span class='neutral'>     * but performing a static call.</span>
 152 |     | <span class='neutral'>     *</span>
 153 |     | <span class='neutral'>     * _Available since v3.3._</span>
 154 |     | <span class='neutral'>     */</span>
 155 |     | <span class='neutral'>    function functionStaticCall(</span>
 156 |     | <span class='neutral'>        address target,</span>
 157 |     | <span class='neutral'>        bytes memory data,</span>
 158 |     | <span class='neutral'>        string memory errorMessage</span>
 159 |     | <span class='neutral'>    ) internal view returns (bytes memory) {</span>
 160 |     | <span class='neutral'>        (bool success, bytes memory returndata) = target.staticcall(data);</span>
 161 |     | <span class='neutral'>        return verifyCallResultFromTarget(target, success, returndata, errorMessage);</span>
 162 |     | <span class='neutral'>    }</span>
 163 |     | <span class='neutral'></span>
 164 |     | <span class='neutral'>    /**</span>
 165 |     | <span class='neutral'>     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],</span>
 166 |     | <span class='neutral'>     * but performing a delegate call.</span>
 167 |     | <span class='neutral'>     *</span>
 168 |     | <span class='neutral'>     * _Available since v3.4._</span>
 169 |     | <span class='neutral'>     */</span>
 170 |     | <span class='unexecuted'>    function functionDelegateCall(address target, bytes memory data) internal returns (bytes memory) {</span>
 171 |     | <span class='unexecuted'>        return functionDelegateCall(target, data, &quot;Address: low-level delegate call failed&quot;);</span>
 172 |     | <span class='neutral'>    }</span>
 173 |     | <span class='neutral'></span>
 174 |     | <span class='neutral'>    /**</span>
 175 |     | <span class='neutral'>     * @dev Same as {xref-Address-functionCall-address-bytes-string-}[`functionCall`],</span>
 176 |     | <span class='neutral'>     * but performing a delegate call.</span>
 177 |     | <span class='neutral'>     *</span>
 178 |     | <span class='neutral'>     * _Available since v3.4._</span>
 179 |     | <span class='neutral'>     */</span>
 180 |     | <span class='unexecuted'>    function functionDelegateCall(</span>
 181 |     | <span class='neutral'>        address target,</span>
 182 |     | <span class='neutral'>        bytes memory data,</span>
 183 |     | <span class='neutral'>        string memory errorMessage</span>
 184 |     | <span class='unexecuted'>    ) internal returns (bytes memory) {</span>
 185 |     | <span class='unexecuted'>        (bool success, bytes memory returndata) = target.delegatecall(data);</span>
 186 |     | <span class='unexecuted'>        return verifyCallResultFromTarget(target, success, returndata, errorMessage);</span>
 187 |     | <span class='neutral'>    }</span>
 188 |     | <span class='neutral'></span>
 189 |     | <span class='neutral'>    /**</span>
 190 |     | <span class='neutral'>     * @dev Tool to verify that a low level call to smart-contract was successful, and revert (either by bubbling</span>
 191 |     | <span class='neutral'>     * the revert reason or using the provided one) in case of unsuccessful call or if target was not a contract.</span>
 192 |     | <span class='neutral'>     *</span>
 193 |     | <span class='neutral'>     * _Available since v4.8._</span>
 194 |     | <span class='neutral'>     */</span>
 195 | *   | <span class='executed'>    function verifyCallResultFromTarget(</span>
 196 |     | <span class='neutral'>        address target,</span>
 197 |     | <span class='neutral'>        bool success,</span>
 198 |     | <span class='neutral'>        bytes memory returndata,</span>
 199 |     | <span class='neutral'>        string memory errorMessage</span>
 200 | *   | <span class='executed'>    ) internal view returns (bytes memory) {</span>
 201 | *   | <span class='executed'>        if (success) {</span>
 202 | *   | <span class='executed'>            if (returndata.length == 0) {</span>
 203 |     | <span class='neutral'>                // only check isContract if the call was successful and the return data is empty</span>
 204 |     | <span class='neutral'>                // otherwise we already know that it was a contract</span>
 205 | *   | <span class='executed'>                require(isContract(target), &quot;Address: call to non-contract&quot;);</span>
 206 |     | <span class='neutral'>            }</span>
 207 | *   | <span class='executed'>            return returndata;</span>
 208 |     | <span class='neutral'>        } else {</span>
 209 | *   | <span class='executed'>            _revert(returndata, errorMessage);</span>
 210 |     | <span class='neutral'>        }</span>
 211 |     | <span class='neutral'>    }</span>
 212 |     | <span class='neutral'></span>
 213 |     | <span class='neutral'>    /**</span>
 214 |     | <span class='neutral'>     * @dev Tool to verify that a low level call was successful, and revert if it wasn&#39;t, either by bubbling the</span>
 215 |     | <span class='neutral'>     * revert reason or using the provided one.</span>
 216 |     | <span class='neutral'>     *</span>
 217 |     | <span class='neutral'>     * _Available since v4.3._</span>
 218 |     | <span class='neutral'>     */</span>
 219 |     | <span class='unexecuted'>    function verifyCallResult(</span>
 220 |     | <span class='neutral'>        bool success,</span>
 221 |     | <span class='neutral'>        bytes memory returndata,</span>
 222 |     | <span class='neutral'>        string memory errorMessage</span>
 223 |     | <span class='unexecuted'>    ) internal pure returns (bytes memory) {</span>
 224 |     | <span class='unexecuted'>        if (success) {</span>
 225 |     | <span class='unexecuted'>            return returndata;</span>
 226 |     | <span class='neutral'>        } else {</span>
 227 |     | <span class='unexecuted'>            _revert(returndata, errorMessage);</span>
 228 |     | <span class='neutral'>        }</span>
 229 |     | <span class='neutral'>    }</span>
 230 |     | <span class='neutral'></span>
 231 | *   | <span class='executed'>    function _revert(bytes memory returndata, string memory errorMessage) private pure {</span>
 232 |     | <span class='neutral'>        // Look for revert reason and bubble it up if present</span>
 233 | *   | <span class='executed'>        if (returndata.length &gt; 0) {</span>
 234 |     | <span class='neutral'>            // The easiest way to bubble the revert reason is using memory via assembly</span>
 235 |     | <span class='neutral'>            /// @solidity memory-safe-assembly</span>
 236 |     | <span class='neutral'>            assembly {</span>
 237 | *   | <span class='executed'>                let returndata_size := mload(returndata)</span>
 238 | *r  | <span class='executed'>                revert(add(32, returndata), returndata_size)</span>
 239 |     | <span class='neutral'>            }</span>
 240 |     | <span class='neutral'>        } else {</span>
 241 | *   | <span class='executed'>            revert(errorMessage);</span>
 242 |     | <span class='neutral'>        }</span>
 243 |     | <span class='neutral'>    }</span>
 244 |     | <span class='neutral'>}</span>
 245 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/lib/openzeppelin-contracts/contracts/utils/Context.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts v4.4.1 (utils/Context.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>/**</span>
  7 |     | <span class='neutral'> * @dev Provides information about the current execution context, including the</span>
  8 |     | <span class='neutral'> * sender of the transaction and its data. While these are generally available</span>
  9 |     | <span class='neutral'> * via msg.sender and msg.data, they should not be accessed in such a direct</span>
 10 |     | <span class='neutral'> * manner, since when dealing with meta-transactions the account sending and</span>
 11 |     | <span class='neutral'> * paying for execution may not be the actual sender (as far as an application</span>
 12 |     | <span class='neutral'> * is concerned).</span>
 13 |     | <span class='neutral'> *</span>
 14 |     | <span class='neutral'> * This contract is only required for intermediate, library-like contracts.</span>
 15 |     | <span class='neutral'> */</span>
 16 |     | <span class='neutral'>abstract contract Context {</span>
 17 |     | <span class='neutral'>    function _msgSender() internal view virtual returns (address) {</span>
 18 |     | <span class='unexecuted'>        return msg.sender;</span>
 19 |     | <span class='neutral'>    }</span>
 20 |     | <span class='neutral'></span>
 21 |     | <span class='neutral'>    function _msgData() internal view virtual returns (bytes calldata) {</span>
 22 |     | <span class='neutral'>        return msg.data;</span>
 23 |     | <span class='neutral'>    }</span>
 24 |     | <span class='neutral'>}</span>
 25 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/lib/openzeppelin-contracts/contracts/utils/Counters.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts v4.4.1 (utils/Counters.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>/**</span>
  7 |     | <span class='neutral'> * @title Counters</span>
  8 |     | <span class='neutral'> * @author Matt Condon (@shrugs)</span>
  9 |     | <span class='neutral'> * @dev Provides counters that can only be incremented, decremented or reset. This can be used e.g. to track the number</span>
 10 |     | <span class='neutral'> * of elements in a mapping, issuing ERC721 ids, or counting request ids.</span>
 11 |     | <span class='neutral'> *</span>
 12 |     | <span class='neutral'> * Include with `using Counters for Counters.Counter;`</span>
 13 |     | <span class='neutral'> */</span>
 14 |     | <span class='unexecuted'>library Counters {</span>
 15 |     | <span class='neutral'>    struct Counter {</span>
 16 |     | <span class='neutral'>        // This variable should never be directly accessed by users of the library: interactions must be restricted to</span>
 17 |     | <span class='neutral'>        // the library&#39;s function. As of Solidity v0.5.2, this cannot be enforced, though there is a proposal to add</span>
 18 |     | <span class='neutral'>        // this feature: see https://github.com/ethereum/solidity/issues/4637</span>
 19 |     | <span class='neutral'>        uint256 _value; // default: 0</span>
 20 |     | <span class='neutral'>    }</span>
 21 |     | <span class='neutral'></span>
 22 |     | <span class='unexecuted'>    function current(Counter storage counter) internal view returns (uint256) {</span>
 23 |     | <span class='unexecuted'>        return counter._value;</span>
 24 |     | <span class='neutral'>    }</span>
 25 |     | <span class='neutral'></span>
 26 |     | <span class='neutral'>    function increment(Counter storage counter) internal {</span>
 27 |     | <span class='neutral'>        unchecked {</span>
 28 |     | <span class='unexecuted'>            counter._value += 1;</span>
 29 |     | <span class='neutral'>        }</span>
 30 |     | <span class='neutral'>    }</span>
 31 |     | <span class='neutral'></span>
 32 |     | <span class='neutral'>    function decrement(Counter storage counter) internal {</span>
 33 |     | <span class='neutral'>        uint256 value = counter._value;</span>
 34 |     | <span class='neutral'>        require(value &gt; 0, &quot;Counter: decrement overflow&quot;);</span>
 35 |     | <span class='neutral'>        unchecked {</span>
 36 |     | <span class='neutral'>            counter._value = value - 1;</span>
 37 |     | <span class='neutral'>        }</span>
 38 |     | <span class='neutral'>    }</span>
 39 |     | <span class='neutral'></span>
 40 |     | <span class='neutral'>    function reset(Counter storage counter) internal {</span>
 41 |     | <span class='neutral'>        counter._value = 0;</span>
 42 |     | <span class='neutral'>    }</span>
 43 |     | <span class='neutral'>}</span>
 44 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/lib/openzeppelin-contracts/contracts/utils/ShortStrings.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (utils/ShortStrings.sol)</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>pragma solidity ^0.8.8;</span>
   5 |     | <span class='neutral'></span>
   6 |     | <span class='neutral'>import &quot;./StorageSlot.sol&quot;;</span>
   7 |     | <span class='neutral'></span>
   8 |     | <span class='neutral'>// | string  | 0xAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA   |</span>
   9 |     | <span class='neutral'>// | length  | 0x                                                              BB |</span>
  10 |     | <span class='neutral'>type ShortString is bytes32;</span>
  11 |     | <span class='neutral'></span>
  12 |     | <span class='neutral'>/**</span>
  13 |     | <span class='neutral'> * @dev This library provides functions to convert short memory strings</span>
  14 |     | <span class='neutral'> * into a `ShortString` type that can be used as an immutable variable.</span>
  15 |     | <span class='neutral'> *</span>
  16 |     | <span class='neutral'> * Strings of arbitrary length can be optimized using this library if</span>
  17 |     | <span class='neutral'> * they are short enough (up to 31 bytes) by packing them with their</span>
  18 |     | <span class='neutral'> * length (1 byte) in a single EVM word (32 bytes). Additionally, a</span>
  19 |     | <span class='neutral'> * fallback mechanism can be used for every other case.</span>
  20 |     | <span class='neutral'> *</span>
  21 |     | <span class='neutral'> * Usage example:</span>
  22 |     | <span class='neutral'> *</span>
  23 |     | <span class='neutral'> * ```solidity</span>
  24 |     | <span class='neutral'> * contract Named {</span>
  25 |     | <span class='neutral'> *     using ShortStrings for *;</span>
  26 |     | <span class='neutral'> *</span>
  27 |     | <span class='neutral'> *     ShortString private immutable _name;</span>
  28 |     | <span class='neutral'> *     string private _nameFallback;</span>
  29 |     | <span class='neutral'> *</span>
  30 |     | <span class='neutral'> *     constructor(string memory contractName) {</span>
  31 |     | <span class='neutral'> *         _name = contractName.toShortStringWithFallback(_nameFallback);</span>
  32 |     | <span class='neutral'> *     }</span>
  33 |     | <span class='neutral'> *</span>
  34 |     | <span class='neutral'> *     function name() external view returns (string memory) {</span>
  35 |     | <span class='neutral'> *         return _name.toStringWithFallback(_nameFallback);</span>
  36 |     | <span class='neutral'> *     }</span>
  37 |     | <span class='neutral'> * }</span>
  38 |     | <span class='neutral'> * ```</span>
  39 |     | <span class='neutral'> */</span>
  40 |     | <span class='unexecuted'>library ShortStrings {</span>
  41 |     | <span class='neutral'>    // Used as an identifier for strings longer than 31 bytes.</span>
  42 |     | <span class='unexecuted'>    bytes32 private constant _FALLBACK_SENTINEL = 0x00000000000000000000000000000000000000000000000000000000000000FF;</span>
  43 |     | <span class='neutral'></span>
  44 |     | <span class='neutral'>    error StringTooLong(string str);</span>
  45 |     | <span class='neutral'>    error InvalidShortString();</span>
  46 |     | <span class='neutral'></span>
  47 |     | <span class='neutral'>    /**</span>
  48 |     | <span class='neutral'>     * @dev Encode a string of at most 31 chars into a `ShortString`.</span>
  49 |     | <span class='neutral'>     *</span>
  50 |     | <span class='neutral'>     * This will trigger a `StringTooLong` error is the input string is too long.</span>
  51 |     | <span class='neutral'>     */</span>
  52 |     | <span class='unexecuted'>    function toShortString(string memory str) internal pure returns (ShortString) {</span>
  53 |     | <span class='unexecuted'>        bytes memory bstr = bytes(str);</span>
  54 |     | <span class='unexecuted'>        if (bstr.length &gt; 31) {</span>
  55 |     | <span class='unexecuted'>            revert StringTooLong(str);</span>
  56 |     | <span class='neutral'>        }</span>
  57 |     | <span class='unexecuted'>        return ShortString.wrap(bytes32(uint256(bytes32(bstr)) | bstr.length));</span>
  58 |     | <span class='neutral'>    }</span>
  59 |     | <span class='neutral'></span>
  60 |     | <span class='neutral'>    /**</span>
  61 |     | <span class='neutral'>     * @dev Decode a `ShortString` back to a &quot;normal&quot; string.</span>
  62 |     | <span class='neutral'>     */</span>
  63 |     | <span class='unexecuted'>    function toString(ShortString sstr) internal pure returns (string memory) {</span>
  64 |     | <span class='unexecuted'>        uint256 len = byteLength(sstr);</span>
  65 |     | <span class='neutral'>        // using `new string(len)` would work locally but is not memory safe.</span>
  66 |     | <span class='unexecuted'>        string memory str = new string(32);</span>
  67 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
  68 |     | <span class='neutral'>        assembly {</span>
  69 |     | <span class='unexecuted'>            mstore(str, len)</span>
  70 |     | <span class='unexecuted'>            mstore(add(str, 0x20), sstr)</span>
  71 |     | <span class='neutral'>        }</span>
  72 |     | <span class='neutral'>        return str;</span>
  73 |     | <span class='neutral'>    }</span>
  74 |     | <span class='neutral'></span>
  75 |     | <span class='neutral'>    /**</span>
  76 |     | <span class='neutral'>     * @dev Return the length of a `ShortString`.</span>
  77 |     | <span class='neutral'>     */</span>
  78 |     | <span class='unexecuted'>    function byteLength(ShortString sstr) internal pure returns (uint256) {</span>
  79 |     | <span class='unexecuted'>        uint256 result = uint256(ShortString.unwrap(sstr)) &amp; 0xFF;</span>
  80 |     | <span class='unexecuted'>        if (result &gt; 31) {</span>
  81 |     | <span class='unexecuted'>            revert InvalidShortString();</span>
  82 |     | <span class='neutral'>        }</span>
  83 |     | <span class='neutral'>        return result;</span>
  84 |     | <span class='neutral'>    }</span>
  85 |     | <span class='neutral'></span>
  86 |     | <span class='neutral'>    /**</span>
  87 |     | <span class='neutral'>     * @dev Encode a string into a `ShortString`, or write it to storage if it is too long.</span>
  88 |     | <span class='neutral'>     */</span>
  89 |     | <span class='unexecuted'>    function toShortStringWithFallback(string memory value, string storage store) internal returns (ShortString) {</span>
  90 |     | <span class='unexecuted'>        if (bytes(value).length &lt; 32) {</span>
  91 |     | <span class='unexecuted'>            return toShortString(value);</span>
  92 |     | <span class='neutral'>        } else {</span>
  93 |     | <span class='unexecuted'>            StorageSlot.getStringSlot(store).value = value;</span>
  94 |     | <span class='neutral'>            return ShortString.wrap(_FALLBACK_SENTINEL);</span>
  95 |     | <span class='neutral'>        }</span>
  96 |     | <span class='neutral'>    }</span>
  97 |     | <span class='neutral'></span>
  98 |     | <span class='neutral'>    /**</span>
  99 |     | <span class='neutral'>     * @dev Decode a string that was encoded to `ShortString` or written to storage using {setWithFallback}.</span>
 100 |     | <span class='neutral'>     */</span>
 101 |     | <span class='unexecuted'>    function toStringWithFallback(ShortString value, string storage store) internal pure returns (string memory) {</span>
 102 |     | <span class='unexecuted'>        if (ShortString.unwrap(value) != _FALLBACK_SENTINEL) {</span>
 103 |     | <span class='unexecuted'>            return toString(value);</span>
 104 |     | <span class='neutral'>        } else {</span>
 105 |     | <span class='unexecuted'>            return store;</span>
 106 |     | <span class='neutral'>        }</span>
 107 |     | <span class='neutral'>    }</span>
 108 |     | <span class='neutral'></span>
 109 |     | <span class='neutral'>    /**</span>
 110 |     | <span class='neutral'>     * @dev Return the length of a string that was encoded to `ShortString` or written to storage using {setWithFallback}.</span>
 111 |     | <span class='neutral'>     *</span>
 112 |     | <span class='neutral'>     * WARNING: This will return the &quot;byte length&quot; of the string. This may not reflect the actual length in terms of</span>
 113 |     | <span class='neutral'>     * actual characters as the UTF-8 encoding of a single character can span over multiple bytes.</span>
 114 |     | <span class='neutral'>     */</span>
 115 |     | <span class='neutral'>    function byteLengthWithFallback(ShortString value, string storage store) internal view returns (uint256) {</span>
 116 |     | <span class='neutral'>        if (ShortString.unwrap(value) != _FALLBACK_SENTINEL) {</span>
 117 |     | <span class='neutral'>            return byteLength(value);</span>
 118 |     | <span class='neutral'>        } else {</span>
 119 |     | <span class='neutral'>            return bytes(store).length;</span>
 120 |     | <span class='neutral'>        }</span>
 121 |     | <span class='neutral'>    }</span>
 122 |     | <span class='neutral'>}</span>
 123 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/lib/openzeppelin-contracts/contracts/utils/StorageSlot.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (utils/StorageSlot.sol)</span>
   3 |     | <span class='neutral'>// This file was procedurally generated from scripts/generate/templates/StorageSlot.js.</span>
   4 |     | <span class='neutral'></span>
   5 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
   6 |     | <span class='neutral'></span>
   7 |     | <span class='neutral'>/**</span>
   8 |     | <span class='neutral'> * @dev Library for reading and writing primitive types to specific storage slots.</span>
   9 |     | <span class='neutral'> *</span>
  10 |     | <span class='neutral'> * Storage slots are often used to avoid storage conflict when dealing with upgradeable contracts.</span>
  11 |     | <span class='neutral'> * This library helps with reading and writing to such slots without the need for inline assembly.</span>
  12 |     | <span class='neutral'> *</span>
  13 |     | <span class='neutral'> * The functions in this library return Slot structs that contain a `value` member that can be used to read or write.</span>
  14 |     | <span class='neutral'> *</span>
  15 |     | <span class='neutral'> * Example usage to set ERC1967 implementation slot:</span>
  16 |     | <span class='neutral'> * ```solidity</span>
  17 |     | <span class='neutral'> * contract ERC1967 {</span>
  18 |     | <span class='neutral'> *     bytes32 internal constant _IMPLEMENTATION_SLOT = 0x360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc;</span>
  19 |     | <span class='neutral'> *</span>
  20 |     | <span class='neutral'> *     function _getImplementation() internal view returns (address) {</span>
  21 |     | <span class='neutral'> *         return StorageSlot.getAddressSlot(_IMPLEMENTATION_SLOT).value;</span>
  22 |     | <span class='neutral'> *     }</span>
  23 |     | <span class='neutral'> *</span>
  24 |     | <span class='neutral'> *     function _setImplementation(address newImplementation) internal {</span>
  25 |     | <span class='neutral'> *         require(Address.isContract(newImplementation), &quot;ERC1967: new implementation is not a contract&quot;);</span>
  26 |     | <span class='neutral'> *         StorageSlot.getAddressSlot(_IMPLEMENTATION_SLOT).value = newImplementation;</span>
  27 |     | <span class='neutral'> *     }</span>
  28 |     | <span class='neutral'> * }</span>
  29 |     | <span class='neutral'> * ```</span>
  30 |     | <span class='neutral'> *</span>
  31 |     | <span class='neutral'> * _Available since v4.1 for `address`, `bool`, `bytes32`, `uint256`._</span>
  32 |     | <span class='neutral'> * _Available since v4.9 for `string`, `bytes`._</span>
  33 |     | <span class='neutral'> */</span>
  34 |     | <span class='unexecuted'>library StorageSlot {</span>
  35 |     | <span class='neutral'>    struct AddressSlot {</span>
  36 |     | <span class='neutral'>        address value;</span>
  37 |     | <span class='neutral'>    }</span>
  38 |     | <span class='neutral'></span>
  39 |     | <span class='neutral'>    struct BooleanSlot {</span>
  40 |     | <span class='neutral'>        bool value;</span>
  41 |     | <span class='neutral'>    }</span>
  42 |     | <span class='neutral'></span>
  43 |     | <span class='neutral'>    struct Bytes32Slot {</span>
  44 |     | <span class='neutral'>        bytes32 value;</span>
  45 |     | <span class='neutral'>    }</span>
  46 |     | <span class='neutral'></span>
  47 |     | <span class='neutral'>    struct Uint256Slot {</span>
  48 |     | <span class='neutral'>        uint256 value;</span>
  49 |     | <span class='neutral'>    }</span>
  50 |     | <span class='neutral'></span>
  51 |     | <span class='neutral'>    struct StringSlot {</span>
  52 |     | <span class='neutral'>        string value;</span>
  53 |     | <span class='neutral'>    }</span>
  54 |     | <span class='neutral'></span>
  55 |     | <span class='neutral'>    struct BytesSlot {</span>
  56 |     | <span class='neutral'>        bytes value;</span>
  57 |     | <span class='neutral'>    }</span>
  58 |     | <span class='neutral'></span>
  59 |     | <span class='neutral'>    /**</span>
  60 |     | <span class='neutral'>     * @dev Returns an `AddressSlot` with member `value` located at `slot`.</span>
  61 |     | <span class='neutral'>     */</span>
  62 |     | <span class='neutral'>    function getAddressSlot(bytes32 slot) internal pure returns (AddressSlot storage r) {</span>
  63 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
  64 |     | <span class='neutral'>        assembly {</span>
  65 |     | <span class='neutral'>            r.slot := slot</span>
  66 |     | <span class='neutral'>        }</span>
  67 |     | <span class='neutral'>    }</span>
  68 |     | <span class='neutral'></span>
  69 |     | <span class='neutral'>    /**</span>
  70 |     | <span class='neutral'>     * @dev Returns an `BooleanSlot` with member `value` located at `slot`.</span>
  71 |     | <span class='neutral'>     */</span>
  72 |     | <span class='neutral'>    function getBooleanSlot(bytes32 slot) internal pure returns (BooleanSlot storage r) {</span>
  73 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
  74 |     | <span class='neutral'>        assembly {</span>
  75 |     | <span class='neutral'>            r.slot := slot</span>
  76 |     | <span class='neutral'>        }</span>
  77 |     | <span class='neutral'>    }</span>
  78 |     | <span class='neutral'></span>
  79 |     | <span class='neutral'>    /**</span>
  80 |     | <span class='neutral'>     * @dev Returns an `Bytes32Slot` with member `value` located at `slot`.</span>
  81 |     | <span class='neutral'>     */</span>
  82 |     | <span class='neutral'>    function getBytes32Slot(bytes32 slot) internal pure returns (Bytes32Slot storage r) {</span>
  83 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
  84 |     | <span class='neutral'>        assembly {</span>
  85 |     | <span class='neutral'>            r.slot := slot</span>
  86 |     | <span class='neutral'>        }</span>
  87 |     | <span class='neutral'>    }</span>
  88 |     | <span class='neutral'></span>
  89 |     | <span class='neutral'>    /**</span>
  90 |     | <span class='neutral'>     * @dev Returns an `Uint256Slot` with member `value` located at `slot`.</span>
  91 |     | <span class='neutral'>     */</span>
  92 |     | <span class='neutral'>    function getUint256Slot(bytes32 slot) internal pure returns (Uint256Slot storage r) {</span>
  93 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
  94 |     | <span class='neutral'>        assembly {</span>
  95 |     | <span class='neutral'>            r.slot := slot</span>
  96 |     | <span class='neutral'>        }</span>
  97 |     | <span class='neutral'>    }</span>
  98 |     | <span class='neutral'></span>
  99 |     | <span class='neutral'>    /**</span>
 100 |     | <span class='neutral'>     * @dev Returns an `StringSlot` with member `value` located at `slot`.</span>
 101 |     | <span class='neutral'>     */</span>
 102 |     | <span class='neutral'>    function getStringSlot(bytes32 slot) internal pure returns (StringSlot storage r) {</span>
 103 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 104 |     | <span class='neutral'>        assembly {</span>
 105 |     | <span class='neutral'>            r.slot := slot</span>
 106 |     | <span class='neutral'>        }</span>
 107 |     | <span class='neutral'>    }</span>
 108 |     | <span class='neutral'></span>
 109 |     | <span class='neutral'>    /**</span>
 110 |     | <span class='neutral'>     * @dev Returns an `StringSlot` representation of the string storage pointer `store`.</span>
 111 |     | <span class='neutral'>     */</span>
 112 |     | <span class='neutral'>    function getStringSlot(string storage store) internal pure returns (StringSlot storage r) {</span>
 113 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 114 |     | <span class='neutral'>        assembly {</span>
 115 |     | <span class='neutral'>            r.slot := store.slot</span>
 116 |     | <span class='neutral'>        }</span>
 117 |     | <span class='neutral'>    }</span>
 118 |     | <span class='neutral'></span>
 119 |     | <span class='neutral'>    /**</span>
 120 |     | <span class='neutral'>     * @dev Returns an `BytesSlot` with member `value` located at `slot`.</span>
 121 |     | <span class='neutral'>     */</span>
 122 |     | <span class='neutral'>    function getBytesSlot(bytes32 slot) internal pure returns (BytesSlot storage r) {</span>
 123 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 124 |     | <span class='neutral'>        assembly {</span>
 125 |     | <span class='neutral'>            r.slot := slot</span>
 126 |     | <span class='neutral'>        }</span>
 127 |     | <span class='neutral'>    }</span>
 128 |     | <span class='neutral'></span>
 129 |     | <span class='neutral'>    /**</span>
 130 |     | <span class='neutral'>     * @dev Returns an `BytesSlot` representation of the bytes storage pointer `store`.</span>
 131 |     | <span class='neutral'>     */</span>
 132 |     | <span class='neutral'>    function getBytesSlot(bytes storage store) internal pure returns (BytesSlot storage r) {</span>
 133 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 134 |     | <span class='neutral'>        assembly {</span>
 135 |     | <span class='neutral'>            r.slot := store.slot</span>
 136 |     | <span class='neutral'>        }</span>
 137 |     | <span class='neutral'>    }</span>
 138 |     | <span class='neutral'>}</span>
 139 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/lib/openzeppelin-contracts/contracts/utils/Strings.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (utils/Strings.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>import &quot;./math/Math.sol&quot;;</span>
  7 |     | <span class='neutral'>import &quot;./math/SignedMath.sol&quot;;</span>
  8 |     | <span class='neutral'></span>
  9 |     | <span class='neutral'>/**</span>
 10 |     | <span class='neutral'> * @dev String operations.</span>
 11 |     | <span class='neutral'> */</span>
 12 |     | <span class='unexecuted'>library Strings {</span>
 13 |     | <span class='neutral'>    bytes16 private constant _SYMBOLS = &quot;0123456789abcdef&quot;;</span>
 14 |     | <span class='neutral'>    uint8 private constant _ADDRESS_LENGTH = 20;</span>
 15 |     | <span class='neutral'></span>
 16 |     | <span class='neutral'>    /**</span>
 17 |     | <span class='neutral'>     * @dev Converts a `uint256` to its ASCII `string` decimal representation.</span>
 18 |     | <span class='neutral'>     */</span>
 19 |     | <span class='neutral'>    function toString(uint256 value) internal pure returns (string memory) {</span>
 20 |     | <span class='neutral'>        unchecked {</span>
 21 |     | <span class='neutral'>            uint256 length = Math.log10(value) + 1;</span>
 22 |     | <span class='neutral'>            string memory buffer = new string(length);</span>
 23 |     | <span class='neutral'>            uint256 ptr;</span>
 24 |     | <span class='neutral'>            /// @solidity memory-safe-assembly</span>
 25 |     | <span class='neutral'>            assembly {</span>
 26 |     | <span class='neutral'>                ptr := add(buffer, add(32, length))</span>
 27 |     | <span class='neutral'>            }</span>
 28 |     | <span class='neutral'>            while (true) {</span>
 29 |     | <span class='neutral'>                ptr--;</span>
 30 |     | <span class='neutral'>                /// @solidity memory-safe-assembly</span>
 31 |     | <span class='neutral'>                assembly {</span>
 32 |     | <span class='neutral'>                    mstore8(ptr, byte(mod(value, 10), _SYMBOLS))</span>
 33 |     | <span class='neutral'>                }</span>
 34 |     | <span class='neutral'>                value /= 10;</span>
 35 |     | <span class='neutral'>                if (value == 0) break;</span>
 36 |     | <span class='neutral'>            }</span>
 37 |     | <span class='neutral'>            return buffer;</span>
 38 |     | <span class='neutral'>        }</span>
 39 |     | <span class='neutral'>    }</span>
 40 |     | <span class='neutral'></span>
 41 |     | <span class='neutral'>    /**</span>
 42 |     | <span class='neutral'>     * @dev Converts a `int256` to its ASCII `string` decimal representation.</span>
 43 |     | <span class='neutral'>     */</span>
 44 |     | <span class='neutral'>    function toString(int256 value) internal pure returns (string memory) {</span>
 45 |     | <span class='neutral'>        return string(abi.encodePacked(value &lt; 0 ? &quot;-&quot; : &quot;&quot;, toString(SignedMath.abs(value))));</span>
 46 |     | <span class='neutral'>    }</span>
 47 |     | <span class='neutral'></span>
 48 |     | <span class='neutral'>    /**</span>
 49 |     | <span class='neutral'>     * @dev Converts a `uint256` to its ASCII `string` hexadecimal representation.</span>
 50 |     | <span class='neutral'>     */</span>
 51 |     | <span class='neutral'>    function toHexString(uint256 value) internal pure returns (string memory) {</span>
 52 |     | <span class='neutral'>        unchecked {</span>
 53 |     | <span class='neutral'>            return toHexString(value, Math.log256(value) + 1);</span>
 54 |     | <span class='neutral'>        }</span>
 55 |     | <span class='neutral'>    }</span>
 56 |     | <span class='neutral'></span>
 57 |     | <span class='neutral'>    /**</span>
 58 |     | <span class='neutral'>     * @dev Converts a `uint256` to its ASCII `string` hexadecimal representation with fixed length.</span>
 59 |     | <span class='neutral'>     */</span>
 60 |     | <span class='neutral'>    function toHexString(uint256 value, uint256 length) internal pure returns (string memory) {</span>
 61 |     | <span class='neutral'>        bytes memory buffer = new bytes(2 * length + 2);</span>
 62 |     | <span class='neutral'>        buffer[0] = &quot;0&quot;;</span>
 63 |     | <span class='neutral'>        buffer[1] = &quot;x&quot;;</span>
 64 |     | <span class='neutral'>        for (uint256 i = 2 * length + 1; i &gt; 1; --i) {</span>
 65 |     | <span class='neutral'>            buffer[i] = _SYMBOLS[value &amp; 0xf];</span>
 66 |     | <span class='neutral'>            value &gt;&gt;= 4;</span>
 67 |     | <span class='neutral'>        }</span>
 68 |     | <span class='neutral'>        require(value == 0, &quot;Strings: hex length insufficient&quot;);</span>
 69 |     | <span class='neutral'>        return string(buffer);</span>
 70 |     | <span class='neutral'>    }</span>
 71 |     | <span class='neutral'></span>
 72 |     | <span class='neutral'>    /**</span>
 73 |     | <span class='neutral'>     * @dev Converts an `address` with fixed length of 20 bytes to its not checksummed ASCII `string` hexadecimal representation.</span>
 74 |     | <span class='neutral'>     */</span>
 75 |     | <span class='neutral'>    function toHexString(address addr) internal pure returns (string memory) {</span>
 76 |     | <span class='neutral'>        return toHexString(uint256(uint160(addr)), _ADDRESS_LENGTH);</span>
 77 |     | <span class='neutral'>    }</span>
 78 |     | <span class='neutral'></span>
 79 |     | <span class='neutral'>    /**</span>
 80 |     | <span class='neutral'>     * @dev Returns true if the two strings are equal.</span>
 81 |     | <span class='neutral'>     */</span>
 82 |     | <span class='neutral'>    function equal(string memory a, string memory b) internal pure returns (bool) {</span>
 83 |     | <span class='neutral'>        return keccak256(bytes(a)) == keccak256(bytes(b));</span>
 84 |     | <span class='neutral'>    }</span>
 85 |     | <span class='neutral'>}</span>
 86 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/lib/openzeppelin-contracts/contracts/utils/cryptography/ECDSA.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (utils/cryptography/ECDSA.sol)</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
   5 |     | <span class='neutral'></span>
   6 |     | <span class='neutral'>import &quot;../Strings.sol&quot;;</span>
   7 |     | <span class='neutral'></span>
   8 |     | <span class='neutral'>/**</span>
   9 |     | <span class='neutral'> * @dev Elliptic Curve Digital Signature Algorithm (ECDSA) operations.</span>
  10 |     | <span class='neutral'> *</span>
  11 |     | <span class='neutral'> * These functions can be used to verify that a message was signed by the holder</span>
  12 |     | <span class='neutral'> * of the private keys of a given address.</span>
  13 |     | <span class='neutral'> */</span>
  14 |     | <span class='unexecuted'>library ECDSA {</span>
  15 |     | <span class='neutral'>    enum RecoverError {</span>
  16 |     | <span class='neutral'>        NoError,</span>
  17 |     | <span class='neutral'>        InvalidSignature,</span>
  18 |     | <span class='neutral'>        InvalidSignatureLength,</span>
  19 |     | <span class='neutral'>        InvalidSignatureS,</span>
  20 |     | <span class='neutral'>        InvalidSignatureV // Deprecated in v4.8</span>
  21 |     | <span class='neutral'>    }</span>
  22 |     | <span class='neutral'></span>
  23 |     | <span class='unexecuted'>    function _throwError(RecoverError error) private pure {</span>
  24 |     | <span class='unexecuted'>        if (error == RecoverError.NoError) {</span>
  25 |     | <span class='neutral'>            return; // no error: do nothing</span>
  26 |     | <span class='unexecuted'>        } else if (error == RecoverError.InvalidSignature) {</span>
  27 |     | <span class='unexecuted'>            revert(&quot;ECDSA: invalid signature&quot;);</span>
  28 |     | <span class='unexecuted'>        } else if (error == RecoverError.InvalidSignatureLength) {</span>
  29 |     | <span class='unexecuted'>            revert(&quot;ECDSA: invalid signature length&quot;);</span>
  30 |     | <span class='unexecuted'>        } else if (error == RecoverError.InvalidSignatureS) {</span>
  31 |     | <span class='unexecuted'>            revert(&quot;ECDSA: invalid signature &#39;s&#39; value&quot;);</span>
  32 |     | <span class='neutral'>        }</span>
  33 |     | <span class='neutral'>    }</span>
  34 |     | <span class='neutral'></span>
  35 |     | <span class='neutral'>    /**</span>
  36 |     | <span class='neutral'>     * @dev Returns the address that signed a hashed message (`hash`) with</span>
  37 |     | <span class='neutral'>     * `signature` or error string. This address can then be used for verification purposes.</span>
  38 |     | <span class='neutral'>     *</span>
  39 |     | <span class='neutral'>     * The `ecrecover` EVM opcode allows for malleable (non-unique) signatures:</span>
  40 |     | <span class='neutral'>     * this function rejects them by requiring the `s` value to be in the lower</span>
  41 |     | <span class='neutral'>     * half order, and the `v` value to be either 27 or 28.</span>
  42 |     | <span class='neutral'>     *</span>
  43 |     | <span class='neutral'>     * IMPORTANT: `hash` _must_ be the result of a hash operation for the</span>
  44 |     | <span class='neutral'>     * verification to be secure: it is possible to craft signatures that</span>
  45 |     | <span class='neutral'>     * recover to arbitrary addresses for non-hashed data. A safe way to ensure</span>
  46 |     | <span class='neutral'>     * this is by receiving a hash of the original message (which may otherwise</span>
  47 |     | <span class='neutral'>     * be too long), and then calling {toEthSignedMessageHash} on it.</span>
  48 |     | <span class='neutral'>     *</span>
  49 |     | <span class='neutral'>     * Documentation for signature generation:</span>
  50 |     | <span class='neutral'>     * - with https://web3js.readthedocs.io/en/v1.3.4/web3-eth-accounts.html#sign[Web3.js]</span>
  51 |     | <span class='neutral'>     * - with https://docs.ethers.io/v5/api/signer/#Signer-signMessage[ethers]</span>
  52 |     | <span class='neutral'>     *</span>
  53 |     | <span class='neutral'>     * _Available since v4.3._</span>
  54 |     | <span class='neutral'>     */</span>
  55 |     | <span class='neutral'>    function tryRecover(bytes32 hash, bytes memory signature) internal pure returns (address, RecoverError) {</span>
  56 |     | <span class='neutral'>        if (signature.length == 65) {</span>
  57 |     | <span class='neutral'>            bytes32 r;</span>
  58 |     | <span class='neutral'>            bytes32 s;</span>
  59 |     | <span class='neutral'>            uint8 v;</span>
  60 |     | <span class='neutral'>            // ecrecover takes the signature parameters, and the only way to get them</span>
  61 |     | <span class='neutral'>            // currently is to use assembly.</span>
  62 |     | <span class='neutral'>            /// @solidity memory-safe-assembly</span>
  63 |     | <span class='neutral'>            assembly {</span>
  64 |     | <span class='neutral'>                r := mload(add(signature, 0x20))</span>
  65 |     | <span class='neutral'>                s := mload(add(signature, 0x40))</span>
  66 |     | <span class='neutral'>                v := byte(0, mload(add(signature, 0x60)))</span>
  67 |     | <span class='neutral'>            }</span>
  68 |     | <span class='neutral'>            return tryRecover(hash, v, r, s);</span>
  69 |     | <span class='neutral'>        } else {</span>
  70 |     | <span class='neutral'>            return (address(0), RecoverError.InvalidSignatureLength);</span>
  71 |     | <span class='neutral'>        }</span>
  72 |     | <span class='neutral'>    }</span>
  73 |     | <span class='neutral'></span>
  74 |     | <span class='neutral'>    /**</span>
  75 |     | <span class='neutral'>     * @dev Returns the address that signed a hashed message (`hash`) with</span>
  76 |     | <span class='neutral'>     * `signature`. This address can then be used for verification purposes.</span>
  77 |     | <span class='neutral'>     *</span>
  78 |     | <span class='neutral'>     * The `ecrecover` EVM opcode allows for malleable (non-unique) signatures:</span>
  79 |     | <span class='neutral'>     * this function rejects them by requiring the `s` value to be in the lower</span>
  80 |     | <span class='neutral'>     * half order, and the `v` value to be either 27 or 28.</span>
  81 |     | <span class='neutral'>     *</span>
  82 |     | <span class='neutral'>     * IMPORTANT: `hash` _must_ be the result of a hash operation for the</span>
  83 |     | <span class='neutral'>     * verification to be secure: it is possible to craft signatures that</span>
  84 |     | <span class='neutral'>     * recover to arbitrary addresses for non-hashed data. A safe way to ensure</span>
  85 |     | <span class='neutral'>     * this is by receiving a hash of the original message (which may otherwise</span>
  86 |     | <span class='neutral'>     * be too long), and then calling {toEthSignedMessageHash} on it.</span>
  87 |     | <span class='neutral'>     */</span>
  88 |     | <span class='neutral'>    function recover(bytes32 hash, bytes memory signature) internal pure returns (address) {</span>
  89 |     | <span class='neutral'>        (address recovered, RecoverError error) = tryRecover(hash, signature);</span>
  90 |     | <span class='neutral'>        _throwError(error);</span>
  91 |     | <span class='neutral'>        return recovered;</span>
  92 |     | <span class='neutral'>    }</span>
  93 |     | <span class='neutral'></span>
  94 |     | <span class='neutral'>    /**</span>
  95 |     | <span class='neutral'>     * @dev Overload of {ECDSA-tryRecover} that receives the `r` and `vs` short-signature fields separately.</span>
  96 |     | <span class='neutral'>     *</span>
  97 |     | <span class='neutral'>     * See https://eips.ethereum.org/EIPS/eip-2098[EIP-2098 short signatures]</span>
  98 |     | <span class='neutral'>     *</span>
  99 |     | <span class='neutral'>     * _Available since v4.3._</span>
 100 |     | <span class='neutral'>     */</span>
 101 |     | <span class='neutral'>    function tryRecover(bytes32 hash, bytes32 r, bytes32 vs) internal pure returns (address, RecoverError) {</span>
 102 |     | <span class='neutral'>        bytes32 s = vs &amp; bytes32(0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff);</span>
 103 |     | <span class='neutral'>        uint8 v = uint8((uint256(vs) &gt;&gt; 255) + 27);</span>
 104 |     | <span class='neutral'>        return tryRecover(hash, v, r, s);</span>
 105 |     | <span class='neutral'>    }</span>
 106 |     | <span class='neutral'></span>
 107 |     | <span class='neutral'>    /**</span>
 108 |     | <span class='neutral'>     * @dev Overload of {ECDSA-recover} that receives the `r and `vs` short-signature fields separately.</span>
 109 |     | <span class='neutral'>     *</span>
 110 |     | <span class='neutral'>     * _Available since v4.2._</span>
 111 |     | <span class='neutral'>     */</span>
 112 |     | <span class='neutral'>    function recover(bytes32 hash, bytes32 r, bytes32 vs) internal pure returns (address) {</span>
 113 |     | <span class='neutral'>        (address recovered, RecoverError error) = tryRecover(hash, r, vs);</span>
 114 |     | <span class='neutral'>        _throwError(error);</span>
 115 |     | <span class='neutral'>        return recovered;</span>
 116 |     | <span class='neutral'>    }</span>
 117 |     | <span class='neutral'></span>
 118 |     | <span class='neutral'>    /**</span>
 119 |     | <span class='neutral'>     * @dev Overload of {ECDSA-tryRecover} that receives the `v`,</span>
 120 |     | <span class='neutral'>     * `r` and `s` signature fields separately.</span>
 121 |     | <span class='neutral'>     *</span>
 122 |     | <span class='neutral'>     * _Available since v4.3._</span>
 123 |     | <span class='neutral'>     */</span>
 124 |     | <span class='unexecuted'>    function tryRecover(bytes32 hash, uint8 v, bytes32 r, bytes32 s) internal pure returns (address, RecoverError) {</span>
 125 |     | <span class='neutral'>        // EIP-2 still allows signature malleability for ecrecover(). Remove this possibility and make the signature</span>
 126 |     | <span class='neutral'>        // unique. Appendix F in the Ethereum Yellow paper (https://ethereum.github.io/yellowpaper/paper.pdf), defines</span>
 127 |     | <span class='neutral'>        // the valid range for s in (301): 0 &lt; s &lt; secp256k1n  2 + 1, and for v in (302): v  {27, 28}. Most</span>
 128 |     | <span class='neutral'>        // signatures from current libraries generate a unique signature with an s-value in the lower half order.</span>
 129 |     | <span class='neutral'>        //</span>
 130 |     | <span class='neutral'>        // If your library generates malleable signatures, such as s-values in the upper range, calculate a new s-value</span>
 131 |     | <span class='neutral'>        // with 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141 - s1 and flip v from 27 to 28 or</span>
 132 |     | <span class='neutral'>        // vice versa. If your library also generates signatures with 0/1 for v instead 27/28, add 27 to v to accept</span>
 133 |     | <span class='neutral'>        // these malleable signatures as well.</span>
 134 |     | <span class='unexecuted'>        if (uint256(s) &gt; 0x7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5D576E7357A4501DDFE92F46681B20A0) {</span>
 135 |     | <span class='unexecuted'>            return (address(0), RecoverError.InvalidSignatureS);</span>
 136 |     | <span class='neutral'>        }</span>
 137 |     | <span class='neutral'></span>
 138 |     | <span class='neutral'>        // If the signature is valid (and not malleable), return the signer address</span>
 139 |     | <span class='unexecuted'>        address signer = ecrecover(hash, v, r, s);</span>
 140 |     | <span class='unexecuted'>        if (signer == address(0)) {</span>
 141 |     | <span class='unexecuted'>            return (address(0), RecoverError.InvalidSignature);</span>
 142 |     | <span class='neutral'>        }</span>
 143 |     | <span class='neutral'></span>
 144 |     | <span class='unexecuted'>        return (signer, RecoverError.NoError);</span>
 145 |     | <span class='neutral'>    }</span>
 146 |     | <span class='neutral'></span>
 147 |     | <span class='neutral'>    /**</span>
 148 |     | <span class='neutral'>     * @dev Overload of {ECDSA-recover} that receives the `v`,</span>
 149 |     | <span class='neutral'>     * `r` and `s` signature fields separately.</span>
 150 |     | <span class='neutral'>     */</span>
 151 |     | <span class='unexecuted'>    function recover(bytes32 hash, uint8 v, bytes32 r, bytes32 s) internal pure returns (address) {</span>
 152 |     | <span class='unexecuted'>        (address recovered, RecoverError error) = tryRecover(hash, v, r, s);</span>
 153 |     | <span class='unexecuted'>        _throwError(error);</span>
 154 |     | <span class='unexecuted'>        return recovered;</span>
 155 |     | <span class='neutral'>    }</span>
 156 |     | <span class='neutral'></span>
 157 |     | <span class='neutral'>    /**</span>
 158 |     | <span class='neutral'>     * @dev Returns an Ethereum Signed Message, created from a `hash`. This</span>
 159 |     | <span class='neutral'>     * produces hash corresponding to the one signed with the</span>
 160 |     | <span class='neutral'>     * https://eth.wiki/json-rpc/API#eth_sign[`eth_sign`]</span>
 161 |     | <span class='neutral'>     * JSON-RPC method as part of EIP-191.</span>
 162 |     | <span class='neutral'>     *</span>
 163 |     | <span class='neutral'>     * See {recover}.</span>
 164 |     | <span class='neutral'>     */</span>
 165 |     | <span class='neutral'>    function toEthSignedMessageHash(bytes32 hash) internal pure returns (bytes32 message) {</span>
 166 |     | <span class='neutral'>        // 32 is the length in bytes of hash,</span>
 167 |     | <span class='neutral'>        // enforced by the type signature above</span>
 168 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 169 |     | <span class='neutral'>        assembly {</span>
 170 |     | <span class='neutral'>            mstore(0x00, &quot;\x19Ethereum Signed Message:\n32&quot;)</span>
 171 |     | <span class='neutral'>            mstore(0x1c, hash)</span>
 172 |     | <span class='neutral'>            message := keccak256(0x00, 0x3c)</span>
 173 |     | <span class='neutral'>        }</span>
 174 |     | <span class='neutral'>    }</span>
 175 |     | <span class='neutral'></span>
 176 |     | <span class='neutral'>    /**</span>
 177 |     | <span class='neutral'>     * @dev Returns an Ethereum Signed Message, created from `s`. This</span>
 178 |     | <span class='neutral'>     * produces hash corresponding to the one signed with the</span>
 179 |     | <span class='neutral'>     * https://eth.wiki/json-rpc/API#eth_sign[`eth_sign`]</span>
 180 |     | <span class='neutral'>     * JSON-RPC method as part of EIP-191.</span>
 181 |     | <span class='neutral'>     *</span>
 182 |     | <span class='neutral'>     * See {recover}.</span>
 183 |     | <span class='neutral'>     */</span>
 184 |     | <span class='neutral'>    function toEthSignedMessageHash(bytes memory s) internal pure returns (bytes32) {</span>
 185 |     | <span class='neutral'>        return keccak256(abi.encodePacked(&quot;\x19Ethereum Signed Message:\n&quot;, Strings.toString(s.length), s));</span>
 186 |     | <span class='neutral'>    }</span>
 187 |     | <span class='neutral'></span>
 188 |     | <span class='neutral'>    /**</span>
 189 |     | <span class='neutral'>     * @dev Returns an Ethereum Signed Typed Data, created from a</span>
 190 |     | <span class='neutral'>     * `domainSeparator` and a `structHash`. This produces hash corresponding</span>
 191 |     | <span class='neutral'>     * to the one signed with the</span>
 192 |     | <span class='neutral'>     * https://eips.ethereum.org/EIPS/eip-712[`eth_signTypedData`]</span>
 193 |     | <span class='neutral'>     * JSON-RPC method as part of EIP-712.</span>
 194 |     | <span class='neutral'>     *</span>
 195 |     | <span class='neutral'>     * See {recover}.</span>
 196 |     | <span class='neutral'>     */</span>
 197 |     | <span class='unexecuted'>    function toTypedDataHash(bytes32 domainSeparator, bytes32 structHash) internal pure returns (bytes32 data) {</span>
 198 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 199 |     | <span class='neutral'>        assembly {</span>
 200 |     | <span class='unexecuted'>            let ptr := mload(0x40)</span>
 201 |     | <span class='unexecuted'>            mstore(ptr, &quot;\x19\x01&quot;)</span>
 202 |     | <span class='unexecuted'>            mstore(add(ptr, 0x02), domainSeparator)</span>
 203 |     | <span class='unexecuted'>            mstore(add(ptr, 0x22), structHash)</span>
 204 |     | <span class='unexecuted'>            data := keccak256(ptr, 0x42)</span>
 205 |     | <span class='neutral'>        }</span>
 206 |     | <span class='neutral'>    }</span>
 207 |     | <span class='neutral'></span>
 208 |     | <span class='neutral'>    /**</span>
 209 |     | <span class='neutral'>     * @dev Returns an Ethereum Signed Data with intended validator, created from a</span>
 210 |     | <span class='neutral'>     * `validator` and `data` according to the version 0 of EIP-191.</span>
 211 |     | <span class='neutral'>     *</span>
 212 |     | <span class='neutral'>     * See {recover}.</span>
 213 |     | <span class='neutral'>     */</span>
 214 |     | <span class='neutral'>    function toDataWithIntendedValidatorHash(address validator, bytes memory data) internal pure returns (bytes32) {</span>
 215 |     | <span class='neutral'>        return keccak256(abi.encodePacked(&quot;\x19\x00&quot;, validator, data));</span>
 216 |     | <span class='neutral'>    }</span>
 217 |     | <span class='neutral'>}</span>
 218 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/lib/openzeppelin-contracts/contracts/utils/cryptography/EIP712.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (utils/cryptography/EIP712.sol)</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>pragma solidity ^0.8.8;</span>
   5 |     | <span class='neutral'></span>
   6 |     | <span class='neutral'>import &quot;./ECDSA.sol&quot;;</span>
   7 |     | <span class='neutral'>import &quot;../ShortStrings.sol&quot;;</span>
   8 |     | <span class='neutral'>import &quot;../../interfaces/IERC5267.sol&quot;;</span>
   9 |     | <span class='neutral'></span>
  10 |     | <span class='neutral'>/**</span>
  11 |     | <span class='neutral'> * @dev https://eips.ethereum.org/EIPS/eip-712[EIP 712] is a standard for hashing and signing of typed structured data.</span>
  12 |     | <span class='neutral'> *</span>
  13 |     | <span class='neutral'> * The encoding specified in the EIP is very generic, and such a generic implementation in Solidity is not feasible,</span>
  14 |     | <span class='neutral'> * thus this contract does not implement the encoding itself. Protocols need to implement the type-specific encoding</span>
  15 |     | <span class='neutral'> * they need in their contracts using a combination of `abi.encode` and `keccak256`.</span>
  16 |     | <span class='neutral'> *</span>
  17 |     | <span class='neutral'> * This contract implements the EIP 712 domain separator ({_domainSeparatorV4}) that is used as part of the encoding</span>
  18 |     | <span class='neutral'> * scheme, and the final step of the encoding to obtain the message digest that is then signed via ECDSA</span>
  19 |     | <span class='neutral'> * ({_hashTypedDataV4}).</span>
  20 |     | <span class='neutral'> *</span>
  21 |     | <span class='neutral'> * The implementation of the domain separator was designed to be as efficient as possible while still properly updating</span>
  22 |     | <span class='neutral'> * the chain id to protect against replay attacks on an eventual fork of the chain.</span>
  23 |     | <span class='neutral'> *</span>
  24 |     | <span class='neutral'> * NOTE: This contract implements the version of the encoding known as &quot;v4&quot;, as implemented by the JSON RPC method</span>
  25 |     | <span class='neutral'> * https://docs.metamask.io/guide/signing-data.html[`eth_signTypedDataV4` in MetaMask].</span>
  26 |     | <span class='neutral'> *</span>
  27 |     | <span class='neutral'> * NOTE: In the upgradeable version of this contract, the cached values will correspond to the address, and the domain</span>
  28 |     | <span class='neutral'> * separator of the implementation contract. This will cause the `_domainSeparatorV4` function to always rebuild the</span>
  29 |     | <span class='neutral'> * separator from the immutable values, which is cheaper than accessing a cached version in cold storage.</span>
  30 |     | <span class='neutral'> *</span>
  31 |     | <span class='neutral'> * _Available since v3.4._</span>
  32 |     | <span class='neutral'> *</span>
  33 |     | <span class='neutral'> * @custom:oz-upgrades-unsafe-allow state-variable-immutable state-variable-assignment</span>
  34 |     | <span class='neutral'> */</span>
  35 |     | <span class='neutral'>abstract contract EIP712 is IERC5267 {</span>
  36 |     | <span class='neutral'>    using ShortStrings for *;</span>
  37 |     | <span class='neutral'></span>
  38 |     | <span class='neutral'>    bytes32 private constant _TYPE_HASH =</span>
  39 |     | <span class='unexecuted'>        keccak256(&quot;EIP712Domain(string name,string version,uint256 chainId,address verifyingContract)&quot;);</span>
  40 |     | <span class='neutral'></span>
  41 |     | <span class='neutral'>    // Cache the domain separator as an immutable value, but also store the chain id that it corresponds to, in order to</span>
  42 |     | <span class='neutral'>    // invalidate the cached domain separator if the chain id changes.</span>
  43 |     | <span class='neutral'>    bytes32 private immutable _cachedDomainSeparator;</span>
  44 |     | <span class='neutral'>    uint256 private immutable _cachedChainId;</span>
  45 |     | <span class='neutral'>    address private immutable _cachedThis;</span>
  46 |     | <span class='neutral'></span>
  47 |     | <span class='neutral'>    bytes32 private immutable _hashedName;</span>
  48 |     | <span class='neutral'>    bytes32 private immutable _hashedVersion;</span>
  49 |     | <span class='neutral'></span>
  50 |     | <span class='neutral'>    ShortString private immutable _name;</span>
  51 |     | <span class='neutral'>    ShortString private immutable _version;</span>
  52 |     | <span class='neutral'>    string private _nameFallback;</span>
  53 |     | <span class='neutral'>    string private _versionFallback;</span>
  54 |     | <span class='neutral'></span>
  55 |     | <span class='neutral'>    /**</span>
  56 |     | <span class='neutral'>     * @dev Initializes the domain separator and parameter caches.</span>
  57 |     | <span class='neutral'>     *</span>
  58 |     | <span class='neutral'>     * The meaning of `name` and `version` is specified in</span>
  59 |     | <span class='neutral'>     * https://eips.ethereum.org/EIPS/eip-712#definition-of-domainseparator[EIP 712]:</span>
  60 |     | <span class='neutral'>     *</span>
  61 |     | <span class='neutral'>     * - `name`: the user readable name of the signing domain, i.e. the name of the DApp or the protocol.</span>
  62 |     | <span class='neutral'>     * - `version`: the current major version of the signing domain.</span>
  63 |     | <span class='neutral'>     *</span>
  64 |     | <span class='neutral'>     * NOTE: These parameters cannot be changed except through a xref:learn::upgrading-smart-contracts.adoc[smart</span>
  65 |     | <span class='neutral'>     * contract upgrade].</span>
  66 |     | <span class='neutral'>     */</span>
  67 |     | <span class='unexecuted'>    constructor(string memory name, string memory version) {</span>
  68 |     | <span class='unexecuted'>        _name = name.toShortStringWithFallback(_nameFallback);</span>
  69 |     | <span class='unexecuted'>        _version = version.toShortStringWithFallback(_versionFallback);</span>
  70 |     | <span class='unexecuted'>        _hashedName = keccak256(bytes(name));</span>
  71 |     | <span class='unexecuted'>        _hashedVersion = keccak256(bytes(version));</span>
  72 |     | <span class='neutral'></span>
  73 |     | <span class='unexecuted'>        _cachedChainId = block.chainid;</span>
  74 |     | <span class='unexecuted'>        _cachedDomainSeparator = _buildDomainSeparator();</span>
  75 |     | <span class='unexecuted'>        _cachedThis = address(this);</span>
  76 |     | <span class='neutral'>    }</span>
  77 |     | <span class='neutral'></span>
  78 |     | <span class='neutral'>    /**</span>
  79 |     | <span class='neutral'>     * @dev Returns the domain separator for the current chain.</span>
  80 |     | <span class='neutral'>     */</span>
  81 |     | <span class='unexecuted'>    function _domainSeparatorV4() internal view returns (bytes32) {</span>
  82 |     | <span class='unexecuted'>        if (address(this) == _cachedThis &amp;&amp; block.chainid == _cachedChainId) {</span>
  83 |     | <span class='unexecuted'>            return _cachedDomainSeparator;</span>
  84 |     | <span class='neutral'>        } else {</span>
  85 |     | <span class='unexecuted'>            return _buildDomainSeparator();</span>
  86 |     | <span class='neutral'>        }</span>
  87 |     | <span class='neutral'>    }</span>
  88 |     | <span class='neutral'></span>
  89 |     | <span class='unexecuted'>    function _buildDomainSeparator() private view returns (bytes32) {</span>
  90 |     | <span class='unexecuted'>        return keccak256(abi.encode(_TYPE_HASH, _hashedName, _hashedVersion, block.chainid, address(this)));</span>
  91 |     | <span class='neutral'>    }</span>
  92 |     | <span class='neutral'></span>
  93 |     | <span class='neutral'>    /**</span>
  94 |     | <span class='neutral'>     * @dev Given an already https://eips.ethereum.org/EIPS/eip-712#definition-of-hashstruct[hashed struct], this</span>
  95 |     | <span class='neutral'>     * function returns the hash of the fully encoded EIP712 message for this domain.</span>
  96 |     | <span class='neutral'>     *</span>
  97 |     | <span class='neutral'>     * This hash can be used together with {ECDSA-recover} to obtain the signer of a message. For example:</span>
  98 |     | <span class='neutral'>     *</span>
  99 |     | <span class='neutral'>     * ```solidity</span>
 100 |     | <span class='neutral'>     * bytes32 digest = _hashTypedDataV4(keccak256(abi.encode(</span>
 101 |     | <span class='neutral'>     *     keccak256(&quot;Mail(address to,string contents)&quot;),</span>
 102 |     | <span class='neutral'>     *     mailTo,</span>
 103 |     | <span class='neutral'>     *     keccak256(bytes(mailContents))</span>
 104 |     | <span class='neutral'>     * )));</span>
 105 |     | <span class='neutral'>     * address signer = ECDSA.recover(digest, signature);</span>
 106 |     | <span class='neutral'>     * ```</span>
 107 |     | <span class='neutral'>     */</span>
 108 |     | <span class='unexecuted'>    function _hashTypedDataV4(bytes32 structHash) internal view virtual returns (bytes32) {</span>
 109 |     | <span class='unexecuted'>        return ECDSA.toTypedDataHash(_domainSeparatorV4(), structHash);</span>
 110 |     | <span class='neutral'>    }</span>
 111 |     | <span class='neutral'></span>
 112 |     | <span class='neutral'>    /**</span>
 113 |     | <span class='neutral'>     * @dev See {EIP-5267}.</span>
 114 |     | <span class='neutral'>     *</span>
 115 |     | <span class='neutral'>     * _Available since v4.9._</span>
 116 |     | <span class='neutral'>     */</span>
 117 |     | <span class='unexecuted'>    function eip712Domain()</span>
 118 |     | <span class='neutral'>        public</span>
 119 |     | <span class='neutral'>        view</span>
 120 |     | <span class='neutral'>        virtual</span>
 121 |     | <span class='neutral'>        override</span>
 122 |     | <span class='neutral'>        returns (</span>
 123 |     | <span class='unexecuted'>            bytes1 fields,</span>
 124 |     | <span class='unexecuted'>            string memory name,</span>
 125 |     | <span class='neutral'>            string memory version,</span>
 126 |     | <span class='neutral'>            uint256 chainId,</span>
 127 |     | <span class='neutral'>            address verifyingContract,</span>
 128 |     | <span class='neutral'>            bytes32 salt,</span>
 129 |     | <span class='neutral'>            uint256[] memory extensions</span>
 130 |     | <span class='neutral'>        )</span>
 131 |     | <span class='neutral'>    {</span>
 132 |     | <span class='unexecuted'>        return (</span>
 133 |     | <span class='neutral'>            hex&quot;0f&quot;, // 01111</span>
 134 |     | <span class='unexecuted'>            _name.toStringWithFallback(_nameFallback),</span>
 135 |     | <span class='unexecuted'>            _version.toStringWithFallback(_versionFallback),</span>
 136 |     | <span class='unexecuted'>            block.chainid,</span>
 137 |     | <span class='unexecuted'>            address(this),</span>
 138 |     | <span class='unexecuted'>            bytes32(0),</span>
 139 |     | <span class='unexecuted'>            new uint256[](0)</span>
 140 |     | <span class='neutral'>        );</span>
 141 |     | <span class='neutral'>    }</span>
 142 |     | <span class='neutral'>}</span>
 143 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/lib/openzeppelin-contracts/contracts/utils/introspection/ERC165.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts v4.4.1 (utils/introspection/ERC165.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>import &quot;./IERC165.sol&quot;;</span>
  7 |     | <span class='neutral'></span>
  8 |     | <span class='neutral'>/**</span>
  9 |     | <span class='neutral'> * @dev Implementation of the {IERC165} interface.</span>
 10 |     | <span class='neutral'> *</span>
 11 |     | <span class='neutral'> * Contracts that want to implement ERC165 should inherit from this contract and override {supportsInterface} to check</span>
 12 |     | <span class='neutral'> * for the additional interface id that will be supported. For example:</span>
 13 |     | <span class='neutral'> *</span>
 14 |     | <span class='neutral'> * ```solidity</span>
 15 |     | <span class='neutral'> * function supportsInterface(bytes4 interfaceId) public view virtual override returns (bool) {</span>
 16 |     | <span class='neutral'> *     return interfaceId == type(MyInterface).interfaceId || super.supportsInterface(interfaceId);</span>
 17 |     | <span class='neutral'> * }</span>
 18 |     | <span class='neutral'> * ```</span>
 19 |     | <span class='neutral'> *</span>
 20 |     | <span class='neutral'> * Alternatively, {ERC165Storage} provides an easier to use but more expensive implementation.</span>
 21 |     | <span class='neutral'> */</span>
 22 |     | <span class='neutral'>abstract contract ERC165 is IERC165 {</span>
 23 |     | <span class='neutral'>    /**</span>
 24 |     | <span class='neutral'>     * @dev See {IERC165-supportsInterface}.</span>
 25 |     | <span class='neutral'>     */</span>
 26 |     | <span class='neutral'>    function supportsInterface(bytes4 interfaceId) public view virtual override returns (bool) {</span>
 27 |     | <span class='unexecuted'>        return interfaceId == type(IERC165).interfaceId;</span>
 28 |     | <span class='neutral'>    }</span>
 29 |     | <span class='neutral'>}</span>
 30 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/lib/openzeppelin-contracts/contracts/utils/introspection/IERC165.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts v4.4.1 (utils/introspection/IERC165.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>/**</span>
  7 |     | <span class='neutral'> * @dev Interface of the ERC165 standard, as defined in the</span>
  8 |     | <span class='neutral'> * https://eips.ethereum.org/EIPS/eip-165[EIP].</span>
  9 |     | <span class='neutral'> *</span>
 10 |     | <span class='neutral'> * Implementers can declare support of contract interfaces, which can then be</span>
 11 |     | <span class='neutral'> * queried by others ({ERC165Checker}).</span>
 12 |     | <span class='neutral'> *</span>
 13 |     | <span class='neutral'> * For an implementation, see {ERC165}.</span>
 14 |     | <span class='neutral'> */</span>
 15 |     | <span class='neutral'>interface IERC165 {</span>
 16 |     | <span class='neutral'>    /**</span>
 17 |     | <span class='neutral'>     * @dev Returns true if this contract implements the interface defined by</span>
 18 |     | <span class='neutral'>     * `interfaceId`. See the corresponding</span>
 19 |     | <span class='neutral'>     * https://eips.ethereum.org/EIPS/eip-165#how-interfaces-are-identified[EIP section]</span>
 20 |     | <span class='neutral'>     * to learn more about how these ids are created.</span>
 21 |     | <span class='neutral'>     *</span>
 22 |     | <span class='neutral'>     * This function call must use less than 30 000 gas.</span>
 23 |     | <span class='neutral'>     */</span>
 24 |     | <span class='neutral'>    function supportsInterface(bytes4 interfaceId) external view returns (bool);</span>
 25 |     | <span class='neutral'>}</span>
 26 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/lib/openzeppelin-contracts/contracts/utils/math/Math.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (utils/math/Math.sol)</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
   5 |     | <span class='neutral'></span>
   6 |     | <span class='neutral'>/**</span>
   7 |     | <span class='neutral'> * @dev Standard math utilities missing in the Solidity language.</span>
   8 |     | <span class='neutral'> */</span>
   9 |     | <span class='unexecuted'>library Math {</span>
  10 |     | <span class='neutral'>    enum Rounding {</span>
  11 |     | <span class='neutral'>        Down, // Toward negative infinity</span>
  12 |     | <span class='neutral'>        Up, // Toward infinity</span>
  13 |     | <span class='neutral'>        Zero // Toward zero</span>
  14 |     | <span class='neutral'>    }</span>
  15 |     | <span class='neutral'></span>
  16 |     | <span class='neutral'>    /**</span>
  17 |     | <span class='neutral'>     * @dev Returns the largest of two numbers.</span>
  18 |     | <span class='neutral'>     */</span>
  19 |     | <span class='neutral'>    function max(uint256 a, uint256 b) internal pure returns (uint256) {</span>
  20 |     | <span class='neutral'>        return a &gt; b ? a : b;</span>
  21 |     | <span class='neutral'>    }</span>
  22 |     | <span class='neutral'></span>
  23 |     | <span class='neutral'>    /**</span>
  24 |     | <span class='neutral'>     * @dev Returns the smallest of two numbers.</span>
  25 |     | <span class='neutral'>     */</span>
  26 | *   | <span class='executed'>    function min(uint256 a, uint256 b) internal pure returns (uint256) {</span>
  27 | *   | <span class='executed'>        return a &lt; b ? a : b;</span>
  28 |     | <span class='neutral'>    }</span>
  29 |     | <span class='neutral'></span>
  30 |     | <span class='neutral'>    /**</span>
  31 |     | <span class='neutral'>     * @dev Returns the average of two numbers. The result is rounded towards</span>
  32 |     | <span class='neutral'>     * zero.</span>
  33 |     | <span class='neutral'>     */</span>
  34 |     | <span class='unexecuted'>    function average(uint256 a, uint256 b) internal pure returns (uint256) {</span>
  35 |     | <span class='neutral'>        // (a + b) / 2 can overflow.</span>
  36 |     | <span class='unexecuted'>        return (a &amp; b) + (a ^ b) / 2;</span>
  37 |     | <span class='neutral'>    }</span>
  38 |     | <span class='neutral'></span>
  39 |     | <span class='neutral'>    /**</span>
  40 |     | <span class='neutral'>     * @dev Returns the ceiling of the division of two numbers.</span>
  41 |     | <span class='neutral'>     *</span>
  42 |     | <span class='neutral'>     * This differs from standard division with `/` in that it rounds up instead</span>
  43 |     | <span class='neutral'>     * of rounding down.</span>
  44 |     | <span class='neutral'>     */</span>
  45 |     | <span class='neutral'>    function ceilDiv(uint256 a, uint256 b) internal pure returns (uint256) {</span>
  46 |     | <span class='neutral'>        // (a + b - 1) / b can overflow on addition, so we distribute.</span>
  47 |     | <span class='neutral'>        return a == 0 ? 0 : (a - 1) / b + 1;</span>
  48 |     | <span class='neutral'>    }</span>
  49 |     | <span class='neutral'></span>
  50 |     | <span class='neutral'>    /**</span>
  51 |     | <span class='neutral'>     * @notice Calculates floor(x * y / denominator) with full precision. Throws if result overflows a uint256 or denominator == 0</span>
  52 |     | <span class='neutral'>     * @dev Original credit to Remco Bloemen under MIT license (https://xn--2-umb.com/21/muldiv)</span>
  53 |     | <span class='neutral'>     * with further edits by Uniswap Labs also under MIT license.</span>
  54 |     | <span class='neutral'>     */</span>
  55 |     | <span class='neutral'>    function mulDiv(uint256 x, uint256 y, uint256 denominator) internal pure returns (uint256 result) {</span>
  56 |     | <span class='neutral'>        unchecked {</span>
  57 |     | <span class='neutral'>            // 512-bit multiply [prod1 prod0] = x * y. Compute the product mod 2^256 and mod 2^256 - 1, then use</span>
  58 |     | <span class='neutral'>            // use the Chinese Remainder Theorem to reconstruct the 512 bit result. The result is stored in two 256</span>
  59 |     | <span class='neutral'>            // variables such that product = prod1 * 2^256 + prod0.</span>
  60 |     | <span class='neutral'>            uint256 prod0; // Least significant 256 bits of the product</span>
  61 |     | <span class='neutral'>            uint256 prod1; // Most significant 256 bits of the product</span>
  62 |     | <span class='neutral'>            assembly {</span>
  63 |     | <span class='neutral'>                let mm := mulmod(x, y, not(0))</span>
  64 |     | <span class='neutral'>                prod0 := mul(x, y)</span>
  65 |     | <span class='neutral'>                prod1 := sub(sub(mm, prod0), lt(mm, prod0))</span>
  66 |     | <span class='neutral'>            }</span>
  67 |     | <span class='neutral'></span>
  68 |     | <span class='neutral'>            // Handle non-overflow cases, 256 by 256 division.</span>
  69 |     | <span class='neutral'>            if (prod1 == 0) {</span>
  70 |     | <span class='neutral'>                // Solidity will revert if denominator == 0, unlike the div opcode on its own.</span>
  71 |     | <span class='neutral'>                // The surrounding unchecked block does not change this fact.</span>
  72 |     | <span class='neutral'>                // See https://docs.soliditylang.org/en/latest/control-structures.html#checked-or-unchecked-arithmetic.</span>
  73 |     | <span class='neutral'>                return prod0 / denominator;</span>
  74 |     | <span class='neutral'>            }</span>
  75 |     | <span class='neutral'></span>
  76 |     | <span class='neutral'>            // Make sure the result is less than 2^256. Also prevents denominator == 0.</span>
  77 |     | <span class='neutral'>            require(denominator &gt; prod1, &quot;Math: mulDiv overflow&quot;);</span>
  78 |     | <span class='neutral'></span>
  79 |     | <span class='neutral'>            ///////////////////////////////////////////////</span>
  80 |     | <span class='neutral'>            // 512 by 256 division.</span>
  81 |     | <span class='neutral'>            ///////////////////////////////////////////////</span>
  82 |     | <span class='neutral'></span>
  83 |     | <span class='neutral'>            // Make division exact by subtracting the remainder from [prod1 prod0].</span>
  84 |     | <span class='neutral'>            uint256 remainder;</span>
  85 |     | <span class='neutral'>            assembly {</span>
  86 |     | <span class='neutral'>                // Compute remainder using mulmod.</span>
  87 |     | <span class='neutral'>                remainder := mulmod(x, y, denominator)</span>
  88 |     | <span class='neutral'></span>
  89 |     | <span class='neutral'>                // Subtract 256 bit number from 512 bit number.</span>
  90 |     | <span class='neutral'>                prod1 := sub(prod1, gt(remainder, prod0))</span>
  91 |     | <span class='neutral'>                prod0 := sub(prod0, remainder)</span>
  92 |     | <span class='neutral'>            }</span>
  93 |     | <span class='neutral'></span>
  94 |     | <span class='neutral'>            // Factor powers of two out of denominator and compute largest power of two divisor of denominator. Always &gt;= 1.</span>
  95 |     | <span class='neutral'>            // See https://cs.stackexchange.com/q/138556/92363.</span>
  96 |     | <span class='neutral'></span>
  97 |     | <span class='neutral'>            // Does not overflow because the denominator cannot be zero at this stage in the function.</span>
  98 |     | <span class='neutral'>            uint256 twos = denominator &amp; (~denominator + 1);</span>
  99 |     | <span class='neutral'>            assembly {</span>
 100 |     | <span class='neutral'>                // Divide denominator by twos.</span>
 101 |     | <span class='neutral'>                denominator := div(denominator, twos)</span>
 102 |     | <span class='neutral'></span>
 103 |     | <span class='neutral'>                // Divide [prod1 prod0] by twos.</span>
 104 |     | <span class='neutral'>                prod0 := div(prod0, twos)</span>
 105 |     | <span class='neutral'></span>
 106 |     | <span class='neutral'>                // Flip twos such that it is 2^256 / twos. If twos is zero, then it becomes one.</span>
 107 |     | <span class='neutral'>                twos := add(div(sub(0, twos), twos), 1)</span>
 108 |     | <span class='neutral'>            }</span>
 109 |     | <span class='neutral'></span>
 110 |     | <span class='neutral'>            // Shift in bits from prod1 into prod0.</span>
 111 |     | <span class='neutral'>            prod0 |= prod1 * twos;</span>
 112 |     | <span class='neutral'></span>
 113 |     | <span class='neutral'>            // Invert denominator mod 2^256. Now that denominator is an odd number, it has an inverse modulo 2^256 such</span>
 114 |     | <span class='neutral'>            // that denominator * inv = 1 mod 2^256. Compute the inverse by starting with a seed that is correct for</span>
 115 |     | <span class='neutral'>            // four bits. That is, denominator * inv = 1 mod 2^4.</span>
 116 |     | <span class='neutral'>            uint256 inverse = (3 * denominator) ^ 2;</span>
 117 |     | <span class='neutral'></span>
 118 |     | <span class='neutral'>            // Use the Newton-Raphson iteration to improve the precision. Thanks to Hensel&#39;s lifting lemma, this also works</span>
 119 |     | <span class='neutral'>            // in modular arithmetic, doubling the correct bits in each step.</span>
 120 |     | <span class='neutral'>            inverse *= 2 - denominator * inverse; // inverse mod 2^8</span>
 121 |     | <span class='neutral'>            inverse *= 2 - denominator * inverse; // inverse mod 2^16</span>
 122 |     | <span class='neutral'>            inverse *= 2 - denominator * inverse; // inverse mod 2^32</span>
 123 |     | <span class='neutral'>            inverse *= 2 - denominator * inverse; // inverse mod 2^64</span>
 124 |     | <span class='neutral'>            inverse *= 2 - denominator * inverse; // inverse mod 2^128</span>
 125 |     | <span class='neutral'>            inverse *= 2 - denominator * inverse; // inverse mod 2^256</span>
 126 |     | <span class='neutral'></span>
 127 |     | <span class='neutral'>            // Because the division is now exact we can divide by multiplying with the modular inverse of denominator.</span>
 128 |     | <span class='neutral'>            // This will give us the correct result modulo 2^256. Since the preconditions guarantee that the outcome is</span>
 129 |     | <span class='neutral'>            // less than 2^256, this is the final result. We don&#39;t need to compute the high bits of the result and prod1</span>
 130 |     | <span class='neutral'>            // is no longer required.</span>
 131 |     | <span class='neutral'>            result = prod0 * inverse;</span>
 132 |     | <span class='neutral'>            return result;</span>
 133 |     | <span class='neutral'>        }</span>
 134 |     | <span class='neutral'>    }</span>
 135 |     | <span class='neutral'></span>
 136 |     | <span class='neutral'>    /**</span>
 137 |     | <span class='neutral'>     * @notice Calculates x * y / denominator with full precision, following the selected rounding direction.</span>
 138 |     | <span class='neutral'>     */</span>
 139 |     | <span class='neutral'>    function mulDiv(uint256 x, uint256 y, uint256 denominator, Rounding rounding) internal pure returns (uint256) {</span>
 140 |     | <span class='neutral'>        uint256 result = mulDiv(x, y, denominator);</span>
 141 |     | <span class='neutral'>        if (rounding == Rounding.Up &amp;&amp; mulmod(x, y, denominator) &gt; 0) {</span>
 142 |     | <span class='neutral'>            result += 1;</span>
 143 |     | <span class='neutral'>        }</span>
 144 |     | <span class='neutral'>        return result;</span>
 145 |     | <span class='neutral'>    }</span>
 146 |     | <span class='neutral'></span>
 147 |     | <span class='neutral'>    /**</span>
 148 |     | <span class='neutral'>     * @dev Returns the square root of a number. If the number is not a perfect square, the value is rounded down.</span>
 149 |     | <span class='neutral'>     *</span>
 150 |     | <span class='neutral'>     * Inspired by Henry S. Warren, Jr.&#39;s &quot;Hacker&#39;s Delight&quot; (Chapter 11).</span>
 151 |     | <span class='neutral'>     */</span>
 152 |     | <span class='unexecuted'>    function sqrt(uint256 a) internal pure returns (uint256) {</span>
 153 |     | <span class='unexecuted'>        if (a == 0) {</span>
 154 |     | <span class='unexecuted'>            return 0;</span>
 155 |     | <span class='neutral'>        }</span>
 156 |     | <span class='neutral'></span>
 157 |     | <span class='neutral'>        // For our first guess, we get the biggest power of 2 which is smaller than the square root of the target.</span>
 158 |     | <span class='neutral'>        //</span>
 159 |     | <span class='neutral'>        // We know that the &quot;msb&quot; (most significant bit) of our target number `a` is a power of 2 such that we have</span>
 160 |     | <span class='neutral'>        // `msb(a) &lt;= a &lt; 2*msb(a)`. This value can be written `msb(a)=2**k` with `k=log2(a)`.</span>
 161 |     | <span class='neutral'>        //</span>
 162 |     | <span class='neutral'>        // This can be rewritten `2**log2(a) &lt;= a &lt; 2**(log2(a) + 1)`</span>
 163 |     | <span class='neutral'>        //  `sqrt(2**k) &lt;= sqrt(a) &lt; sqrt(2**(k+1))`</span>
 164 |     | <span class='neutral'>        //  `2**(k/2) &lt;= sqrt(a) &lt; 2**((k+1)/2) &lt;= 2**(k/2 + 1)`</span>
 165 |     | <span class='neutral'>        //</span>
 166 |     | <span class='neutral'>        // Consequently, `2**(log2(a) / 2)` is a good first approximation of `sqrt(a)` with at least 1 correct bit.</span>
 167 |     | <span class='unexecuted'>        uint256 result = 1 &lt;&lt; (log2(a) &gt;&gt; 1);</span>
 168 |     | <span class='neutral'></span>
 169 |     | <span class='neutral'>        // At this point `result` is an estimation with one bit of precision. We know the true value is a uint128,</span>
 170 |     | <span class='neutral'>        // since it is the square root of a uint256. Newton&#39;s method converges quadratically (precision doubles at</span>
 171 |     | <span class='neutral'>        // every iteration). We thus need at most 7 iteration to turn our partial result with one bit of precision</span>
 172 |     | <span class='neutral'>        // into the expected uint128 result.</span>
 173 |     | <span class='neutral'>        unchecked {</span>
 174 |     | <span class='unexecuted'>            result = (result + a / result) &gt;&gt; 1;</span>
 175 |     | <span class='unexecuted'>            result = (result + a / result) &gt;&gt; 1;</span>
 176 |     | <span class='unexecuted'>            result = (result + a / result) &gt;&gt; 1;</span>
 177 |     | <span class='unexecuted'>            result = (result + a / result) &gt;&gt; 1;</span>
 178 |     | <span class='unexecuted'>            result = (result + a / result) &gt;&gt; 1;</span>
 179 |     | <span class='unexecuted'>            result = (result + a / result) &gt;&gt; 1;</span>
 180 |     | <span class='unexecuted'>            result = (result + a / result) &gt;&gt; 1;</span>
 181 |     | <span class='unexecuted'>            return min(result, a / result);</span>
 182 |     | <span class='neutral'>        }</span>
 183 |     | <span class='neutral'>    }</span>
 184 |     | <span class='neutral'></span>
 185 |     | <span class='neutral'>    /**</span>
 186 |     | <span class='neutral'>     * @notice Calculates sqrt(a), following the selected rounding direction.</span>
 187 |     | <span class='neutral'>     */</span>
 188 |     | <span class='neutral'>    function sqrt(uint256 a, Rounding rounding) internal pure returns (uint256) {</span>
 189 |     | <span class='neutral'>        unchecked {</span>
 190 |     | <span class='neutral'>            uint256 result = sqrt(a);</span>
 191 |     | <span class='neutral'>            return result + (rounding == Rounding.Up &amp;&amp; result * result &lt; a ? 1 : 0);</span>
 192 |     | <span class='neutral'>        }</span>
 193 |     | <span class='neutral'>    }</span>
 194 |     | <span class='neutral'></span>
 195 |     | <span class='neutral'>    /**</span>
 196 |     | <span class='neutral'>     * @dev Return the log in base 2, rounded down, of a positive value.</span>
 197 |     | <span class='neutral'>     * Returns 0 if given 0.</span>
 198 |     | <span class='neutral'>     */</span>
 199 |     | <span class='unexecuted'>    function log2(uint256 value) internal pure returns (uint256) {</span>
 200 |     | <span class='neutral'>        uint256 result = 0;</span>
 201 |     | <span class='neutral'>        unchecked {</span>
 202 |     | <span class='unexecuted'>            if (value &gt;&gt; 128 &gt; 0) {</span>
 203 |     | <span class='unexecuted'>                value &gt;&gt;= 128;</span>
 204 |     | <span class='unexecuted'>                result += 128;</span>
 205 |     | <span class='neutral'>            }</span>
 206 |     | <span class='unexecuted'>            if (value &gt;&gt; 64 &gt; 0) {</span>
 207 |     | <span class='unexecuted'>                value &gt;&gt;= 64;</span>
 208 |     | <span class='unexecuted'>                result += 64;</span>
 209 |     | <span class='neutral'>            }</span>
 210 |     | <span class='unexecuted'>            if (value &gt;&gt; 32 &gt; 0) {</span>
 211 |     | <span class='unexecuted'>                value &gt;&gt;= 32;</span>
 212 |     | <span class='unexecuted'>                result += 32;</span>
 213 |     | <span class='neutral'>            }</span>
 214 |     | <span class='unexecuted'>            if (value &gt;&gt; 16 &gt; 0) {</span>
 215 |     | <span class='unexecuted'>                value &gt;&gt;= 16;</span>
 216 |     | <span class='unexecuted'>                result += 16;</span>
 217 |     | <span class='neutral'>            }</span>
 218 |     | <span class='unexecuted'>            if (value &gt;&gt; 8 &gt; 0) {</span>
 219 |     | <span class='unexecuted'>                value &gt;&gt;= 8;</span>
 220 |     | <span class='unexecuted'>                result += 8;</span>
 221 |     | <span class='neutral'>            }</span>
 222 |     | <span class='unexecuted'>            if (value &gt;&gt; 4 &gt; 0) {</span>
 223 |     | <span class='unexecuted'>                value &gt;&gt;= 4;</span>
 224 |     | <span class='unexecuted'>                result += 4;</span>
 225 |     | <span class='neutral'>            }</span>
 226 |     | <span class='unexecuted'>            if (value &gt;&gt; 2 &gt; 0) {</span>
 227 |     | <span class='unexecuted'>                value &gt;&gt;= 2;</span>
 228 |     | <span class='unexecuted'>                result += 2;</span>
 229 |     | <span class='neutral'>            }</span>
 230 |     | <span class='unexecuted'>            if (value &gt;&gt; 1 &gt; 0) {</span>
 231 |     | <span class='unexecuted'>                result += 1;</span>
 232 |     | <span class='neutral'>            }</span>
 233 |     | <span class='neutral'>        }</span>
 234 |     | <span class='unexecuted'>        return result;</span>
 235 |     | <span class='neutral'>    }</span>
 236 |     | <span class='neutral'></span>
 237 |     | <span class='neutral'>    /**</span>
 238 |     | <span class='neutral'>     * @dev Return the log in base 2, following the selected rounding direction, of a positive value.</span>
 239 |     | <span class='neutral'>     * Returns 0 if given 0.</span>
 240 |     | <span class='neutral'>     */</span>
 241 |     | <span class='neutral'>    function log2(uint256 value, Rounding rounding) internal pure returns (uint256) {</span>
 242 |     | <span class='neutral'>        unchecked {</span>
 243 |     | <span class='neutral'>            uint256 result = log2(value);</span>
 244 |     | <span class='neutral'>            return result + (rounding == Rounding.Up &amp;&amp; 1 &lt;&lt; result &lt; value ? 1 : 0);</span>
 245 |     | <span class='neutral'>        }</span>
 246 |     | <span class='neutral'>    }</span>
 247 |     | <span class='neutral'></span>
 248 |     | <span class='neutral'>    /**</span>
 249 |     | <span class='neutral'>     * @dev Return the log in base 10, rounded down, of a positive value.</span>
 250 |     | <span class='neutral'>     * Returns 0 if given 0.</span>
 251 |     | <span class='neutral'>     */</span>
 252 |     | <span class='neutral'>    function log10(uint256 value) internal pure returns (uint256) {</span>
 253 |     | <span class='neutral'>        uint256 result = 0;</span>
 254 |     | <span class='neutral'>        unchecked {</span>
 255 |     | <span class='neutral'>            if (value &gt;= 10 ** 64) {</span>
 256 |     | <span class='neutral'>                value /= 10 ** 64;</span>
 257 |     | <span class='neutral'>                result += 64;</span>
 258 |     | <span class='neutral'>            }</span>
 259 |     | <span class='neutral'>            if (value &gt;= 10 ** 32) {</span>
 260 |     | <span class='neutral'>                value /= 10 ** 32;</span>
 261 |     | <span class='neutral'>                result += 32;</span>
 262 |     | <span class='neutral'>            }</span>
 263 |     | <span class='neutral'>            if (value &gt;= 10 ** 16) {</span>
 264 |     | <span class='neutral'>                value /= 10 ** 16;</span>
 265 |     | <span class='neutral'>                result += 16;</span>
 266 |     | <span class='neutral'>            }</span>
 267 |     | <span class='neutral'>            if (value &gt;= 10 ** 8) {</span>
 268 |     | <span class='neutral'>                value /= 10 ** 8;</span>
 269 |     | <span class='neutral'>                result += 8;</span>
 270 |     | <span class='neutral'>            }</span>
 271 |     | <span class='neutral'>            if (value &gt;= 10 ** 4) {</span>
 272 |     | <span class='neutral'>                value /= 10 ** 4;</span>
 273 |     | <span class='neutral'>                result += 4;</span>
 274 |     | <span class='neutral'>            }</span>
 275 |     | <span class='neutral'>            if (value &gt;= 10 ** 2) {</span>
 276 |     | <span class='neutral'>                value /= 10 ** 2;</span>
 277 |     | <span class='neutral'>                result += 2;</span>
 278 |     | <span class='neutral'>            }</span>
 279 |     | <span class='neutral'>            if (value &gt;= 10 ** 1) {</span>
 280 |     | <span class='neutral'>                result += 1;</span>
 281 |     | <span class='neutral'>            }</span>
 282 |     | <span class='neutral'>        }</span>
 283 |     | <span class='neutral'>        return result;</span>
 284 |     | <span class='neutral'>    }</span>
 285 |     | <span class='neutral'></span>
 286 |     | <span class='neutral'>    /**</span>
 287 |     | <span class='neutral'>     * @dev Return the log in base 10, following the selected rounding direction, of a positive value.</span>
 288 |     | <span class='neutral'>     * Returns 0 if given 0.</span>
 289 |     | <span class='neutral'>     */</span>
 290 |     | <span class='neutral'>    function log10(uint256 value, Rounding rounding) internal pure returns (uint256) {</span>
 291 |     | <span class='neutral'>        unchecked {</span>
 292 |     | <span class='neutral'>            uint256 result = log10(value);</span>
 293 |     | <span class='neutral'>            return result + (rounding == Rounding.Up &amp;&amp; 10 ** result &lt; value ? 1 : 0);</span>
 294 |     | <span class='neutral'>        }</span>
 295 |     | <span class='neutral'>    }</span>
 296 |     | <span class='neutral'></span>
 297 |     | <span class='neutral'>    /**</span>
 298 |     | <span class='neutral'>     * @dev Return the log in base 256, rounded down, of a positive value.</span>
 299 |     | <span class='neutral'>     * Returns 0 if given 0.</span>
 300 |     | <span class='neutral'>     *</span>
 301 |     | <span class='neutral'>     * Adding one to the result gives the number of pairs of hex symbols needed to represent `value` as a hex string.</span>
 302 |     | <span class='neutral'>     */</span>
 303 |     | <span class='neutral'>    function log256(uint256 value) internal pure returns (uint256) {</span>
 304 |     | <span class='neutral'>        uint256 result = 0;</span>
 305 |     | <span class='neutral'>        unchecked {</span>
 306 |     | <span class='neutral'>            if (value &gt;&gt; 128 &gt; 0) {</span>
 307 |     | <span class='neutral'>                value &gt;&gt;= 128;</span>
 308 |     | <span class='neutral'>                result += 16;</span>
 309 |     | <span class='neutral'>            }</span>
 310 |     | <span class='neutral'>            if (value &gt;&gt; 64 &gt; 0) {</span>
 311 |     | <span class='neutral'>                value &gt;&gt;= 64;</span>
 312 |     | <span class='neutral'>                result += 8;</span>
 313 |     | <span class='neutral'>            }</span>
 314 |     | <span class='neutral'>            if (value &gt;&gt; 32 &gt; 0) {</span>
 315 |     | <span class='neutral'>                value &gt;&gt;= 32;</span>
 316 |     | <span class='neutral'>                result += 4;</span>
 317 |     | <span class='neutral'>            }</span>
 318 |     | <span class='neutral'>            if (value &gt;&gt; 16 &gt; 0) {</span>
 319 |     | <span class='neutral'>                value &gt;&gt;= 16;</span>
 320 |     | <span class='neutral'>                result += 2;</span>
 321 |     | <span class='neutral'>            }</span>
 322 |     | <span class='neutral'>            if (value &gt;&gt; 8 &gt; 0) {</span>
 323 |     | <span class='neutral'>                result += 1;</span>
 324 |     | <span class='neutral'>            }</span>
 325 |     | <span class='neutral'>        }</span>
 326 |     | <span class='neutral'>        return result;</span>
 327 |     | <span class='neutral'>    }</span>
 328 |     | <span class='neutral'></span>
 329 |     | <span class='neutral'>    /**</span>
 330 |     | <span class='neutral'>     * @dev Return the log in base 256, following the selected rounding direction, of a positive value.</span>
 331 |     | <span class='neutral'>     * Returns 0 if given 0.</span>
 332 |     | <span class='neutral'>     */</span>
 333 |     | <span class='neutral'>    function log256(uint256 value, Rounding rounding) internal pure returns (uint256) {</span>
 334 |     | <span class='neutral'>        unchecked {</span>
 335 |     | <span class='neutral'>            uint256 result = log256(value);</span>
 336 |     | <span class='neutral'>            return result + (rounding == Rounding.Up &amp;&amp; 1 &lt;&lt; (result &lt;&lt; 3) &lt; value ? 1 : 0);</span>
 337 |     | <span class='neutral'>        }</span>
 338 |     | <span class='neutral'>    }</span>
 339 |     | <span class='neutral'>}</span>
 340 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/lib/openzeppelin-contracts/contracts/utils/math/SafeCast.sol</b>
<code>
    1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
    2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.8.0) (utils/math/SafeCast.sol)</span>
    3 |     | <span class='neutral'>// This file was procedurally generated from scripts/generate/templates/SafeCast.js.</span>
    4 |     | <span class='neutral'></span>
    5 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
    6 |     | <span class='neutral'></span>
    7 |     | <span class='neutral'>/**</span>
    8 |     | <span class='neutral'> * @dev Wrappers over Solidity&#39;s uintXX/intXX casting operators with added overflow</span>
    9 |     | <span class='neutral'> * checks.</span>
   10 |     | <span class='neutral'> *</span>
   11 |     | <span class='neutral'> * Downcasting from uint256/int256 in Solidity does not revert on overflow. This can</span>
   12 |     | <span class='neutral'> * easily result in undesired exploitation or bugs, since developers usually</span>
   13 |     | <span class='neutral'> * assume that overflows raise errors. `SafeCast` restores this intuition by</span>
   14 |     | <span class='neutral'> * reverting the transaction when such an operation overflows.</span>
   15 |     | <span class='neutral'> *</span>
   16 |     | <span class='neutral'> * Using this library instead of the unchecked operations eliminates an entire</span>
   17 |     | <span class='neutral'> * class of bugs, so it&#39;s recommended to use it always.</span>
   18 |     | <span class='neutral'> *</span>
   19 |     | <span class='neutral'> * Can be combined with {SafeMath} and {SignedSafeMath} to extend it to smaller types, by performing</span>
   20 |     | <span class='neutral'> * all math on `uint256` and `int256` and then downcasting.</span>
   21 |     | <span class='neutral'> */</span>
   22 |     | <span class='unexecuted'>library SafeCast {</span>
   23 |     | <span class='neutral'>    /**</span>
   24 |     | <span class='neutral'>     * @dev Returns the downcasted uint248 from uint256, reverting on</span>
   25 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint248).</span>
   26 |     | <span class='neutral'>     *</span>
   27 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint248` operator.</span>
   28 |     | <span class='neutral'>     *</span>
   29 |     | <span class='neutral'>     * Requirements:</span>
   30 |     | <span class='neutral'>     *</span>
   31 |     | <span class='neutral'>     * - input must fit into 248 bits</span>
   32 |     | <span class='neutral'>     *</span>
   33 |     | <span class='neutral'>     * _Available since v4.7._</span>
   34 |     | <span class='neutral'>     */</span>
   35 |     | <span class='neutral'>    function toUint248(uint256 value) internal pure returns (uint248) {</span>
   36 |     | <span class='neutral'>        require(value &lt;= type(uint248).max, &quot;SafeCast: value doesn&#39;t fit in 248 bits&quot;);</span>
   37 |     | <span class='neutral'>        return uint248(value);</span>
   38 |     | <span class='neutral'>    }</span>
   39 |     | <span class='neutral'></span>
   40 |     | <span class='neutral'>    /**</span>
   41 |     | <span class='neutral'>     * @dev Returns the downcasted uint240 from uint256, reverting on</span>
   42 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint240).</span>
   43 |     | <span class='neutral'>     *</span>
   44 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint240` operator.</span>
   45 |     | <span class='neutral'>     *</span>
   46 |     | <span class='neutral'>     * Requirements:</span>
   47 |     | <span class='neutral'>     *</span>
   48 |     | <span class='neutral'>     * - input must fit into 240 bits</span>
   49 |     | <span class='neutral'>     *</span>
   50 |     | <span class='neutral'>     * _Available since v4.7._</span>
   51 |     | <span class='neutral'>     */</span>
   52 |     | <span class='neutral'>    function toUint240(uint256 value) internal pure returns (uint240) {</span>
   53 |     | <span class='neutral'>        require(value &lt;= type(uint240).max, &quot;SafeCast: value doesn&#39;t fit in 240 bits&quot;);</span>
   54 |     | <span class='neutral'>        return uint240(value);</span>
   55 |     | <span class='neutral'>    }</span>
   56 |     | <span class='neutral'></span>
   57 |     | <span class='neutral'>    /**</span>
   58 |     | <span class='neutral'>     * @dev Returns the downcasted uint232 from uint256, reverting on</span>
   59 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint232).</span>
   60 |     | <span class='neutral'>     *</span>
   61 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint232` operator.</span>
   62 |     | <span class='neutral'>     *</span>
   63 |     | <span class='neutral'>     * Requirements:</span>
   64 |     | <span class='neutral'>     *</span>
   65 |     | <span class='neutral'>     * - input must fit into 232 bits</span>
   66 |     | <span class='neutral'>     *</span>
   67 |     | <span class='neutral'>     * _Available since v4.7._</span>
   68 |     | <span class='neutral'>     */</span>
   69 |     | <span class='neutral'>    function toUint232(uint256 value) internal pure returns (uint232) {</span>
   70 |     | <span class='neutral'>        require(value &lt;= type(uint232).max, &quot;SafeCast: value doesn&#39;t fit in 232 bits&quot;);</span>
   71 |     | <span class='neutral'>        return uint232(value);</span>
   72 |     | <span class='neutral'>    }</span>
   73 |     | <span class='neutral'></span>
   74 |     | <span class='neutral'>    /**</span>
   75 |     | <span class='neutral'>     * @dev Returns the downcasted uint224 from uint256, reverting on</span>
   76 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint224).</span>
   77 |     | <span class='neutral'>     *</span>
   78 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint224` operator.</span>
   79 |     | <span class='neutral'>     *</span>
   80 |     | <span class='neutral'>     * Requirements:</span>
   81 |     | <span class='neutral'>     *</span>
   82 |     | <span class='neutral'>     * - input must fit into 224 bits</span>
   83 |     | <span class='neutral'>     *</span>
   84 |     | <span class='neutral'>     * _Available since v4.2._</span>
   85 |     | <span class='neutral'>     */</span>
   86 |     | <span class='unexecuted'>    function toUint224(uint256 value) internal pure returns (uint224) {</span>
   87 |     | <span class='unexecuted'>        require(value &lt;= type(uint224).max, &quot;SafeCast: value doesn&#39;t fit in 224 bits&quot;);</span>
   88 |     | <span class='neutral'>        return uint224(value);</span>
   89 |     | <span class='neutral'>    }</span>
   90 |     | <span class='neutral'></span>
   91 |     | <span class='neutral'>    /**</span>
   92 |     | <span class='neutral'>     * @dev Returns the downcasted uint216 from uint256, reverting on</span>
   93 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint216).</span>
   94 |     | <span class='neutral'>     *</span>
   95 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint216` operator.</span>
   96 |     | <span class='neutral'>     *</span>
   97 |     | <span class='neutral'>     * Requirements:</span>
   98 |     | <span class='neutral'>     *</span>
   99 |     | <span class='neutral'>     * - input must fit into 216 bits</span>
  100 |     | <span class='neutral'>     *</span>
  101 |     | <span class='neutral'>     * _Available since v4.7._</span>
  102 |     | <span class='neutral'>     */</span>
  103 |     | <span class='neutral'>    function toUint216(uint256 value) internal pure returns (uint216) {</span>
  104 |     | <span class='neutral'>        require(value &lt;= type(uint216).max, &quot;SafeCast: value doesn&#39;t fit in 216 bits&quot;);</span>
  105 |     | <span class='neutral'>        return uint216(value);</span>
  106 |     | <span class='neutral'>    }</span>
  107 |     | <span class='neutral'></span>
  108 |     | <span class='neutral'>    /**</span>
  109 |     | <span class='neutral'>     * @dev Returns the downcasted uint208 from uint256, reverting on</span>
  110 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint208).</span>
  111 |     | <span class='neutral'>     *</span>
  112 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint208` operator.</span>
  113 |     | <span class='neutral'>     *</span>
  114 |     | <span class='neutral'>     * Requirements:</span>
  115 |     | <span class='neutral'>     *</span>
  116 |     | <span class='neutral'>     * - input must fit into 208 bits</span>
  117 |     | <span class='neutral'>     *</span>
  118 |     | <span class='neutral'>     * _Available since v4.7._</span>
  119 |     | <span class='neutral'>     */</span>
  120 |     | <span class='neutral'>    function toUint208(uint256 value) internal pure returns (uint208) {</span>
  121 |     | <span class='neutral'>        require(value &lt;= type(uint208).max, &quot;SafeCast: value doesn&#39;t fit in 208 bits&quot;);</span>
  122 |     | <span class='neutral'>        return uint208(value);</span>
  123 |     | <span class='neutral'>    }</span>
  124 |     | <span class='neutral'></span>
  125 |     | <span class='neutral'>    /**</span>
  126 |     | <span class='neutral'>     * @dev Returns the downcasted uint200 from uint256, reverting on</span>
  127 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint200).</span>
  128 |     | <span class='neutral'>     *</span>
  129 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint200` operator.</span>
  130 |     | <span class='neutral'>     *</span>
  131 |     | <span class='neutral'>     * Requirements:</span>
  132 |     | <span class='neutral'>     *</span>
  133 |     | <span class='neutral'>     * - input must fit into 200 bits</span>
  134 |     | <span class='neutral'>     *</span>
  135 |     | <span class='neutral'>     * _Available since v4.7._</span>
  136 |     | <span class='neutral'>     */</span>
  137 |     | <span class='neutral'>    function toUint200(uint256 value) internal pure returns (uint200) {</span>
  138 |     | <span class='neutral'>        require(value &lt;= type(uint200).max, &quot;SafeCast: value doesn&#39;t fit in 200 bits&quot;);</span>
  139 |     | <span class='neutral'>        return uint200(value);</span>
  140 |     | <span class='neutral'>    }</span>
  141 |     | <span class='neutral'></span>
  142 |     | <span class='neutral'>    /**</span>
  143 |     | <span class='neutral'>     * @dev Returns the downcasted uint192 from uint256, reverting on</span>
  144 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint192).</span>
  145 |     | <span class='neutral'>     *</span>
  146 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint192` operator.</span>
  147 |     | <span class='neutral'>     *</span>
  148 |     | <span class='neutral'>     * Requirements:</span>
  149 |     | <span class='neutral'>     *</span>
  150 |     | <span class='neutral'>     * - input must fit into 192 bits</span>
  151 |     | <span class='neutral'>     *</span>
  152 |     | <span class='neutral'>     * _Available since v4.7._</span>
  153 |     | <span class='neutral'>     */</span>
  154 |     | <span class='neutral'>    function toUint192(uint256 value) internal pure returns (uint192) {</span>
  155 |     | <span class='neutral'>        require(value &lt;= type(uint192).max, &quot;SafeCast: value doesn&#39;t fit in 192 bits&quot;);</span>
  156 |     | <span class='neutral'>        return uint192(value);</span>
  157 |     | <span class='neutral'>    }</span>
  158 |     | <span class='neutral'></span>
  159 |     | <span class='neutral'>    /**</span>
  160 |     | <span class='neutral'>     * @dev Returns the downcasted uint184 from uint256, reverting on</span>
  161 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint184).</span>
  162 |     | <span class='neutral'>     *</span>
  163 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint184` operator.</span>
  164 |     | <span class='neutral'>     *</span>
  165 |     | <span class='neutral'>     * Requirements:</span>
  166 |     | <span class='neutral'>     *</span>
  167 |     | <span class='neutral'>     * - input must fit into 184 bits</span>
  168 |     | <span class='neutral'>     *</span>
  169 |     | <span class='neutral'>     * _Available since v4.7._</span>
  170 |     | <span class='neutral'>     */</span>
  171 |     | <span class='neutral'>    function toUint184(uint256 value) internal pure returns (uint184) {</span>
  172 |     | <span class='neutral'>        require(value &lt;= type(uint184).max, &quot;SafeCast: value doesn&#39;t fit in 184 bits&quot;);</span>
  173 |     | <span class='neutral'>        return uint184(value);</span>
  174 |     | <span class='neutral'>    }</span>
  175 |     | <span class='neutral'></span>
  176 |     | <span class='neutral'>    /**</span>
  177 |     | <span class='neutral'>     * @dev Returns the downcasted uint176 from uint256, reverting on</span>
  178 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint176).</span>
  179 |     | <span class='neutral'>     *</span>
  180 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint176` operator.</span>
  181 |     | <span class='neutral'>     *</span>
  182 |     | <span class='neutral'>     * Requirements:</span>
  183 |     | <span class='neutral'>     *</span>
  184 |     | <span class='neutral'>     * - input must fit into 176 bits</span>
  185 |     | <span class='neutral'>     *</span>
  186 |     | <span class='neutral'>     * _Available since v4.7._</span>
  187 |     | <span class='neutral'>     */</span>
  188 |     | <span class='neutral'>    function toUint176(uint256 value) internal pure returns (uint176) {</span>
  189 |     | <span class='neutral'>        require(value &lt;= type(uint176).max, &quot;SafeCast: value doesn&#39;t fit in 176 bits&quot;);</span>
  190 |     | <span class='neutral'>        return uint176(value);</span>
  191 |     | <span class='neutral'>    }</span>
  192 |     | <span class='neutral'></span>
  193 |     | <span class='neutral'>    /**</span>
  194 |     | <span class='neutral'>     * @dev Returns the downcasted uint168 from uint256, reverting on</span>
  195 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint168).</span>
  196 |     | <span class='neutral'>     *</span>
  197 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint168` operator.</span>
  198 |     | <span class='neutral'>     *</span>
  199 |     | <span class='neutral'>     * Requirements:</span>
  200 |     | <span class='neutral'>     *</span>
  201 |     | <span class='neutral'>     * - input must fit into 168 bits</span>
  202 |     | <span class='neutral'>     *</span>
  203 |     | <span class='neutral'>     * _Available since v4.7._</span>
  204 |     | <span class='neutral'>     */</span>
  205 |     | <span class='neutral'>    function toUint168(uint256 value) internal pure returns (uint168) {</span>
  206 |     | <span class='neutral'>        require(value &lt;= type(uint168).max, &quot;SafeCast: value doesn&#39;t fit in 168 bits&quot;);</span>
  207 |     | <span class='neutral'>        return uint168(value);</span>
  208 |     | <span class='neutral'>    }</span>
  209 |     | <span class='neutral'></span>
  210 |     | <span class='neutral'>    /**</span>
  211 |     | <span class='neutral'>     * @dev Returns the downcasted uint160 from uint256, reverting on</span>
  212 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint160).</span>
  213 |     | <span class='neutral'>     *</span>
  214 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint160` operator.</span>
  215 |     | <span class='neutral'>     *</span>
  216 |     | <span class='neutral'>     * Requirements:</span>
  217 |     | <span class='neutral'>     *</span>
  218 |     | <span class='neutral'>     * - input must fit into 160 bits</span>
  219 |     | <span class='neutral'>     *</span>
  220 |     | <span class='neutral'>     * _Available since v4.7._</span>
  221 |     | <span class='neutral'>     */</span>
  222 |     | <span class='neutral'>    function toUint160(uint256 value) internal pure returns (uint160) {</span>
  223 |     | <span class='neutral'>        require(value &lt;= type(uint160).max, &quot;SafeCast: value doesn&#39;t fit in 160 bits&quot;);</span>
  224 |     | <span class='neutral'>        return uint160(value);</span>
  225 |     | <span class='neutral'>    }</span>
  226 |     | <span class='neutral'></span>
  227 |     | <span class='neutral'>    /**</span>
  228 |     | <span class='neutral'>     * @dev Returns the downcasted uint152 from uint256, reverting on</span>
  229 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint152).</span>
  230 |     | <span class='neutral'>     *</span>
  231 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint152` operator.</span>
  232 |     | <span class='neutral'>     *</span>
  233 |     | <span class='neutral'>     * Requirements:</span>
  234 |     | <span class='neutral'>     *</span>
  235 |     | <span class='neutral'>     * - input must fit into 152 bits</span>
  236 |     | <span class='neutral'>     *</span>
  237 |     | <span class='neutral'>     * _Available since v4.7._</span>
  238 |     | <span class='neutral'>     */</span>
  239 |     | <span class='neutral'>    function toUint152(uint256 value) internal pure returns (uint152) {</span>
  240 |     | <span class='neutral'>        require(value &lt;= type(uint152).max, &quot;SafeCast: value doesn&#39;t fit in 152 bits&quot;);</span>
  241 |     | <span class='neutral'>        return uint152(value);</span>
  242 |     | <span class='neutral'>    }</span>
  243 |     | <span class='neutral'></span>
  244 |     | <span class='neutral'>    /**</span>
  245 |     | <span class='neutral'>     * @dev Returns the downcasted uint144 from uint256, reverting on</span>
  246 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint144).</span>
  247 |     | <span class='neutral'>     *</span>
  248 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint144` operator.</span>
  249 |     | <span class='neutral'>     *</span>
  250 |     | <span class='neutral'>     * Requirements:</span>
  251 |     | <span class='neutral'>     *</span>
  252 |     | <span class='neutral'>     * - input must fit into 144 bits</span>
  253 |     | <span class='neutral'>     *</span>
  254 |     | <span class='neutral'>     * _Available since v4.7._</span>
  255 |     | <span class='neutral'>     */</span>
  256 |     | <span class='neutral'>    function toUint144(uint256 value) internal pure returns (uint144) {</span>
  257 |     | <span class='neutral'>        require(value &lt;= type(uint144).max, &quot;SafeCast: value doesn&#39;t fit in 144 bits&quot;);</span>
  258 |     | <span class='neutral'>        return uint144(value);</span>
  259 |     | <span class='neutral'>    }</span>
  260 |     | <span class='neutral'></span>
  261 |     | <span class='neutral'>    /**</span>
  262 |     | <span class='neutral'>     * @dev Returns the downcasted uint136 from uint256, reverting on</span>
  263 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint136).</span>
  264 |     | <span class='neutral'>     *</span>
  265 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint136` operator.</span>
  266 |     | <span class='neutral'>     *</span>
  267 |     | <span class='neutral'>     * Requirements:</span>
  268 |     | <span class='neutral'>     *</span>
  269 |     | <span class='neutral'>     * - input must fit into 136 bits</span>
  270 |     | <span class='neutral'>     *</span>
  271 |     | <span class='neutral'>     * _Available since v4.7._</span>
  272 |     | <span class='neutral'>     */</span>
  273 |     | <span class='neutral'>    function toUint136(uint256 value) internal pure returns (uint136) {</span>
  274 |     | <span class='neutral'>        require(value &lt;= type(uint136).max, &quot;SafeCast: value doesn&#39;t fit in 136 bits&quot;);</span>
  275 |     | <span class='neutral'>        return uint136(value);</span>
  276 |     | <span class='neutral'>    }</span>
  277 |     | <span class='neutral'></span>
  278 |     | <span class='neutral'>    /**</span>
  279 |     | <span class='neutral'>     * @dev Returns the downcasted uint128 from uint256, reverting on</span>
  280 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint128).</span>
  281 |     | <span class='neutral'>     *</span>
  282 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint128` operator.</span>
  283 |     | <span class='neutral'>     *</span>
  284 |     | <span class='neutral'>     * Requirements:</span>
  285 |     | <span class='neutral'>     *</span>
  286 |     | <span class='neutral'>     * - input must fit into 128 bits</span>
  287 |     | <span class='neutral'>     *</span>
  288 |     | <span class='neutral'>     * _Available since v2.5._</span>
  289 |     | <span class='neutral'>     */</span>
  290 |     | <span class='neutral'>    function toUint128(uint256 value) internal pure returns (uint128) {</span>
  291 |     | <span class='neutral'>        require(value &lt;= type(uint128).max, &quot;SafeCast: value doesn&#39;t fit in 128 bits&quot;);</span>
  292 |     | <span class='neutral'>        return uint128(value);</span>
  293 |     | <span class='neutral'>    }</span>
  294 |     | <span class='neutral'></span>
  295 |     | <span class='neutral'>    /**</span>
  296 |     | <span class='neutral'>     * @dev Returns the downcasted uint120 from uint256, reverting on</span>
  297 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint120).</span>
  298 |     | <span class='neutral'>     *</span>
  299 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint120` operator.</span>
  300 |     | <span class='neutral'>     *</span>
  301 |     | <span class='neutral'>     * Requirements:</span>
  302 |     | <span class='neutral'>     *</span>
  303 |     | <span class='neutral'>     * - input must fit into 120 bits</span>
  304 |     | <span class='neutral'>     *</span>
  305 |     | <span class='neutral'>     * _Available since v4.7._</span>
  306 |     | <span class='neutral'>     */</span>
  307 |     | <span class='neutral'>    function toUint120(uint256 value) internal pure returns (uint120) {</span>
  308 |     | <span class='neutral'>        require(value &lt;= type(uint120).max, &quot;SafeCast: value doesn&#39;t fit in 120 bits&quot;);</span>
  309 |     | <span class='neutral'>        return uint120(value);</span>
  310 |     | <span class='neutral'>    }</span>
  311 |     | <span class='neutral'></span>
  312 |     | <span class='neutral'>    /**</span>
  313 |     | <span class='neutral'>     * @dev Returns the downcasted uint112 from uint256, reverting on</span>
  314 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint112).</span>
  315 |     | <span class='neutral'>     *</span>
  316 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint112` operator.</span>
  317 |     | <span class='neutral'>     *</span>
  318 |     | <span class='neutral'>     * Requirements:</span>
  319 |     | <span class='neutral'>     *</span>
  320 |     | <span class='neutral'>     * - input must fit into 112 bits</span>
  321 |     | <span class='neutral'>     *</span>
  322 |     | <span class='neutral'>     * _Available since v4.7._</span>
  323 |     | <span class='neutral'>     */</span>
  324 |     | <span class='neutral'>    function toUint112(uint256 value) internal pure returns (uint112) {</span>
  325 |     | <span class='neutral'>        require(value &lt;= type(uint112).max, &quot;SafeCast: value doesn&#39;t fit in 112 bits&quot;);</span>
  326 |     | <span class='neutral'>        return uint112(value);</span>
  327 |     | <span class='neutral'>    }</span>
  328 |     | <span class='neutral'></span>
  329 |     | <span class='neutral'>    /**</span>
  330 |     | <span class='neutral'>     * @dev Returns the downcasted uint104 from uint256, reverting on</span>
  331 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint104).</span>
  332 |     | <span class='neutral'>     *</span>
  333 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint104` operator.</span>
  334 |     | <span class='neutral'>     *</span>
  335 |     | <span class='neutral'>     * Requirements:</span>
  336 |     | <span class='neutral'>     *</span>
  337 |     | <span class='neutral'>     * - input must fit into 104 bits</span>
  338 |     | <span class='neutral'>     *</span>
  339 |     | <span class='neutral'>     * _Available since v4.7._</span>
  340 |     | <span class='neutral'>     */</span>
  341 |     | <span class='neutral'>    function toUint104(uint256 value) internal pure returns (uint104) {</span>
  342 |     | <span class='neutral'>        require(value &lt;= type(uint104).max, &quot;SafeCast: value doesn&#39;t fit in 104 bits&quot;);</span>
  343 |     | <span class='neutral'>        return uint104(value);</span>
  344 |     | <span class='neutral'>    }</span>
  345 |     | <span class='neutral'></span>
  346 |     | <span class='neutral'>    /**</span>
  347 |     | <span class='neutral'>     * @dev Returns the downcasted uint96 from uint256, reverting on</span>
  348 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint96).</span>
  349 |     | <span class='neutral'>     *</span>
  350 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint96` operator.</span>
  351 |     | <span class='neutral'>     *</span>
  352 |     | <span class='neutral'>     * Requirements:</span>
  353 |     | <span class='neutral'>     *</span>
  354 |     | <span class='neutral'>     * - input must fit into 96 bits</span>
  355 |     | <span class='neutral'>     *</span>
  356 |     | <span class='neutral'>     * _Available since v4.2._</span>
  357 |     | <span class='neutral'>     */</span>
  358 |     | <span class='neutral'>    function toUint96(uint256 value) internal pure returns (uint96) {</span>
  359 |     | <span class='neutral'>        require(value &lt;= type(uint96).max, &quot;SafeCast: value doesn&#39;t fit in 96 bits&quot;);</span>
  360 |     | <span class='neutral'>        return uint96(value);</span>
  361 |     | <span class='neutral'>    }</span>
  362 |     | <span class='neutral'></span>
  363 |     | <span class='neutral'>    /**</span>
  364 |     | <span class='neutral'>     * @dev Returns the downcasted uint88 from uint256, reverting on</span>
  365 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint88).</span>
  366 |     | <span class='neutral'>     *</span>
  367 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint88` operator.</span>
  368 |     | <span class='neutral'>     *</span>
  369 |     | <span class='neutral'>     * Requirements:</span>
  370 |     | <span class='neutral'>     *</span>
  371 |     | <span class='neutral'>     * - input must fit into 88 bits</span>
  372 |     | <span class='neutral'>     *</span>
  373 |     | <span class='neutral'>     * _Available since v4.7._</span>
  374 |     | <span class='neutral'>     */</span>
  375 |     | <span class='neutral'>    function toUint88(uint256 value) internal pure returns (uint88) {</span>
  376 |     | <span class='neutral'>        require(value &lt;= type(uint88).max, &quot;SafeCast: value doesn&#39;t fit in 88 bits&quot;);</span>
  377 |     | <span class='neutral'>        return uint88(value);</span>
  378 |     | <span class='neutral'>    }</span>
  379 |     | <span class='neutral'></span>
  380 |     | <span class='neutral'>    /**</span>
  381 |     | <span class='neutral'>     * @dev Returns the downcasted uint80 from uint256, reverting on</span>
  382 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint80).</span>
  383 |     | <span class='neutral'>     *</span>
  384 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint80` operator.</span>
  385 |     | <span class='neutral'>     *</span>
  386 |     | <span class='neutral'>     * Requirements:</span>
  387 |     | <span class='neutral'>     *</span>
  388 |     | <span class='neutral'>     * - input must fit into 80 bits</span>
  389 |     | <span class='neutral'>     *</span>
  390 |     | <span class='neutral'>     * _Available since v4.7._</span>
  391 |     | <span class='neutral'>     */</span>
  392 |     | <span class='neutral'>    function toUint80(uint256 value) internal pure returns (uint80) {</span>
  393 |     | <span class='neutral'>        require(value &lt;= type(uint80).max, &quot;SafeCast: value doesn&#39;t fit in 80 bits&quot;);</span>
  394 |     | <span class='neutral'>        return uint80(value);</span>
  395 |     | <span class='neutral'>    }</span>
  396 |     | <span class='neutral'></span>
  397 |     | <span class='neutral'>    /**</span>
  398 |     | <span class='neutral'>     * @dev Returns the downcasted uint72 from uint256, reverting on</span>
  399 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint72).</span>
  400 |     | <span class='neutral'>     *</span>
  401 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint72` operator.</span>
  402 |     | <span class='neutral'>     *</span>
  403 |     | <span class='neutral'>     * Requirements:</span>
  404 |     | <span class='neutral'>     *</span>
  405 |     | <span class='neutral'>     * - input must fit into 72 bits</span>
  406 |     | <span class='neutral'>     *</span>
  407 |     | <span class='neutral'>     * _Available since v4.7._</span>
  408 |     | <span class='neutral'>     */</span>
  409 |     | <span class='neutral'>    function toUint72(uint256 value) internal pure returns (uint72) {</span>
  410 |     | <span class='neutral'>        require(value &lt;= type(uint72).max, &quot;SafeCast: value doesn&#39;t fit in 72 bits&quot;);</span>
  411 |     | <span class='neutral'>        return uint72(value);</span>
  412 |     | <span class='neutral'>    }</span>
  413 |     | <span class='neutral'></span>
  414 |     | <span class='neutral'>    /**</span>
  415 |     | <span class='neutral'>     * @dev Returns the downcasted uint64 from uint256, reverting on</span>
  416 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint64).</span>
  417 |     | <span class='neutral'>     *</span>
  418 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint64` operator.</span>
  419 |     | <span class='neutral'>     *</span>
  420 |     | <span class='neutral'>     * Requirements:</span>
  421 |     | <span class='neutral'>     *</span>
  422 |     | <span class='neutral'>     * - input must fit into 64 bits</span>
  423 |     | <span class='neutral'>     *</span>
  424 |     | <span class='neutral'>     * _Available since v2.5._</span>
  425 |     | <span class='neutral'>     */</span>
  426 |     | <span class='unexecuted'>    function toUint64(uint256 value) internal pure returns (uint64) {</span>
  427 |     | <span class='unexecuted'>        require(value &lt;= type(uint64).max, &quot;SafeCast: value doesn&#39;t fit in 64 bits&quot;);</span>
  428 |     | <span class='unexecuted'>        return uint64(value);</span>
  429 |     | <span class='neutral'>    }</span>
  430 |     | <span class='neutral'></span>
  431 |     | <span class='neutral'>    /**</span>
  432 |     | <span class='neutral'>     * @dev Returns the downcasted uint56 from uint256, reverting on</span>
  433 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint56).</span>
  434 |     | <span class='neutral'>     *</span>
  435 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint56` operator.</span>
  436 |     | <span class='neutral'>     *</span>
  437 |     | <span class='neutral'>     * Requirements:</span>
  438 |     | <span class='neutral'>     *</span>
  439 |     | <span class='neutral'>     * - input must fit into 56 bits</span>
  440 |     | <span class='neutral'>     *</span>
  441 |     | <span class='neutral'>     * _Available since v4.7._</span>
  442 |     | <span class='neutral'>     */</span>
  443 |     | <span class='neutral'>    function toUint56(uint256 value) internal pure returns (uint56) {</span>
  444 |     | <span class='neutral'>        require(value &lt;= type(uint56).max, &quot;SafeCast: value doesn&#39;t fit in 56 bits&quot;);</span>
  445 |     | <span class='neutral'>        return uint56(value);</span>
  446 |     | <span class='neutral'>    }</span>
  447 |     | <span class='neutral'></span>
  448 |     | <span class='neutral'>    /**</span>
  449 |     | <span class='neutral'>     * @dev Returns the downcasted uint48 from uint256, reverting on</span>
  450 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint48).</span>
  451 |     | <span class='neutral'>     *</span>
  452 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint48` operator.</span>
  453 |     | <span class='neutral'>     *</span>
  454 |     | <span class='neutral'>     * Requirements:</span>
  455 |     | <span class='neutral'>     *</span>
  456 |     | <span class='neutral'>     * - input must fit into 48 bits</span>
  457 |     | <span class='neutral'>     *</span>
  458 |     | <span class='neutral'>     * _Available since v4.7._</span>
  459 |     | <span class='neutral'>     */</span>
  460 |     | <span class='unexecuted'>    function toUint48(uint256 value) internal pure returns (uint48) {</span>
  461 |     | <span class='unexecuted'>        require(value &lt;= type(uint48).max, &quot;SafeCast: value doesn&#39;t fit in 48 bits&quot;);</span>
  462 |     | <span class='neutral'>        return uint48(value);</span>
  463 |     | <span class='neutral'>    }</span>
  464 |     | <span class='neutral'></span>
  465 |     | <span class='neutral'>    /**</span>
  466 |     | <span class='neutral'>     * @dev Returns the downcasted uint40 from uint256, reverting on</span>
  467 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint40).</span>
  468 |     | <span class='neutral'>     *</span>
  469 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint40` operator.</span>
  470 |     | <span class='neutral'>     *</span>
  471 |     | <span class='neutral'>     * Requirements:</span>
  472 |     | <span class='neutral'>     *</span>
  473 |     | <span class='neutral'>     * - input must fit into 40 bits</span>
  474 |     | <span class='neutral'>     *</span>
  475 |     | <span class='neutral'>     * _Available since v4.7._</span>
  476 |     | <span class='neutral'>     */</span>
  477 |     | <span class='neutral'>    function toUint40(uint256 value) internal pure returns (uint40) {</span>
  478 |     | <span class='neutral'>        require(value &lt;= type(uint40).max, &quot;SafeCast: value doesn&#39;t fit in 40 bits&quot;);</span>
  479 |     | <span class='neutral'>        return uint40(value);</span>
  480 |     | <span class='neutral'>    }</span>
  481 |     | <span class='neutral'></span>
  482 |     | <span class='neutral'>    /**</span>
  483 |     | <span class='neutral'>     * @dev Returns the downcasted uint32 from uint256, reverting on</span>
  484 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint32).</span>
  485 |     | <span class='neutral'>     *</span>
  486 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint32` operator.</span>
  487 |     | <span class='neutral'>     *</span>
  488 |     | <span class='neutral'>     * Requirements:</span>
  489 |     | <span class='neutral'>     *</span>
  490 |     | <span class='neutral'>     * - input must fit into 32 bits</span>
  491 |     | <span class='neutral'>     *</span>
  492 |     | <span class='neutral'>     * _Available since v2.5._</span>
  493 |     | <span class='neutral'>     */</span>
  494 |     | <span class='unexecuted'>    function toUint32(uint256 value) internal pure returns (uint32) {</span>
  495 |     | <span class='unexecuted'>        require(value &lt;= type(uint32).max, &quot;SafeCast: value doesn&#39;t fit in 32 bits&quot;);</span>
  496 |     | <span class='unexecuted'>        return uint32(value);</span>
  497 |     | <span class='neutral'>    }</span>
  498 |     | <span class='neutral'></span>
  499 |     | <span class='neutral'>    /**</span>
  500 |     | <span class='neutral'>     * @dev Returns the downcasted uint24 from uint256, reverting on</span>
  501 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint24).</span>
  502 |     | <span class='neutral'>     *</span>
  503 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint24` operator.</span>
  504 |     | <span class='neutral'>     *</span>
  505 |     | <span class='neutral'>     * Requirements:</span>
  506 |     | <span class='neutral'>     *</span>
  507 |     | <span class='neutral'>     * - input must fit into 24 bits</span>
  508 |     | <span class='neutral'>     *</span>
  509 |     | <span class='neutral'>     * _Available since v4.7._</span>
  510 |     | <span class='neutral'>     */</span>
  511 |     | <span class='neutral'>    function toUint24(uint256 value) internal pure returns (uint24) {</span>
  512 |     | <span class='neutral'>        require(value &lt;= type(uint24).max, &quot;SafeCast: value doesn&#39;t fit in 24 bits&quot;);</span>
  513 |     | <span class='neutral'>        return uint24(value);</span>
  514 |     | <span class='neutral'>    }</span>
  515 |     | <span class='neutral'></span>
  516 |     | <span class='neutral'>    /**</span>
  517 |     | <span class='neutral'>     * @dev Returns the downcasted uint16 from uint256, reverting on</span>
  518 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint16).</span>
  519 |     | <span class='neutral'>     *</span>
  520 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint16` operator.</span>
  521 |     | <span class='neutral'>     *</span>
  522 |     | <span class='neutral'>     * Requirements:</span>
  523 |     | <span class='neutral'>     *</span>
  524 |     | <span class='neutral'>     * - input must fit into 16 bits</span>
  525 |     | <span class='neutral'>     *</span>
  526 |     | <span class='neutral'>     * _Available since v2.5._</span>
  527 |     | <span class='neutral'>     */</span>
  528 |     | <span class='neutral'>    function toUint16(uint256 value) internal pure returns (uint16) {</span>
  529 |     | <span class='neutral'>        require(value &lt;= type(uint16).max, &quot;SafeCast: value doesn&#39;t fit in 16 bits&quot;);</span>
  530 |     | <span class='neutral'>        return uint16(value);</span>
  531 |     | <span class='neutral'>    }</span>
  532 |     | <span class='neutral'></span>
  533 |     | <span class='neutral'>    /**</span>
  534 |     | <span class='neutral'>     * @dev Returns the downcasted uint8 from uint256, reverting on</span>
  535 |     | <span class='neutral'>     * overflow (when the input is greater than largest uint8).</span>
  536 |     | <span class='neutral'>     *</span>
  537 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `uint8` operator.</span>
  538 |     | <span class='neutral'>     *</span>
  539 |     | <span class='neutral'>     * Requirements:</span>
  540 |     | <span class='neutral'>     *</span>
  541 |     | <span class='neutral'>     * - input must fit into 8 bits</span>
  542 |     | <span class='neutral'>     *</span>
  543 |     | <span class='neutral'>     * _Available since v2.5._</span>
  544 |     | <span class='neutral'>     */</span>
  545 |     | <span class='neutral'>    function toUint8(uint256 value) internal pure returns (uint8) {</span>
  546 |     | <span class='neutral'>        require(value &lt;= type(uint8).max, &quot;SafeCast: value doesn&#39;t fit in 8 bits&quot;);</span>
  547 |     | <span class='neutral'>        return uint8(value);</span>
  548 |     | <span class='neutral'>    }</span>
  549 |     | <span class='neutral'></span>
  550 |     | <span class='neutral'>    /**</span>
  551 |     | <span class='neutral'>     * @dev Converts a signed int256 into an unsigned uint256.</span>
  552 |     | <span class='neutral'>     *</span>
  553 |     | <span class='neutral'>     * Requirements:</span>
  554 |     | <span class='neutral'>     *</span>
  555 |     | <span class='neutral'>     * - input must be greater than or equal to 0.</span>
  556 |     | <span class='neutral'>     *</span>
  557 |     | <span class='neutral'>     * _Available since v3.0._</span>
  558 |     | <span class='neutral'>     */</span>
  559 |     | <span class='neutral'>    function toUint256(int256 value) internal pure returns (uint256) {</span>
  560 |     | <span class='neutral'>        require(value &gt;= 0, &quot;SafeCast: value must be positive&quot;);</span>
  561 |     | <span class='neutral'>        return uint256(value);</span>
  562 |     | <span class='neutral'>    }</span>
  563 |     | <span class='neutral'></span>
  564 |     | <span class='neutral'>    /**</span>
  565 |     | <span class='neutral'>     * @dev Returns the downcasted int248 from int256, reverting on</span>
  566 |     | <span class='neutral'>     * overflow (when the input is less than smallest int248 or</span>
  567 |     | <span class='neutral'>     * greater than largest int248).</span>
  568 |     | <span class='neutral'>     *</span>
  569 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int248` operator.</span>
  570 |     | <span class='neutral'>     *</span>
  571 |     | <span class='neutral'>     * Requirements:</span>
  572 |     | <span class='neutral'>     *</span>
  573 |     | <span class='neutral'>     * - input must fit into 248 bits</span>
  574 |     | <span class='neutral'>     *</span>
  575 |     | <span class='neutral'>     * _Available since v4.7._</span>
  576 |     | <span class='neutral'>     */</span>
  577 |     | <span class='neutral'>    function toInt248(int256 value) internal pure returns (int248 downcasted) {</span>
  578 |     | <span class='neutral'>        downcasted = int248(value);</span>
  579 |     | <span class='neutral'>        require(downcasted == value, &quot;SafeCast: value doesn&#39;t fit in 248 bits&quot;);</span>
  580 |     | <span class='neutral'>    }</span>
  581 |     | <span class='neutral'></span>
  582 |     | <span class='neutral'>    /**</span>
  583 |     | <span class='neutral'>     * @dev Returns the downcasted int240 from int256, reverting on</span>
  584 |     | <span class='neutral'>     * overflow (when the input is less than smallest int240 or</span>
  585 |     | <span class='neutral'>     * greater than largest int240).</span>
  586 |     | <span class='neutral'>     *</span>
  587 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int240` operator.</span>
  588 |     | <span class='neutral'>     *</span>
  589 |     | <span class='neutral'>     * Requirements:</span>
  590 |     | <span class='neutral'>     *</span>
  591 |     | <span class='neutral'>     * - input must fit into 240 bits</span>
  592 |     | <span class='neutral'>     *</span>
  593 |     | <span class='neutral'>     * _Available since v4.7._</span>
  594 |     | <span class='neutral'>     */</span>
  595 |     | <span class='neutral'>    function toInt240(int256 value) internal pure returns (int240 downcasted) {</span>
  596 |     | <span class='neutral'>        downcasted = int240(value);</span>
  597 |     | <span class='neutral'>        require(downcasted == value, &quot;SafeCast: value doesn&#39;t fit in 240 bits&quot;);</span>
  598 |     | <span class='neutral'>    }</span>
  599 |     | <span class='neutral'></span>
  600 |     | <span class='neutral'>    /**</span>
  601 |     | <span class='neutral'>     * @dev Returns the downcasted int232 from int256, reverting on</span>
  602 |     | <span class='neutral'>     * overflow (when the input is less than smallest int232 or</span>
  603 |     | <span class='neutral'>     * greater than largest int232).</span>
  604 |     | <span class='neutral'>     *</span>
  605 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int232` operator.</span>
  606 |     | <span class='neutral'>     *</span>
  607 |     | <span class='neutral'>     * Requirements:</span>
  608 |     | <span class='neutral'>     *</span>
  609 |     | <span class='neutral'>     * - input must fit into 232 bits</span>
  610 |     | <span class='neutral'>     *</span>
  611 |     | <span class='neutral'>     * _Available since v4.7._</span>
  612 |     | <span class='neutral'>     */</span>
  613 |     | <span class='neutral'>    function toInt232(int256 value) internal pure returns (int232 downcasted) {</span>
  614 |     | <span class='neutral'>        downcasted = int232(value);</span>
  615 |     | <span class='neutral'>        require(downcasted == value, &quot;SafeCast: value doesn&#39;t fit in 232 bits&quot;);</span>
  616 |     | <span class='neutral'>    }</span>
  617 |     | <span class='neutral'></span>
  618 |     | <span class='neutral'>    /**</span>
  619 |     | <span class='neutral'>     * @dev Returns the downcasted int224 from int256, reverting on</span>
  620 |     | <span class='neutral'>     * overflow (when the input is less than smallest int224 or</span>
  621 |     | <span class='neutral'>     * greater than largest int224).</span>
  622 |     | <span class='neutral'>     *</span>
  623 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int224` operator.</span>
  624 |     | <span class='neutral'>     *</span>
  625 |     | <span class='neutral'>     * Requirements:</span>
  626 |     | <span class='neutral'>     *</span>
  627 |     | <span class='neutral'>     * - input must fit into 224 bits</span>
  628 |     | <span class='neutral'>     *</span>
  629 |     | <span class='neutral'>     * _Available since v4.7._</span>
  630 |     | <span class='neutral'>     */</span>
  631 |     | <span class='neutral'>    function toInt224(int256 value) internal pure returns (int224 downcasted) {</span>
  632 |     | <span class='neutral'>        downcasted = int224(value);</span>
  633 |     | <span class='neutral'>        require(downcasted == value, &quot;SafeCast: value doesn&#39;t fit in 224 bits&quot;);</span>
  634 |     | <span class='neutral'>    }</span>
  635 |     | <span class='neutral'></span>
  636 |     | <span class='neutral'>    /**</span>
  637 |     | <span class='neutral'>     * @dev Returns the downcasted int216 from int256, reverting on</span>
  638 |     | <span class='neutral'>     * overflow (when the input is less than smallest int216 or</span>
  639 |     | <span class='neutral'>     * greater than largest int216).</span>
  640 |     | <span class='neutral'>     *</span>
  641 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int216` operator.</span>
  642 |     | <span class='neutral'>     *</span>
  643 |     | <span class='neutral'>     * Requirements:</span>
  644 |     | <span class='neutral'>     *</span>
  645 |     | <span class='neutral'>     * - input must fit into 216 bits</span>
  646 |     | <span class='neutral'>     *</span>
  647 |     | <span class='neutral'>     * _Available since v4.7._</span>
  648 |     | <span class='neutral'>     */</span>
  649 |     | <span class='neutral'>    function toInt216(int256 value) internal pure returns (int216 downcasted) {</span>
  650 |     | <span class='neutral'>        downcasted = int216(value);</span>
  651 |     | <span class='neutral'>        require(downcasted == value, &quot;SafeCast: value doesn&#39;t fit in 216 bits&quot;);</span>
  652 |     | <span class='neutral'>    }</span>
  653 |     | <span class='neutral'></span>
  654 |     | <span class='neutral'>    /**</span>
  655 |     | <span class='neutral'>     * @dev Returns the downcasted int208 from int256, reverting on</span>
  656 |     | <span class='neutral'>     * overflow (when the input is less than smallest int208 or</span>
  657 |     | <span class='neutral'>     * greater than largest int208).</span>
  658 |     | <span class='neutral'>     *</span>
  659 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int208` operator.</span>
  660 |     | <span class='neutral'>     *</span>
  661 |     | <span class='neutral'>     * Requirements:</span>
  662 |     | <span class='neutral'>     *</span>
  663 |     | <span class='neutral'>     * - input must fit into 208 bits</span>
  664 |     | <span class='neutral'>     *</span>
  665 |     | <span class='neutral'>     * _Available since v4.7._</span>
  666 |     | <span class='neutral'>     */</span>
  667 |     | <span class='neutral'>    function toInt208(int256 value) internal pure returns (int208 downcasted) {</span>
  668 |     | <span class='neutral'>        downcasted = int208(value);</span>
  669 |     | <span class='neutral'>        require(downcasted == value, &quot;SafeCast: value doesn&#39;t fit in 208 bits&quot;);</span>
  670 |     | <span class='neutral'>    }</span>
  671 |     | <span class='neutral'></span>
  672 |     | <span class='neutral'>    /**</span>
  673 |     | <span class='neutral'>     * @dev Returns the downcasted int200 from int256, reverting on</span>
  674 |     | <span class='neutral'>     * overflow (when the input is less than smallest int200 or</span>
  675 |     | <span class='neutral'>     * greater than largest int200).</span>
  676 |     | <span class='neutral'>     *</span>
  677 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int200` operator.</span>
  678 |     | <span class='neutral'>     *</span>
  679 |     | <span class='neutral'>     * Requirements:</span>
  680 |     | <span class='neutral'>     *</span>
  681 |     | <span class='neutral'>     * - input must fit into 200 bits</span>
  682 |     | <span class='neutral'>     *</span>
  683 |     | <span class='neutral'>     * _Available since v4.7._</span>
  684 |     | <span class='neutral'>     */</span>
  685 |     | <span class='neutral'>    function toInt200(int256 value) internal pure returns (int200 downcasted) {</span>
  686 |     | <span class='neutral'>        downcasted = int200(value);</span>
  687 |     | <span class='neutral'>        require(downcasted == value, &quot;SafeCast: value doesn&#39;t fit in 200 bits&quot;);</span>
  688 |     | <span class='neutral'>    }</span>
  689 |     | <span class='neutral'></span>
  690 |     | <span class='neutral'>    /**</span>
  691 |     | <span class='neutral'>     * @dev Returns the downcasted int192 from int256, reverting on</span>
  692 |     | <span class='neutral'>     * overflow (when the input is less than smallest int192 or</span>
  693 |     | <span class='neutral'>     * greater than largest int192).</span>
  694 |     | <span class='neutral'>     *</span>
  695 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int192` operator.</span>
  696 |     | <span class='neutral'>     *</span>
  697 |     | <span class='neutral'>     * Requirements:</span>
  698 |     | <span class='neutral'>     *</span>
  699 |     | <span class='neutral'>     * - input must fit into 192 bits</span>
  700 |     | <span class='neutral'>     *</span>
  701 |     | <span class='neutral'>     * _Available since v4.7._</span>
  702 |     | <span class='neutral'>     */</span>
  703 |     | <span class='neutral'>    function toInt192(int256 value) internal pure returns (int192 downcasted) {</span>
  704 |     | <span class='neutral'>        downcasted = int192(value);</span>
  705 |     | <span class='neutral'>        require(downcasted == value, &quot;SafeCast: value doesn&#39;t fit in 192 bits&quot;);</span>
  706 |     | <span class='neutral'>    }</span>
  707 |     | <span class='neutral'></span>
  708 |     | <span class='neutral'>    /**</span>
  709 |     | <span class='neutral'>     * @dev Returns the downcasted int184 from int256, reverting on</span>
  710 |     | <span class='neutral'>     * overflow (when the input is less than smallest int184 or</span>
  711 |     | <span class='neutral'>     * greater than largest int184).</span>
  712 |     | <span class='neutral'>     *</span>
  713 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int184` operator.</span>
  714 |     | <span class='neutral'>     *</span>
  715 |     | <span class='neutral'>     * Requirements:</span>
  716 |     | <span class='neutral'>     *</span>
  717 |     | <span class='neutral'>     * - input must fit into 184 bits</span>
  718 |     | <span class='neutral'>     *</span>
  719 |     | <span class='neutral'>     * _Available since v4.7._</span>
  720 |     | <span class='neutral'>     */</span>
  721 |     | <span class='neutral'>    function toInt184(int256 value) internal pure returns (int184 downcasted) {</span>
  722 |     | <span class='neutral'>        downcasted = int184(value);</span>
  723 |     | <span class='neutral'>        require(downcasted == value, &quot;SafeCast: value doesn&#39;t fit in 184 bits&quot;);</span>
  724 |     | <span class='neutral'>    }</span>
  725 |     | <span class='neutral'></span>
  726 |     | <span class='neutral'>    /**</span>
  727 |     | <span class='neutral'>     * @dev Returns the downcasted int176 from int256, reverting on</span>
  728 |     | <span class='neutral'>     * overflow (when the input is less than smallest int176 or</span>
  729 |     | <span class='neutral'>     * greater than largest int176).</span>
  730 |     | <span class='neutral'>     *</span>
  731 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int176` operator.</span>
  732 |     | <span class='neutral'>     *</span>
  733 |     | <span class='neutral'>     * Requirements:</span>
  734 |     | <span class='neutral'>     *</span>
  735 |     | <span class='neutral'>     * - input must fit into 176 bits</span>
  736 |     | <span class='neutral'>     *</span>
  737 |     | <span class='neutral'>     * _Available since v4.7._</span>
  738 |     | <span class='neutral'>     */</span>
  739 |     | <span class='neutral'>    function toInt176(int256 value) internal pure returns (int176 downcasted) {</span>
  740 |     | <span class='neutral'>        downcasted = int176(value);</span>
  741 |     | <span class='neutral'>        require(downcasted == value, &quot;SafeCast: value doesn&#39;t fit in 176 bits&quot;);</span>
  742 |     | <span class='neutral'>    }</span>
  743 |     | <span class='neutral'></span>
  744 |     | <span class='neutral'>    /**</span>
  745 |     | <span class='neutral'>     * @dev Returns the downcasted int168 from int256, reverting on</span>
  746 |     | <span class='neutral'>     * overflow (when the input is less than smallest int168 or</span>
  747 |     | <span class='neutral'>     * greater than largest int168).</span>
  748 |     | <span class='neutral'>     *</span>
  749 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int168` operator.</span>
  750 |     | <span class='neutral'>     *</span>
  751 |     | <span class='neutral'>     * Requirements:</span>
  752 |     | <span class='neutral'>     *</span>
  753 |     | <span class='neutral'>     * - input must fit into 168 bits</span>
  754 |     | <span class='neutral'>     *</span>
  755 |     | <span class='neutral'>     * _Available since v4.7._</span>
  756 |     | <span class='neutral'>     */</span>
  757 |     | <span class='neutral'>    function toInt168(int256 value) internal pure returns (int168 downcasted) {</span>
  758 |     | <span class='neutral'>        downcasted = int168(value);</span>
  759 |     | <span class='neutral'>        require(downcasted == value, &quot;SafeCast: value doesn&#39;t fit in 168 bits&quot;);</span>
  760 |     | <span class='neutral'>    }</span>
  761 |     | <span class='neutral'></span>
  762 |     | <span class='neutral'>    /**</span>
  763 |     | <span class='neutral'>     * @dev Returns the downcasted int160 from int256, reverting on</span>
  764 |     | <span class='neutral'>     * overflow (when the input is less than smallest int160 or</span>
  765 |     | <span class='neutral'>     * greater than largest int160).</span>
  766 |     | <span class='neutral'>     *</span>
  767 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int160` operator.</span>
  768 |     | <span class='neutral'>     *</span>
  769 |     | <span class='neutral'>     * Requirements:</span>
  770 |     | <span class='neutral'>     *</span>
  771 |     | <span class='neutral'>     * - input must fit into 160 bits</span>
  772 |     | <span class='neutral'>     *</span>
  773 |     | <span class='neutral'>     * _Available since v4.7._</span>
  774 |     | <span class='neutral'>     */</span>
  775 |     | <span class='neutral'>    function toInt160(int256 value) internal pure returns (int160 downcasted) {</span>
  776 |     | <span class='neutral'>        downcasted = int160(value);</span>
  777 |     | <span class='neutral'>        require(downcasted == value, &quot;SafeCast: value doesn&#39;t fit in 160 bits&quot;);</span>
  778 |     | <span class='neutral'>    }</span>
  779 |     | <span class='neutral'></span>
  780 |     | <span class='neutral'>    /**</span>
  781 |     | <span class='neutral'>     * @dev Returns the downcasted int152 from int256, reverting on</span>
  782 |     | <span class='neutral'>     * overflow (when the input is less than smallest int152 or</span>
  783 |     | <span class='neutral'>     * greater than largest int152).</span>
  784 |     | <span class='neutral'>     *</span>
  785 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int152` operator.</span>
  786 |     | <span class='neutral'>     *</span>
  787 |     | <span class='neutral'>     * Requirements:</span>
  788 |     | <span class='neutral'>     *</span>
  789 |     | <span class='neutral'>     * - input must fit into 152 bits</span>
  790 |     | <span class='neutral'>     *</span>
  791 |     | <span class='neutral'>     * _Available since v4.7._</span>
  792 |     | <span class='neutral'>     */</span>
  793 |     | <span class='neutral'>    function toInt152(int256 value) internal pure returns (int152 downcasted) {</span>
  794 |     | <span class='neutral'>        downcasted = int152(value);</span>
  795 |     | <span class='neutral'>        require(downcasted == value, &quot;SafeCast: value doesn&#39;t fit in 152 bits&quot;);</span>
  796 |     | <span class='neutral'>    }</span>
  797 |     | <span class='neutral'></span>
  798 |     | <span class='neutral'>    /**</span>
  799 |     | <span class='neutral'>     * @dev Returns the downcasted int144 from int256, reverting on</span>
  800 |     | <span class='neutral'>     * overflow (when the input is less than smallest int144 or</span>
  801 |     | <span class='neutral'>     * greater than largest int144).</span>
  802 |     | <span class='neutral'>     *</span>
  803 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int144` operator.</span>
  804 |     | <span class='neutral'>     *</span>
  805 |     | <span class='neutral'>     * Requirements:</span>
  806 |     | <span class='neutral'>     *</span>
  807 |     | <span class='neutral'>     * - input must fit into 144 bits</span>
  808 |     | <span class='neutral'>     *</span>
  809 |     | <span class='neutral'>     * _Available since v4.7._</span>
  810 |     | <span class='neutral'>     */</span>
  811 |     | <span class='neutral'>    function toInt144(int256 value) internal pure returns (int144 downcasted) {</span>
  812 |     | <span class='neutral'>        downcasted = int144(value);</span>
  813 |     | <span class='neutral'>        require(downcasted == value, &quot;SafeCast: value doesn&#39;t fit in 144 bits&quot;);</span>
  814 |     | <span class='neutral'>    }</span>
  815 |     | <span class='neutral'></span>
  816 |     | <span class='neutral'>    /**</span>
  817 |     | <span class='neutral'>     * @dev Returns the downcasted int136 from int256, reverting on</span>
  818 |     | <span class='neutral'>     * overflow (when the input is less than smallest int136 or</span>
  819 |     | <span class='neutral'>     * greater than largest int136).</span>
  820 |     | <span class='neutral'>     *</span>
  821 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int136` operator.</span>
  822 |     | <span class='neutral'>     *</span>
  823 |     | <span class='neutral'>     * Requirements:</span>
  824 |     | <span class='neutral'>     *</span>
  825 |     | <span class='neutral'>     * - input must fit into 136 bits</span>
  826 |     | <span class='neutral'>     *</span>
  827 |     | <span class='neutral'>     * _Available since v4.7._</span>
  828 |     | <span class='neutral'>     */</span>
  829 |     | <span class='neutral'>    function toInt136(int256 value) internal pure returns (int136 downcasted) {</span>
  830 |     | <span class='neutral'>        downcasted = int136(value);</span>
  831 |     | <span class='neutral'>        require(downcasted == value, &quot;SafeCast: value doesn&#39;t fit in 136 bits&quot;);</span>
  832 |     | <span class='neutral'>    }</span>
  833 |     | <span class='neutral'></span>
  834 |     | <span class='neutral'>    /**</span>
  835 |     | <span class='neutral'>     * @dev Returns the downcasted int128 from int256, reverting on</span>
  836 |     | <span class='neutral'>     * overflow (when the input is less than smallest int128 or</span>
  837 |     | <span class='neutral'>     * greater than largest int128).</span>
  838 |     | <span class='neutral'>     *</span>
  839 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int128` operator.</span>
  840 |     | <span class='neutral'>     *</span>
  841 |     | <span class='neutral'>     * Requirements:</span>
  842 |     | <span class='neutral'>     *</span>
  843 |     | <span class='neutral'>     * - input must fit into 128 bits</span>
  844 |     | <span class='neutral'>     *</span>
  845 |     | <span class='neutral'>     * _Available since v3.1._</span>
  846 |     | <span class='neutral'>     */</span>
  847 |     | <span class='neutral'>    function toInt128(int256 value) internal pure returns (int128 downcasted) {</span>
  848 |     | <span class='neutral'>        downcasted = int128(value);</span>
  849 |     | <span class='neutral'>        require(downcasted == value, &quot;SafeCast: value doesn&#39;t fit in 128 bits&quot;);</span>
  850 |     | <span class='neutral'>    }</span>
  851 |     | <span class='neutral'></span>
  852 |     | <span class='neutral'>    /**</span>
  853 |     | <span class='neutral'>     * @dev Returns the downcasted int120 from int256, reverting on</span>
  854 |     | <span class='neutral'>     * overflow (when the input is less than smallest int120 or</span>
  855 |     | <span class='neutral'>     * greater than largest int120).</span>
  856 |     | <span class='neutral'>     *</span>
  857 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int120` operator.</span>
  858 |     | <span class='neutral'>     *</span>
  859 |     | <span class='neutral'>     * Requirements:</span>
  860 |     | <span class='neutral'>     *</span>
  861 |     | <span class='neutral'>     * - input must fit into 120 bits</span>
  862 |     | <span class='neutral'>     *</span>
  863 |     | <span class='neutral'>     * _Available since v4.7._</span>
  864 |     | <span class='neutral'>     */</span>
  865 |     | <span class='neutral'>    function toInt120(int256 value) internal pure returns (int120 downcasted) {</span>
  866 |     | <span class='neutral'>        downcasted = int120(value);</span>
  867 |     | <span class='neutral'>        require(downcasted == value, &quot;SafeCast: value doesn&#39;t fit in 120 bits&quot;);</span>
  868 |     | <span class='neutral'>    }</span>
  869 |     | <span class='neutral'></span>
  870 |     | <span class='neutral'>    /**</span>
  871 |     | <span class='neutral'>     * @dev Returns the downcasted int112 from int256, reverting on</span>
  872 |     | <span class='neutral'>     * overflow (when the input is less than smallest int112 or</span>
  873 |     | <span class='neutral'>     * greater than largest int112).</span>
  874 |     | <span class='neutral'>     *</span>
  875 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int112` operator.</span>
  876 |     | <span class='neutral'>     *</span>
  877 |     | <span class='neutral'>     * Requirements:</span>
  878 |     | <span class='neutral'>     *</span>
  879 |     | <span class='neutral'>     * - input must fit into 112 bits</span>
  880 |     | <span class='neutral'>     *</span>
  881 |     | <span class='neutral'>     * _Available since v4.7._</span>
  882 |     | <span class='neutral'>     */</span>
  883 |     | <span class='neutral'>    function toInt112(int256 value) internal pure returns (int112 downcasted) {</span>
  884 |     | <span class='neutral'>        downcasted = int112(value);</span>
  885 |     | <span class='neutral'>        require(downcasted == value, &quot;SafeCast: value doesn&#39;t fit in 112 bits&quot;);</span>
  886 |     | <span class='neutral'>    }</span>
  887 |     | <span class='neutral'></span>
  888 |     | <span class='neutral'>    /**</span>
  889 |     | <span class='neutral'>     * @dev Returns the downcasted int104 from int256, reverting on</span>
  890 |     | <span class='neutral'>     * overflow (when the input is less than smallest int104 or</span>
  891 |     | <span class='neutral'>     * greater than largest int104).</span>
  892 |     | <span class='neutral'>     *</span>
  893 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int104` operator.</span>
  894 |     | <span class='neutral'>     *</span>
  895 |     | <span class='neutral'>     * Requirements:</span>
  896 |     | <span class='neutral'>     *</span>
  897 |     | <span class='neutral'>     * - input must fit into 104 bits</span>
  898 |     | <span class='neutral'>     *</span>
  899 |     | <span class='neutral'>     * _Available since v4.7._</span>
  900 |     | <span class='neutral'>     */</span>
  901 |     | <span class='neutral'>    function toInt104(int256 value) internal pure returns (int104 downcasted) {</span>
  902 |     | <span class='neutral'>        downcasted = int104(value);</span>
  903 |     | <span class='neutral'>        require(downcasted == value, &quot;SafeCast: value doesn&#39;t fit in 104 bits&quot;);</span>
  904 |     | <span class='neutral'>    }</span>
  905 |     | <span class='neutral'></span>
  906 |     | <span class='neutral'>    /**</span>
  907 |     | <span class='neutral'>     * @dev Returns the downcasted int96 from int256, reverting on</span>
  908 |     | <span class='neutral'>     * overflow (when the input is less than smallest int96 or</span>
  909 |     | <span class='neutral'>     * greater than largest int96).</span>
  910 |     | <span class='neutral'>     *</span>
  911 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int96` operator.</span>
  912 |     | <span class='neutral'>     *</span>
  913 |     | <span class='neutral'>     * Requirements:</span>
  914 |     | <span class='neutral'>     *</span>
  915 |     | <span class='neutral'>     * - input must fit into 96 bits</span>
  916 |     | <span class='neutral'>     *</span>
  917 |     | <span class='neutral'>     * _Available since v4.7._</span>
  918 |     | <span class='neutral'>     */</span>
  919 |     | <span class='neutral'>    function toInt96(int256 value) internal pure returns (int96 downcasted) {</span>
  920 |     | <span class='neutral'>        downcasted = int96(value);</span>
  921 |     | <span class='neutral'>        require(downcasted == value, &quot;SafeCast: value doesn&#39;t fit in 96 bits&quot;);</span>
  922 |     | <span class='neutral'>    }</span>
  923 |     | <span class='neutral'></span>
  924 |     | <span class='neutral'>    /**</span>
  925 |     | <span class='neutral'>     * @dev Returns the downcasted int88 from int256, reverting on</span>
  926 |     | <span class='neutral'>     * overflow (when the input is less than smallest int88 or</span>
  927 |     | <span class='neutral'>     * greater than largest int88).</span>
  928 |     | <span class='neutral'>     *</span>
  929 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int88` operator.</span>
  930 |     | <span class='neutral'>     *</span>
  931 |     | <span class='neutral'>     * Requirements:</span>
  932 |     | <span class='neutral'>     *</span>
  933 |     | <span class='neutral'>     * - input must fit into 88 bits</span>
  934 |     | <span class='neutral'>     *</span>
  935 |     | <span class='neutral'>     * _Available since v4.7._</span>
  936 |     | <span class='neutral'>     */</span>
  937 |     | <span class='neutral'>    function toInt88(int256 value) internal pure returns (int88 downcasted) {</span>
  938 |     | <span class='neutral'>        downcasted = int88(value);</span>
  939 |     | <span class='neutral'>        require(downcasted == value, &quot;SafeCast: value doesn&#39;t fit in 88 bits&quot;);</span>
  940 |     | <span class='neutral'>    }</span>
  941 |     | <span class='neutral'></span>
  942 |     | <span class='neutral'>    /**</span>
  943 |     | <span class='neutral'>     * @dev Returns the downcasted int80 from int256, reverting on</span>
  944 |     | <span class='neutral'>     * overflow (when the input is less than smallest int80 or</span>
  945 |     | <span class='neutral'>     * greater than largest int80).</span>
  946 |     | <span class='neutral'>     *</span>
  947 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int80` operator.</span>
  948 |     | <span class='neutral'>     *</span>
  949 |     | <span class='neutral'>     * Requirements:</span>
  950 |     | <span class='neutral'>     *</span>
  951 |     | <span class='neutral'>     * - input must fit into 80 bits</span>
  952 |     | <span class='neutral'>     *</span>
  953 |     | <span class='neutral'>     * _Available since v4.7._</span>
  954 |     | <span class='neutral'>     */</span>
  955 |     | <span class='neutral'>    function toInt80(int256 value) internal pure returns (int80 downcasted) {</span>
  956 |     | <span class='neutral'>        downcasted = int80(value);</span>
  957 |     | <span class='neutral'>        require(downcasted == value, &quot;SafeCast: value doesn&#39;t fit in 80 bits&quot;);</span>
  958 |     | <span class='neutral'>    }</span>
  959 |     | <span class='neutral'></span>
  960 |     | <span class='neutral'>    /**</span>
  961 |     | <span class='neutral'>     * @dev Returns the downcasted int72 from int256, reverting on</span>
  962 |     | <span class='neutral'>     * overflow (when the input is less than smallest int72 or</span>
  963 |     | <span class='neutral'>     * greater than largest int72).</span>
  964 |     | <span class='neutral'>     *</span>
  965 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int72` operator.</span>
  966 |     | <span class='neutral'>     *</span>
  967 |     | <span class='neutral'>     * Requirements:</span>
  968 |     | <span class='neutral'>     *</span>
  969 |     | <span class='neutral'>     * - input must fit into 72 bits</span>
  970 |     | <span class='neutral'>     *</span>
  971 |     | <span class='neutral'>     * _Available since v4.7._</span>
  972 |     | <span class='neutral'>     */</span>
  973 |     | <span class='neutral'>    function toInt72(int256 value) internal pure returns (int72 downcasted) {</span>
  974 |     | <span class='neutral'>        downcasted = int72(value);</span>
  975 |     | <span class='neutral'>        require(downcasted == value, &quot;SafeCast: value doesn&#39;t fit in 72 bits&quot;);</span>
  976 |     | <span class='neutral'>    }</span>
  977 |     | <span class='neutral'></span>
  978 |     | <span class='neutral'>    /**</span>
  979 |     | <span class='neutral'>     * @dev Returns the downcasted int64 from int256, reverting on</span>
  980 |     | <span class='neutral'>     * overflow (when the input is less than smallest int64 or</span>
  981 |     | <span class='neutral'>     * greater than largest int64).</span>
  982 |     | <span class='neutral'>     *</span>
  983 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int64` operator.</span>
  984 |     | <span class='neutral'>     *</span>
  985 |     | <span class='neutral'>     * Requirements:</span>
  986 |     | <span class='neutral'>     *</span>
  987 |     | <span class='neutral'>     * - input must fit into 64 bits</span>
  988 |     | <span class='neutral'>     *</span>
  989 |     | <span class='neutral'>     * _Available since v3.1._</span>
  990 |     | <span class='neutral'>     */</span>
  991 |     | <span class='neutral'>    function toInt64(int256 value) internal pure returns (int64 downcasted) {</span>
  992 |     | <span class='neutral'>        downcasted = int64(value);</span>
  993 |     | <span class='neutral'>        require(downcasted == value, &quot;SafeCast: value doesn&#39;t fit in 64 bits&quot;);</span>
  994 |     | <span class='neutral'>    }</span>
  995 |     | <span class='neutral'></span>
  996 |     | <span class='neutral'>    /**</span>
  997 |     | <span class='neutral'>     * @dev Returns the downcasted int56 from int256, reverting on</span>
  998 |     | <span class='neutral'>     * overflow (when the input is less than smallest int56 or</span>
  999 |     | <span class='neutral'>     * greater than largest int56).</span>
 1000 |     | <span class='neutral'>     *</span>
 1001 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int56` operator.</span>
 1002 |     | <span class='neutral'>     *</span>
 1003 |     | <span class='neutral'>     * Requirements:</span>
 1004 |     | <span class='neutral'>     *</span>
 1005 |     | <span class='neutral'>     * - input must fit into 56 bits</span>
 1006 |     | <span class='neutral'>     *</span>
 1007 |     | <span class='neutral'>     * _Available since v4.7._</span>
 1008 |     | <span class='neutral'>     */</span>
 1009 |     | <span class='neutral'>    function toInt56(int256 value) internal pure returns (int56 downcasted) {</span>
 1010 |     | <span class='neutral'>        downcasted = int56(value);</span>
 1011 |     | <span class='neutral'>        require(downcasted == value, &quot;SafeCast: value doesn&#39;t fit in 56 bits&quot;);</span>
 1012 |     | <span class='neutral'>    }</span>
 1013 |     | <span class='neutral'></span>
 1014 |     | <span class='neutral'>    /**</span>
 1015 |     | <span class='neutral'>     * @dev Returns the downcasted int48 from int256, reverting on</span>
 1016 |     | <span class='neutral'>     * overflow (when the input is less than smallest int48 or</span>
 1017 |     | <span class='neutral'>     * greater than largest int48).</span>
 1018 |     | <span class='neutral'>     *</span>
 1019 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int48` operator.</span>
 1020 |     | <span class='neutral'>     *</span>
 1021 |     | <span class='neutral'>     * Requirements:</span>
 1022 |     | <span class='neutral'>     *</span>
 1023 |     | <span class='neutral'>     * - input must fit into 48 bits</span>
 1024 |     | <span class='neutral'>     *</span>
 1025 |     | <span class='neutral'>     * _Available since v4.7._</span>
 1026 |     | <span class='neutral'>     */</span>
 1027 |     | <span class='neutral'>    function toInt48(int256 value) internal pure returns (int48 downcasted) {</span>
 1028 |     | <span class='neutral'>        downcasted = int48(value);</span>
 1029 |     | <span class='neutral'>        require(downcasted == value, &quot;SafeCast: value doesn&#39;t fit in 48 bits&quot;);</span>
 1030 |     | <span class='neutral'>    }</span>
 1031 |     | <span class='neutral'></span>
 1032 |     | <span class='neutral'>    /**</span>
 1033 |     | <span class='neutral'>     * @dev Returns the downcasted int40 from int256, reverting on</span>
 1034 |     | <span class='neutral'>     * overflow (when the input is less than smallest int40 or</span>
 1035 |     | <span class='neutral'>     * greater than largest int40).</span>
 1036 |     | <span class='neutral'>     *</span>
 1037 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int40` operator.</span>
 1038 |     | <span class='neutral'>     *</span>
 1039 |     | <span class='neutral'>     * Requirements:</span>
 1040 |     | <span class='neutral'>     *</span>
 1041 |     | <span class='neutral'>     * - input must fit into 40 bits</span>
 1042 |     | <span class='neutral'>     *</span>
 1043 |     | <span class='neutral'>     * _Available since v4.7._</span>
 1044 |     | <span class='neutral'>     */</span>
 1045 |     | <span class='neutral'>    function toInt40(int256 value) internal pure returns (int40 downcasted) {</span>
 1046 |     | <span class='neutral'>        downcasted = int40(value);</span>
 1047 |     | <span class='neutral'>        require(downcasted == value, &quot;SafeCast: value doesn&#39;t fit in 40 bits&quot;);</span>
 1048 |     | <span class='neutral'>    }</span>
 1049 |     | <span class='neutral'></span>
 1050 |     | <span class='neutral'>    /**</span>
 1051 |     | <span class='neutral'>     * @dev Returns the downcasted int32 from int256, reverting on</span>
 1052 |     | <span class='neutral'>     * overflow (when the input is less than smallest int32 or</span>
 1053 |     | <span class='neutral'>     * greater than largest int32).</span>
 1054 |     | <span class='neutral'>     *</span>
 1055 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int32` operator.</span>
 1056 |     | <span class='neutral'>     *</span>
 1057 |     | <span class='neutral'>     * Requirements:</span>
 1058 |     | <span class='neutral'>     *</span>
 1059 |     | <span class='neutral'>     * - input must fit into 32 bits</span>
 1060 |     | <span class='neutral'>     *</span>
 1061 |     | <span class='neutral'>     * _Available since v3.1._</span>
 1062 |     | <span class='neutral'>     */</span>
 1063 |     | <span class='neutral'>    function toInt32(int256 value) internal pure returns (int32 downcasted) {</span>
 1064 |     | <span class='neutral'>        downcasted = int32(value);</span>
 1065 |     | <span class='neutral'>        require(downcasted == value, &quot;SafeCast: value doesn&#39;t fit in 32 bits&quot;);</span>
 1066 |     | <span class='neutral'>    }</span>
 1067 |     | <span class='neutral'></span>
 1068 |     | <span class='neutral'>    /**</span>
 1069 |     | <span class='neutral'>     * @dev Returns the downcasted int24 from int256, reverting on</span>
 1070 |     | <span class='neutral'>     * overflow (when the input is less than smallest int24 or</span>
 1071 |     | <span class='neutral'>     * greater than largest int24).</span>
 1072 |     | <span class='neutral'>     *</span>
 1073 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int24` operator.</span>
 1074 |     | <span class='neutral'>     *</span>
 1075 |     | <span class='neutral'>     * Requirements:</span>
 1076 |     | <span class='neutral'>     *</span>
 1077 |     | <span class='neutral'>     * - input must fit into 24 bits</span>
 1078 |     | <span class='neutral'>     *</span>
 1079 |     | <span class='neutral'>     * _Available since v4.7._</span>
 1080 |     | <span class='neutral'>     */</span>
 1081 |     | <span class='neutral'>    function toInt24(int256 value) internal pure returns (int24 downcasted) {</span>
 1082 |     | <span class='neutral'>        downcasted = int24(value);</span>
 1083 |     | <span class='neutral'>        require(downcasted == value, &quot;SafeCast: value doesn&#39;t fit in 24 bits&quot;);</span>
 1084 |     | <span class='neutral'>    }</span>
 1085 |     | <span class='neutral'></span>
 1086 |     | <span class='neutral'>    /**</span>
 1087 |     | <span class='neutral'>     * @dev Returns the downcasted int16 from int256, reverting on</span>
 1088 |     | <span class='neutral'>     * overflow (when the input is less than smallest int16 or</span>
 1089 |     | <span class='neutral'>     * greater than largest int16).</span>
 1090 |     | <span class='neutral'>     *</span>
 1091 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int16` operator.</span>
 1092 |     | <span class='neutral'>     *</span>
 1093 |     | <span class='neutral'>     * Requirements:</span>
 1094 |     | <span class='neutral'>     *</span>
 1095 |     | <span class='neutral'>     * - input must fit into 16 bits</span>
 1096 |     | <span class='neutral'>     *</span>
 1097 |     | <span class='neutral'>     * _Available since v3.1._</span>
 1098 |     | <span class='neutral'>     */</span>
 1099 |     | <span class='neutral'>    function toInt16(int256 value) internal pure returns (int16 downcasted) {</span>
 1100 |     | <span class='neutral'>        downcasted = int16(value);</span>
 1101 |     | <span class='neutral'>        require(downcasted == value, &quot;SafeCast: value doesn&#39;t fit in 16 bits&quot;);</span>
 1102 |     | <span class='neutral'>    }</span>
 1103 |     | <span class='neutral'></span>
 1104 |     | <span class='neutral'>    /**</span>
 1105 |     | <span class='neutral'>     * @dev Returns the downcasted int8 from int256, reverting on</span>
 1106 |     | <span class='neutral'>     * overflow (when the input is less than smallest int8 or</span>
 1107 |     | <span class='neutral'>     * greater than largest int8).</span>
 1108 |     | <span class='neutral'>     *</span>
 1109 |     | <span class='neutral'>     * Counterpart to Solidity&#39;s `int8` operator.</span>
 1110 |     | <span class='neutral'>     *</span>
 1111 |     | <span class='neutral'>     * Requirements:</span>
 1112 |     | <span class='neutral'>     *</span>
 1113 |     | <span class='neutral'>     * - input must fit into 8 bits</span>
 1114 |     | <span class='neutral'>     *</span>
 1115 |     | <span class='neutral'>     * _Available since v3.1._</span>
 1116 |     | <span class='neutral'>     */</span>
 1117 |     | <span class='neutral'>    function toInt8(int256 value) internal pure returns (int8 downcasted) {</span>
 1118 |     | <span class='neutral'>        downcasted = int8(value);</span>
 1119 |     | <span class='neutral'>        require(downcasted == value, &quot;SafeCast: value doesn&#39;t fit in 8 bits&quot;);</span>
 1120 |     | <span class='neutral'>    }</span>
 1121 |     | <span class='neutral'></span>
 1122 |     | <span class='neutral'>    /**</span>
 1123 |     | <span class='neutral'>     * @dev Converts an unsigned uint256 into a signed int256.</span>
 1124 |     | <span class='neutral'>     *</span>
 1125 |     | <span class='neutral'>     * Requirements:</span>
 1126 |     | <span class='neutral'>     *</span>
 1127 |     | <span class='neutral'>     * - input must be less than or equal to maxInt256.</span>
 1128 |     | <span class='neutral'>     *</span>
 1129 |     | <span class='neutral'>     * _Available since v3.0._</span>
 1130 |     | <span class='neutral'>     */</span>
 1131 |     | <span class='neutral'>    function toInt256(uint256 value) internal pure returns (int256) {</span>
 1132 |     | <span class='neutral'>        // Note: Unsafe cast below is okay because `type(int256).max` is guaranteed to be positive</span>
 1133 |     | <span class='neutral'>        require(value &lt;= uint256(type(int256).max), &quot;SafeCast: value doesn&#39;t fit in an int256&quot;);</span>
 1134 |     | <span class='neutral'>        return int256(value);</span>
 1135 |     | <span class='neutral'>    }</span>
 1136 |     | <span class='neutral'>}</span>
 1137 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/lib/openzeppelin-contracts/contracts/utils/math/SignedMath.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
  2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.8.0) (utils/math/SignedMath.sol)</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>pragma solidity ^0.8.0;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='neutral'>/**</span>
  7 |     | <span class='neutral'> * @dev Standard signed math utilities missing in the Solidity language.</span>
  8 |     | <span class='neutral'> */</span>
  9 |     | <span class='unexecuted'>library SignedMath {</span>
 10 |     | <span class='neutral'>    /**</span>
 11 |     | <span class='neutral'>     * @dev Returns the largest of two signed numbers.</span>
 12 |     | <span class='neutral'>     */</span>
 13 |     | <span class='neutral'>    function max(int256 a, int256 b) internal pure returns (int256) {</span>
 14 |     | <span class='neutral'>        return a &gt; b ? a : b;</span>
 15 |     | <span class='neutral'>    }</span>
 16 |     | <span class='neutral'></span>
 17 |     | <span class='neutral'>    /**</span>
 18 |     | <span class='neutral'>     * @dev Returns the smallest of two signed numbers.</span>
 19 |     | <span class='neutral'>     */</span>
 20 |     | <span class='neutral'>    function min(int256 a, int256 b) internal pure returns (int256) {</span>
 21 |     | <span class='neutral'>        return a &lt; b ? a : b;</span>
 22 |     | <span class='neutral'>    }</span>
 23 |     | <span class='neutral'></span>
 24 |     | <span class='neutral'>    /**</span>
 25 |     | <span class='neutral'>     * @dev Returns the average of two signed numbers without overflow.</span>
 26 |     | <span class='neutral'>     * The result is rounded towards zero.</span>
 27 |     | <span class='neutral'>     */</span>
 28 |     | <span class='neutral'>    function average(int256 a, int256 b) internal pure returns (int256) {</span>
 29 |     | <span class='neutral'>        // Formula from the book &quot;Hacker&#39;s Delight&quot;</span>
 30 |     | <span class='neutral'>        int256 x = (a &amp; b) + ((a ^ b) &gt;&gt; 1);</span>
 31 |     | <span class='neutral'>        return x + (int256(uint256(x) &gt;&gt; 255) &amp; (a ^ b));</span>
 32 |     | <span class='neutral'>    }</span>
 33 |     | <span class='neutral'></span>
 34 |     | <span class='neutral'>    /**</span>
 35 |     | <span class='neutral'>     * @dev Returns the absolute unsigned value of a signed value.</span>
 36 |     | <span class='neutral'>     */</span>
 37 |     | <span class='neutral'>    function abs(int256 n) internal pure returns (uint256) {</span>
 38 |     | <span class='neutral'>        unchecked {</span>
 39 |     | <span class='neutral'>            // must be unchecked in order to support `n = type(int256).min`</span>
 40 |     | <span class='neutral'>            return uint256(n &gt;= 0 ? n : -n);</span>
 41 |     | <span class='neutral'>        }</span>
 42 |     | <span class='neutral'>    }</span>
 43 |     | <span class='neutral'>}</span>
 44 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/lib/openzeppelin-contracts/contracts/utils/structs/DoubleEndedQueue.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>// OpenZeppelin Contracts (last updated v4.9.0) (utils/structs/DoubleEndedQueue.sol)</span>
   3 |     | <span class='neutral'>pragma solidity ^0.8.4;</span>
   4 |     | <span class='neutral'></span>
   5 |     | <span class='neutral'>import &quot;../math/SafeCast.sol&quot;;</span>
   6 |     | <span class='neutral'></span>
   7 |     | <span class='neutral'>/**</span>
   8 |     | <span class='neutral'> * @dev A sequence of items with the ability to efficiently push and pop items (i.e. insert and remove) on both ends of</span>
   9 |     | <span class='neutral'> * the sequence (called front and back). Among other access patterns, it can be used to implement efficient LIFO and</span>
  10 |     | <span class='neutral'> * FIFO queues. Storage use is optimized, and all operations are O(1) constant time. This includes {clear}, given that</span>
  11 |     | <span class='neutral'> * the existing queue contents are left in storage.</span>
  12 |     | <span class='neutral'> *</span>
  13 |     | <span class='neutral'> * The struct is called `Bytes32Deque`. Other types can be cast to and from `bytes32`. This data structure can only be</span>
  14 |     | <span class='neutral'> * used in storage, and not in memory.</span>
  15 |     | <span class='neutral'> * ```solidity</span>
  16 |     | <span class='neutral'> * DoubleEndedQueue.Bytes32Deque queue;</span>
  17 |     | <span class='neutral'> * ```</span>
  18 |     | <span class='neutral'> *</span>
  19 |     | <span class='neutral'> * _Available since v4.6._</span>
  20 |     | <span class='neutral'> */</span>
  21 |     | <span class='unexecuted'>library DoubleEndedQueue {</span>
  22 |     | <span class='neutral'>    /**</span>
  23 |     | <span class='neutral'>     * @dev An operation (e.g. {front}) couldn&#39;t be completed due to the queue being empty.</span>
  24 |     | <span class='neutral'>     */</span>
  25 |     | <span class='neutral'>    error Empty();</span>
  26 |     | <span class='neutral'></span>
  27 |     | <span class='neutral'>    /**</span>
  28 |     | <span class='neutral'>     * @dev An operation (e.g. {at}) couldn&#39;t be completed due to an index being out of bounds.</span>
  29 |     | <span class='neutral'>     */</span>
  30 |     | <span class='neutral'>    error OutOfBounds();</span>
  31 |     | <span class='neutral'></span>
  32 |     | <span class='neutral'>    /**</span>
  33 |     | <span class='neutral'>     * @dev Indices are signed integers because the queue can grow in any direction. They are 128 bits so begin and end</span>
  34 |     | <span class='neutral'>     * are packed in a single storage slot for efficient access. Since the items are added one at a time we can safely</span>
  35 |     | <span class='neutral'>     * assume that these 128-bit indices will not overflow, and use unchecked arithmetic.</span>
  36 |     | <span class='neutral'>     *</span>
  37 |     | <span class='neutral'>     * Struct members have an underscore prefix indicating that they are &quot;private&quot; and should not be read or written to</span>
  38 |     | <span class='neutral'>     * directly. Use the functions provided below instead. Modifying the struct manually may violate assumptions and</span>
  39 |     | <span class='neutral'>     * lead to unexpected behavior.</span>
  40 |     | <span class='neutral'>     *</span>
  41 |     | <span class='neutral'>     * Indices are in the range [begin, end) which means the first item is at data[begin] and the last item is at</span>
  42 |     | <span class='neutral'>     * data[end - 1].</span>
  43 |     | <span class='neutral'>     */</span>
  44 |     | <span class='neutral'>    struct Bytes32Deque {</span>
  45 |     | <span class='neutral'>        int128 _begin;</span>
  46 |     | <span class='neutral'>        int128 _end;</span>
  47 |     | <span class='neutral'>        mapping(int128 =&gt; bytes32) _data;</span>
  48 |     | <span class='neutral'>    }</span>
  49 |     | <span class='neutral'></span>
  50 |     | <span class='neutral'>    /**</span>
  51 |     | <span class='neutral'>     * @dev Inserts an item at the end of the queue.</span>
  52 |     | <span class='neutral'>     */</span>
  53 |     | <span class='unexecuted'>    function pushBack(Bytes32Deque storage deque, bytes32 value) internal {</span>
  54 |     | <span class='unexecuted'>        int128 backIndex = deque._end;</span>
  55 |     | <span class='unexecuted'>        deque._data[backIndex] = value;</span>
  56 |     | <span class='neutral'>        unchecked {</span>
  57 |     | <span class='unexecuted'>            deque._end = backIndex + 1;</span>
  58 |     | <span class='neutral'>        }</span>
  59 |     | <span class='neutral'>    }</span>
  60 |     | <span class='neutral'></span>
  61 |     | <span class='neutral'>    /**</span>
  62 |     | <span class='neutral'>     * @dev Removes the item at the end of the queue and returns it.</span>
  63 |     | <span class='neutral'>     *</span>
  64 |     | <span class='neutral'>     * Reverts with `Empty` if the queue is empty.</span>
  65 |     | <span class='neutral'>     */</span>
  66 |     | <span class='neutral'>    function popBack(Bytes32Deque storage deque) internal returns (bytes32 value) {</span>
  67 |     | <span class='neutral'>        if (empty(deque)) revert Empty();</span>
  68 |     | <span class='neutral'>        int128 backIndex;</span>
  69 |     | <span class='neutral'>        unchecked {</span>
  70 |     | <span class='neutral'>            backIndex = deque._end - 1;</span>
  71 |     | <span class='neutral'>        }</span>
  72 |     | <span class='neutral'>        value = deque._data[backIndex];</span>
  73 |     | <span class='neutral'>        delete deque._data[backIndex];</span>
  74 |     | <span class='neutral'>        deque._end = backIndex;</span>
  75 |     | <span class='neutral'>    }</span>
  76 |     | <span class='neutral'></span>
  77 |     | <span class='neutral'>    /**</span>
  78 |     | <span class='neutral'>     * @dev Inserts an item at the beginning of the queue.</span>
  79 |     | <span class='neutral'>     */</span>
  80 |     | <span class='neutral'>    function pushFront(Bytes32Deque storage deque, bytes32 value) internal {</span>
  81 |     | <span class='neutral'>        int128 frontIndex;</span>
  82 |     | <span class='neutral'>        unchecked {</span>
  83 |     | <span class='neutral'>            frontIndex = deque._begin - 1;</span>
  84 |     | <span class='neutral'>        }</span>
  85 |     | <span class='neutral'>        deque._data[frontIndex] = value;</span>
  86 |     | <span class='neutral'>        deque._begin = frontIndex;</span>
  87 |     | <span class='neutral'>    }</span>
  88 |     | <span class='neutral'></span>
  89 |     | <span class='neutral'>    /**</span>
  90 |     | <span class='neutral'>     * @dev Removes the item at the beginning of the queue and returns it.</span>
  91 |     | <span class='neutral'>     *</span>
  92 |     | <span class='neutral'>     * Reverts with `Empty` if the queue is empty.</span>
  93 |     | <span class='neutral'>     */</span>
  94 |     | <span class='unexecuted'>    function popFront(Bytes32Deque storage deque) internal returns (bytes32 value) {</span>
  95 |     | <span class='unexecuted'>        if (empty(deque)) revert Empty();</span>
  96 |     | <span class='unexecuted'>        int128 frontIndex = deque._begin;</span>
  97 |     | <span class='unexecuted'>        value = deque._data[frontIndex];</span>
  98 |     | <span class='unexecuted'>        delete deque._data[frontIndex];</span>
  99 |     | <span class='neutral'>        unchecked {</span>
 100 |     | <span class='unexecuted'>            deque._begin = frontIndex + 1;</span>
 101 |     | <span class='neutral'>        }</span>
 102 |     | <span class='neutral'>    }</span>
 103 |     | <span class='neutral'></span>
 104 |     | <span class='neutral'>    /**</span>
 105 |     | <span class='neutral'>     * @dev Returns the item at the beginning of the queue.</span>
 106 |     | <span class='neutral'>     *</span>
 107 |     | <span class='neutral'>     * Reverts with `Empty` if the queue is empty.</span>
 108 |     | <span class='neutral'>     */</span>
 109 |     | <span class='neutral'>    function front(Bytes32Deque storage deque) internal view returns (bytes32 value) {</span>
 110 |     | <span class='neutral'>        if (empty(deque)) revert Empty();</span>
 111 |     | <span class='neutral'>        int128 frontIndex = deque._begin;</span>
 112 |     | <span class='neutral'>        return deque._data[frontIndex];</span>
 113 |     | <span class='neutral'>    }</span>
 114 |     | <span class='neutral'></span>
 115 |     | <span class='neutral'>    /**</span>
 116 |     | <span class='neutral'>     * @dev Returns the item at the end of the queue.</span>
 117 |     | <span class='neutral'>     *</span>
 118 |     | <span class='neutral'>     * Reverts with `Empty` if the queue is empty.</span>
 119 |     | <span class='neutral'>     */</span>
 120 |     | <span class='neutral'>    function back(Bytes32Deque storage deque) internal view returns (bytes32 value) {</span>
 121 |     | <span class='neutral'>        if (empty(deque)) revert Empty();</span>
 122 |     | <span class='neutral'>        int128 backIndex;</span>
 123 |     | <span class='neutral'>        unchecked {</span>
 124 |     | <span class='neutral'>            backIndex = deque._end - 1;</span>
 125 |     | <span class='neutral'>        }</span>
 126 |     | <span class='neutral'>        return deque._data[backIndex];</span>
 127 |     | <span class='neutral'>    }</span>
 128 |     | <span class='neutral'></span>
 129 |     | <span class='neutral'>    /**</span>
 130 |     | <span class='neutral'>     * @dev Return the item at a position in the queue given by `index`, with the first item at 0 and last item at</span>
 131 |     | <span class='neutral'>     * `length(deque) - 1`.</span>
 132 |     | <span class='neutral'>     *</span>
 133 |     | <span class='neutral'>     * Reverts with `OutOfBounds` if the index is out of bounds.</span>
 134 |     | <span class='neutral'>     */</span>
 135 |     | <span class='neutral'>    function at(Bytes32Deque storage deque, uint256 index) internal view returns (bytes32 value) {</span>
 136 |     | <span class='neutral'>        // int256(deque._begin) is a safe upcast</span>
 137 |     | <span class='neutral'>        int128 idx = SafeCast.toInt128(int256(deque._begin) + SafeCast.toInt256(index));</span>
 138 |     | <span class='neutral'>        if (idx &gt;= deque._end) revert OutOfBounds();</span>
 139 |     | <span class='neutral'>        return deque._data[idx];</span>
 140 |     | <span class='neutral'>    }</span>
 141 |     | <span class='neutral'></span>
 142 |     | <span class='neutral'>    /**</span>
 143 |     | <span class='neutral'>     * @dev Resets the queue back to being empty.</span>
 144 |     | <span class='neutral'>     *</span>
 145 |     | <span class='neutral'>     * NOTE: The current items are left behind in storage. This does not affect the functioning of the queue, but misses</span>
 146 |     | <span class='neutral'>     * out on potential gas refunds.</span>
 147 |     | <span class='neutral'>     */</span>
 148 |     | <span class='neutral'>    function clear(Bytes32Deque storage deque) internal {</span>
 149 |     | <span class='neutral'>        deque._begin = 0;</span>
 150 |     | <span class='neutral'>        deque._end = 0;</span>
 151 |     | <span class='neutral'>    }</span>
 152 |     | <span class='neutral'></span>
 153 |     | <span class='neutral'>    /**</span>
 154 |     | <span class='neutral'>     * @dev Returns the number of items in the queue.</span>
 155 |     | <span class='neutral'>     */</span>
 156 |     | <span class='neutral'>    function length(Bytes32Deque storage deque) internal view returns (uint256) {</span>
 157 |     | <span class='neutral'>        // The interface preserves the invariant that begin &lt;= end so we assume this will not overflow.</span>
 158 |     | <span class='neutral'>        // We also assume there are at most int256.max items in the queue.</span>
 159 |     | <span class='neutral'>        unchecked {</span>
 160 |     | <span class='neutral'>            return uint256(int256(deque._end) - int256(deque._begin));</span>
 161 |     | <span class='neutral'>        }</span>
 162 |     | <span class='neutral'>    }</span>
 163 |     | <span class='neutral'></span>
 164 |     | <span class='neutral'>    /**</span>
 165 |     | <span class='neutral'>     * @dev Returns true if the queue is empty.</span>
 166 |     | <span class='neutral'>     */</span>
 167 |     | <span class='unexecuted'>    function empty(Bytes32Deque storage deque) internal view returns (bool) {</span>
 168 |     | <span class='unexecuted'>        return deque._end &lt;= deque._begin;</span>
 169 |     | <span class='neutral'>    }</span>
 170 |     | <span class='neutral'>}</span>
 171 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/lib/solady/src/utils/Clone.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>pragma solidity ^0.8.4;</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>/// @notice Class with helper read functions for clone with immutable args.</span>
   5 |     | <span class='neutral'>/// @author Solady (https://github.com/vectorized/solady/blob/main/src/utils/Clone.sol)</span>
   6 |     | <span class='neutral'>/// @author Adapted from clones with immutable args by zefram.eth, Saw-mon &amp; Natalie</span>
   7 |     | <span class='neutral'>/// (https://github.com/Saw-mon-and-Natalie/clones-with-immutable-args)</span>
   8 |     | <span class='neutral'>abstract contract Clone {</span>
   9 |     | <span class='neutral'>    /// @dev Reads all of the immutable args.</span>
  10 |     | <span class='neutral'>    function _getArgBytes() internal pure returns (bytes memory arg) {</span>
  11 |     | <span class='neutral'>        uint256 offset = _getImmutableArgsOffset();</span>
  12 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
  13 |     | <span class='neutral'>        assembly {</span>
  14 |     | <span class='neutral'>            arg := mload(0x40)</span>
  15 |     | <span class='neutral'>            let length := sub(calldatasize(), add(2, offset)) // 2 bytes are used for the length.</span>
  16 |     | <span class='neutral'>            mstore(arg, length) // Store the length.</span>
  17 |     | <span class='neutral'>            calldatacopy(add(arg, 0x20), offset, length)</span>
  18 |     | <span class='neutral'>            let o := add(add(arg, 0x20), length)</span>
  19 |     | <span class='neutral'>            mstore(o, 0) // Zeroize the slot after the bytes.</span>
  20 |     | <span class='neutral'>            mstore(0x40, add(o, 0x20)) // Allocate the memory.</span>
  21 |     | <span class='neutral'>        }</span>
  22 |     | <span class='neutral'>    }</span>
  23 |     | <span class='neutral'></span>
  24 |     | <span class='neutral'>    /// @dev Reads an immutable arg with type bytes.</span>
  25 |     | <span class='neutral'>    function _getArgBytes(uint256 argOffset, uint256 length)</span>
  26 |     | <span class='neutral'>        internal</span>
  27 |     | <span class='neutral'>        pure</span>
  28 |     | <span class='neutral'>        returns (bytes memory arg)</span>
  29 |     | <span class='neutral'>    {</span>
  30 |     | <span class='neutral'>        uint256 offset = _getImmutableArgsOffset();</span>
  31 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
  32 |     | <span class='neutral'>        assembly {</span>
  33 |     | <span class='neutral'>            arg := mload(0x40)</span>
  34 |     | <span class='neutral'>            mstore(arg, length) // Store the length.</span>
  35 |     | <span class='neutral'>            calldatacopy(add(arg, 0x20), add(offset, argOffset), length)</span>
  36 |     | <span class='neutral'>            let o := add(add(arg, 0x20), length)</span>
  37 |     | <span class='neutral'>            mstore(o, 0) // Zeroize the slot after the bytes.</span>
  38 |     | <span class='neutral'>            mstore(0x40, add(o, 0x20)) // Allocate the memory.</span>
  39 |     | <span class='neutral'>        }</span>
  40 |     | <span class='neutral'>    }</span>
  41 |     | <span class='neutral'></span>
  42 |     | <span class='neutral'>    /// @dev Reads an immutable arg with type address.</span>
  43 | *   | <span class='executed'>    function _getArgAddress(uint256 argOffset) internal pure returns (address arg) {</span>
  44 | *   | <span class='executed'>        uint256 offset = _getImmutableArgsOffset();</span>
  45 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
  46 |     | <span class='neutral'>        assembly {</span>
  47 | *   | <span class='executed'>            arg := shr(96, calldataload(add(offset, argOffset)))</span>
  48 |     | <span class='neutral'>        }</span>
  49 |     | <span class='neutral'>    }</span>
  50 |     | <span class='neutral'></span>
  51 |     | <span class='neutral'>    /// @dev Reads a uint256 array stored in the immutable args.</span>
  52 |     | <span class='neutral'>    function _getArgUint256Array(uint256 argOffset, uint256 length)</span>
  53 |     | <span class='neutral'>        internal</span>
  54 |     | <span class='neutral'>        pure</span>
  55 |     | <span class='neutral'>        returns (uint256[] memory arg)</span>
  56 |     | <span class='neutral'>    {</span>
  57 |     | <span class='neutral'>        uint256 offset = _getImmutableArgsOffset();</span>
  58 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
  59 |     | <span class='neutral'>        assembly {</span>
  60 |     | <span class='neutral'>            arg := mload(0x40)</span>
  61 |     | <span class='neutral'>            mstore(arg, length) // Store the length.</span>
  62 |     | <span class='neutral'>            calldatacopy(add(arg, 0x20), add(offset, argOffset), shl(5, length))</span>
  63 |     | <span class='neutral'>            mstore(0x40, add(add(arg, 0x20), shl(5, length))) // Allocate the memory.</span>
  64 |     | <span class='neutral'>        }</span>
  65 |     | <span class='neutral'>    }</span>
  66 |     | <span class='neutral'></span>
  67 |     | <span class='neutral'>    /// @dev Reads a bytes32 array stored in the immutable args.</span>
  68 |     | <span class='neutral'>    function _getArgBytes32Array(uint256 argOffset, uint256 length)</span>
  69 |     | <span class='neutral'>        internal</span>
  70 |     | <span class='neutral'>        pure</span>
  71 |     | <span class='neutral'>        returns (bytes32[] memory arg)</span>
  72 |     | <span class='neutral'>    {</span>
  73 |     | <span class='neutral'>        uint256 offset = _getImmutableArgsOffset();</span>
  74 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
  75 |     | <span class='neutral'>        assembly {</span>
  76 |     | <span class='neutral'>            arg := mload(0x40)</span>
  77 |     | <span class='neutral'>            mstore(arg, length) // Store the length.</span>
  78 |     | <span class='neutral'>            calldatacopy(add(arg, 0x20), add(offset, argOffset), shl(5, length))</span>
  79 |     | <span class='neutral'>            mstore(0x40, add(add(arg, 0x20), shl(5, length))) // Allocate the memory.</span>
  80 |     | <span class='neutral'>        }</span>
  81 |     | <span class='neutral'>    }</span>
  82 |     | <span class='neutral'></span>
  83 |     | <span class='neutral'>    /// @dev Reads an immutable arg with type bytes32.</span>
  84 |     | <span class='neutral'>    function _getArgBytes32(uint256 argOffset) internal pure returns (bytes32 arg) {</span>
  85 |     | <span class='neutral'>        uint256 offset = _getImmutableArgsOffset();</span>
  86 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
  87 |     | <span class='neutral'>        assembly {</span>
  88 |     | <span class='neutral'>            arg := calldataload(add(offset, argOffset))</span>
  89 |     | <span class='neutral'>        }</span>
  90 |     | <span class='neutral'>    }</span>
  91 |     | <span class='neutral'></span>
  92 |     | <span class='neutral'>    /// @dev Reads an immutable arg with type uint256.</span>
  93 | *   | <span class='executed'>    function _getArgUint256(uint256 argOffset) internal pure returns (uint256 arg) {</span>
  94 | *   | <span class='executed'>        uint256 offset = _getImmutableArgsOffset();</span>
  95 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
  96 |     | <span class='neutral'>        assembly {</span>
  97 | *   | <span class='executed'>            arg := calldataload(add(offset, argOffset))</span>
  98 |     | <span class='neutral'>        }</span>
  99 |     | <span class='neutral'>    }</span>
 100 |     | <span class='neutral'></span>
 101 |     | <span class='neutral'>    /// @dev Reads an immutable arg with type uint248.</span>
 102 |     | <span class='neutral'>    function _getArgUint248(uint256 argOffset) internal pure returns (uint248 arg) {</span>
 103 |     | <span class='neutral'>        uint256 offset = _getImmutableArgsOffset();</span>
 104 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 105 |     | <span class='neutral'>        assembly {</span>
 106 |     | <span class='neutral'>            arg := shr(8, calldataload(add(offset, argOffset)))</span>
 107 |     | <span class='neutral'>        }</span>
 108 |     | <span class='neutral'>    }</span>
 109 |     | <span class='neutral'></span>
 110 |     | <span class='neutral'>    /// @dev Reads an immutable arg with type uint240.</span>
 111 |     | <span class='neutral'>    function _getArgUint240(uint256 argOffset) internal pure returns (uint240 arg) {</span>
 112 |     | <span class='neutral'>        uint256 offset = _getImmutableArgsOffset();</span>
 113 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 114 |     | <span class='neutral'>        assembly {</span>
 115 |     | <span class='neutral'>            arg := shr(16, calldataload(add(offset, argOffset)))</span>
 116 |     | <span class='neutral'>        }</span>
 117 |     | <span class='neutral'>    }</span>
 118 |     | <span class='neutral'></span>
 119 |     | <span class='neutral'>    /// @dev Reads an immutable arg with type uint232.</span>
 120 |     | <span class='neutral'>    function _getArgUint232(uint256 argOffset) internal pure returns (uint232 arg) {</span>
 121 |     | <span class='neutral'>        uint256 offset = _getImmutableArgsOffset();</span>
 122 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 123 |     | <span class='neutral'>        assembly {</span>
 124 |     | <span class='neutral'>            arg := shr(24, calldataload(add(offset, argOffset)))</span>
 125 |     | <span class='neutral'>        }</span>
 126 |     | <span class='neutral'>    }</span>
 127 |     | <span class='neutral'></span>
 128 |     | <span class='neutral'>    /// @dev Reads an immutable arg with type uint224.</span>
 129 |     | <span class='neutral'>    function _getArgUint224(uint256 argOffset) internal pure returns (uint224 arg) {</span>
 130 |     | <span class='neutral'>        uint256 offset = _getImmutableArgsOffset();</span>
 131 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 132 |     | <span class='neutral'>        assembly {</span>
 133 |     | <span class='neutral'>            arg := shr(0x20, calldataload(add(offset, argOffset)))</span>
 134 |     | <span class='neutral'>        }</span>
 135 |     | <span class='neutral'>    }</span>
 136 |     | <span class='neutral'></span>
 137 |     | <span class='neutral'>    /// @dev Reads an immutable arg with type uint216.</span>
 138 |     | <span class='neutral'>    function _getArgUint216(uint256 argOffset) internal pure returns (uint216 arg) {</span>
 139 |     | <span class='neutral'>        uint256 offset = _getImmutableArgsOffset();</span>
 140 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 141 |     | <span class='neutral'>        assembly {</span>
 142 |     | <span class='neutral'>            arg := shr(40, calldataload(add(offset, argOffset)))</span>
 143 |     | <span class='neutral'>        }</span>
 144 |     | <span class='neutral'>    }</span>
 145 |     | <span class='neutral'></span>
 146 |     | <span class='neutral'>    /// @dev Reads an immutable arg with type uint208.</span>
 147 |     | <span class='neutral'>    function _getArgUint208(uint256 argOffset) internal pure returns (uint208 arg) {</span>
 148 |     | <span class='neutral'>        uint256 offset = _getImmutableArgsOffset();</span>
 149 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 150 |     | <span class='neutral'>        assembly {</span>
 151 |     | <span class='neutral'>            arg := shr(48, calldataload(add(offset, argOffset)))</span>
 152 |     | <span class='neutral'>        }</span>
 153 |     | <span class='neutral'>    }</span>
 154 |     | <span class='neutral'></span>
 155 |     | <span class='neutral'>    /// @dev Reads an immutable arg with type uint200.</span>
 156 |     | <span class='neutral'>    function _getArgUint200(uint256 argOffset) internal pure returns (uint200 arg) {</span>
 157 |     | <span class='neutral'>        uint256 offset = _getImmutableArgsOffset();</span>
 158 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 159 |     | <span class='neutral'>        assembly {</span>
 160 |     | <span class='neutral'>            arg := shr(56, calldataload(add(offset, argOffset)))</span>
 161 |     | <span class='neutral'>        }</span>
 162 |     | <span class='neutral'>    }</span>
 163 |     | <span class='neutral'></span>
 164 |     | <span class='neutral'>    /// @dev Reads an immutable arg with type uint192.</span>
 165 |     | <span class='neutral'>    function _getArgUint192(uint256 argOffset) internal pure returns (uint192 arg) {</span>
 166 |     | <span class='neutral'>        uint256 offset = _getImmutableArgsOffset();</span>
 167 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 168 |     | <span class='neutral'>        assembly {</span>
 169 |     | <span class='neutral'>            arg := shr(64, calldataload(add(offset, argOffset)))</span>
 170 |     | <span class='neutral'>        }</span>
 171 |     | <span class='neutral'>    }</span>
 172 |     | <span class='neutral'></span>
 173 |     | <span class='neutral'>    /// @dev Reads an immutable arg with type uint184.</span>
 174 |     | <span class='neutral'>    function _getArgUint184(uint256 argOffset) internal pure returns (uint184 arg) {</span>
 175 |     | <span class='neutral'>        uint256 offset = _getImmutableArgsOffset();</span>
 176 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 177 |     | <span class='neutral'>        assembly {</span>
 178 |     | <span class='neutral'>            arg := shr(72, calldataload(add(offset, argOffset)))</span>
 179 |     | <span class='neutral'>        }</span>
 180 |     | <span class='neutral'>    }</span>
 181 |     | <span class='neutral'></span>
 182 |     | <span class='neutral'>    /// @dev Reads an immutable arg with type uint176.</span>
 183 |     | <span class='neutral'>    function _getArgUint176(uint256 argOffset) internal pure returns (uint176 arg) {</span>
 184 |     | <span class='neutral'>        uint256 offset = _getImmutableArgsOffset();</span>
 185 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 186 |     | <span class='neutral'>        assembly {</span>
 187 |     | <span class='neutral'>            arg := shr(80, calldataload(add(offset, argOffset)))</span>
 188 |     | <span class='neutral'>        }</span>
 189 |     | <span class='neutral'>    }</span>
 190 |     | <span class='neutral'></span>
 191 |     | <span class='neutral'>    /// @dev Reads an immutable arg with type uint168.</span>
 192 |     | <span class='neutral'>    function _getArgUint168(uint256 argOffset) internal pure returns (uint168 arg) {</span>
 193 |     | <span class='neutral'>        uint256 offset = _getImmutableArgsOffset();</span>
 194 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 195 |     | <span class='neutral'>        assembly {</span>
 196 |     | <span class='neutral'>            arg := shr(88, calldataload(add(offset, argOffset)))</span>
 197 |     | <span class='neutral'>        }</span>
 198 |     | <span class='neutral'>    }</span>
 199 |     | <span class='neutral'></span>
 200 |     | <span class='neutral'>    /// @dev Reads an immutable arg with type uint160.</span>
 201 |     | <span class='neutral'>    function _getArgUint160(uint256 argOffset) internal pure returns (uint160 arg) {</span>
 202 |     | <span class='neutral'>        uint256 offset = _getImmutableArgsOffset();</span>
 203 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 204 |     | <span class='neutral'>        assembly {</span>
 205 |     | <span class='neutral'>            arg := shr(96, calldataload(add(offset, argOffset)))</span>
 206 |     | <span class='neutral'>        }</span>
 207 |     | <span class='neutral'>    }</span>
 208 |     | <span class='neutral'></span>
 209 |     | <span class='neutral'>    /// @dev Reads an immutable arg with type uint152.</span>
 210 |     | <span class='neutral'>    function _getArgUint152(uint256 argOffset) internal pure returns (uint152 arg) {</span>
 211 |     | <span class='neutral'>        uint256 offset = _getImmutableArgsOffset();</span>
 212 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 213 |     | <span class='neutral'>        assembly {</span>
 214 |     | <span class='neutral'>            arg := shr(104, calldataload(add(offset, argOffset)))</span>
 215 |     | <span class='neutral'>        }</span>
 216 |     | <span class='neutral'>    }</span>
 217 |     | <span class='neutral'></span>
 218 |     | <span class='neutral'>    /// @dev Reads an immutable arg with type uint144.</span>
 219 |     | <span class='neutral'>    function _getArgUint144(uint256 argOffset) internal pure returns (uint144 arg) {</span>
 220 |     | <span class='neutral'>        uint256 offset = _getImmutableArgsOffset();</span>
 221 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 222 |     | <span class='neutral'>        assembly {</span>
 223 |     | <span class='neutral'>            arg := shr(112, calldataload(add(offset, argOffset)))</span>
 224 |     | <span class='neutral'>        }</span>
 225 |     | <span class='neutral'>    }</span>
 226 |     | <span class='neutral'></span>
 227 |     | <span class='neutral'>    /// @dev Reads an immutable arg with type uint136.</span>
 228 |     | <span class='neutral'>    function _getArgUint136(uint256 argOffset) internal pure returns (uint136 arg) {</span>
 229 |     | <span class='neutral'>        uint256 offset = _getImmutableArgsOffset();</span>
 230 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 231 |     | <span class='neutral'>        assembly {</span>
 232 |     | <span class='neutral'>            arg := shr(120, calldataload(add(offset, argOffset)))</span>
 233 |     | <span class='neutral'>        }</span>
 234 |     | <span class='neutral'>    }</span>
 235 |     | <span class='neutral'></span>
 236 |     | <span class='neutral'>    /// @dev Reads an immutable arg with type uint128.</span>
 237 |     | <span class='neutral'>    function _getArgUint128(uint256 argOffset) internal pure returns (uint128 arg) {</span>
 238 |     | <span class='neutral'>        uint256 offset = _getImmutableArgsOffset();</span>
 239 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 240 |     | <span class='neutral'>        assembly {</span>
 241 |     | <span class='neutral'>            arg := shr(128, calldataload(add(offset, argOffset)))</span>
 242 |     | <span class='neutral'>        }</span>
 243 |     | <span class='neutral'>    }</span>
 244 |     | <span class='neutral'></span>
 245 |     | <span class='neutral'>    /// @dev Reads an immutable arg with type uint120.</span>
 246 |     | <span class='neutral'>    function _getArgUint120(uint256 argOffset) internal pure returns (uint120 arg) {</span>
 247 |     | <span class='neutral'>        uint256 offset = _getImmutableArgsOffset();</span>
 248 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 249 |     | <span class='neutral'>        assembly {</span>
 250 |     | <span class='neutral'>            arg := shr(136, calldataload(add(offset, argOffset)))</span>
 251 |     | <span class='neutral'>        }</span>
 252 |     | <span class='neutral'>    }</span>
 253 |     | <span class='neutral'></span>
 254 |     | <span class='neutral'>    /// @dev Reads an immutable arg with type uint112.</span>
 255 |     | <span class='neutral'>    function _getArgUint112(uint256 argOffset) internal pure returns (uint112 arg) {</span>
 256 |     | <span class='neutral'>        uint256 offset = _getImmutableArgsOffset();</span>
 257 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 258 |     | <span class='neutral'>        assembly {</span>
 259 |     | <span class='neutral'>            arg := shr(144, calldataload(add(offset, argOffset)))</span>
 260 |     | <span class='neutral'>        }</span>
 261 |     | <span class='neutral'>    }</span>
 262 |     | <span class='neutral'></span>
 263 |     | <span class='neutral'>    /// @dev Reads an immutable arg with type uint104.</span>
 264 |     | <span class='neutral'>    function _getArgUint104(uint256 argOffset) internal pure returns (uint104 arg) {</span>
 265 |     | <span class='neutral'>        uint256 offset = _getImmutableArgsOffset();</span>
 266 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 267 |     | <span class='neutral'>        assembly {</span>
 268 |     | <span class='neutral'>            arg := shr(152, calldataload(add(offset, argOffset)))</span>
 269 |     | <span class='neutral'>        }</span>
 270 |     | <span class='neutral'>    }</span>
 271 |     | <span class='neutral'></span>
 272 |     | <span class='neutral'>    /// @dev Reads an immutable arg with type uint96.</span>
 273 |     | <span class='neutral'>    function _getArgUint96(uint256 argOffset) internal pure returns (uint96 arg) {</span>
 274 |     | <span class='neutral'>        uint256 offset = _getImmutableArgsOffset();</span>
 275 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 276 |     | <span class='neutral'>        assembly {</span>
 277 |     | <span class='neutral'>            arg := shr(160, calldataload(add(offset, argOffset)))</span>
 278 |     | <span class='neutral'>        }</span>
 279 |     | <span class='neutral'>    }</span>
 280 |     | <span class='neutral'></span>
 281 |     | <span class='neutral'>    /// @dev Reads an immutable arg with type uint88.</span>
 282 |     | <span class='neutral'>    function _getArgUint88(uint256 argOffset) internal pure returns (uint88 arg) {</span>
 283 |     | <span class='neutral'>        uint256 offset = _getImmutableArgsOffset();</span>
 284 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 285 |     | <span class='neutral'>        assembly {</span>
 286 |     | <span class='neutral'>            arg := shr(168, calldataload(add(offset, argOffset)))</span>
 287 |     | <span class='neutral'>        }</span>
 288 |     | <span class='neutral'>    }</span>
 289 |     | <span class='neutral'></span>
 290 |     | <span class='neutral'>    /// @dev Reads an immutable arg with type uint80.</span>
 291 |     | <span class='neutral'>    function _getArgUint80(uint256 argOffset) internal pure returns (uint80 arg) {</span>
 292 |     | <span class='neutral'>        uint256 offset = _getImmutableArgsOffset();</span>
 293 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 294 |     | <span class='neutral'>        assembly {</span>
 295 |     | <span class='neutral'>            arg := shr(176, calldataload(add(offset, argOffset)))</span>
 296 |     | <span class='neutral'>        }</span>
 297 |     | <span class='neutral'>    }</span>
 298 |     | <span class='neutral'></span>
 299 |     | <span class='neutral'>    /// @dev Reads an immutable arg with type uint72.</span>
 300 |     | <span class='neutral'>    function _getArgUint72(uint256 argOffset) internal pure returns (uint72 arg) {</span>
 301 |     | <span class='neutral'>        uint256 offset = _getImmutableArgsOffset();</span>
 302 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 303 |     | <span class='neutral'>        assembly {</span>
 304 |     | <span class='neutral'>            arg := shr(184, calldataload(add(offset, argOffset)))</span>
 305 |     | <span class='neutral'>        }</span>
 306 |     | <span class='neutral'>    }</span>
 307 |     | <span class='neutral'></span>
 308 |     | <span class='neutral'>    /// @dev Reads an immutable arg with type uint64.</span>
 309 |     | <span class='neutral'>    function _getArgUint64(uint256 argOffset) internal pure returns (uint64 arg) {</span>
 310 |     | <span class='neutral'>        uint256 offset = _getImmutableArgsOffset();</span>
 311 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 312 |     | <span class='neutral'>        assembly {</span>
 313 |     | <span class='neutral'>            arg := shr(192, calldataload(add(offset, argOffset)))</span>
 314 |     | <span class='neutral'>        }</span>
 315 |     | <span class='neutral'>    }</span>
 316 |     | <span class='neutral'></span>
 317 |     | <span class='neutral'>    /// @dev Reads an immutable arg with type uint56.</span>
 318 |     | <span class='neutral'>    function _getArgUint56(uint256 argOffset) internal pure returns (uint56 arg) {</span>
 319 |     | <span class='neutral'>        uint256 offset = _getImmutableArgsOffset();</span>
 320 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 321 |     | <span class='neutral'>        assembly {</span>
 322 |     | <span class='neutral'>            arg := shr(200, calldataload(add(offset, argOffset)))</span>
 323 |     | <span class='neutral'>        }</span>
 324 |     | <span class='neutral'>    }</span>
 325 |     | <span class='neutral'></span>
 326 |     | <span class='neutral'>    /// @dev Reads an immutable arg with type uint48.</span>
 327 |     | <span class='neutral'>    function _getArgUint48(uint256 argOffset) internal pure returns (uint48 arg) {</span>
 328 |     | <span class='neutral'>        uint256 offset = _getImmutableArgsOffset();</span>
 329 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 330 |     | <span class='neutral'>        assembly {</span>
 331 |     | <span class='neutral'>            arg := shr(208, calldataload(add(offset, argOffset)))</span>
 332 |     | <span class='neutral'>        }</span>
 333 |     | <span class='neutral'>    }</span>
 334 |     | <span class='neutral'></span>
 335 |     | <span class='neutral'>    /// @dev Reads an immutable arg with type uint40.</span>
 336 | *   | <span class='executed'>    function _getArgUint40(uint256 argOffset) internal pure returns (uint40 arg) {</span>
 337 | *   | <span class='executed'>        uint256 offset = _getImmutableArgsOffset();</span>
 338 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 339 |     | <span class='neutral'>        assembly {</span>
 340 | *   | <span class='executed'>            arg := shr(216, calldataload(add(offset, argOffset)))</span>
 341 |     | <span class='neutral'>        }</span>
 342 |     | <span class='neutral'>    }</span>
 343 |     | <span class='neutral'></span>
 344 |     | <span class='neutral'>    /// @dev Reads an immutable arg with type uint32.</span>
 345 |     | <span class='neutral'>    function _getArgUint32(uint256 argOffset) internal pure returns (uint32 arg) {</span>
 346 |     | <span class='neutral'>        uint256 offset = _getImmutableArgsOffset();</span>
 347 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 348 |     | <span class='neutral'>        assembly {</span>
 349 |     | <span class='neutral'>            arg := shr(224, calldataload(add(offset, argOffset)))</span>
 350 |     | <span class='neutral'>        }</span>
 351 |     | <span class='neutral'>    }</span>
 352 |     | <span class='neutral'></span>
 353 |     | <span class='neutral'>    /// @dev Reads an immutable arg with type uint24.</span>
 354 |     | <span class='neutral'>    function _getArgUint24(uint256 argOffset) internal pure returns (uint24 arg) {</span>
 355 |     | <span class='neutral'>        uint256 offset = _getImmutableArgsOffset();</span>
 356 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 357 |     | <span class='neutral'>        assembly {</span>
 358 |     | <span class='neutral'>            arg := shr(232, calldataload(add(offset, argOffset)))</span>
 359 |     | <span class='neutral'>        }</span>
 360 |     | <span class='neutral'>    }</span>
 361 |     | <span class='neutral'></span>
 362 |     | <span class='neutral'>    /// @dev Reads an immutable arg with type uint16.</span>
 363 |     | <span class='neutral'>    function _getArgUint16(uint256 argOffset) internal pure returns (uint16 arg) {</span>
 364 |     | <span class='neutral'>        uint256 offset = _getImmutableArgsOffset();</span>
 365 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 366 |     | <span class='neutral'>        assembly {</span>
 367 |     | <span class='neutral'>            arg := shr(240, calldataload(add(offset, argOffset)))</span>
 368 |     | <span class='neutral'>        }</span>
 369 |     | <span class='neutral'>    }</span>
 370 |     | <span class='neutral'></span>
 371 |     | <span class='neutral'>    /// @dev Reads an immutable arg with type uint8.</span>
 372 |     | <span class='neutral'>    function _getArgUint8(uint256 argOffset) internal pure returns (uint8 arg) {</span>
 373 |     | <span class='neutral'>        uint256 offset = _getImmutableArgsOffset();</span>
 374 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 375 |     | <span class='neutral'>        assembly {</span>
 376 |     | <span class='neutral'>            arg := shr(248, calldataload(add(offset, argOffset)))</span>
 377 |     | <span class='neutral'>        }</span>
 378 |     | <span class='neutral'>    }</span>
 379 |     | <span class='neutral'></span>
 380 |     | <span class='neutral'>    /// @return offset The offset of the packed immutable args in calldata.</span>
 381 | *   | <span class='executed'>    function _getImmutableArgsOffset() internal pure returns (uint256 offset) {</span>
 382 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 383 |     | <span class='neutral'>        assembly {</span>
 384 | *   | <span class='executed'>            offset := sub(calldatasize(), shr(240, calldataload(sub(calldatasize(), 2))))</span>
 385 |     | <span class='neutral'>        }</span>
 386 |     | <span class='neutral'>    }</span>
 387 |     | <span class='neutral'>}</span>
 388 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/lib/solady/src/utils/LibClone.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: MIT</span>
   2 |     | <span class='neutral'>pragma solidity ^0.8.4;</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>/// @notice Minimal proxy library.</span>
   5 |     | <span class='neutral'>/// @author Solady (https://github.com/vectorized/solady/blob/main/src/utils/LibClone.sol)</span>
   6 |     | <span class='neutral'>/// @author Minimal proxy by 0age (https://github.com/0age)</span>
   7 |     | <span class='neutral'>/// @author Clones with immutable args by wighawag, zefram.eth, Saw-mon &amp; Natalie</span>
   8 |     | <span class='neutral'>/// (https://github.com/Saw-mon-and-Natalie/clones-with-immutable-args)</span>
   9 |     | <span class='neutral'>///</span>
  10 |     | <span class='neutral'>/// @dev Minimal proxy:</span>
  11 |     | <span class='neutral'>/// Although the sw0nt pattern saves 5 gas over the erc-1167 pattern during runtime,</span>
  12 |     | <span class='neutral'>/// it is not supported out-of-the-box on Etherscan. Hence, we choose to use the 0age pattern,</span>
  13 |     | <span class='neutral'>/// which saves 4 gas over the erc-1167 pattern during runtime, and has the smallest bytecode.</span>
  14 |     | <span class='neutral'>///</span>
  15 |     | <span class='neutral'>/// @dev Minimal proxy (PUSH0 variant):</span>
  16 |     | <span class='neutral'>/// This is a new minimal proxy that uses the PUSH0 opcode introduced during Shanghai.</span>
  17 |     | <span class='neutral'>/// It is optimized first for minimal runtime gas, then for minimal bytecode.</span>
  18 |     | <span class='neutral'>/// The PUSH0 clone functions are intentionally postfixed with a jarring &quot;_PUSH0&quot; as</span>
  19 |     | <span class='neutral'>/// many EVM chains may not support the PUSH0 opcode in the early months after Shanghai.</span>
  20 |     | <span class='neutral'>/// Please use with caution.</span>
  21 |     | <span class='neutral'>///</span>
  22 |     | <span class='neutral'>/// @dev Clones with immutable args (CWIA):</span>
  23 |     | <span class='neutral'>/// The implementation of CWIA here implements a `receive()` method that emits the</span>
  24 |     | <span class='neutral'>/// `ReceiveETH(uint256)` event. This skips the `DELEGATECALL` when there is no calldata,</span>
  25 |     | <span class='neutral'>/// enabling us to accept hard gas-capped `sends` &amp; `transfers` for maximum backwards</span>
  26 |     | <span class='neutral'>/// composability. The minimal proxy implementation does not offer this feature.</span>
  27 |     | <span class='unexecuted'>library LibClone {</span>
  28 |     | <span class='neutral'>    /*:.+.*.*:.*..:..*.*:.*..:.+.*.*:*/</span>
  29 |     | <span class='neutral'>    /*                       CUSTOM ERRORS                        */</span>
  30 |     | <span class='neutral'>    /*.:.+.*.:*.*.+.:*.*..:.:.*.:*.+.*/</span>
  31 |     | <span class='neutral'></span>
  32 |     | <span class='neutral'>    /// @dev Unable to deploy the clone.</span>
  33 |     | <span class='neutral'>    error DeploymentFailed();</span>
  34 |     | <span class='neutral'></span>
  35 |     | <span class='neutral'>    /// @dev The salt must start with either the zero address or the caller.</span>
  36 |     | <span class='neutral'>    error SaltDoesNotStartWithCaller();</span>
  37 |     | <span class='neutral'></span>
  38 |     | <span class='neutral'>    /*:.+.*.*:.*..:..*.*:.*..:.+.*.*:*/</span>
  39 |     | <span class='neutral'>    /*                  MINIMAL PROXY OPERATIONS                  */</span>
  40 |     | <span class='neutral'>    /*.:.+.*.:*.*.+.:*.*..:.:.*.:*.+.*/</span>
  41 |     | <span class='neutral'></span>
  42 |     | <span class='neutral'>    /// @dev Deploys a clone of `implementation`.</span>
  43 |     | <span class='neutral'>    function clone(address implementation) internal returns (address instance) {</span>
  44 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
  45 |     | <span class='neutral'>        assembly {</span>
  46 |     | <span class='neutral'>            /**</span>
  47 |     | <span class='neutral'>             * --------------------------------------------------------------------------+</span>
  48 |     | <span class='neutral'>             * CREATION (9 bytes)                                                        |</span>
  49 |     | <span class='neutral'>             * --------------------------------------------------------------------------|</span>
  50 |     | <span class='neutral'>             * Opcode     | Mnemonic          | Stack     | Memory                       |</span>
  51 |     | <span class='neutral'>             * --------------------------------------------------------------------------|</span>
  52 |     | <span class='neutral'>             * 60 runSize | PUSH1 runSize     | r         |                              |</span>
  53 |     | <span class='neutral'>             * 3d         | RETURNDATASIZE    | 0 r       |                              |</span>
  54 |     | <span class='neutral'>             * 81         | DUP2              | r 0 r     |                              |</span>
  55 |     | <span class='neutral'>             * 60 offset  | PUSH1 offset      | o r 0 r   |                              |</span>
  56 |     | <span class='neutral'>             * 3d         | RETURNDATASIZE    | 0 o r 0 r |                              |</span>
  57 |     | <span class='neutral'>             * 39         | CODECOPY          | 0 r       | [0..runSize): runtime code   |</span>
  58 |     | <span class='neutral'>             * f3         | RETURN            |           | [0..runSize): runtime code   |</span>
  59 |     | <span class='neutral'>             * --------------------------------------------------------------------------|</span>
  60 |     | <span class='neutral'>             * RUNTIME (44 bytes)                                                        |</span>
  61 |     | <span class='neutral'>             * --------------------------------------------------------------------------|</span>
  62 |     | <span class='neutral'>             * Opcode  | Mnemonic       | Stack                  | Memory                |</span>
  63 |     | <span class='neutral'>             * --------------------------------------------------------------------------|</span>
  64 |     | <span class='neutral'>             *                                                                           |</span>
  65 |     | <span class='neutral'>             * ::: keep some values in stack ::::::::::::::::::::::::::::::::::::::::::: |</span>
  66 |     | <span class='neutral'>             * 3d      | RETURNDATASIZE | 0                      |                       |</span>
  67 |     | <span class='neutral'>             * 3d      | RETURNDATASIZE | 0 0                    |                       |</span>
  68 |     | <span class='neutral'>             * 3d      | RETURNDATASIZE | 0 0 0                  |                       |</span>
  69 |     | <span class='neutral'>             * 3d      | RETURNDATASIZE | 0 0 0 0                |                       |</span>
  70 |     | <span class='neutral'>             *                                                                           |</span>
  71 |     | <span class='neutral'>             * ::: copy calldata to memory ::::::::::::::::::::::::::::::::::::::::::::: |</span>
  72 |     | <span class='neutral'>             * 36      | CALLDATASIZE   | cds 0 0 0 0            |                       |</span>
  73 |     | <span class='neutral'>             * 3d      | RETURNDATASIZE | 0 cds 0 0 0 0          |                       |</span>
  74 |     | <span class='neutral'>             * 3d      | RETURNDATASIZE | 0 0 cds 0 0 0 0        |                       |</span>
  75 |     | <span class='neutral'>             * 37      | CALLDATACOPY   | 0 0 0 0                | [0..cds): calldata    |</span>
  76 |     | <span class='neutral'>             *                                                                           |</span>
  77 |     | <span class='neutral'>             * ::: delegate call to the implementation contract :::::::::::::::::::::::: |</span>
  78 |     | <span class='neutral'>             * 36      | CALLDATASIZE   | cds 0 0 0 0            | [0..cds): calldata    |</span>
  79 |     | <span class='neutral'>             * 3d      | RETURNDATASIZE | 0 cds 0 0 0 0          | [0..cds): calldata    |</span>
  80 |     | <span class='neutral'>             * 73 addr | PUSH20 addr    | addr 0 cds 0 0 0 0     | [0..cds): calldata    |</span>
  81 |     | <span class='neutral'>             * 5a      | GAS            | gas addr 0 cds 0 0 0 0 | [0..cds): calldata    |</span>
  82 |     | <span class='neutral'>             * f4      | DELEGATECALL   | success 0 0            | [0..cds): calldata    |</span>
  83 |     | <span class='neutral'>             *                                                                           |</span>
  84 |     | <span class='neutral'>             * ::: copy return data to memory :::::::::::::::::::::::::::::::::::::::::: |</span>
  85 |     | <span class='neutral'>             * 3d      | RETURNDATASIZE | rds success 0 0        | [0..cds): calldata    |</span>
  86 |     | <span class='neutral'>             * 3d      | RETURNDATASIZE | rds rds success 0 0    | [0..cds): calldata    |</span>
  87 |     | <span class='neutral'>             * 93      | SWAP4          | 0 rds success 0 rds    | [0..cds): calldata    |</span>
  88 |     | <span class='neutral'>             * 80      | DUP1           | 0 0 rds success 0 rds  | [0..cds): calldata    |</span>
  89 |     | <span class='neutral'>             * 3e      | RETURNDATACOPY | success 0 rds          | [0..rds): returndata  |</span>
  90 |     | <span class='neutral'>             *                                                                           |</span>
  91 |     | <span class='neutral'>             * 60 0x2a | PUSH1 0x2a     | 0x2a success 0 rds     | [0..rds): returndata  |</span>
  92 |     | <span class='neutral'>             * 57      | JUMPI          | 0 rds                  | [0..rds): returndata  |</span>
  93 |     | <span class='neutral'>             *                                                                           |</span>
  94 |     | <span class='neutral'>             * ::: revert :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: |</span>
  95 |     | <span class='neutral'>             * fd      | REVERT         |                        | [0..rds): returndata  |</span>
  96 |     | <span class='neutral'>             *                                                                           |</span>
  97 |     | <span class='neutral'>             * ::: return :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: |</span>
  98 |     | <span class='neutral'>             * 5b      | JUMPDEST       | 0 rds                  | [0..rds): returndata  |</span>
  99 |     | <span class='neutral'>             * f3      | RETURN         |                        | [0..rds): returndata  |</span>
 100 |     | <span class='neutral'>             * --------------------------------------------------------------------------+</span>
 101 |     | <span class='neutral'>             */</span>
 102 |     | <span class='neutral'></span>
 103 |     | <span class='neutral'>            mstore(0x21, 0x5af43d3d93803e602a57fd5bf3)</span>
 104 |     | <span class='neutral'>            mstore(0x14, implementation)</span>
 105 |     | <span class='neutral'>            mstore(0x00, 0x602c3d8160093d39f33d3d3d3d363d3d37363d73)</span>
 106 |     | <span class='neutral'>            instance := create(0, 0x0c, 0x35)</span>
 107 |     | <span class='neutral'>            // If `instance` is zero, revert.</span>
 108 |     | <span class='neutral'>            if iszero(instance) {</span>
 109 |     | <span class='neutral'>                // Store the function selector of `DeploymentFailed()`.</span>
 110 |     | <span class='neutral'>                mstore(0x00, 0x30116425)</span>
 111 |     | <span class='neutral'>                // Revert with (offset, size).</span>
 112 |     | <span class='neutral'>                revert(0x1c, 0x04)</span>
 113 |     | <span class='neutral'>            }</span>
 114 |     | <span class='neutral'>            // Restore the part of the free memory pointer that has been overwritten.</span>
 115 |     | <span class='neutral'>            mstore(0x21, 0)</span>
 116 |     | <span class='neutral'>        }</span>
 117 |     | <span class='neutral'>    }</span>
 118 |     | <span class='neutral'></span>
 119 |     | <span class='neutral'>    /// @dev Deploys a deterministic clone of `implementation` with `salt`.</span>
 120 |     | <span class='neutral'>    function cloneDeterministic(address implementation, bytes32 salt)</span>
 121 |     | <span class='neutral'>        internal</span>
 122 |     | <span class='neutral'>        returns (address instance)</span>
 123 |     | <span class='neutral'>    {</span>
 124 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 125 |     | <span class='neutral'>        assembly {</span>
 126 |     | <span class='neutral'>            mstore(0x21, 0x5af43d3d93803e602a57fd5bf3)</span>
 127 |     | <span class='neutral'>            mstore(0x14, implementation)</span>
 128 |     | <span class='neutral'>            mstore(0x00, 0x602c3d8160093d39f33d3d3d3d363d3d37363d73)</span>
 129 |     | <span class='neutral'>            instance := create2(0, 0x0c, 0x35, salt)</span>
 130 |     | <span class='neutral'>            // If `instance` is zero, revert.</span>
 131 |     | <span class='neutral'>            if iszero(instance) {</span>
 132 |     | <span class='neutral'>                // Store the function selector of `DeploymentFailed()`.</span>
 133 |     | <span class='neutral'>                mstore(0x00, 0x30116425)</span>
 134 |     | <span class='neutral'>                // Revert with (offset, size).</span>
 135 |     | <span class='neutral'>                revert(0x1c, 0x04)</span>
 136 |     | <span class='neutral'>            }</span>
 137 |     | <span class='neutral'>            // Restore the part of the free memory pointer that has been overwritten.</span>
 138 |     | <span class='neutral'>            mstore(0x21, 0)</span>
 139 |     | <span class='neutral'>        }</span>
 140 |     | <span class='neutral'>    }</span>
 141 |     | <span class='neutral'></span>
 142 |     | <span class='neutral'>    /// @dev Returns the initialization code hash of the clone of `implementation`.</span>
 143 |     | <span class='neutral'>    /// Used for mining vanity addresses with create2crunch.</span>
 144 |     | <span class='neutral'>    function initCodeHash(address implementation) internal pure returns (bytes32 hash) {</span>
 145 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 146 |     | <span class='neutral'>        assembly {</span>
 147 |     | <span class='neutral'>            mstore(0x21, 0x5af43d3d93803e602a57fd5bf3)</span>
 148 |     | <span class='neutral'>            mstore(0x14, implementation)</span>
 149 |     | <span class='neutral'>            mstore(0x00, 0x602c3d8160093d39f33d3d3d3d363d3d37363d73)</span>
 150 |     | <span class='neutral'>            hash := keccak256(0x0c, 0x35)</span>
 151 |     | <span class='neutral'>            // Restore the part of the free memory pointer that has been overwritten.</span>
 152 |     | <span class='neutral'>            mstore(0x21, 0)</span>
 153 |     | <span class='neutral'>        }</span>
 154 |     | <span class='neutral'>    }</span>
 155 |     | <span class='neutral'></span>
 156 |     | <span class='neutral'>    /// @dev Returns the address of the deterministic clone of `implementation`,</span>
 157 |     | <span class='neutral'>    /// with `salt` by `deployer`.</span>
 158 |     | <span class='neutral'>    /// Note: The returned result has dirty upper 96 bits. Please clean if used in assembly.</span>
 159 |     | <span class='neutral'>    function predictDeterministicAddress(address implementation, bytes32 salt, address deployer)</span>
 160 |     | <span class='neutral'>        internal</span>
 161 |     | <span class='neutral'>        pure</span>
 162 |     | <span class='neutral'>        returns (address predicted)</span>
 163 |     | <span class='neutral'>    {</span>
 164 |     | <span class='neutral'>        bytes32 hash = initCodeHash(implementation);</span>
 165 |     | <span class='neutral'>        predicted = predictDeterministicAddress(hash, salt, deployer);</span>
 166 |     | <span class='neutral'>    }</span>
 167 |     | <span class='neutral'></span>
 168 |     | <span class='neutral'>    /*:.+.*.*:.*..:..*.*:.*..:.+.*.*:*/</span>
 169 |     | <span class='neutral'>    /*          MINIMAL PROXY OPERATIONS (PUSH0 VARIANT)          */</span>
 170 |     | <span class='neutral'>    /*.:.+.*.:*.*.+.:*.*..:.:.*.:*.+.*/</span>
 171 |     | <span class='neutral'></span>
 172 |     | <span class='neutral'>    /// @dev Deploys a PUSH0 clone of `implementation`.</span>
 173 |     | <span class='neutral'>    function clone_PUSH0(address implementation) internal returns (address instance) {</span>
 174 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 175 |     | <span class='neutral'>        assembly {</span>
 176 |     | <span class='neutral'>            /**</span>
 177 |     | <span class='neutral'>             * --------------------------------------------------------------------------+</span>
 178 |     | <span class='neutral'>             * CREATION (9 bytes)                                                        |</span>
 179 |     | <span class='neutral'>             * --------------------------------------------------------------------------|</span>
 180 |     | <span class='neutral'>             * Opcode     | Mnemonic          | Stack     | Memory                       |</span>
 181 |     | <span class='neutral'>             * --------------------------------------------------------------------------|</span>
 182 |     | <span class='neutral'>             * 60 runSize | PUSH1 runSize     | r         |                              |</span>
 183 |     | <span class='neutral'>             * 5f         | PUSH0             | 0 r       |                              |</span>
 184 |     | <span class='neutral'>             * 81         | DUP2              | r 0 r     |                              |</span>
 185 |     | <span class='neutral'>             * 60 offset  | PUSH1 offset      | o r 0 r   |                              |</span>
 186 |     | <span class='neutral'>             * 5f         | PUSH0             | 0 o r 0 r |                              |</span>
 187 |     | <span class='neutral'>             * 39         | CODECOPY          | 0 r       | [0..runSize): runtime code   |</span>
 188 |     | <span class='neutral'>             * f3         | RETURN            |           | [0..runSize): runtime code   |</span>
 189 |     | <span class='neutral'>             * --------------------------------------------------------------------------|</span>
 190 |     | <span class='neutral'>             * RUNTIME (45 bytes)                                                        |</span>
 191 |     | <span class='neutral'>             * --------------------------------------------------------------------------|</span>
 192 |     | <span class='neutral'>             * Opcode  | Mnemonic       | Stack                  | Memory                |</span>
 193 |     | <span class='neutral'>             * --------------------------------------------------------------------------|</span>
 194 |     | <span class='neutral'>             *                                                                           |</span>
 195 |     | <span class='neutral'>             * ::: keep some values in stack ::::::::::::::::::::::::::::::::::::::::::: |</span>
 196 |     | <span class='neutral'>             * 5f      | PUSH0          | 0                      |                       |</span>
 197 |     | <span class='neutral'>             * 5f      | PUSH0          | 0 0                    |                       |</span>
 198 |     | <span class='neutral'>             *                                                                           |</span>
 199 |     | <span class='neutral'>             * ::: copy calldata to memory ::::::::::::::::::::::::::::::::::::::::::::: |</span>
 200 |     | <span class='neutral'>             * 36      | CALLDATASIZE   | cds 0 0                |                       |</span>
 201 |     | <span class='neutral'>             * 5f      | PUSH0          | 0 cds 0 0              |                       |</span>
 202 |     | <span class='neutral'>             * 5f      | PUSH0          | 0 0 cds 0 0            |                       |</span>
 203 |     | <span class='neutral'>             * 37      | CALLDATACOPY   | 0 0                    | [0..cds): calldata    |</span>
 204 |     | <span class='neutral'>             *                                                                           |</span>
 205 |     | <span class='neutral'>             * ::: delegate call to the implementation contract :::::::::::::::::::::::: |</span>
 206 |     | <span class='neutral'>             * 36      | CALLDATASIZE   | cds 0 0                | [0..cds): calldata    |</span>
 207 |     | <span class='neutral'>             * 5f      | PUSH0          | 0 cds 0 0              | [0..cds): calldata    |</span>
 208 |     | <span class='neutral'>             * 73 addr | PUSH20 addr    | addr 0 cds 0 0         | [0..cds): calldata    |</span>
 209 |     | <span class='neutral'>             * 5a      | GAS            | gas addr 0 cds 0 0     | [0..cds): calldata    |</span>
 210 |     | <span class='neutral'>             * f4      | DELEGATECALL   | success                | [0..cds): calldata    |</span>
 211 |     | <span class='neutral'>             *                                                                           |</span>
 212 |     | <span class='neutral'>             * ::: copy return data to memory :::::::::::::::::::::::::::::::::::::::::: |</span>
 213 |     | <span class='neutral'>             * 3d      | RETURNDATASIZE | rds success            | [0..cds): calldata    |</span>
 214 |     | <span class='neutral'>             * 5f      | PUSH0          | 0 rds success          | [0..cds): calldata    |</span>
 215 |     | <span class='neutral'>             * 5f      | PUSH0          | 0 0 rds success        | [0..cds): calldata    |</span>
 216 |     | <span class='neutral'>             * 3e      | RETURNDATACOPY | success                | [0..rds): returndata  |</span>
 217 |     | <span class='neutral'>             *                                                                           |</span>
 218 |     | <span class='neutral'>             * 60 0x29 | PUSH1 0x29     | 0x29 success           | [0..rds): returndata  |</span>
 219 |     | <span class='neutral'>             * 57      | JUMPI          |                        | [0..rds): returndata  |</span>
 220 |     | <span class='neutral'>             *                                                                           |</span>
 221 |     | <span class='neutral'>             * ::: revert :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: |</span>
 222 |     | <span class='neutral'>             * 3d      | RETURNDATASIZE | rds                    | [0..rds): returndata  |</span>
 223 |     | <span class='neutral'>             * 5f      | PUSH0          | 0 rds                  | [0..rds): returndata  |</span>
 224 |     | <span class='neutral'>             * fd      | REVERT         |                        | [0..rds): returndata  |</span>
 225 |     | <span class='neutral'>             *                                                                           |</span>
 226 |     | <span class='neutral'>             * ::: return :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: |</span>
 227 |     | <span class='neutral'>             * 5b      | JUMPDEST       |                        | [0..rds): returndata  |</span>
 228 |     | <span class='neutral'>             * 3d      | RETURNDATASIZE | rds                    | [0..rds): returndata  |</span>
 229 |     | <span class='neutral'>             * 5f      | PUSH0          | 0 rds                  | [0..rds): returndata  |</span>
 230 |     | <span class='neutral'>             * f3      | RETURN         |                        | [0..rds): returndata  |</span>
 231 |     | <span class='neutral'>             * --------------------------------------------------------------------------+</span>
 232 |     | <span class='neutral'>             */</span>
 233 |     | <span class='neutral'></span>
 234 |     | <span class='neutral'>            mstore(0x24, 0x5af43d5f5f3e6029573d5ffd5b3d5ff3) // 16</span>
 235 |     | <span class='neutral'>            mstore(0x14, implementation) // 20</span>
 236 |     | <span class='neutral'>            mstore(0x00, 0x602d5f8160095f39f35f5f365f5f37365f73) // 9 + 9</span>
 237 |     | <span class='neutral'>            instance := create(0, 0x0e, 0x36)</span>
 238 |     | <span class='neutral'>            // If `instance` is zero, revert.</span>
 239 |     | <span class='neutral'>            if iszero(instance) {</span>
 240 |     | <span class='neutral'>                // Store the function selector of `DeploymentFailed()`.</span>
 241 |     | <span class='neutral'>                mstore(0x00, 0x30116425)</span>
 242 |     | <span class='neutral'>                // Revert with (offset, size).</span>
 243 |     | <span class='neutral'>                revert(0x1c, 0x04)</span>
 244 |     | <span class='neutral'>            }</span>
 245 |     | <span class='neutral'>            // Restore the part of the free memory pointer that has been overwritten.</span>
 246 |     | <span class='neutral'>            mstore(0x24, 0)</span>
 247 |     | <span class='neutral'>        }</span>
 248 |     | <span class='neutral'>    }</span>
 249 |     | <span class='neutral'></span>
 250 |     | <span class='neutral'>    /// @dev Deploys a deterministic PUSH0 clone of `implementation` with `salt`.</span>
 251 |     | <span class='neutral'>    function cloneDeterministic_PUSH0(address implementation, bytes32 salt)</span>
 252 |     | <span class='neutral'>        internal</span>
 253 |     | <span class='neutral'>        returns (address instance)</span>
 254 |     | <span class='neutral'>    {</span>
 255 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 256 |     | <span class='neutral'>        assembly {</span>
 257 |     | <span class='neutral'>            mstore(0x24, 0x5af43d5f5f3e6029573d5ffd5b3d5ff3) // 16</span>
 258 |     | <span class='neutral'>            mstore(0x14, implementation) // 20</span>
 259 |     | <span class='neutral'>            mstore(0x00, 0x602d5f8160095f39f35f5f365f5f37365f73) // 9 + 9</span>
 260 |     | <span class='neutral'>            instance := create2(0, 0x0e, 0x36, salt)</span>
 261 |     | <span class='neutral'>            // If `instance` is zero, revert.</span>
 262 |     | <span class='neutral'>            if iszero(instance) {</span>
 263 |     | <span class='neutral'>                // Store the function selector of `DeploymentFailed()`.</span>
 264 |     | <span class='neutral'>                mstore(0x00, 0x30116425)</span>
 265 |     | <span class='neutral'>                // Revert with (offset, size).</span>
 266 |     | <span class='neutral'>                revert(0x1c, 0x04)</span>
 267 |     | <span class='neutral'>            }</span>
 268 |     | <span class='neutral'>            // Restore the part of the free memory pointer that has been overwritten.</span>
 269 |     | <span class='neutral'>            mstore(0x24, 0)</span>
 270 |     | <span class='neutral'>        }</span>
 271 |     | <span class='neutral'>    }</span>
 272 |     | <span class='neutral'></span>
 273 |     | <span class='neutral'>    /// @dev Returns the initialization code hash of the PUSH0 clone of `implementation`.</span>
 274 |     | <span class='neutral'>    /// Used for mining vanity addresses with create2crunch.</span>
 275 |     | <span class='neutral'>    function initCodeHash_PUSH0(address implementation) internal pure returns (bytes32 hash) {</span>
 276 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 277 |     | <span class='neutral'>        assembly {</span>
 278 |     | <span class='neutral'>            mstore(0x24, 0x5af43d5f5f3e6029573d5ffd5b3d5ff3) // 16</span>
 279 |     | <span class='neutral'>            mstore(0x14, implementation) // 20</span>
 280 |     | <span class='neutral'>            mstore(0x00, 0x602d5f8160095f39f35f5f365f5f37365f73) // 9 + 9</span>
 281 |     | <span class='neutral'>            hash := keccak256(0x0e, 0x36)</span>
 282 |     | <span class='neutral'>            // Restore the part of the free memory pointer that has been overwritten.</span>
 283 |     | <span class='neutral'>            mstore(0x24, 0)</span>
 284 |     | <span class='neutral'>        }</span>
 285 |     | <span class='neutral'>    }</span>
 286 |     | <span class='neutral'></span>
 287 |     | <span class='neutral'>    /// @dev Returns the address of the deterministic PUSH0 clone of `implementation`,</span>
 288 |     | <span class='neutral'>    /// with `salt` by `deployer`.</span>
 289 |     | <span class='neutral'>    /// Note: The returned result has dirty upper 96 bits. Please clean if used in assembly.</span>
 290 |     | <span class='neutral'>    function predictDeterministicAddress_PUSH0(</span>
 291 |     | <span class='neutral'>        address implementation,</span>
 292 |     | <span class='neutral'>        bytes32 salt,</span>
 293 |     | <span class='neutral'>        address deployer</span>
 294 |     | <span class='neutral'>    ) internal pure returns (address predicted) {</span>
 295 |     | <span class='neutral'>        bytes32 hash = initCodeHash_PUSH0(implementation);</span>
 296 |     | <span class='neutral'>        predicted = predictDeterministicAddress(hash, salt, deployer);</span>
 297 |     | <span class='neutral'>    }</span>
 298 |     | <span class='neutral'></span>
 299 |     | <span class='neutral'>    /*:.+.*.*:.*..:..*.*:.*..:.+.*.*:*/</span>
 300 |     | <span class='neutral'>    /*           CLONES WITH IMMUTABLE ARGS OPERATIONS            */</span>
 301 |     | <span class='neutral'>    /*.:.+.*.:*.*.+.:*.*..:.:.*.:*.+.*/</span>
 302 |     | <span class='neutral'></span>
 303 |     | <span class='neutral'>    /// @dev Deploys a minimal proxy with `implementation`,</span>
 304 |     | <span class='neutral'>    /// using immutable arguments encoded in `data`.</span>
 305 |     | <span class='neutral'>    ///</span>
 306 |     | <span class='neutral'>    /// Note: This implementation of CWIA differs from the original implementation.</span>
 307 |     | <span class='neutral'>    /// If the calldata is empty, it will emit a `ReceiveETH(uint256)` event and skip the `DELEGATECALL`.</span>
 308 |     | <span class='unexecuted'>    function clone(address implementation, bytes memory data) internal returns (address instance) {</span>
 309 |     | <span class='neutral'>        assembly {</span>
 310 |     | <span class='neutral'>            // Compute the boundaries of the data and cache the memory slots around it.</span>
 311 |     | <span class='unexecuted'>            let mBefore3 := mload(sub(data, 0x60))</span>
 312 |     | <span class='unexecuted'>            let mBefore2 := mload(sub(data, 0x40))</span>
 313 |     | <span class='unexecuted'>            let mBefore1 := mload(sub(data, 0x20))</span>
 314 |     | <span class='unexecuted'>            let dataLength := mload(data)</span>
 315 |     | <span class='unexecuted'>            let dataEnd := add(add(data, 0x20), dataLength)</span>
 316 |     | <span class='unexecuted'>            let mAfter1 := mload(dataEnd)</span>
 317 |     | <span class='neutral'></span>
 318 |     | <span class='neutral'>            // +2 bytes for telling how much data there is appended to the call.</span>
 319 |     | <span class='unexecuted'>            let extraLength := add(dataLength, 2)</span>
 320 |     | <span class='neutral'>            // The `creationSize` is `extraLength + 108`</span>
 321 |     | <span class='neutral'>            // The `runSize` is `creationSize - 10`.</span>
 322 |     | <span class='neutral'></span>
 323 |     | <span class='neutral'>            /**</span>
 324 |     | <span class='neutral'>             * ---------------------------------------------------------------------------------------------------+</span>
 325 |     | <span class='neutral'>             * CREATION (10 bytes)                                                                                |</span>
 326 |     | <span class='neutral'>             * ---------------------------------------------------------------------------------------------------|</span>
 327 |     | <span class='neutral'>             * Opcode     | Mnemonic          | Stack     | Memory                                                |</span>
 328 |     | <span class='neutral'>             * ---------------------------------------------------------------------------------------------------|</span>
 329 |     | <span class='neutral'>             * 61 runSize | PUSH2 runSize     | r         |                                                       |</span>
 330 |     | <span class='neutral'>             * 3d         | RETURNDATASIZE    | 0 r       |                                                       |</span>
 331 |     | <span class='neutral'>             * 81         | DUP2              | r 0 r     |                                                       |</span>
 332 |     | <span class='neutral'>             * 60 offset  | PUSH1 offset      | o r 0 r   |                                                       |</span>
 333 |     | <span class='neutral'>             * 3d         | RETURNDATASIZE    | 0 o r 0 r |                                                       |</span>
 334 |     | <span class='neutral'>             * 39         | CODECOPY          | 0 r       | [0..runSize): runtime code                            |</span>
 335 |     | <span class='neutral'>             * f3         | RETURN            |           | [0..runSize): runtime code                            |</span>
 336 |     | <span class='neutral'>             * ---------------------------------------------------------------------------------------------------|</span>
 337 |     | <span class='neutral'>             * RUNTIME (98 bytes + extraLength)                                                                   |</span>
 338 |     | <span class='neutral'>             * ---------------------------------------------------------------------------------------------------|</span>
 339 |     | <span class='neutral'>             * Opcode   | Mnemonic       | Stack                    | Memory                                      |</span>
 340 |     | <span class='neutral'>             * ---------------------------------------------------------------------------------------------------|</span>
 341 |     | <span class='neutral'>             *                                                                                                    |</span>
 342 |     | <span class='neutral'>             * ::: if no calldata, emit event &amp; return w/o `DELEGATECALL` ::::::::::::::::::::::::::::::::::::::: |</span>
 343 |     | <span class='neutral'>             * 36       | CALLDATASIZE   | cds                      |                                             |</span>
 344 |     | <span class='neutral'>             * 60 0x2c  | PUSH1 0x2c     | 0x2c cds                 |                                             |</span>
 345 |     | <span class='neutral'>             * 57       | JUMPI          |                          |                                             |</span>
 346 |     | <span class='neutral'>             * 34       | CALLVALUE      | cv                       |                                             |</span>
 347 |     | <span class='neutral'>             * 3d       | RETURNDATASIZE | 0 cv                     |                                             |</span>
 348 |     | <span class='neutral'>             * 52       | MSTORE         |                          | [0..0x20): callvalue                        |</span>
 349 |     | <span class='neutral'>             * 7f sig   | PUSH32 0x9e..  | sig                      | [0..0x20): callvalue                        |</span>
 350 |     | <span class='neutral'>             * 59       | MSIZE          | 0x20 sig                 | [0..0x20): callvalue                        |</span>
 351 |     | <span class='neutral'>             * 3d       | RETURNDATASIZE | 0 0x20 sig               | [0..0x20): callvalue                        |</span>
 352 |     | <span class='neutral'>             * a1       | LOG1           |                          | [0..0x20): callvalue                        |</span>
 353 |     | <span class='neutral'>             * 00       | STOP           |                          | [0..0x20): callvalue                        |</span>
 354 |     | <span class='neutral'>             * 5b       | JUMPDEST       |                          |                                             |</span>
 355 |     | <span class='neutral'>             *                                                                                                    |</span>
 356 |     | <span class='neutral'>             * ::: copy calldata to memory :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: |</span>
 357 |     | <span class='neutral'>             * 36       | CALLDATASIZE   | cds                      |                                             |</span>
 358 |     | <span class='neutral'>             * 3d       | RETURNDATASIZE | 0 cds                    |                                             |</span>
 359 |     | <span class='neutral'>             * 3d       | RETURNDATASIZE | 0 0 cds                  |                                             |</span>
 360 |     | <span class='neutral'>             * 37       | CALLDATACOPY   |                          | [0..cds): calldata                          |</span>
 361 |     | <span class='neutral'>             *                                                                                                    |</span>
 362 |     | <span class='neutral'>             * ::: keep some values in stack :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: |</span>
 363 |     | <span class='neutral'>             * 3d       | RETURNDATASIZE | 0                        | [0..cds): calldata                          |</span>
 364 |     | <span class='neutral'>             * 3d       | RETURNDATASIZE | 0 0                      | [0..cds): calldata                          |</span>
 365 |     | <span class='neutral'>             * 3d       | RETURNDATASIZE | 0 0 0                    | [0..cds): calldata                          |</span>
 366 |     | <span class='neutral'>             * 3d       | RETURNDATASIZE | 0 0 0 0                  | [0..cds): calldata                          |</span>
 367 |     | <span class='neutral'>             * 61 extra | PUSH2 extra    | e 0 0 0 0                | [0..cds): calldata                          |</span>
 368 |     | <span class='neutral'>             *                                                                                                    |</span>
 369 |     | <span class='neutral'>             * ::: copy extra data to memory :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: |</span>
 370 |     | <span class='neutral'>             * 80       | DUP1           | e e 0 0 0 0              | [0..cds): calldata                          |</span>
 371 |     | <span class='neutral'>             * 60 0x62  | PUSH1 0x62     | 0x62 e e 0 0 0 0         | [0..cds): calldata                          |</span>
 372 |     | <span class='neutral'>             * 36       | CALLDATASIZE   | cds 0x62 e e 0 0 0 0     | [0..cds): calldata                          |</span>
 373 |     | <span class='neutral'>             * 39       | CODECOPY       | e 0 0 0 0                | [0..cds): calldata, [cds..cds+e): extraData |</span>
 374 |     | <span class='neutral'>             *                                                                                                    |</span>
 375 |     | <span class='neutral'>             * ::: delegate call to the implementation contract ::::::::::::::::::::::::::::::::::::::::::::::::: |</span>
 376 |     | <span class='neutral'>             * 36       | CALLDATASIZE   | cds e 0 0 0 0            | [0..cds): calldata, [cds..cds+e): extraData |</span>
 377 |     | <span class='neutral'>             * 01       | ADD            | cds+e 0 0 0 0            | [0..cds): calldata, [cds..cds+e): extraData |</span>
 378 |     | <span class='neutral'>             * 3d       | RETURNDATASIZE | 0 cds+e 0 0 0 0          | [0..cds): calldata, [cds..cds+e): extraData |</span>
 379 |     | <span class='neutral'>             * 73 addr  | PUSH20 addr    | addr 0 cds+e 0 0 0 0     | [0..cds): calldata, [cds..cds+e): extraData |</span>
 380 |     | <span class='neutral'>             * 5a       | GAS            | gas addr 0 cds+e 0 0 0 0 | [0..cds): calldata, [cds..cds+e): extraData |</span>
 381 |     | <span class='neutral'>             * f4       | DELEGATECALL   | success 0 0              | [0..cds): calldata, [cds..cds+e): extraData |</span>
 382 |     | <span class='neutral'>             *                                                                                                    |</span>
 383 |     | <span class='neutral'>             * ::: copy return data to memory ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: |</span>
 384 |     | <span class='neutral'>             * 3d       | RETURNDATASIZE | rds success 0 0          | [0..cds): calldata, [cds..cds+e): extraData |</span>
 385 |     | <span class='neutral'>             * 3d       | RETURNDATASIZE | rds rds success 0 0      | [0..cds): calldata, [cds..cds+e): extraData |</span>
 386 |     | <span class='neutral'>             * 93       | SWAP4          | 0 rds success 0 rds      | [0..cds): calldata, [cds..cds+e): extraData |</span>
 387 |     | <span class='neutral'>             * 80       | DUP1           | 0 0 rds success 0 rds    | [0..cds): calldata, [cds..cds+e): extraData |</span>
 388 |     | <span class='neutral'>             * 3e       | RETURNDATACOPY | success 0 rds            | [0..rds): returndata                        |</span>
 389 |     | <span class='neutral'>             *                                                                                                    |</span>
 390 |     | <span class='neutral'>             * 60 0x60  | PUSH1 0x60     | 0x60 success 0 rds       | [0..rds): returndata                        |</span>
 391 |     | <span class='neutral'>             * 57       | JUMPI          | 0 rds                    | [0..rds): returndata                        |</span>
 392 |     | <span class='neutral'>             *                                                                                                    |</span>
 393 |     | <span class='neutral'>             * ::: revert ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: |</span>
 394 |     | <span class='neutral'>             * fd       | REVERT         |                          | [0..rds): returndata                        |</span>
 395 |     | <span class='neutral'>             *                                                                                                    |</span>
 396 |     | <span class='neutral'>             * ::: return ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: |</span>
 397 |     | <span class='neutral'>             * 5b       | JUMPDEST       | 0 rds                    | [0..rds): returndata                        |</span>
 398 |     | <span class='neutral'>             * f3       | RETURN         |                          | [0..rds): returndata                        |</span>
 399 |     | <span class='neutral'>             * ---------------------------------------------------------------------------------------------------+</span>
 400 |     | <span class='neutral'>             */</span>
 401 |     | <span class='neutral'>            // Write the bytecode before the data.</span>
 402 |     | <span class='unexecuted'>            mstore(data, 0x5af43d3d93803e606057fd5bf3)</span>
 403 |     | <span class='neutral'>            // Write the address of the implementation.</span>
 404 |     | <span class='unexecuted'>            mstore(sub(data, 0x0d), implementation)</span>
 405 |     | <span class='neutral'>            // Write the rest of the bytecode.</span>
 406 |     | <span class='unexecuted'>            mstore(</span>
 407 |     | <span class='unexecuted'>                sub(data, 0x21),</span>
 408 |     | <span class='unexecuted'>                or(shl(0x48, extraLength), 0x593da1005b363d3d373d3d3d3d610000806062363936013d73)</span>
 409 |     | <span class='neutral'>            )</span>
 410 |     | <span class='neutral'>            // `keccak256(&quot;ReceiveETH(uint256)&quot;)`</span>
 411 |     | <span class='unexecuted'>            mstore(</span>
 412 |     | <span class='unexecuted'>                sub(data, 0x3a), 0x9e4ac34f21c619cefc926c8bd93b54bf5a39c7ab2127a895af1cc0691d7e3dff</span>
 413 |     | <span class='neutral'>            )</span>
 414 |     | <span class='unexecuted'>            mstore(</span>
 415 |     | <span class='neutral'>                // Do a out-of-gas revert if `extraLength` is too big. 0xffff - 0x62 + 0x01 = 0xff9e.</span>
 416 |     | <span class='neutral'>                // The actual EVM limit may be smaller and may change over time.</span>
 417 |     | <span class='unexecuted'>                sub(data, add(0x59, lt(extraLength, 0xff9e))),</span>
 418 |     | <span class='unexecuted'>                or(shl(0x78, add(extraLength, 0x62)), 0xfd6100003d81600a3d39f336602c57343d527f)</span>
 419 |     | <span class='neutral'>            )</span>
 420 |     | <span class='unexecuted'>            mstore(dataEnd, shl(0xf0, extraLength))</span>
 421 |     | <span class='neutral'></span>
 422 |     | <span class='neutral'>            // Create the instance.</span>
 423 |     | <span class='unexecuted'>            instance := create(0, sub(data, 0x4c), add(extraLength, 0x6c))</span>
 424 |     | <span class='neutral'></span>
 425 |     | <span class='neutral'>            // If `instance` is zero, revert.</span>
 426 |     | <span class='unexecuted'>            if iszero(instance) {</span>
 427 |     | <span class='neutral'>                // Store the function selector of `DeploymentFailed()`.</span>
 428 |     | <span class='unexecuted'>                mstore(0x00, 0x30116425)</span>
 429 |     | <span class='neutral'>                // Revert with (offset, size).</span>
 430 |     | <span class='unexecuted'>                revert(0x1c, 0x04)</span>
 431 |     | <span class='neutral'>            }</span>
 432 |     | <span class='neutral'></span>
 433 |     | <span class='neutral'>            // Restore the overwritten memory surrounding `data`.</span>
 434 |     | <span class='unexecuted'>            mstore(dataEnd, mAfter1)</span>
 435 |     | <span class='unexecuted'>            mstore(data, dataLength)</span>
 436 |     | <span class='unexecuted'>            mstore(sub(data, 0x20), mBefore1)</span>
 437 |     | <span class='unexecuted'>            mstore(sub(data, 0x40), mBefore2)</span>
 438 |     | <span class='unexecuted'>            mstore(sub(data, 0x60), mBefore3)</span>
 439 |     | <span class='neutral'>        }</span>
 440 |     | <span class='neutral'>    }</span>
 441 |     | <span class='neutral'></span>
 442 |     | <span class='neutral'>    /// @dev Deploys a deterministic clone of `implementation`,</span>
 443 |     | <span class='neutral'>    /// using immutable arguments encoded in `data`, with `salt`.</span>
 444 |     | <span class='neutral'>    ///</span>
 445 |     | <span class='neutral'>    /// Note: This implementation of CWIA differs from the original implementation.</span>
 446 |     | <span class='neutral'>    /// If the calldata is empty, it will emit a `ReceiveETH(uint256)` event and skip the `DELEGATECALL`.</span>
 447 |     | <span class='neutral'>    function cloneDeterministic(address implementation, bytes memory data, bytes32 salt)</span>
 448 |     | <span class='neutral'>        internal</span>
 449 |     | <span class='neutral'>        returns (address instance)</span>
 450 |     | <span class='neutral'>    {</span>
 451 |     | <span class='neutral'>        assembly {</span>
 452 |     | <span class='neutral'>            // Compute the boundaries of the data and cache the memory slots around it.</span>
 453 |     | <span class='neutral'>            let mBefore3 := mload(sub(data, 0x60))</span>
 454 |     | <span class='neutral'>            let mBefore2 := mload(sub(data, 0x40))</span>
 455 |     | <span class='neutral'>            let mBefore1 := mload(sub(data, 0x20))</span>
 456 |     | <span class='neutral'>            let dataLength := mload(data)</span>
 457 |     | <span class='neutral'>            let dataEnd := add(add(data, 0x20), dataLength)</span>
 458 |     | <span class='neutral'>            let mAfter1 := mload(dataEnd)</span>
 459 |     | <span class='neutral'></span>
 460 |     | <span class='neutral'>            // +2 bytes for telling how much data there is appended to the call.</span>
 461 |     | <span class='neutral'>            let extraLength := add(dataLength, 2)</span>
 462 |     | <span class='neutral'></span>
 463 |     | <span class='neutral'>            // Write the bytecode before the data.</span>
 464 |     | <span class='neutral'>            mstore(data, 0x5af43d3d93803e606057fd5bf3)</span>
 465 |     | <span class='neutral'>            // Write the address of the implementation.</span>
 466 |     | <span class='neutral'>            mstore(sub(data, 0x0d), implementation)</span>
 467 |     | <span class='neutral'>            // Write the rest of the bytecode.</span>
 468 |     | <span class='neutral'>            mstore(</span>
 469 |     | <span class='neutral'>                sub(data, 0x21),</span>
 470 |     | <span class='neutral'>                or(shl(0x48, extraLength), 0x593da1005b363d3d373d3d3d3d610000806062363936013d73)</span>
 471 |     | <span class='neutral'>            )</span>
 472 |     | <span class='neutral'>            // `keccak256(&quot;ReceiveETH(uint256)&quot;)`</span>
 473 |     | <span class='neutral'>            mstore(</span>
 474 |     | <span class='neutral'>                sub(data, 0x3a), 0x9e4ac34f21c619cefc926c8bd93b54bf5a39c7ab2127a895af1cc0691d7e3dff</span>
 475 |     | <span class='neutral'>            )</span>
 476 |     | <span class='neutral'>            mstore(</span>
 477 |     | <span class='neutral'>                // Do a out-of-gas revert if `extraLength` is too big. 0xffff - 0x62 + 0x01 = 0xff9e.</span>
 478 |     | <span class='neutral'>                // The actual EVM limit may be smaller and may change over time.</span>
 479 |     | <span class='neutral'>                sub(data, add(0x59, lt(extraLength, 0xff9e))),</span>
 480 |     | <span class='neutral'>                or(shl(0x78, add(extraLength, 0x62)), 0xfd6100003d81600a3d39f336602c57343d527f)</span>
 481 |     | <span class='neutral'>            )</span>
 482 |     | <span class='neutral'>            mstore(dataEnd, shl(0xf0, extraLength))</span>
 483 |     | <span class='neutral'></span>
 484 |     | <span class='neutral'>            // Create the instance.</span>
 485 |     | <span class='neutral'>            instance := create2(0, sub(data, 0x4c), add(extraLength, 0x6c), salt)</span>
 486 |     | <span class='neutral'></span>
 487 |     | <span class='neutral'>            // If `instance` is zero, revert.</span>
 488 |     | <span class='neutral'>            if iszero(instance) {</span>
 489 |     | <span class='neutral'>                // Store the function selector of `DeploymentFailed()`.</span>
 490 |     | <span class='neutral'>                mstore(0x00, 0x30116425)</span>
 491 |     | <span class='neutral'>                // Revert with (offset, size).</span>
 492 |     | <span class='neutral'>                revert(0x1c, 0x04)</span>
 493 |     | <span class='neutral'>            }</span>
 494 |     | <span class='neutral'></span>
 495 |     | <span class='neutral'>            // Restore the overwritten memory surrounding `data`.</span>
 496 |     | <span class='neutral'>            mstore(dataEnd, mAfter1)</span>
 497 |     | <span class='neutral'>            mstore(data, dataLength)</span>
 498 |     | <span class='neutral'>            mstore(sub(data, 0x20), mBefore1)</span>
 499 |     | <span class='neutral'>            mstore(sub(data, 0x40), mBefore2)</span>
 500 |     | <span class='neutral'>            mstore(sub(data, 0x60), mBefore3)</span>
 501 |     | <span class='neutral'>        }</span>
 502 |     | <span class='neutral'>    }</span>
 503 |     | <span class='neutral'></span>
 504 |     | <span class='neutral'>    /// @dev Returns the initialization code hash of the clone of `implementation`</span>
 505 |     | <span class='neutral'>    /// using immutable arguments encoded in `data`.</span>
 506 |     | <span class='neutral'>    /// Used for mining vanity addresses with create2crunch.</span>
 507 |     | <span class='neutral'>    function initCodeHash(address implementation, bytes memory data)</span>
 508 |     | <span class='neutral'>        internal</span>
 509 |     | <span class='neutral'>        pure</span>
 510 |     | <span class='neutral'>        returns (bytes32 hash)</span>
 511 |     | <span class='neutral'>    {</span>
 512 |     | <span class='neutral'>        assembly {</span>
 513 |     | <span class='neutral'>            // Compute the boundaries of the data and cache the memory slots around it.</span>
 514 |     | <span class='neutral'>            let mBefore3 := mload(sub(data, 0x60))</span>
 515 |     | <span class='neutral'>            let mBefore2 := mload(sub(data, 0x40))</span>
 516 |     | <span class='neutral'>            let mBefore1 := mload(sub(data, 0x20))</span>
 517 |     | <span class='neutral'>            let dataLength := mload(data)</span>
 518 |     | <span class='neutral'>            let dataEnd := add(add(data, 0x20), dataLength)</span>
 519 |     | <span class='neutral'>            let mAfter1 := mload(dataEnd)</span>
 520 |     | <span class='neutral'></span>
 521 |     | <span class='neutral'>            // Do a out-of-gas revert if `dataLength` is too big. 0xffff - 0x02 - 0x62 = 0xff9b.</span>
 522 |     | <span class='neutral'>            // The actual EVM limit may be smaller and may change over time.</span>
 523 |     | <span class='neutral'>            returndatacopy(returndatasize(), returndatasize(), gt(dataLength, 0xff9b))</span>
 524 |     | <span class='neutral'></span>
 525 |     | <span class='neutral'>            // +2 bytes for telling how much data there is appended to the call.</span>
 526 |     | <span class='neutral'>            let extraLength := add(dataLength, 2)</span>
 527 |     | <span class='neutral'></span>
 528 |     | <span class='neutral'>            // Write the bytecode before the data.</span>
 529 |     | <span class='neutral'>            mstore(data, 0x5af43d3d93803e606057fd5bf3)</span>
 530 |     | <span class='neutral'>            // Write the address of the implementation.</span>
 531 |     | <span class='neutral'>            mstore(sub(data, 0x0d), implementation)</span>
 532 |     | <span class='neutral'>            // Write the rest of the bytecode.</span>
 533 |     | <span class='neutral'>            mstore(</span>
 534 |     | <span class='neutral'>                sub(data, 0x21),</span>
 535 |     | <span class='neutral'>                or(shl(0x48, extraLength), 0x593da1005b363d3d373d3d3d3d610000806062363936013d73)</span>
 536 |     | <span class='neutral'>            )</span>
 537 |     | <span class='neutral'>            // `keccak256(&quot;ReceiveETH(uint256)&quot;)`</span>
 538 |     | <span class='neutral'>            mstore(</span>
 539 |     | <span class='neutral'>                sub(data, 0x3a), 0x9e4ac34f21c619cefc926c8bd93b54bf5a39c7ab2127a895af1cc0691d7e3dff</span>
 540 |     | <span class='neutral'>            )</span>
 541 |     | <span class='neutral'>            mstore(</span>
 542 |     | <span class='neutral'>                sub(data, 0x5a),</span>
 543 |     | <span class='neutral'>                or(shl(0x78, add(extraLength, 0x62)), 0x6100003d81600a3d39f336602c57343d527f)</span>
 544 |     | <span class='neutral'>            )</span>
 545 |     | <span class='neutral'>            mstore(dataEnd, shl(0xf0, extraLength))</span>
 546 |     | <span class='neutral'></span>
 547 |     | <span class='neutral'>            // Compute and store the bytecode hash.</span>
 548 |     | <span class='neutral'>            hash := keccak256(sub(data, 0x4c), add(extraLength, 0x6c))</span>
 549 |     | <span class='neutral'></span>
 550 |     | <span class='neutral'>            // Restore the overwritten memory surrounding `data`.</span>
 551 |     | <span class='neutral'>            mstore(dataEnd, mAfter1)</span>
 552 |     | <span class='neutral'>            mstore(data, dataLength)</span>
 553 |     | <span class='neutral'>            mstore(sub(data, 0x20), mBefore1)</span>
 554 |     | <span class='neutral'>            mstore(sub(data, 0x40), mBefore2)</span>
 555 |     | <span class='neutral'>            mstore(sub(data, 0x60), mBefore3)</span>
 556 |     | <span class='neutral'>        }</span>
 557 |     | <span class='neutral'>    }</span>
 558 |     | <span class='neutral'></span>
 559 |     | <span class='neutral'>    /// @dev Returns the address of the deterministic clone of</span>
 560 |     | <span class='neutral'>    /// `implementation` using immutable arguments encoded in `data`, with `salt`, by `deployer`.</span>
 561 |     | <span class='neutral'>    /// Note: The returned result has dirty upper 96 bits. Please clean if used in assembly.</span>
 562 |     | <span class='neutral'>    function predictDeterministicAddress(</span>
 563 |     | <span class='neutral'>        address implementation,</span>
 564 |     | <span class='neutral'>        bytes memory data,</span>
 565 |     | <span class='neutral'>        bytes32 salt,</span>
 566 |     | <span class='neutral'>        address deployer</span>
 567 |     | <span class='neutral'>    ) internal pure returns (address predicted) {</span>
 568 |     | <span class='neutral'>        bytes32 hash = initCodeHash(implementation, data);</span>
 569 |     | <span class='neutral'>        predicted = predictDeterministicAddress(hash, salt, deployer);</span>
 570 |     | <span class='neutral'>    }</span>
 571 |     | <span class='neutral'></span>
 572 |     | <span class='neutral'>    /*:.+.*.*:.*..:..*.*:.*..:.+.*.*:*/</span>
 573 |     | <span class='neutral'>    /*                      OTHER OPERATIONS                      */</span>
 574 |     | <span class='neutral'>    /*.:.+.*.:*.*.+.:*.*..:.:.*.:*.+.*/</span>
 575 |     | <span class='neutral'></span>
 576 |     | <span class='neutral'>    /// @dev Returns the address when a contract with initialization code hash,</span>
 577 |     | <span class='neutral'>    /// `hash`, is deployed with `salt`, by `deployer`.</span>
 578 |     | <span class='neutral'>    /// Note: The returned result has dirty upper 96 bits. Please clean if used in assembly.</span>
 579 |     | <span class='neutral'>    function predictDeterministicAddress(bytes32 hash, bytes32 salt, address deployer)</span>
 580 |     | <span class='neutral'>        internal</span>
 581 |     | <span class='neutral'>        pure</span>
 582 |     | <span class='neutral'>        returns (address predicted)</span>
 583 |     | <span class='neutral'>    {</span>
 584 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 585 |     | <span class='neutral'>        assembly {</span>
 586 |     | <span class='neutral'>            // Compute and store the bytecode hash.</span>
 587 |     | <span class='neutral'>            mstore8(0x00, 0xff) // Write the prefix.</span>
 588 |     | <span class='neutral'>            mstore(0x35, hash)</span>
 589 |     | <span class='neutral'>            mstore(0x01, shl(96, deployer))</span>
 590 |     | <span class='neutral'>            mstore(0x15, salt)</span>
 591 |     | <span class='neutral'>            predicted := keccak256(0x00, 0x55)</span>
 592 |     | <span class='neutral'>            // Restore the part of the free memory pointer that has been overwritten.</span>
 593 |     | <span class='neutral'>            mstore(0x35, 0)</span>
 594 |     | <span class='neutral'>        }</span>
 595 |     | <span class='neutral'>    }</span>
 596 |     | <span class='neutral'></span>
 597 |     | <span class='neutral'>    /// @dev Reverts if `salt` does not start with either the zero address or the caller.</span>
 598 |     | <span class='neutral'>    function checkStartsWithCaller(bytes32 salt) internal view {</span>
 599 |     | <span class='neutral'>        /// @solidity memory-safe-assembly</span>
 600 |     | <span class='neutral'>        assembly {</span>
 601 |     | <span class='neutral'>            // If the salt does not start with the zero address or the caller.</span>
 602 |     | <span class='neutral'>            if iszero(or(iszero(shr(96, salt)), eq(caller(), shr(96, salt)))) {</span>
 603 |     | <span class='neutral'>                // Store the function selector of `SaltDoesNotStartWithCaller()`.</span>
 604 |     | <span class='neutral'>                mstore(0x00, 0x2f634836)</span>
 605 |     | <span class='neutral'>                // Revert with (offset, size).</span>
 606 |     | <span class='neutral'>                revert(0x1c, 0x04)</span>
 607 |     | <span class='neutral'>            }</span>
 608 |     | <span class='neutral'>        }</span>
 609 |     | <span class='neutral'>    }</span>
 610 |     | <span class='neutral'>}</span>
 611 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/src/Echidna.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: GPL-3.0</span>
   2 |     | <span class='neutral'>pragma solidity 0.8.23;</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>import &quot;./VestingEscrow.sol&quot;;</span>
   5 |     | <span class='neutral'>import &quot;./VestingEscrowFactory.sol&quot;;</span>
   6 |     | <span class='neutral'>import &quot;./adaptors/OZVotingAdaptor.sol&quot;;</span>
   7 |     | <span class='neutral'></span>
   8 |     | <span class='neutral'>import {GovernorVotesMock} from &#39;../test/lib/GovernorVotesMock.sol&#39;;</span>
   9 |     | <span class='neutral'>import {OZVotingToken} from &#39;../test/lib/OZVotingToken.sol&#39;;</span>
  10 |     | <span class='neutral'></span>
  11 | *r  | <span class='executed'>contract TestEchidna {</span>
  12 |     | <span class='neutral'></span>
  13 |     | <span class='neutral'>    event AssertionFailed(uint256);</span>
  14 |     | <span class='neutral'>    event AssertionFailed(uint256,uint256);</span>
  15 |     | <span class='neutral'>    event AssertionFailed(uint,uint256,uint256);</span>
  16 |     | <span class='neutral'>    event AssertionFailed();</span>
  17 |     | <span class='neutral'>    event AssertionFailed(string);</span>
  18 |     | <span class='neutral'></span>
  19 |     | <span class='neutral'></span>
  20 |     | <span class='neutral'>    struct VestingEscrowConfig {</span>
  21 |     | <span class='neutral'>        uint256 amount;</span>
  22 |     | <span class='neutral'>        address recipient;</span>
  23 |     | <span class='neutral'>        uint40 vestingDuration;</span>
  24 |     | <span class='neutral'>        uint40 vestingStart;</span>
  25 |     | <span class='neutral'>        uint40 cliffLength;</span>
  26 |     | <span class='neutral'>        bool isFullyRevokable;</span>
  27 |     | <span class='neutral'>        bytes initialDelegateParams;</span>
  28 |     | <span class='neutral'>    }</span>
  29 |     | <span class='neutral'></span>
  30 |     | <span class='neutral'>    enum VoteType {</span>
  31 |     | <span class='neutral'>        Against,</span>
  32 |     | <span class='neutral'>        For,</span>
  33 |     | <span class='neutral'>        Abstain</span>
  34 |     | <span class='neutral'>    }</span>
  35 |     | <span class='neutral'></span>
  36 |     | <span class='neutral'></span>
  37 |     | <span class='neutral'>    VestingEscrowFactory  factory;</span>
  38 |     | <span class='neutral'>    OZVotingAdaptor  ozVotingAdaptor;</span>
  39 |     | <span class='neutral'></span>
  40 |     | <span class='neutral'>    GovernorVotesMock  governor;</span>
  41 |     | <span class='neutral'>    OZVotingToken  token;</span>
  42 |     | <span class='neutral'></span>
  43 |     | <span class='neutral'>    VestingEscrow  deployedVesting;</span>
  44 |     | <span class='neutral'></span>
  45 |     | <span class='neutral'>    uint256  amount;</span>
  46 |     | <span class='neutral'>    address  recipient;</span>
  47 |     | <span class='neutral'>    uint40  startTime;</span>
  48 |     | <span class='neutral'>    uint40  duration;</span>
  49 |     | <span class='neutral'>    uint40  cliffLength;</span>
  50 |     | <span class='neutral'>    bool  isFullyRevokable;</span>
  51 |     | <span class='unexecuted'>    bytes  initialDelegateParams = new bytes(0);</span>
  52 |     | <span class='neutral'></span>
  53 |     | <span class='neutral'>    uint testStartTime;</span>
  54 |     | <span class='neutral'></span>
  55 |     | <span class='neutral'>    address escrow;</span>
  56 |     | <span class='neutral'></span>
  57 |     | <span class='unexecuted'>    constructor() {</span>
  58 |     | <span class='unexecuted'>        address owner = address(this);</span>
  59 |     | <span class='neutral'>        address manager = address(this);</span>
  60 |     | <span class='neutral'>        // Setup Protocol</span>
  61 |     | <span class='unexecuted'>        token = new OZVotingToken();</span>
  62 |     | <span class='unexecuted'>        governor = new GovernorVotesMock(address(token));</span>
  63 |     | <span class='unexecuted'>        ozVotingAdaptor = new OZVotingAdaptor(address(governor), address(token), owner);</span>
  64 |     | <span class='unexecuted'>        factory = new VestingEscrowFactory(</span>
  65 |     | <span class='unexecuted'>            address(new VestingEscrow()), address(token), owner, manager, address(ozVotingAdaptor)</span>
  66 |     | <span class='neutral'>        );</span>
  67 |     | <span class='unexecuted'>        token.mint(owner, 100 ether);</span>
  68 |     | <span class='unexecuted'>        token.approve(address(factory), 100 ether);</span>
  69 |     | <span class='neutral'>        //setup vesting later     </span>
  70 |     | <span class='unexecuted'>        testStartTime = block.timestamp;   </span>
  71 |     | <span class='neutral'>    }</span>
  72 |     | <span class='neutral'></span>
  73 | *   | <span class='executed'>    function setAmount(uint256 _amount) public {</span>
  74 | *r  | <span class='executed'>        require(_amount&gt; 1e5);</span>
  75 | *   | <span class='executed'>        require(amount &lt;= token.balanceOf(address(this)), &quot;amount must be less than 100 ether&quot;);        </span>
  76 | *   | <span class='executed'>        amount = _amount;</span>
  77 |     | <span class='neutral'>    }</span>
  78 |     | <span class='neutral'></span>
  79 | *   | <span class='executed'>    function setStartTime(uint40 _startTime) public {</span>
  80 | *   | <span class='executed'>        startTime = _startTime;</span>
  81 |     | <span class='neutral'>    }</span>
  82 |     | <span class='neutral'></span>
  83 | *   | <span class='executed'>    function setStartTimeBlockTimeStamp() public {</span>
  84 | *   | <span class='executed'>        startTime = uint40(block.timestamp);</span>
  85 |     | <span class='neutral'>    }</span>
  86 |     | <span class='neutral'></span>
  87 | *   | <span class='executed'>    function setDuration(uint40 _endTime) public {</span>
  88 | *   | <span class='executed'>        duration = _endTime;</span>
  89 |     | <span class='neutral'>    }</span>
  90 |     | <span class='neutral'></span>
  91 | *   | <span class='executed'>    function setCliffLength(uint40 _cliffLength) public {</span>
  92 | *r  | <span class='executed'>        require(_cliffLength &lt; duration);</span>
  93 | *   | <span class='executed'>        cliffLength = _cliffLength;</span>
  94 |     | <span class='neutral'>    }</span>
  95 | *   | <span class='executed'>    function setFullyRevokable(bool _isFullyRevokable) public {</span>
  96 | *   | <span class='executed'>        isFullyRevokable = _isFullyRevokable;</span>
  97 |     | <span class='neutral'>    }</span>
  98 |     | <span class='neutral'></span>
  99 | *   | <span class='executed'>    function randomDeploy() public {</span>
 100 | *   | <span class='executed'>        require(escrow == address(0), &quot;escrow already deployed&quot;);</span>
 101 |     | <span class='neutral'>        // Deploy Vesting Escrow</span>
 102 |     | <span class='neutral'>        // amount = 100 ether;</span>
 103 | *   | <span class='executed'>        recipient = address(this);</span>
 104 |     | <span class='neutral'>        // startTime = uint40(block.timestamp);</span>
 105 |     | <span class='neutral'>        // endTime = startTime + 1000;</span>
 106 |     | <span class='neutral'>        // cliffLength = 100;</span>
 107 |     | <span class='neutral'>        // isFullyRevokable = true;</span>
 108 | *   | <span class='executed'>        initialDelegateParams = new bytes(0);</span>
 109 |     | <span class='neutral'></span>
 110 | *r  | <span class='executed'>        escrow = factory.deployVestingContract(</span>
 111 | *   | <span class='executed'>            amount, recipient, startTime, duration, cliffLength, isFullyRevokable, initialDelegateParams</span>
 112 |     | <span class='neutral'>        );</span>
 113 |     | <span class='neutral'></span>
 114 | *   | <span class='executed'>        deployedVesting = VestingEscrow(escrow);</span>
 115 |     | <span class='neutral'>    }</span>
 116 |     | <span class='neutral'></span>
 117 | *   | <span class='executed'>    function slowlyStealToken() public {</span>
 118 | *   | <span class='executed'>        require(escrow != address(0), &quot;escrow not deployed&quot;);</span>
 119 | *   | <span class='executed'>        uint previousBalance = token.balanceOf(address(this));</span>
 120 | *   | <span class='executed'>        deployedVesting.recoverERC20(address(token), 9999e18);</span>
 121 | *   | <span class='executed'>        uint afterBalance = token.balanceOf(address(this));</span>
 122 | *   | <span class='executed'>        if(previousBalance != afterBalance) {</span>
 123 | *   | <span class='executed'>            emit AssertionFailed(previousBalance,afterBalance);</span>
 124 |     | <span class='neutral'>        }</span>
 125 |     | <span class='neutral'>    }</span>
 126 |     | <span class='neutral'></span>
 127 | *   | <span class='executed'>    function claimToken(uint _amount) public {</span>
 128 | *   | <span class='executed'>        require(escrow != address(0), &quot;escrow not deployed&quot;);</span>
 129 | *   | <span class='executed'>        uint returnedToken =deployedVesting.claim(address(this),_amount);</span>
 130 |     | <span class='neutral'>    }</span>
 131 |     | <span class='neutral'></span>
 132 | *   | <span class='executed'>    function unclaimedAlwaysEqualAvailableToken() public {</span>
 133 | *   | <span class='executed'>        require(escrow != address(0), &quot;escrow not deployed&quot;);</span>
 134 | *   | <span class='executed'>        uint unclaimed = deployedVesting.unclaimed();</span>
 135 | *r  | <span class='executed'>        require(unclaimed&gt;0);</span>
 136 | *   | <span class='executed'>        uint tokenBalance = token.balanceOf(address(deployedVesting));</span>
 137 | *   | <span class='executed'>        if(unclaimed != tokenBalance) {</span>
 138 | *   | <span class='executed'>            emit AssertionFailed(block.timestamp,unclaimed,tokenBalance);</span>
 139 |     | <span class='neutral'>        }</span>
 140 |     | <span class='neutral'>    }</span>
 141 |     | <span class='neutral'></span>
 142 |     | <span class='neutral'></span>
 143 | *   | <span class='executed'>    function unclaimedAlwaysBigger() public {</span>
 144 | *   | <span class='executed'>        require(escrow != address(0), &quot;escrow not deployed&quot;);</span>
 145 | *   | <span class='executed'>        uint unclaimed = deployedVesting.unclaimed();</span>
 146 | *r  | <span class='executed'>        require(unclaimed&gt;0);</span>
 147 | *   | <span class='executed'>        uint tokenBalance = token.balanceOf(address(deployedVesting));</span>
 148 | *   | <span class='executed'>        if(unclaimed &gt; tokenBalance) {</span>
 149 |     | <span class='unexecuted'>            emit AssertionFailed(unclaimed,tokenBalance);</span>
 150 |     | <span class='neutral'>        }</span>
 151 |     | <span class='neutral'>    }    </span>
 152 |     | <span class='neutral'></span>
 153 | *   | <span class='executed'>    function unclaimedAlwaysEqualLocked() public {</span>
 154 | *   | <span class='executed'>        require(escrow != address(0), &quot;escrow not deployed&quot;);</span>
 155 | *   | <span class='executed'>        uint unclaimed = deployedVesting.unclaimed();</span>
 156 | *r  | <span class='executed'>        require(unclaimed&gt;0);</span>
 157 | *   | <span class='executed'>        uint tokenBalance = token.balanceOf(address(deployedVesting));</span>
 158 | *   | <span class='executed'>        uint locked = deployedVesting.locked();</span>
 159 | *   | <span class='executed'>        if(unclaimed &lt; locked) {</span>
 160 | *   | <span class='executed'>            emit AssertionFailed(unclaimed,locked);</span>
 161 |     | <span class='neutral'>        }</span>
 162 |     | <span class='neutral'>    }</span>
 163 |     | <span class='neutral'></span>
 164 | *   | <span class='executed'>    function revokeUnvested() public {</span>
 165 | *r  | <span class='executed'>        require(escrow != address(0), &quot;escrow not deployed&quot;);</span>
 166 | *r  | <span class='executed'>        deployedVesting.revokeUnvested();</span>
 167 |     | <span class='neutral'>    }</span>
 168 | *   | <span class='executed'>    function revokeAll() public {</span>
 169 | *   | <span class='executed'>        require(escrow != address(0), &quot;escrow not deployed&quot;);</span>
 170 | *   | <span class='executed'>        deployedVesting.revokeAll();</span>
 171 |     | <span class='neutral'>    }</span>
 172 |     | <span class='neutral'>    </span>
 173 |     | <span class='neutral'>    // function checkStartTime() public  returns (bool) {</span>
 174 |     | <span class='neutral'>    //     assert(testStartTime + 1000 &gt;= block.timestamp);</span>
 175 |     | <span class='neutral'>    //     return false;</span>
 176 |     | <span class='neutral'>    // }</span>
 177 |     | <span class='neutral'></span>
 178 |     | <span class='neutral'>    // function echidna_balance_check() public returns (bool) {</span>
 179 |     | <span class='neutral'>    //     return token.balanceOf(address(this)) &gt; 0;</span>
 180 |     | <span class='neutral'>    // }</span>
 181 |     | <span class='neutral'></span>
 182 |     | <span class='neutral'>}</span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/src/VestingEscrow.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: GPL-3.0</span>
   2 |     | <span class='neutral'>pragma solidity 0.8.23;</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>import {Clone} from &#39;@solady/utils/Clone.sol&#39;;</span>
   5 |     | <span class='neutral'>import {Math} from &#39;@openzeppelin/contracts/utils/math/Math.sol&#39;;</span>
   6 |     | <span class='neutral'>import {Address} from &#39;@openzeppelin/contracts/utils/Address.sol&#39;;</span>
   7 |     | <span class='neutral'>import {IERC20} from &#39;@openzeppelin/contracts/token/ERC20/IERC20.sol&#39;;</span>
   8 |     | <span class='neutral'>import {SafeERC20} from &#39;@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol&#39;;</span>
   9 |     | <span class='neutral'>import {IVestingEscrowFactory} from &#39;src/interfaces/IVestingEscrowFactory.sol&#39;;</span>
  10 |     | <span class='neutral'>import {IVestingEscrow} from &#39;src/interfaces/IVestingEscrow.sol&#39;;</span>
  11 |     | <span class='neutral'>import {IVotingAdaptor} from &#39;src/interfaces/IVotingAdaptor.sol&#39;;</span>
  12 |     | <span class='neutral'></span>
  13 | *r  | <span class='executed'>contract VestingEscrow is IVestingEscrow, Clone {</span>
  14 |     | <span class='neutral'>    using SafeERC20 for IERC20;</span>
  15 |     | <span class='neutral'>    using Address for address;</span>
  16 |     | <span class='neutral'>    using Address for address payable;</span>
  17 |     | <span class='neutral'></span>
  18 |     | <span class='neutral'>    /// @notice The factory that created this VestingEscrow instance.</span>
  19 | *   | <span class='executed'>    function factory() public pure returns (IVestingEscrowFactory) {</span>
  20 | *   | <span class='executed'>        return IVestingEscrowFactory(_getArgAddress(0));</span>
  21 |     | <span class='neutral'>    }</span>
  22 |     | <span class='neutral'></span>
  23 |     | <span class='neutral'>    /// @notice The token.</span>
  24 | *   | <span class='executed'>    function token() public pure returns (IERC20) {</span>
  25 | *   | <span class='executed'>        return IERC20(_getArgAddress(20));</span>
  26 |     | <span class='neutral'>    }</span>
  27 |     | <span class='neutral'></span>
  28 |     | <span class='neutral'>    /// @notice The token recipient.</span>
  29 | *   | <span class='executed'>    function recipient() public pure returns (address) {</span>
  30 | *   | <span class='executed'>        return _getArgAddress(40);</span>
  31 |     | <span class='neutral'>    }</span>
  32 |     | <span class='neutral'></span>
  33 |     | <span class='neutral'>    /// @notice The vesting start timestamp.</span>
  34 | *   | <span class='executed'>    function startTime() public pure returns (uint40) {</span>
  35 | *   | <span class='executed'>        return _getArgUint40(60);</span>
  36 |     | <span class='neutral'>    }</span>
  37 |     | <span class='neutral'></span>
  38 |     | <span class='neutral'>    /// @notice The vesting end timestamp.</span>
  39 | *   | <span class='executed'>    function endTime() public pure returns (uint40) {</span>
  40 | *   | <span class='executed'>        return _getArgUint40(65);</span>
  41 |     | <span class='neutral'>    }</span>
  42 |     | <span class='neutral'></span>
  43 |     | <span class='neutral'>    /// @notice The vesting cliff length.</span>
  44 | *   | <span class='executed'>    function cliffLength() public pure returns (uint40) {</span>
  45 | *   | <span class='executed'>        return _getArgUint40(70);</span>
  46 |     | <span class='neutral'>    }</span>
  47 |     | <span class='neutral'></span>
  48 |     | <span class='neutral'>    /// @notice The total amount of tokens locked.</span>
  49 | *   | <span class='executed'>    function totalLocked() public pure returns (uint256) {</span>
  50 | *   | <span class='executed'>        return _getArgUint256(75);</span>
  51 |     | <span class='neutral'>    }</span>
  52 |     | <span class='neutral'></span>
  53 |     | <span class='neutral'>    /// @notice The total amount of tokens that have been claimed.</span>
  54 | *   | <span class='executed'>    uint256 public totalClaimed;</span>
  55 |     | <span class='neutral'></span>
  56 |     | <span class='neutral'>    /// @notice The vesting end time or the time at which vesting was revoked.</span>
  57 | *   | <span class='executed'>    uint40 public disabledAt;</span>
  58 |     | <span class='neutral'></span>
  59 |     | <span class='neutral'>    /// @notice Whether vesting is fully revokable.</span>
  60 | *   | <span class='executed'>    bool public isFullyRevokable;</span>
  61 |     | <span class='neutral'></span>
  62 |     | <span class='neutral'>    /// @notice Whether vesting has been fully revoked.</span>
  63 | *   | <span class='executed'>    bool public isFullyRevoked;</span>
  64 |     | <span class='neutral'></span>
  65 |     | <span class='neutral'>    /// @notice Throws if called by any account other than the owner.</span>
  66 |     | <span class='neutral'>    modifier onlyOwner() {</span>
  67 | *   | <span class='executed'>        _checkOwner();</span>
  68 |     | <span class='neutral'>        _;</span>
  69 |     | <span class='neutral'>    }</span>
  70 |     | <span class='neutral'></span>
  71 |     | <span class='neutral'>    /// @notice Throws if called by any account other than the owner or manager.</span>
  72 |     | <span class='neutral'>    modifier onlyOwnerOrManager() {</span>
  73 | *   | <span class='executed'>        _checkOwnerOrManager();</span>
  74 |     | <span class='neutral'>        _;</span>
  75 |     | <span class='neutral'>    }</span>
  76 |     | <span class='neutral'></span>
  77 |     | <span class='neutral'>    /// @notice Throws if called by any account other than the recipient.</span>
  78 |     | <span class='neutral'>    modifier onlyRecipient() {</span>
  79 | *   | <span class='executed'>        _checkRecipient();</span>
  80 | *   | <span class='executed'>        _;</span>
  81 |     | <span class='neutral'>    }</span>
  82 |     | <span class='neutral'></span>
  83 |     | <span class='neutral'>    /// @notice Throws if the voting adaptor is not set.</span>
  84 |     | <span class='neutral'>    modifier whenVotingAdaptorIsSet() {</span>
  85 |     | <span class='unexecuted'>        _checkVotingAdaptorIsSet();</span>
  86 |     | <span class='neutral'>        _;</span>
  87 |     | <span class='neutral'>    }</span>
  88 |     | <span class='neutral'></span>
  89 |     | <span class='neutral'>    /// @notice Initializes the contract.</span>
  90 |     | <span class='neutral'>    /// @param _isFullyRevokable Whether the tokens are fully revokable.</span>
  91 |     | <span class='neutral'>    /// @param _initialDelegateParams The optional initial delegate information (skipped if empty bytes).</span>
  92 | *   | <span class='executed'>    function initialize(bool _isFullyRevokable, bytes calldata _initialDelegateParams) external {</span>
  93 | *   | <span class='executed'>        address _factory = address(factory());</span>
  94 | *   | <span class='executed'>        uint256 _totalLocked = totalLocked();</span>
  95 | *   | <span class='executed'>        uint40 _endTime = endTime();</span>
  96 | *   | <span class='executed'>        IERC20 _token = token();</span>
  97 |     | <span class='neutral'>        //@audit H fail if(block.timestamp &gt; _endTime) emit AssertionFailed(&quot;block.timestamp &gt; _endTime&quot;);</span>
  98 |     | <span class='neutral'>        // if(block.timestamp &gt; _endTime) emit AssertionFailed(&quot;block.timestamp &gt; _endTime&quot;);</span>
  99 | *r  | <span class='executed'>        if (msg.sender != _factory) revert NOT_FACTORY(msg.sender);</span>
 100 | *   | <span class='executed'>        if (_token.balanceOf(address(this)) &lt; _totalLocked) revert INSUFFICIENT_BALANCE();</span>
 101 | *   | <span class='executed'>        if(_endTime == startTime()) emit AssertionFailed(&quot;end time zero&quot;);</span>
 102 | *   | <span class='executed'>        disabledAt = _endTime; // Set to maximum time</span>
 103 | *   | <span class='executed'>        isFullyRevokable = _isFullyRevokable;</span>
 104 |     | <span class='neutral'></span>
 105 | *   | <span class='executed'>        if (_initialDelegateParams.length != 0) _delegate(_initialDelegateParams);</span>
 106 |     | <span class='neutral'></span>
 107 | *   | <span class='executed'>        emit VestingEscrowInitialized(</span>
 108 | *   | <span class='executed'>            _factory,</span>
 109 | *   | <span class='executed'>            recipient(),</span>
 110 | *   | <span class='executed'>            address(_token),</span>
 111 | *   | <span class='executed'>            _totalLocked,</span>
 112 | *   | <span class='executed'>            startTime(),</span>
 113 | *   | <span class='executed'>            _endTime,</span>
 114 | *   | <span class='executed'>            cliffLength(),</span>
 115 |     | <span class='neutral'>            _isFullyRevokable</span>
 116 |     | <span class='neutral'>        );</span>
 117 |     | <span class='neutral'>    }</span>
 118 |     | <span class='neutral'></span>
 119 |     | <span class='neutral'>    /// @notice Get the number of unclaimed, vested tokens for recipient.</span>
 120 | *   | <span class='executed'>    function unclaimed() public view returns (uint256) {</span>
 121 | *   | <span class='executed'>        if (isFullyRevoked) return 0;</span>
 122 |     | <span class='neutral'></span>
 123 | *   | <span class='executed'>        uint256 claimTime = Math.min(block.timestamp, disabledAt);</span>
 124 | *   | <span class='executed'>        return _totalVestedAt(claimTime) - totalClaimed;</span>
 125 |     | <span class='neutral'>    }</span>
 126 |     | <span class='neutral'></span>
 127 |     | <span class='neutral'>    /// @notice Get the number of locked tokens for recipient.</span>
 128 | *   | <span class='executed'>    function locked() public view returns (uint256) {</span>
 129 | *   | <span class='executed'>        if (block.timestamp &gt;= disabledAt) return 0;</span>
 130 |     | <span class='neutral'></span>
 131 | *   | <span class='executed'>        return totalLocked() - _totalVestedAt(block.timestamp);</span>
 132 |     | <span class='neutral'>    }</span>
 133 |     | <span class='neutral'></span>
 134 |     | <span class='neutral'>    /// @notice Claim tokens which have vested.</span>
 135 |     | <span class='neutral'>    /// @param beneficiary Address to transfer claimed tokens to.</span>
 136 |     | <span class='neutral'>    /// @param amount Amount of tokens to claim.</span>
 137 | *   | <span class='executed'>    function claim(address beneficiary, uint256 amount) external onlyRecipient returns (uint256) {</span>
 138 | *   | <span class='executed'>        uint256 claimable = Math.min(unclaimed(), amount);</span>
 139 | *   | <span class='executed'>        totalClaimed += claimable;</span>
 140 | *   | <span class='executed'>        if(claimable &gt; token().balanceOf(address(this)))</span>
 141 |     | <span class='unexecuted'>            emit AssertionFailed(&quot;claimable &gt; token().balanceOf(address(this))&quot;,claimable,token().balanceOf(address(this)));</span>
 142 | *   | <span class='executed'>        token().safeTransfer(beneficiary, claimable);</span>
 143 | *   | <span class='executed'>        emit Claim(beneficiary, claimable);</span>
 144 |     | <span class='neutral'></span>
 145 | *   | <span class='executed'>        return claimable;</span>
 146 |     | <span class='neutral'>    }</span>
 147 |     | <span class='neutral'></span>
 148 |     | <span class='neutral'>    /// @notice Delegate voting power of all available tokens.</span>
 149 |     | <span class='neutral'>    /// @param params The ABI-encoded delegate params.</span>
 150 | *   | <span class='executed'>    function delegate(bytes calldata params) external onlyRecipient returns (bytes memory) {</span>
 151 | *   | <span class='executed'>        return _delegate(params);</span>
 152 |     | <span class='neutral'>    }</span>
 153 |     | <span class='neutral'></span>
 154 |     | <span class='neutral'>    /// @notice Participate in a governance vote using all available tokens on the contract&#39;s balance.</span>
 155 |     | <span class='neutral'>    /// @param params The ABI-encoded data for call. Can be obtained from VotingAdaptor.encodeVoteCalldata.</span>
 156 | *   | <span class='executed'>    function vote(bytes calldata params) external onlyRecipient whenVotingAdaptorIsSet returns (bytes memory) {</span>
 157 |     | <span class='unexecuted'>        return _votingAdaptor().functionDelegateCall(abi.encodeCall(IVotingAdaptor.vote, (params)));</span>
 158 |     | <span class='neutral'>    }</span>
 159 |     | <span class='neutral'></span>
 160 |     | <span class='neutral'>    // forgefmt: disable-next-item</span>
 161 |     | <span class='neutral'>    /// @notice Participate in a governance vote with a reason using all available tokens on the contract&#39;s balance.</span>
 162 |     | <span class='neutral'>    /// @param params The ABI-encoded data for call. Can be obtained from VotingAdaptor.encodeVoteWithReasonCalldata.</span>
 163 | *   | <span class='executed'>    function voteWithReason(bytes calldata params) external onlyRecipient whenVotingAdaptorIsSet returns (bytes memory) {</span>
 164 |     | <span class='unexecuted'>        return _votingAdaptor().functionDelegateCall(abi.encodeCall(IVotingAdaptor.voteWithReason, (params)));</span>
 165 |     | <span class='neutral'>    }</span>
 166 |     | <span class='neutral'></span>
 167 |     | <span class='neutral'>    /// @notice Disable further flow of tokens and revoke the unvested part to owner.</span>
 168 | *   | <span class='executed'>    function revokeUnvested() external onlyOwnerOrManager {</span>
 169 | *   | <span class='executed'>        uint256 revokable = locked();</span>
 170 | *   | <span class='executed'>        if (revokable == 0) revert NOTHING_TO_REVOKE();</span>
 171 |     | <span class='neutral'></span>
 172 | *   | <span class='executed'>        disabledAt = uint40(block.timestamp);</span>
 173 |     | <span class='neutral'></span>
 174 | *   | <span class='executed'>        token().safeTransfer(_owner(), revokable);</span>
 175 | *   | <span class='executed'>        emit UnvestedTokensRevoked(msg.sender, revokable);</span>
 176 |     | <span class='neutral'>    }</span>
 177 |     | <span class='neutral'></span>
 178 |     | <span class='neutral'>    /// @notice Disable further flow of tokens and revoke all tokens to owner.</span>
 179 | *   | <span class='executed'>    function revokeAll() external onlyOwner {</span>
 180 | *   | <span class='executed'>        if (!isFullyRevokable) revert NOT_FULLY_REVOKABLE();</span>
 181 | *   | <span class='executed'>        if (isFullyRevoked) revert ALREADY_FULLY_REVOKED();</span>
 182 |     | <span class='neutral'></span>
 183 | *   | <span class='executed'>        uint256 revokable = locked() + unclaimed();</span>
 184 | *   | <span class='executed'>        if (revokable == 0) revert NOTHING_TO_REVOKE();</span>
 185 |     | <span class='neutral'></span>
 186 | *   | <span class='executed'>        isFullyRevoked = true;</span>
 187 | *   | <span class='executed'>        disabledAt = uint40(block.timestamp);</span>
 188 |     | <span class='neutral'></span>
 189 | *   | <span class='executed'>        token().safeTransfer(_owner(), revokable);</span>
 190 | *   | <span class='executed'>        emit VestingFullyRevoked(msg.sender, revokable);</span>
 191 |     | <span class='neutral'>    }</span>
 192 |     | <span class='neutral'></span>
 193 |     | <span class='neutral'>    /// @notice Permanently disable full token revocation.</span>
 194 | *   | <span class='executed'>    function permanentlyDisableFullRevocation() external onlyOwner {</span>
 195 |     | <span class='unexecuted'>        if (!isFullyRevokable) revert NOT_FULLY_REVOKABLE();</span>
 196 |     | <span class='neutral'></span>
 197 |     | <span class='unexecuted'>        isFullyRevokable = false;</span>
 198 |     | <span class='unexecuted'>        emit FullRevocationPermanentlyDisabled(msg.sender);</span>
 199 |     | <span class='neutral'>    }</span>
 200 |     | <span class='neutral'></span>
 201 |     | <span class='neutral'>    /// @notice Recover any ERC20 token to the recipient.</span>
 202 |     | <span class='neutral'>    /// @param token_ Address of the ERC20 token to recover.</span>
 203 |     | <span class='neutral'>    /// @param amount Amount of tokens to recover.</span>
 204 | *   | <span class='executed'>    function recoverERC20(address token_, uint256 amount) external {</span>
 205 | *   | <span class='executed'>        uint256 recoverable = amount;</span>
 206 | *   | <span class='executed'>        if (token_ == address(token())) {</span>
 207 | *   | <span class='executed'>            uint256 available = token().balanceOf(address(this)) - (locked() + unclaimed());</span>
 208 | *   | <span class='executed'>            recoverable = Math.min(recoverable, available);</span>
 209 |     | <span class='neutral'>        }</span>
 210 | *   | <span class='executed'>        if (recoverable &gt; 0) {</span>
 211 | *   | <span class='executed'>            IERC20(token_).safeTransfer(recipient(), recoverable);</span>
 212 |     | <span class='unexecuted'>            emit ERC20Recovered(token_, recoverable);</span>
 213 |     | <span class='neutral'>        }</span>
 214 |     | <span class='neutral'>    }</span>
 215 |     | <span class='neutral'></span>
 216 |     | <span class='neutral'>    /// @notice Recover any ETH to the recipient.</span>
 217 | *   | <span class='executed'>    function recoverEther() external {</span>
 218 | *   | <span class='executed'>        uint256 amount = address(this).balance;</span>
 219 | *   | <span class='executed'>        if (amount &gt; 0) {</span>
 220 |     | <span class='unexecuted'>            payable(recipient()).sendValue(amount);</span>
 221 |     | <span class='unexecuted'>            emit ETHRecovered(amount);</span>
 222 |     | <span class='neutral'>        }</span>
 223 |     | <span class='neutral'>    }</span>
 224 |     | <span class='neutral'></span>
 225 |     | <span class='neutral'>    /// @dev Returns the factory owner.</span>
 226 | *   | <span class='executed'>    function _owner() internal view returns (address) {</span>
 227 | *   | <span class='executed'>        return factory().owner();</span>
 228 |     | <span class='neutral'>    }</span>
 229 |     | <span class='neutral'></span>
 230 |     | <span class='neutral'>    /// @dev Returns the factory manager.</span>
 231 |     | <span class='unexecuted'>    function _manager() internal view returns (address) {</span>
 232 |     | <span class='unexecuted'>        return factory().manager();</span>
 233 |     | <span class='neutral'>    }</span>
 234 |     | <span class='neutral'></span>
 235 |     | <span class='neutral'>    /// @dev Returns the factory voting adaptor.</span>
 236 |     | <span class='unexecuted'>    function _votingAdaptor() internal view returns (address) {</span>
 237 |     | <span class='unexecuted'>        return factory().votingAdaptor();</span>
 238 |     | <span class='neutral'>    }</span>
 239 |     | <span class='neutral'></span>
 240 |     | <span class='neutral'>    /// @dev Throws if called by any account other than the owner.</span>
 241 | *   | <span class='executed'>    function _checkOwner() internal view {</span>
 242 | *   | <span class='executed'>        if (msg.sender != _owner()) {</span>
 243 |     | <span class='unexecuted'>            revert NOT_OWNER(msg.sender);</span>
 244 |     | <span class='neutral'>        }</span>
 245 |     | <span class='neutral'>    }</span>
 246 |     | <span class='neutral'></span>
 247 |     | <span class='neutral'>    /// @dev Throws if called by any account other than the owner or manager.</span>
 248 | *   | <span class='executed'>    function _checkOwnerOrManager() internal view {</span>
 249 | *   | <span class='executed'>        if (msg.sender != _owner() &amp;&amp; msg.sender != _manager()) {</span>
 250 |     | <span class='unexecuted'>            revert NOT_OWNER_OR_MANAGER(msg.sender);</span>
 251 |     | <span class='neutral'>        }</span>
 252 |     | <span class='neutral'>    }</span>
 253 |     | <span class='neutral'></span>
 254 |     | <span class='neutral'>    /// @dev Throws if called by any account other than the recipient.</span>
 255 | *   | <span class='executed'>    function _checkRecipient() internal view {</span>
 256 | *   | <span class='executed'>        if (msg.sender != recipient()) {</span>
 257 | *   | <span class='executed'>            revert NOT_RECIPIENT(msg.sender);</span>
 258 |     | <span class='neutral'>        }</span>
 259 |     | <span class='neutral'>    }</span>
 260 |     | <span class='neutral'></span>
 261 |     | <span class='neutral'>    /// @dev Throws if the voting adaptor is not set.</span>
 262 |     | <span class='unexecuted'>    function _checkVotingAdaptorIsSet() internal view {</span>
 263 |     | <span class='unexecuted'>        if (_votingAdaptor() == address(0)) {</span>
 264 |     | <span class='unexecuted'>            revert VOTING_ADAPTOR_NOT_SET();</span>
 265 |     | <span class='neutral'>        }</span>
 266 |     | <span class='neutral'>    }</span>
 267 |     | <span class='neutral'></span>
 268 |     | <span class='neutral'>    /// @notice Delegate voting power of all available tokens.</span>
 269 |     | <span class='neutral'>    /// @param params The ABI-encoded delegate params.</span>
 270 |     | <span class='unexecuted'>    function _delegate(bytes calldata params) internal whenVotingAdaptorIsSet returns (bytes memory) {</span>
 271 |     | <span class='unexecuted'>        return _votingAdaptor().functionDelegateCall(abi.encodeCall(IVotingAdaptor.delegate, params));</span>
 272 |     | <span class='neutral'>    }</span>
 273 |     | <span class='neutral'></span>
 274 |     | <span class='neutral'>    /// @dev Returns the vested token amount at a specific time.</span>
 275 |     | <span class='neutral'>    /// @param time The time to retrieve the vesting amount for.</span>
 276 | *   | <span class='executed'>    function _totalVestedAt(uint256 time) internal pure returns (uint256) {</span>
 277 | *   | <span class='executed'>        uint40 _startTime = startTime();</span>
 278 | *   | <span class='executed'>        uint256 _totalLocked = totalLocked();</span>
 279 | *   | <span class='executed'>        if (time &lt; _startTime + cliffLength()) {</span>
 280 | *   | <span class='executed'>            return 0;</span>
 281 |     | <span class='neutral'>        }</span>
 282 | *   | <span class='executed'>        return Math.min(_totalLocked * (time - _startTime) / (endTime() - _startTime), _totalLocked);</span>
 283 |     | <span class='neutral'>    }</span>
 284 |     | <span class='neutral'></span>
 285 |     | <span class='neutral'>            event AssertionFailed(uint256);</span>
 286 |     | <span class='neutral'>    event AssertionFailed();</span>
 287 |     | <span class='neutral'>    event AssertionFailed(string);</span>
 288 |     | <span class='neutral'>    event AssertionFailed(string,uint,uint);</span>
 289 |     | <span class='neutral'>}</span>
 290 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/src/VestingEscrowFactory.sol</b>
<code>
   1 |     | <span class='neutral'>// SPDX-License-Identifier: GPL-3.0</span>
   2 |     | <span class='neutral'>pragma solidity 0.8.23;</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>import {LibClone} from &#39;@solady/utils/LibClone.sol&#39;;</span>
   5 |     | <span class='neutral'>import {Address} from &#39;@openzeppelin/contracts/utils/Address.sol&#39;;</span>
   6 |     | <span class='neutral'>import {Ownable} from &#39;@openzeppelin/contracts/access/Ownable.sol&#39;;</span>
   7 |     | <span class='neutral'>import {IERC20} from &#39;@openzeppelin/contracts/token/ERC20/IERC20.sol&#39;;</span>
   8 |     | <span class='neutral'>import {Ownable2Step} from &#39;@openzeppelin/contracts/access/Ownable2Step.sol&#39;;</span>
   9 |     | <span class='neutral'>import {SafeERC20} from &#39;@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol&#39;;</span>
  10 |     | <span class='neutral'>import {IVestingEscrowFactory} from &#39;src/interfaces/IVestingEscrowFactory.sol&#39;;</span>
  11 |     | <span class='neutral'>import {IVestingEscrow} from &#39;src/interfaces/IVestingEscrow.sol&#39;;</span>
  12 |     | <span class='neutral'></span>
  13 |     | <span class='unexecuted'>contract VestingEscrowFactory is IVestingEscrowFactory, Ownable2Step {</span>
  14 |     | <span class='neutral'>    using LibClone for address;</span>
  15 |     | <span class='neutral'>    using SafeERC20 for IERC20;</span>
  16 |     | <span class='neutral'>    using Address for address payable;</span>
  17 |     | <span class='neutral'></span>
  18 |     | <span class='neutral'>    /// @notice The vesting escrow implementation contract.</span>
  19 |     | <span class='unexecuted'>    address public immutable vestingEscrowImpl;</span>
  20 |     | <span class='neutral'></span>
  21 |     | <span class='neutral'>    /// @notice The ERC20 token that will be locked in the vesting contracts.</span>
  22 |     | <span class='unexecuted'>    address public immutable token;</span>
  23 |     | <span class='neutral'></span>
  24 |     | <span class='neutral'>    /// @notice The adaptor that will be used to delegate and/or vote from the vesting contracts.</span>
  25 |     | <span class='unexecuted'>    address public votingAdaptor;</span>
  26 |     | <span class='neutral'></span>
  27 |     | <span class='neutral'>    /// @notice The account that will manage the vesting contracts.</span>
  28 |     | <span class='unexecuted'>    address public manager;</span>
  29 |     | <span class='neutral'></span>
  30 |     | <span class='unexecuted'>    constructor(address _vestingEscrowImpl, address _token, address _owner, address _manager, address _votingAdaptor) {</span>
  31 |     | <span class='unexecuted'>        if (_vestingEscrowImpl == address(0)) revert INVALID_VESTING_ESCROW_IMPL();</span>
  32 |     | <span class='unexecuted'>        if (_token == address(0)) revert INVALID_TOKEN();</span>
  33 |     | <span class='unexecuted'>        if (_owner == address(0)) revert INVALID_OWNER();</span>
  34 |     | <span class='neutral'></span>
  35 |     | <span class='unexecuted'>        vestingEscrowImpl = _vestingEscrowImpl;</span>
  36 |     | <span class='unexecuted'>        token = _token;</span>
  37 |     | <span class='unexecuted'>        manager = _manager;</span>
  38 |     | <span class='unexecuted'>        votingAdaptor = _votingAdaptor;</span>
  39 |     | <span class='neutral'></span>
  40 |     | <span class='unexecuted'>        _transferOwnership(_owner);</span>
  41 |     | <span class='neutral'>    }</span>
  42 |     | <span class='neutral'></span>
  43 |     | <span class='neutral'>    /// @notice Deploy and fund a new vesting contract.</span>
  44 |     | <span class='neutral'>    /// @param amount The amount of tokens to lock in the vesting contract.</span>
  45 |     | <span class='neutral'>    /// @param recipient The recipient of the vesting contract.</span>
  46 |     | <span class='neutral'>    /// @param vestingDuration The duration of the vesting contract.</span>
  47 |     | <span class='neutral'>    /// @param vestingStart The start of the vesting contract.</span>
  48 |     | <span class='neutral'>    /// @param cliffLength The cliff length of the vesting contract.</span>
  49 |     | <span class='neutral'>    /// @param isFullyRevokable Whether the vesting contract is fully revokable.</span>
  50 |     | <span class='neutral'>    /// @param initialDelegateParams The optional initial delegate information (skipped if empty bytes).</span>
  51 |     | <span class='unexecuted'>    function deployVestingContract(</span>
  52 |     | <span class='neutral'>        uint256 amount,</span>
  53 |     | <span class='neutral'>        address recipient,</span>
  54 |     | <span class='neutral'>        uint40 vestingDuration,</span>
  55 |     | <span class='neutral'>        uint40 vestingStart,</span>
  56 |     | <span class='neutral'>        uint40 cliffLength,</span>
  57 |     | <span class='neutral'>        bool isFullyRevokable,</span>
  58 |     | <span class='neutral'>        bytes calldata initialDelegateParams</span>
  59 |     | <span class='unexecuted'>    ) external returns (address escrow) {</span>
  60 |     | <span class='unexecuted'>        if (vestingDuration == 0) revert INVALID_VESTING_DURATION();</span>
  61 |     | <span class='unexecuted'>        if (cliffLength &gt; vestingDuration) revert INVALID_VESTING_CLIFF();</span>
  62 |     | <span class='unexecuted'>        if (recipient == address(0)) revert INVALID_RECIPIENT();</span>
  63 |     | <span class='unexecuted'>        if (amount == 0) revert INVALID_AMOUNT();</span>
  64 |     | <span class='neutral'></span>
  65 |     | <span class='unexecuted'>        escrow = vestingEscrowImpl.clone(</span>
  66 |     | <span class='unexecuted'>            abi.encodePacked(</span>
  67 |     | <span class='unexecuted'>                address(this), token, recipient, vestingStart, vestingStart + vestingDuration, cliffLength, amount</span>
  68 |     | <span class='neutral'>            )</span>
  69 |     | <span class='neutral'>        );</span>
  70 |     | <span class='neutral'></span>
  71 |     | <span class='unexecuted'>        IERC20(token).safeTransferFrom(msg.sender, escrow, amount);</span>
  72 |     | <span class='unexecuted'>        IVestingEscrow(escrow).initialize(isFullyRevokable, initialDelegateParams);</span>
  73 |     | <span class='neutral'></span>
  74 |     | <span class='unexecuted'>        emit VestingEscrowCreated(msg.sender, recipient, escrow);</span>
  75 |     | <span class='neutral'>    }</span>
  76 |     | <span class='neutral'></span>
  77 |     | <span class='neutral'>    /// @notice Recover any ERC20 to the owner.</span>
  78 |     | <span class='neutral'>    /// @param token_ The ERC20 token to recover.</span>
  79 |     | <span class='neutral'>    /// @param amount The amount to recover.</span>
  80 |     | <span class='unexecuted'>    function recoverERC20(address token_, uint256 amount) external {</span>
  81 |     | <span class='unexecuted'>        if (amount &gt; 0) {</span>
  82 |     | <span class='unexecuted'>            IERC20(token_).safeTransfer(owner(), amount);</span>
  83 |     | <span class='unexecuted'>            emit ERC20Recovered(token_, amount);</span>
  84 |     | <span class='neutral'>        }</span>
  85 |     | <span class='neutral'>    }</span>
  86 |     | <span class='neutral'></span>
  87 |     | <span class='neutral'>    /// @notice Recover any ETH to the owner.</span>
  88 |     | <span class='unexecuted'>    function recoverEther() external {</span>
  89 |     | <span class='unexecuted'>        uint256 amount = address(this).balance;</span>
  90 |     | <span class='unexecuted'>        if (amount &gt; 0) {</span>
  91 |     | <span class='unexecuted'>            payable(owner()).sendValue(amount);</span>
  92 |     | <span class='unexecuted'>            emit ETHRecovered(amount);</span>
  93 |     | <span class='neutral'>        }</span>
  94 |     | <span class='neutral'>    }</span>
  95 |     | <span class='neutral'></span>
  96 |     | <span class='neutral'>    /// @notice Change the voting adaptor of the vesting contracts.</span>
  97 |     | <span class='unexecuted'>    function updateVotingAdaptor(address _votingAdaptor) external onlyOwner {</span>
  98 |     | <span class='unexecuted'>        votingAdaptor = _votingAdaptor;</span>
  99 |     | <span class='unexecuted'>        emit VotingAdaptorUpgraded(_votingAdaptor);</span>
 100 |     | <span class='neutral'>    }</span>
 101 |     | <span class='neutral'></span>
 102 |     | <span class='neutral'>    /// @notice Change the manager of the vesting contracts.</span>
 103 |     | <span class='unexecuted'>    function changeManager(address _manager) external onlyOwner {</span>
 104 |     | <span class='unexecuted'>        manager = _manager;</span>
 105 |     | <span class='unexecuted'>        emit ManagerChanged(_manager);</span>
 106 |     | <span class='neutral'>    }</span>
 107 |     | <span class='neutral'></span>
 108 |     | <span class='neutral'>    /// @notice The address of the current owner.</span>
 109 |     | <span class='unexecuted'>    function owner() public view override(Ownable, IVestingEscrowFactory) returns (address) {</span>
 110 |     | <span class='neutral'>        return super.owner();</span>
 111 |     | <span class='neutral'>    }</span>
 112 |     | <span class='neutral'></span>
 113 |     | <span class='neutral'>        event AssertionFailed(uint256);</span>
 114 |     | <span class='neutral'>    event AssertionFailed();</span>
 115 |     | <span class='neutral'>    event AssertionFailed(string);</span>
 116 |     | <span class='neutral'>}</span>
 117 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/src/adaptors/OZVotingAdaptor.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: GPL-3.0</span>
  2 |     | <span class='neutral'>pragma solidity 0.8.23;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>import {SafeERC20} from &#39;@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol&#39;;</span>
  5 |     | <span class='neutral'>import {IGovernor} from &#39;@openzeppelin/contracts/governance/IGovernor.sol&#39;;</span>
  6 |     | <span class='neutral'>import {IVotes} from &#39;@openzeppelin/contracts/governance/utils/IVotes.sol&#39;;</span>
  7 |     | <span class='neutral'>import {IERC20} from &#39;@openzeppelin/contracts/token/ERC20/IERC20.sol&#39;;</span>
  8 |     | <span class='neutral'>import {Ownable} from &#39;@openzeppelin/contracts/access/Ownable.sol&#39;;</span>
  9 |     | <span class='neutral'>import {Address} from &#39;@openzeppelin/contracts/utils/Address.sol&#39;;</span>
 10 |     | <span class='neutral'>import {IVotingAdaptor} from &#39;src/interfaces/IVotingAdaptor.sol&#39;;</span>
 11 |     | <span class='neutral'></span>
 12 |     | <span class='unexecuted'>contract OZVotingAdaptor is IVotingAdaptor, Ownable {</span>
 13 |     | <span class='neutral'>    using SafeERC20 for IERC20;</span>
 14 |     | <span class='neutral'>    using Address for address payable;</span>
 15 |     | <span class='neutral'></span>
 16 |     | <span class='neutral'>    /// @notice The governor contract address.</span>
 17 |     | <span class='unexecuted'>    address public immutable governor;</span>
 18 |     | <span class='neutral'></span>
 19 |     | <span class='neutral'>    /// @notice The voting token contract address.</span>
 20 |     | <span class='unexecuted'>    address public immutable votingToken;</span>
 21 |     | <span class='neutral'></span>
 22 |     | <span class='unexecuted'>    constructor(address _governor, address _votingToken, address _owner) {</span>
 23 |     | <span class='unexecuted'>        if (_owner == address(0)) revert INVALID_OWNER();</span>
 24 |     | <span class='unexecuted'>        if (_governor == address(0)) revert INVALID_GOVERNOR();</span>
 25 |     | <span class='unexecuted'>        if (_votingToken == address(0)) revert INVALID_VOTING_TOKEN();</span>
 26 |     | <span class='neutral'></span>
 27 |     | <span class='unexecuted'>        governor = _governor;</span>
 28 |     | <span class='unexecuted'>        votingToken = _votingToken;</span>
 29 |     | <span class='neutral'></span>
 30 |     | <span class='unexecuted'>        _transferOwnership(_owner);</span>
 31 |     | <span class='neutral'>    }</span>
 32 |     | <span class='neutral'></span>
 33 |     | <span class='neutral'>    /// @notice Encode OZ delegate calldata for use in VestingEscrow.</span>
 34 |     | <span class='neutral'>    /// @param delegatee The delegatee address.</span>
 35 |     | <span class='unexecuted'>    function encodeDelegateCallData(address delegatee) external pure returns (bytes memory) {</span>
 36 |     | <span class='unexecuted'>        return abi.encode(delegatee);</span>
 37 |     | <span class='neutral'>    }</span>
 38 |     | <span class='neutral'></span>
 39 |     | <span class='neutral'>    /// @notice Encode OZ vote calldata for use in VestingEscrow.</span>
 40 |     | <span class='neutral'>    /// @param proposalId The proposal id.</span>
 41 |     | <span class='neutral'>    /// @param support The support value.</span>
 42 |     | <span class='unexecuted'>    function encodeVoteCallData(uint256 proposalId, uint8 support) external pure returns (bytes memory) {</span>
 43 |     | <span class='unexecuted'>        return abi.encode(proposalId, support);</span>
 44 |     | <span class='neutral'>    }</span>
 45 |     | <span class='neutral'></span>
 46 |     | <span class='neutral'>    // forgefmt: disable-next-item</span>
 47 |     | <span class='neutral'>    /// @notice Encode OZ vote with reason calldata for use in VestingEscrow.</span>
 48 |     | <span class='neutral'>    /// @param proposalId The proposal id.</span>
 49 |     | <span class='neutral'>    /// @param support The support value.</span>
 50 |     | <span class='neutral'>    /// @param reason The vote reason.</span>
 51 |     | <span class='unexecuted'>    function encodeVoteWithReasonCallData(uint256 proposalId, uint8 support, string calldata reason) external pure returns (bytes memory) {</span>
 52 |     | <span class='unexecuted'>        return abi.encode(proposalId, support, reason);</span>
 53 |     | <span class='neutral'>    }</span>
 54 |     | <span class='neutral'></span>
 55 |     | <span class='neutral'>    /// @notice Delegate votes.</span>
 56 |     | <span class='neutral'>    /// @param params The ABI-encoded delegatee address.</span>
 57 |     | <span class='unexecuted'>    function delegate(bytes calldata params) external {</span>
 58 |     | <span class='unexecuted'>        IVotes(votingToken).delegate(abi.decode(params, (address)));</span>
 59 |     | <span class='neutral'>    }</span>
 60 |     | <span class='neutral'></span>
 61 |     | <span class='neutral'>    /// @notice Vote on an OZ proposal.</span>
 62 |     | <span class='neutral'>    /// @param params The ABI-encoded proposal id and support value.</span>
 63 |     | <span class='unexecuted'>    function vote(bytes calldata params) external {</span>
 64 |     | <span class='unexecuted'>        (uint256 proposalId, uint8 support) = abi.decode(params, (uint256, uint8));</span>
 65 |     | <span class='unexecuted'>        IGovernor(governor).castVote(proposalId, support);</span>
 66 |     | <span class='neutral'>    }</span>
 67 |     | <span class='neutral'></span>
 68 |     | <span class='neutral'>    /// @notice Vote on a proposal with a reason.</span>
 69 |     | <span class='neutral'>    /// @param params The ABI-encoded proposal id, support value, and reason.</span>
 70 |     | <span class='unexecuted'>    function voteWithReason(bytes calldata params) external {</span>
 71 |     | <span class='unexecuted'>        (uint256 proposalId, uint8 support, string memory reason) = abi.decode(params, (uint256, uint8, string));</span>
 72 |     | <span class='unexecuted'>        IGovernor(governor).castVoteWithReason(proposalId, support, reason);</span>
 73 |     | <span class='neutral'>    }</span>
 74 |     | <span class='neutral'></span>
 75 |     | <span class='neutral'>    /// @notice Recover any ERC20 to the owner.</span>
 76 |     | <span class='neutral'>    /// @param token_ The ERC20 token to recover.</span>
 77 |     | <span class='neutral'>    /// @param amount The amount to recover.</span>
 78 |     | <span class='unexecuted'>    function recoverERC20(address token_, uint256 amount) external {</span>
 79 |     | <span class='unexecuted'>        if (amount &gt; 0) {</span>
 80 |     | <span class='unexecuted'>            IERC20(token_).safeTransfer(owner(), amount);</span>
 81 |     | <span class='unexecuted'>            emit ERC20Recovered(token_, amount);</span>
 82 |     | <span class='neutral'>        }</span>
 83 |     | <span class='neutral'>    }</span>
 84 |     | <span class='neutral'></span>
 85 |     | <span class='neutral'>    /// @notice Recover any ETH to the owner.</span>
 86 |     | <span class='unexecuted'>    function recoverEther() external {</span>
 87 |     | <span class='unexecuted'>        uint256 amount = address(this).balance;</span>
 88 |     | <span class='unexecuted'>        if (amount &gt; 0) {</span>
 89 |     | <span class='unexecuted'>            payable(owner()).sendValue(amount);</span>
 90 |     | <span class='unexecuted'>            emit ETHRecovered(amount);</span>
 91 |     | <span class='neutral'>        }</span>
 92 |     | <span class='neutral'>    }</span>
 93 |     | <span class='neutral'>}</span>
 94 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/src/interfaces/IVestingEscrow.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: GPL-3.0</span>
  2 |     | <span class='neutral'>pragma solidity 0.8.23;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>interface IVestingEscrow {</span>
  5 |     | <span class='neutral'>    /// @notice Thrown when the caller is not the owner.</span>
  6 |     | <span class='neutral'>    error NOT_OWNER(address account);</span>
  7 |     | <span class='neutral'></span>
  8 |     | <span class='neutral'>    /// @notice Thrown when the caller is not the owner or manager.</span>
  9 |     | <span class='neutral'>    error NOT_OWNER_OR_MANAGER(address account);</span>
 10 |     | <span class='neutral'></span>
 11 |     | <span class='neutral'>    /// @notice Thrown when the caller is not the recipient.</span>
 12 |     | <span class='neutral'>    error NOT_RECIPIENT(address account);</span>
 13 |     | <span class='neutral'></span>
 14 |     | <span class='neutral'>    /// @notice Throws if called by any account other than the factory.</span>
 15 |     | <span class='neutral'>    error NOT_FACTORY(address account);</span>
 16 |     | <span class='neutral'></span>
 17 |     | <span class='neutral'>    /// @notice Throws if the contract token balance is insufficient.</span>
 18 |     | <span class='neutral'>    error INSUFFICIENT_BALANCE();</span>
 19 |     | <span class='neutral'></span>
 20 |     | <span class='neutral'>    /// @notice Thrown when tokens are not fully revokable.</span>
 21 |     | <span class='neutral'>    error NOT_FULLY_REVOKABLE();</span>
 22 |     | <span class='neutral'></span>
 23 |     | <span class='neutral'>    /// @notice Thrown when tokens are already fully revoked.</span>
 24 |     | <span class='neutral'>    error ALREADY_FULLY_REVOKED();</span>
 25 |     | <span class='neutral'></span>
 26 |     | <span class='neutral'>    /// @notice Thrown when there are no tokens to revoke.</span>
 27 |     | <span class='neutral'>    error NOTHING_TO_REVOKE();</span>
 28 |     | <span class='neutral'></span>
 29 |     | <span class='neutral'>    /// @notice Thrown when the voting adaptor is not set.</span>
 30 |     | <span class='neutral'>    error VOTING_ADAPTOR_NOT_SET();</span>
 31 |     | <span class='neutral'></span>
 32 |     | <span class='neutral'>    /// @notice Emitted when the vesting escrow is initialized.</span>
 33 |     | <span class='neutral'>    event VestingEscrowInitialized(</span>
 34 |     | <span class='neutral'>        address indexed factory,</span>
 35 |     | <span class='neutral'>        address indexed recipient,</span>
 36 |     | <span class='neutral'>        address indexed token,</span>
 37 |     | <span class='neutral'>        uint256 amount,</span>
 38 |     | <span class='neutral'>        uint40 startTime,</span>
 39 |     | <span class='neutral'>        uint40 endTime,</span>
 40 |     | <span class='neutral'>        uint40 cliffLength,</span>
 41 |     | <span class='neutral'>        bool isFullyRevokable</span>
 42 |     | <span class='neutral'>    );</span>
 43 |     | <span class='neutral'></span>
 44 |     | <span class='neutral'>    /// @notice Emitted when vested tokens are claimed.</span>
 45 |     | <span class='neutral'>    event Claim(address indexed beneficiary, uint256 claimed);</span>
 46 |     | <span class='neutral'></span>
 47 |     | <span class='neutral'>    /// @notice Emitted when unvested tokens are revoked.</span>
 48 |     | <span class='neutral'>    event UnvestedTokensRevoked(address indexed recoverer, uint256 revoked);</span>
 49 |     | <span class='neutral'></span>
 50 |     | <span class='neutral'>    /// @notice Emitted when all tokens are revoked.</span>
 51 |     | <span class='neutral'>    event VestingFullyRevoked(address indexed recoverer, uint256 revoked);</span>
 52 |     | <span class='neutral'></span>
 53 |     | <span class='neutral'>    /// @notice Emitted when full revocation power is permanently disabled.</span>
 54 |     | <span class='neutral'>    event FullRevocationPermanentlyDisabled(address indexed owner);</span>
 55 |     | <span class='neutral'></span>
 56 |     | <span class='neutral'>    /// @notice Emitted when ERC20 tokens are recovered.</span>
 57 |     | <span class='neutral'>    event ERC20Recovered(address token, uint256 amount);</span>
 58 |     | <span class='neutral'></span>
 59 |     | <span class='neutral'>    /// @notice Emitted when ETH is recovered.</span>
 60 |     | <span class='neutral'>    event ETHRecovered(uint256 amount);</span>
 61 |     | <span class='neutral'></span>
 62 |     | <span class='neutral'>    /// @notice Initializes the contract.</span>
 63 |     | <span class='neutral'>    /// @param isFullyRevokable Whether the tokens are fully revokable.</span>
 64 |     | <span class='neutral'>    /// @param initialDelegateParams The optional initial delegate information (skipped if empty bytes).</span>
 65 |     | <span class='neutral'>    function initialize(bool isFullyRevokable, bytes calldata initialDelegateParams) external;</span>
 66 |     | <span class='neutral'>}</span>
 67 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/src/interfaces/IVestingEscrowFactory.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: GPL-3.0</span>
  2 |     | <span class='neutral'>pragma solidity 0.8.23;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>interface IVestingEscrowFactory {</span>
  5 |     | <span class='neutral'>    /// @notice Thrown when the vesting duration is zero</span>
  6 |     | <span class='neutral'>    error INVALID_VESTING_DURATION();</span>
  7 |     | <span class='neutral'></span>
  8 |     | <span class='neutral'>    /// @notice Thrown when the vesting cliff is greater than the vesting duration</span>
  9 |     | <span class='neutral'>    error INVALID_VESTING_CLIFF();</span>
 10 |     | <span class='neutral'></span>
 11 |     | <span class='neutral'>    /// @notice Thrown when the recipient is the zero address</span>
 12 |     | <span class='neutral'>    error INVALID_RECIPIENT();</span>
 13 |     | <span class='neutral'></span>
 14 |     | <span class='neutral'>    /// @notice Thrown when the amount is zero</span>
 15 |     | <span class='neutral'>    error INVALID_AMOUNT();</span>
 16 |     | <span class='neutral'></span>
 17 |     | <span class='neutral'>    /// @notice Thrown when the vesting escrow implementation is the zero address</span>
 18 |     | <span class='neutral'>    error INVALID_VESTING_ESCROW_IMPL();</span>
 19 |     | <span class='neutral'></span>
 20 |     | <span class='neutral'>    /// @notice Thrown when the token is the zero address</span>
 21 |     | <span class='neutral'>    error INVALID_TOKEN();</span>
 22 |     | <span class='neutral'></span>
 23 |     | <span class='neutral'>    /// @notice Thrown when the owner is the zero address</span>
 24 |     | <span class='neutral'>    error INVALID_OWNER();</span>
 25 |     | <span class='neutral'></span>
 26 |     | <span class='neutral'>    /// @notice Thrown when a transfer fails.</span>
 27 |     | <span class='neutral'>    error TRANSFER_FAILED();</span>
 28 |     | <span class='neutral'></span>
 29 |     | <span class='neutral'>    /// @notice Emitted when a vesting escrow is created.</span>
 30 |     | <span class='neutral'>    event VestingEscrowCreated(address indexed creator, address indexed recipient, address escrow);</span>
 31 |     | <span class='neutral'></span>
 32 |     | <span class='neutral'>    /// @notice Emitted when an ERC20 token is recovered.</span>
 33 |     | <span class='neutral'>    event ERC20Recovered(address token, uint256 amount);</span>
 34 |     | <span class='neutral'></span>
 35 |     | <span class='neutral'>    /// @notice Emitted when ETH is recovered.</span>
 36 |     | <span class='neutral'>    event ETHRecovered(uint256 amount);</span>
 37 |     | <span class='neutral'></span>
 38 |     | <span class='neutral'>    /// @notice Emitted when the voting adaptor is upgraded.</span>
 39 |     | <span class='neutral'>    event VotingAdaptorUpgraded(address votingAdaptor);</span>
 40 |     | <span class='neutral'></span>
 41 |     | <span class='neutral'>    /// @notice Emitted when the manager is changed.</span>
 42 |     | <span class='neutral'>    event ManagerChanged(address manager);</span>
 43 |     | <span class='neutral'></span>
 44 |     | <span class='neutral'>    function votingAdaptor() external view returns (address);</span>
 45 |     | <span class='neutral'>    function owner() external view returns (address);</span>
 46 |     | <span class='neutral'>    function manager() external view returns (address);</span>
 47 |     | <span class='neutral'>}</span>
 48 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/src/interfaces/IVotingAdaptor.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: GPL-3.0</span>
  2 |     | <span class='neutral'>pragma solidity 0.8.23;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>interface IVotingAdaptor {</span>
  5 |     | <span class='neutral'>    /// @notice Thrown when the owner is the zero address.</span>
  6 |     | <span class='neutral'>    error INVALID_OWNER();</span>
  7 |     | <span class='neutral'></span>
  8 |     | <span class='neutral'>    /// @notice Thrown when the governor is the zero address.</span>
  9 |     | <span class='neutral'>    error INVALID_GOVERNOR();</span>
 10 |     | <span class='neutral'></span>
 11 |     | <span class='neutral'>    /// @notice Thrown when the voting token is the zero address.</span>
 12 |     | <span class='neutral'>    error INVALID_VOTING_TOKEN();</span>
 13 |     | <span class='neutral'></span>
 14 |     | <span class='neutral'>    /// @notice Emitted when ERC20 tokens are recovered.</span>
 15 |     | <span class='neutral'>    event ERC20Recovered(address token, uint256 amount);</span>
 16 |     | <span class='neutral'></span>
 17 |     | <span class='neutral'>    /// @notice Emitted when ETH is recovered.</span>
 18 |     | <span class='neutral'>    event ETHRecovered(uint256 amount);</span>
 19 |     | <span class='neutral'></span>
 20 |     | <span class='neutral'>    /// @notice Delegate votes.</span>
 21 |     | <span class='neutral'>    /// @param params The ABI-encoded delegate params.</span>
 22 |     | <span class='neutral'>    function delegate(bytes calldata params) external;</span>
 23 |     | <span class='neutral'></span>
 24 |     | <span class='neutral'>    /// @notice Vote on a proposal.</span>
 25 |     | <span class='neutral'>    /// @param params The ABI-encoded vote params.</span>
 26 |     | <span class='neutral'>    function vote(bytes calldata params) external;</span>
 27 |     | <span class='neutral'></span>
 28 |     | <span class='neutral'>    /// @notice Vote on a proposal with a reason.</span>
 29 |     | <span class='neutral'>    /// @param params The ABI-encoded vote with reason params.</span>
 30 |     | <span class='neutral'>    function voteWithReason(bytes calldata params) external;</span>
 31 |     | <span class='neutral'>}</span>
 32 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/test/OZVotingAdaptor.t.sol</b>
<code>
  1 |     | <span class='neutral'>// // SPDX-License-Identifier: GPL-3.0</span>
  2 |     | <span class='neutral'>// pragma solidity 0.8.23;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>// import {TestUtil} from &#39;test/lib/TestUtil.sol&#39;;</span>
  5 |     | <span class='neutral'>// import {ERC20Token} from &#39;test/lib/ERC20Token.sol&#39;;</span>
  6 |     | <span class='neutral'></span>
  7 |     | <span class='neutral'>// contract OZVotingAdaptorTest is TestUtil {</span>
  8 |     | <span class='neutral'>//     function setUp() public {</span>
  9 |     | <span class='neutral'>//         setUpProtocol(ProtocolConfig({owner: address(1), manager: address(2)}));</span>
 10 |     | <span class='neutral'>//         deployVestingEscrow(</span>
 11 |     | <span class='neutral'>//             VestingEscrowConfig({</span>
 12 |     | <span class='neutral'>//                 amount: 1 ether,</span>
 13 |     | <span class='neutral'>//                 recipient: address(this),</span>
 14 |     | <span class='neutral'>//                 vestingDuration: 365 days,</span>
 15 |     | <span class='neutral'>//                 vestingStart: uint40(block.timestamp),</span>
 16 |     | <span class='neutral'>//                 cliffLength: 90 days,</span>
 17 |     | <span class='neutral'>//                 isFullyRevokable: true,</span>
 18 |     | <span class='neutral'>//                 initialDelegateParams: new bytes(0)</span>
 19 |     | <span class='neutral'>//             })</span>
 20 |     | <span class='neutral'>//         );</span>
 21 |     | <span class='neutral'>//     }</span>
 22 |     | <span class='neutral'></span>
 23 |     | <span class='neutral'>//     function testRecoverERC20() public {</span>
 24 |     | <span class='neutral'>//         ERC20Token token2 = new ERC20Token();</span>
 25 |     | <span class='neutral'>//         address _owner = ozVotingAdaptor.owner();</span>
 26 |     | <span class='neutral'></span>
 27 |     | <span class='neutral'>//         token2.mint(address(ozVotingAdaptor), amount);</span>
 28 |     | <span class='neutral'></span>
 29 |     | <span class='neutral'>//         uint256 ownerBalance = token2.balanceOf(_owner);</span>
 30 |     | <span class='neutral'></span>
 31 |     | <span class='neutral'>//         ozVotingAdaptor.recoverERC20(address(token2), amount);</span>
 32 |     | <span class='neutral'></span>
 33 |     | <span class='neutral'>//         assertEq(token2.balanceOf(_owner), amount + ownerBalance);</span>
 34 |     | <span class='neutral'>//         assertEq(token2.balanceOf(address(ozVotingAdaptor)), 0);</span>
 35 |     | <span class='neutral'>//     }</span>
 36 |     | <span class='neutral'></span>
 37 |     | <span class='neutral'>//     function testRecoverEther() public {</span>
 38 |     | <span class='neutral'>//         vm.deal(address(ozVotingAdaptor), 1 ether);</span>
 39 |     | <span class='neutral'>//         assertEq(address(ozVotingAdaptor).balance, 1 ether);</span>
 40 |     | <span class='neutral'></span>
 41 |     | <span class='neutral'>//         address _owner = ozVotingAdaptor.owner();</span>
 42 |     | <span class='neutral'>//         uint256 ownerBalance = address(_owner).balance;</span>
 43 |     | <span class='neutral'></span>
 44 |     | <span class='neutral'>//         ozVotingAdaptor.recoverEther();</span>
 45 |     | <span class='neutral'></span>
 46 |     | <span class='neutral'>//         assertEq(address(_owner).balance, ownerBalance + 1 ether);</span>
 47 |     | <span class='neutral'>//         assertEq(address(ozVotingAdaptor).balance, 0);</span>
 48 |     | <span class='neutral'>//     }</span>
 49 |     | <span class='neutral'></span>
 50 |     | <span class='neutral'>//     function testSendEtherReverts() public {</span>
 51 |     | <span class='neutral'>//         vm.deal(address(ozVotingAdaptor), 1 ether);</span>
 52 |     | <span class='neutral'>//         assertEq(address(ozVotingAdaptor).balance, 1 ether);</span>
 53 |     | <span class='neutral'></span>
 54 |     | <span class='neutral'>//         vm.prank(RANDOM_GUY);</span>
 55 |     | <span class='neutral'>//         (bool success,) = address(ozVotingAdaptor).call{value: 1 ether}(new bytes(0));</span>
 56 |     | <span class='neutral'>//         assertEq(success, false);</span>
 57 |     | <span class='neutral'>//     }</span>
 58 |     | <span class='neutral'>// }</span>
 59 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/test/VestingEscrow.t.sol</b>
<code>
   1 |     | <span class='neutral'>// // SPDX-License-Identifier: GPL-3.0</span>
   2 |     | <span class='neutral'>// pragma solidity 0.8.23;</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>// import {TestUtil} from &#39;test/lib/TestUtil.sol&#39;;</span>
   5 |     | <span class='neutral'>// import {IVestingEscrow} from &#39;src/interfaces/IVestingEscrow.sol&#39;;</span>
   6 |     | <span class='neutral'>// import {OZVotingAdaptor} from &#39;src/adaptors/OZVotingAdaptor.sol&#39;;</span>
   7 |     | <span class='neutral'>// import {ERC20NoReturnToken} from &#39;test/lib/ERC20NoReturnToken.sol&#39;;</span>
   8 |     | <span class='neutral'>// import {ERC20Token} from &#39;test/lib/ERC20Token.sol&#39;;</span>
   9 |     | <span class='neutral'></span>
  10 |     | <span class='neutral'>// contract VestingEscrowTest is TestUtil {</span>
  11 |     | <span class='neutral'>//     function setUp() public {</span>
  12 |     | <span class='neutral'>//         setUpProtocol(ProtocolConfig({owner: address(1), manager: address(2)}));</span>
  13 |     | <span class='neutral'>//         deployVestingEscrow(</span>
  14 |     | <span class='neutral'>//             VestingEscrowConfig({</span>
  15 |     | <span class='neutral'>//                 amount: 1 ether,</span>
  16 |     | <span class='neutral'>//                 recipient: address(this),</span>
  17 |     | <span class='neutral'>//                 vestingDuration: 365 days,</span>
  18 |     | <span class='neutral'>//                 vestingStart: uint40(block.timestamp),</span>
  19 |     | <span class='neutral'>//                 cliffLength: 90 days,</span>
  20 |     | <span class='neutral'>//                 isFullyRevokable: true,</span>
  21 |     | <span class='neutral'>//                 initialDelegateParams: new bytes(0)</span>
  22 |     | <span class='neutral'>//             })</span>
  23 |     | <span class='neutral'>//         );</span>
  24 |     | <span class='neutral'>//     }</span>
  25 |     | <span class='neutral'></span>
  26 |     | <span class='neutral'>//     function testInitializeFromNonFactoryReverts() public {</span>
  27 |     | <span class='neutral'>//         address _owner = factory.owner();</span>
  28 |     | <span class='neutral'></span>
  29 |     | <span class='neutral'>//         vm.prank(_owner);</span>
  30 |     | <span class='neutral'>//         vm.expectRevert(abi.encodeWithSelector(IVestingEscrow.NOT_FACTORY.selector, _owner));</span>
  31 |     | <span class='neutral'>//         deployedVesting.initialize(true, new bytes(0));</span>
  32 |     | <span class='neutral'>//     }</span>
  33 |     | <span class='neutral'></span>
  34 |     | <span class='neutral'>//     function testClaimNonRecipientReverts() public {</span>
  35 |     | <span class='neutral'>//         vm.warp(endTime);</span>
  36 |     | <span class='neutral'>//         vm.prank(RANDOM_GUY);</span>
  37 |     | <span class='neutral'></span>
  38 |     | <span class='neutral'>//         vm.expectRevert(abi.encodeWithSelector(IVestingEscrow.NOT_RECIPIENT.selector, RANDOM_GUY));</span>
  39 |     | <span class='neutral'>//         deployedVesting.claim(RANDOM_GUY, type(uint256).max);</span>
  40 |     | <span class='neutral'>//     }</span>
  41 |     | <span class='neutral'></span>
  42 |     | <span class='neutral'>//     function testClaimFull() public {</span>
  43 |     | <span class='neutral'>//         vm.warp(endTime);</span>
  44 |     | <span class='neutral'>//         assertEq(token.balanceOf(recipient), 0);</span>
  45 |     | <span class='neutral'></span>
  46 |     | <span class='neutral'>//         vm.prank(recipient);</span>
  47 |     | <span class='neutral'>//         assertEq(deployedVesting.claim(recipient, type(uint256).max), amount);</span>
  48 |     | <span class='neutral'>//         assertEq(token.balanceOf(recipient), amount);</span>
  49 |     | <span class='neutral'>//     }</span>
  50 |     | <span class='neutral'></span>
  51 |     | <span class='neutral'>//     function testClaimLess() public {</span>
  52 |     | <span class='neutral'>//         vm.warp(endTime);</span>
  53 |     | <span class='neutral'>//         assertEq(token.balanceOf(recipient), 0);</span>
  54 |     | <span class='neutral'></span>
  55 |     | <span class='neutral'>//         vm.prank(recipient);</span>
  56 |     | <span class='neutral'>//         assertEq(deployedVesting.claim(recipient, amount / 10), amount / 10);</span>
  57 |     | <span class='neutral'>//         assertEq(token.balanceOf(recipient), amount / 10);</span>
  58 |     | <span class='neutral'>//     }</span>
  59 |     | <span class='neutral'></span>
  60 |     | <span class='neutral'>//     function testClaimBeneficiary() public {</span>
  61 |     | <span class='neutral'>//         vm.warp(endTime);</span>
  62 |     | <span class='neutral'>//         assertEq(token.balanceOf(RANDOM_GUY), 0);</span>
  63 |     | <span class='neutral'></span>
  64 |     | <span class='neutral'>//         vm.prank(recipient);</span>
  65 |     | <span class='neutral'>//         deployedVesting.claim(RANDOM_GUY, type(uint256).max);</span>
  66 |     | <span class='neutral'></span>
  67 |     | <span class='neutral'>//         assertEq(token.balanceOf(RANDOM_GUY), amount);</span>
  68 |     | <span class='neutral'>//     }</span>
  69 |     | <span class='neutral'></span>
  70 |     | <span class='neutral'>//     function testClaimBeforeStart() public {</span>
  71 |     | <span class='neutral'>//         vm.warp(startTime - 1);</span>
  72 |     | <span class='neutral'>//         vm.prank(recipient);</span>
  73 |     | <span class='neutral'></span>
  74 |     | <span class='neutral'>//         assertEq(deployedVesting.claim(recipient, type(uint256).max), 0);</span>
  75 |     | <span class='neutral'>//         assertEq(token.balanceOf(recipient), 0);</span>
  76 |     | <span class='neutral'>//     }</span>
  77 |     | <span class='neutral'></span>
  78 |     | <span class='neutral'>//     function testClaimBeforeCliff() public {</span>
  79 |     | <span class='neutral'>//         vm.warp(startTime + cliffLength - 1);</span>
  80 |     | <span class='neutral'>//         vm.prank(recipient);</span>
  81 |     | <span class='neutral'></span>
  82 |     | <span class='neutral'>//         deployedVesting.claim(recipient, type(uint256).max);</span>
  83 |     | <span class='neutral'></span>
  84 |     | <span class='neutral'>//         assertEq(token.balanceOf(recipient), 0);</span>
  85 |     | <span class='neutral'>//     }</span>
  86 |     | <span class='neutral'></span>
  87 |     | <span class='neutral'>//     function testClaimAfterCliff() public {</span>
  88 |     | <span class='neutral'>//         vm.warp(startTime + cliffLength + 1);</span>
  89 |     | <span class='neutral'>//         vm.prank(recipient);</span>
  90 |     | <span class='neutral'></span>
  91 |     | <span class='neutral'>//         uint256 amountClaimed = deployedVesting.claim(recipient, type(uint256).max);</span>
  92 |     | <span class='neutral'>//         uint256 expectedAmount = (amount * (block.timestamp - startTime)) / (endTime - startTime);</span>
  93 |     | <span class='neutral'></span>
  94 |     | <span class='neutral'>//         assertEq(amountClaimed, expectedAmount);</span>
  95 |     | <span class='neutral'>//         assertEq(token.balanceOf(recipient), expectedAmount);</span>
  96 |     | <span class='neutral'>//         assertEq(deployedVesting.totalClaimed(), expectedAmount);</span>
  97 |     | <span class='neutral'>//     }</span>
  98 |     | <span class='neutral'></span>
  99 |     | <span class='neutral'>//     function testClaimAfterEnd() public {</span>
 100 |     | <span class='neutral'>//         vm.warp(endTime + 1);</span>
 101 |     | <span class='neutral'>//         deployedVesting.claim(recipient, type(uint256).max);</span>
 102 |     | <span class='neutral'></span>
 103 |     | <span class='neutral'>//         assertEq(token.balanceOf(recipient), amount);</span>
 104 |     | <span class='neutral'>//     }</span>
 105 |     | <span class='neutral'></span>
 106 |     | <span class='neutral'>//     function testClaimPartial() public {</span>
 107 |     | <span class='neutral'>//         vm.warp(block.timestamp + ((endTime - startTime) / 2));</span>
 108 |     | <span class='neutral'>//         vm.prank(recipient);</span>
 109 |     | <span class='neutral'></span>
 110 |     | <span class='neutral'>//         deployedVesting.claim(recipient, type(uint256).max);</span>
 111 |     | <span class='neutral'>//         uint256 expectedAmount = (amount * (block.timestamp - startTime)) / (endTime - startTime);</span>
 112 |     | <span class='neutral'></span>
 113 |     | <span class='neutral'>//         assertEq(token.balanceOf(recipient), expectedAmount);</span>
 114 |     | <span class='neutral'>//         assertEq(deployedVesting.totalClaimed(), expectedAmount);</span>
 115 |     | <span class='neutral'>//     }</span>
 116 |     | <span class='neutral'></span>
 117 |     | <span class='neutral'>//     function testClaimMultiple() public {</span>
 118 |     | <span class='neutral'>//         vm.warp(startTime);</span>
 119 |     | <span class='neutral'></span>
 120 |     | <span class='neutral'>//         uint256 recipientBalance = 0;</span>
 121 |     | <span class='neutral'>//         for (uint256 i = 1; i &lt;= 11; i++) {</span>
 122 |     | <span class='neutral'>//             vm.warp(((endTime - startTime) / 10) * i);</span>
 123 |     | <span class='neutral'></span>
 124 |     | <span class='neutral'>//             deployedVesting.claim(recipient, type(uint256).max);</span>
 125 |     | <span class='neutral'>//             uint256 newBalance = token.balanceOf(recipient);</span>
 126 |     | <span class='neutral'></span>
 127 |     | <span class='neutral'>//             if (block.timestamp &lt; startTime + cliffLength) {</span>
 128 |     | <span class='neutral'>//                 assertEq(newBalance, recipientBalance);</span>
 129 |     | <span class='neutral'>//             } else {</span>
 130 |     | <span class='neutral'>//                 assertTrue(newBalance &gt; recipientBalance);</span>
 131 |     | <span class='neutral'>//             }</span>
 132 |     | <span class='neutral'>//             recipientBalance = newBalance;</span>
 133 |     | <span class='neutral'>//         }</span>
 134 |     | <span class='neutral'></span>
 135 |     | <span class='neutral'>//         assertEq(token.balanceOf(recipient), recipientBalance);</span>
 136 |     | <span class='neutral'>//     }</span>
 137 |     | <span class='neutral'></span>
 138 |     | <span class='neutral'>//     function testInitialDelegate() public {</span>
 139 |     | <span class='neutral'>//         deployVestingEscrow(</span>
 140 |     | <span class='neutral'>//             VestingEscrowConfig({</span>
 141 |     | <span class='neutral'>//                 amount: 1 ether,</span>
 142 |     | <span class='neutral'>//                 recipient: address(this),</span>
 143 |     | <span class='neutral'>//                 vestingDuration: 365 days,</span>
 144 |     | <span class='neutral'>//                 vestingStart: uint40(block.timestamp),</span>
 145 |     | <span class='neutral'>//                 cliffLength: 90 days,</span>
 146 |     | <span class='neutral'>//                 isFullyRevokable: false,</span>
 147 |     | <span class='neutral'>//                 initialDelegateParams: ozVotingAdaptor.encodeDelegateCallData(RANDOM_GUY)</span>
 148 |     | <span class='neutral'>//             })</span>
 149 |     | <span class='neutral'>//         );</span>
 150 |     | <span class='neutral'></span>
 151 |     | <span class='neutral'>//         assertEq(token.delegates(address(deployedVesting)), RANDOM_GUY);</span>
 152 |     | <span class='neutral'>//     }</span>
 153 |     | <span class='neutral'></span>
 154 |     | <span class='neutral'>//     function testInitialDelegateEmptySkipsDelegation() public {</span>
 155 |     | <span class='neutral'>//         deployVestingEscrow(</span>
 156 |     | <span class='neutral'>//             VestingEscrowConfig({</span>
 157 |     | <span class='neutral'>//                 amount: 1 ether,</span>
 158 |     | <span class='neutral'>//                 recipient: address(this),</span>
 159 |     | <span class='neutral'>//                 vestingDuration: 365 days,</span>
 160 |     | <span class='neutral'>//                 vestingStart: uint40(block.timestamp),</span>
 161 |     | <span class='neutral'>//                 cliffLength: 90 days,</span>
 162 |     | <span class='neutral'>//                 isFullyRevokable: false,</span>
 163 |     | <span class='neutral'>//                 initialDelegateParams: new bytes(0)</span>
 164 |     | <span class='neutral'>//             })</span>
 165 |     | <span class='neutral'>//         );</span>
 166 |     | <span class='neutral'></span>
 167 |     | <span class='neutral'>//         assertEq(token.delegates(address(deployedVesting)), address(0));</span>
 168 |     | <span class='neutral'>//     }</span>
 169 |     | <span class='neutral'></span>
 170 |     | <span class='neutral'>//     function testDelegate() public {</span>
 171 |     | <span class='neutral'>//         assertEq(token.delegates(address(deployedVesting)), address(0));</span>
 172 |     | <span class='neutral'></span>
 173 |     | <span class='neutral'>//         vm.prank(recipient);</span>
 174 |     | <span class='neutral'>//         deployedVesting.delegate(ozVotingAdaptor.encodeDelegateCallData(RANDOM_GUY));</span>
 175 |     | <span class='neutral'>//         assertEq(token.delegates(address(deployedVesting)), RANDOM_GUY);</span>
 176 |     | <span class='neutral'>//     }</span>
 177 |     | <span class='neutral'></span>
 178 |     | <span class='neutral'>//     function testDelegateAfterUpgrade() public {</span>
 179 |     | <span class='neutral'>//         assertEq(token.delegates(address(deployedVesting)), address(0));</span>
 180 |     | <span class='neutral'></span>
 181 |     | <span class='neutral'>//         address newVotingAdaptor = address(new OZVotingAdaptor(address(governor), address(token), factory.owner()));</span>
 182 |     | <span class='neutral'></span>
 183 |     | <span class='neutral'>//         vm.prank(factory.owner());</span>
 184 |     | <span class='neutral'>//         factory.updateVotingAdaptor(newVotingAdaptor);</span>
 185 |     | <span class='neutral'></span>
 186 |     | <span class='neutral'>//         vm.prank(recipient);</span>
 187 |     | <span class='neutral'>//         deployedVesting.delegate(ozVotingAdaptor.encodeDelegateCallData(RANDOM_GUY));</span>
 188 |     | <span class='neutral'>//         assertEq(token.delegates(address(deployedVesting)), RANDOM_GUY);</span>
 189 |     | <span class='neutral'>//     }</span>
 190 |     | <span class='neutral'></span>
 191 |     | <span class='neutral'>//     function testDelegateFromNonRecipientReverts() public {</span>
 192 |     | <span class='neutral'>//         bytes memory params = ozVotingAdaptor.encodeDelegateCallData(RANDOM_GUY);</span>
 193 |     | <span class='neutral'></span>
 194 |     | <span class='neutral'>//         vm.prank(RANDOM_GUY);</span>
 195 |     | <span class='neutral'>//         vm.expectRevert(abi.encodeWithSelector(IVestingEscrow.NOT_RECIPIENT.selector, RANDOM_GUY));</span>
 196 |     | <span class='neutral'>//         deployedVesting.delegate(params);</span>
 197 |     | <span class='neutral'>//     }</span>
 198 |     | <span class='neutral'></span>
 199 |     | <span class='neutral'>//     function testDelegateAdaptorNotSetReverts() public {</span>
 200 |     | <span class='neutral'>//         bytes memory params = ozVotingAdaptor.encodeDelegateCallData(RANDOM_GUY);</span>
 201 |     | <span class='neutral'></span>
 202 |     | <span class='neutral'>//         vm.prank(factory.owner());</span>
 203 |     | <span class='neutral'>//         factory.updateVotingAdaptor(address(0));</span>
 204 |     | <span class='neutral'></span>
 205 |     | <span class='neutral'>//         vm.prank(recipient);</span>
 206 |     | <span class='neutral'>//         vm.expectRevert(IVestingEscrow.VOTING_ADAPTOR_NOT_SET.selector);</span>
 207 |     | <span class='neutral'>//         deployedVesting.delegate(params);</span>
 208 |     | <span class='neutral'>//     }</span>
 209 |     | <span class='neutral'></span>
 210 |     | <span class='neutral'>//     function testVote() public {</span>
 211 |     | <span class='neutral'>//         vm.prank(recipient);</span>
 212 |     | <span class='neutral'>//         deployedVesting.delegate(ozVotingAdaptor.encodeDelegateCallData(address(deployedVesting)));</span>
 213 |     | <span class='neutral'></span>
 214 |     | <span class='neutral'>//         uint256 proposalId = createProposal();</span>
 215 |     | <span class='neutral'>//         uint256 votingBalance = token.getVotes(address(deployedVesting));</span>
 216 |     | <span class='neutral'></span>
 217 |     | <span class='neutral'>//         vm.roll(block.number + 1);</span>
 218 |     | <span class='neutral'></span>
 219 |     | <span class='neutral'>//         vm.prank(recipient);</span>
 220 |     | <span class='neutral'>//         deployedVesting.vote(ozVotingAdaptor.encodeVoteCallData(proposalId, uint8(VoteType.For)));</span>
 221 |     | <span class='neutral'></span>
 222 |     | <span class='neutral'>//         (uint256 againstVotes, uint256 forVotes, uint256 abstainVotes) = governor.proposalVotes(proposalId);</span>
 223 |     | <span class='neutral'></span>
 224 |     | <span class='neutral'>//         assertEq(forVotes, votingBalance);</span>
 225 |     | <span class='neutral'>//         assertEq(againstVotes, 0);</span>
 226 |     | <span class='neutral'>//         assertEq(abstainVotes, 0);</span>
 227 |     | <span class='neutral'>//     }</span>
 228 |     | <span class='neutral'></span>
 229 |     | <span class='neutral'>//     function testVoteAfterClaimAll() public {</span>
 230 |     | <span class='neutral'>//         vm.warp(endTime);</span>
 231 |     | <span class='neutral'></span>
 232 |     | <span class='neutral'>//         vm.prank(recipient);</span>
 233 |     | <span class='neutral'>//         deployedVesting.delegate(ozVotingAdaptor.encodeDelegateCallData(address(deployedVesting)));</span>
 234 |     | <span class='neutral'></span>
 235 |     | <span class='neutral'>//         vm.prank(recipient);</span>
 236 |     | <span class='neutral'>//         deployedVesting.claim(recipient, type(uint256).max);</span>
 237 |     | <span class='neutral'></span>
 238 |     | <span class='neutral'>//         assertEq(token.balanceOf(address(deployedVesting)), 0);</span>
 239 |     | <span class='neutral'></span>
 240 |     | <span class='neutral'>//         uint256 proposalId = createProposal();</span>
 241 |     | <span class='neutral'>//         vm.roll(block.number + 1);</span>
 242 |     | <span class='neutral'></span>
 243 |     | <span class='neutral'>//         vm.prank(recipient);</span>
 244 |     | <span class='neutral'>//         deployedVesting.vote(ozVotingAdaptor.encodeVoteCallData(proposalId, uint8(VoteType.For)));</span>
 245 |     | <span class='neutral'></span>
 246 |     | <span class='neutral'>//         (uint256 againstVotes, uint256 forVotes, uint256 abstainVotes) = governor.proposalVotes(proposalId);</span>
 247 |     | <span class='neutral'></span>
 248 |     | <span class='neutral'>//         assertEq(forVotes, 0);</span>
 249 |     | <span class='neutral'>//         assertEq(againstVotes, 0);</span>
 250 |     | <span class='neutral'>//         assertEq(abstainVotes, 0);</span>
 251 |     | <span class='neutral'>//     }</span>
 252 |     | <span class='neutral'></span>
 253 |     | <span class='neutral'>//     function testVoteAfterUpgrade() public {</span>
 254 |     | <span class='neutral'>//         vm.prank(recipient);</span>
 255 |     | <span class='neutral'>//         deployedVesting.delegate(ozVotingAdaptor.encodeDelegateCallData(address(deployedVesting)));</span>
 256 |     | <span class='neutral'></span>
 257 |     | <span class='neutral'>//         address newVotingAdaptor = address(new OZVotingAdaptor(address(governor), address(token), factory.owner()));</span>
 258 |     | <span class='neutral'></span>
 259 |     | <span class='neutral'>//         vm.prank(factory.owner());</span>
 260 |     | <span class='neutral'>//         factory.updateVotingAdaptor(newVotingAdaptor);</span>
 261 |     | <span class='neutral'></span>
 262 |     | <span class='neutral'>//         uint256 proposalId = createProposal();</span>
 263 |     | <span class='neutral'>//         uint256 votingBalance = token.getVotes(address(deployedVesting));</span>
 264 |     | <span class='neutral'></span>
 265 |     | <span class='neutral'>//         vm.roll(block.number + 1);</span>
 266 |     | <span class='neutral'></span>
 267 |     | <span class='neutral'>//         vm.prank(recipient);</span>
 268 |     | <span class='neutral'>//         deployedVesting.vote(ozVotingAdaptor.encodeVoteCallData(proposalId, uint8(VoteType.For)));</span>
 269 |     | <span class='neutral'></span>
 270 |     | <span class='neutral'>//         (uint256 againstVotes, uint256 forVotes, uint256 abstainVotes) = governor.proposalVotes(proposalId);</span>
 271 |     | <span class='neutral'></span>
 272 |     | <span class='neutral'>//         assertEq(forVotes, votingBalance);</span>
 273 |     | <span class='neutral'>//         assertEq(againstVotes, 0);</span>
 274 |     | <span class='neutral'>//         assertEq(abstainVotes, 0);</span>
 275 |     | <span class='neutral'>//     }</span>
 276 |     | <span class='neutral'></span>
 277 |     | <span class='neutral'>//     function testVoteAdaptorNotSetReverts() public {</span>
 278 |     | <span class='neutral'>//         uint256 proposalId = createProposal();</span>
 279 |     | <span class='neutral'>//         bytes memory params = ozVotingAdaptor.encodeVoteCallData(proposalId, uint8(VoteType.For));</span>
 280 |     | <span class='neutral'></span>
 281 |     | <span class='neutral'>//         vm.prank(factory.owner());</span>
 282 |     | <span class='neutral'>//         factory.updateVotingAdaptor(address(0));</span>
 283 |     | <span class='neutral'></span>
 284 |     | <span class='neutral'>//         vm.roll(block.number + 1);</span>
 285 |     | <span class='neutral'></span>
 286 |     | <span class='neutral'>//         vm.prank(recipient);</span>
 287 |     | <span class='neutral'>//         vm.expectRevert(IVestingEscrow.VOTING_ADAPTOR_NOT_SET.selector);</span>
 288 |     | <span class='neutral'>//         deployedVesting.vote(params);</span>
 289 |     | <span class='neutral'>//     }</span>
 290 |     | <span class='neutral'></span>
 291 |     | <span class='neutral'>//     function testVoteFromNonRecipientReverts() public {</span>
 292 |     | <span class='neutral'>//         uint256 proposalId = createProposal();</span>
 293 |     | <span class='neutral'>//         bytes memory params = ozVotingAdaptor.encodeVoteCallData(proposalId, uint8(VoteType.For));</span>
 294 |     | <span class='neutral'></span>
 295 |     | <span class='neutral'>//         vm.roll(block.number + 1);</span>
 296 |     | <span class='neutral'></span>
 297 |     | <span class='neutral'>//         vm.prank(RANDOM_GUY);</span>
 298 |     | <span class='neutral'>//         vm.expectRevert(abi.encodeWithSelector(IVestingEscrow.NOT_RECIPIENT.selector, RANDOM_GUY));</span>
 299 |     | <span class='neutral'>//         deployedVesting.vote(params);</span>
 300 |     | <span class='neutral'>//     }</span>
 301 |     | <span class='neutral'></span>
 302 |     | <span class='neutral'>//     function testVoteWithReason() public {</span>
 303 |     | <span class='neutral'>//         vm.prank(recipient);</span>
 304 |     | <span class='neutral'>//         deployedVesting.delegate(ozVotingAdaptor.encodeDelegateCallData(address(deployedVesting)));</span>
 305 |     | <span class='neutral'></span>
 306 |     | <span class='neutral'>//         uint256 proposalId = createProposal();</span>
 307 |     | <span class='neutral'>//         uint256 votingBalance = token.getVotes(address(deployedVesting));</span>
 308 |     | <span class='neutral'></span>
 309 |     | <span class='neutral'>//         vm.roll(block.number + 1);</span>
 310 |     | <span class='neutral'></span>
 311 |     | <span class='neutral'>//         vm.prank(recipient);</span>
 312 |     | <span class='neutral'>//         deployedVesting.voteWithReason(</span>
 313 |     | <span class='neutral'>//             ozVotingAdaptor.encodeVoteWithReasonCallData(proposalId, uint8(VoteType.For), &#39;Reason&#39;)</span>
 314 |     | <span class='neutral'>//         );</span>
 315 |     | <span class='neutral'></span>
 316 |     | <span class='neutral'>//         (uint256 againstVotes, uint256 forVotes, uint256 abstainVotes) = governor.proposalVotes(proposalId);</span>
 317 |     | <span class='neutral'></span>
 318 |     | <span class='neutral'>//         assertEq(forVotes, votingBalance);</span>
 319 |     | <span class='neutral'>//         assertEq(againstVotes, 0);</span>
 320 |     | <span class='neutral'>//         assertEq(abstainVotes, 0);</span>
 321 |     | <span class='neutral'>//     }</span>
 322 |     | <span class='neutral'></span>
 323 |     | <span class='neutral'>//     function testVoteWithReasonAfterClaimAll() public {</span>
 324 |     | <span class='neutral'>//         vm.warp(endTime);</span>
 325 |     | <span class='neutral'></span>
 326 |     | <span class='neutral'>//         vm.prank(recipient);</span>
 327 |     | <span class='neutral'>//         deployedVesting.delegate(ozVotingAdaptor.encodeDelegateCallData(address(deployedVesting)));</span>
 328 |     | <span class='neutral'></span>
 329 |     | <span class='neutral'>//         vm.prank(recipient);</span>
 330 |     | <span class='neutral'>//         deployedVesting.claim(recipient, type(uint256).max);</span>
 331 |     | <span class='neutral'></span>
 332 |     | <span class='neutral'>//         assertEq(token.balanceOf(address(deployedVesting)), 0);</span>
 333 |     | <span class='neutral'></span>
 334 |     | <span class='neutral'>//         uint256 proposalId = createProposal();</span>
 335 |     | <span class='neutral'>//         vm.roll(block.number + 1);</span>
 336 |     | <span class='neutral'></span>
 337 |     | <span class='neutral'>//         vm.prank(recipient);</span>
 338 |     | <span class='neutral'>//         deployedVesting.voteWithReason(</span>
 339 |     | <span class='neutral'>//             ozVotingAdaptor.encodeVoteWithReasonCallData(proposalId, uint8(VoteType.For), &#39;Reason&#39;)</span>
 340 |     | <span class='neutral'>//         );</span>
 341 |     | <span class='neutral'></span>
 342 |     | <span class='neutral'>//         (uint256 againstVotes, uint256 forVotes, uint256 abstainVotes) = governor.proposalVotes(proposalId);</span>
 343 |     | <span class='neutral'></span>
 344 |     | <span class='neutral'>//         assertEq(forVotes, 0);</span>
 345 |     | <span class='neutral'>//         assertEq(againstVotes, 0);</span>
 346 |     | <span class='neutral'>//         assertEq(abstainVotes, 0);</span>
 347 |     | <span class='neutral'>//     }</span>
 348 |     | <span class='neutral'></span>
 349 |     | <span class='neutral'>//     function testVoteWithReasonAfterUpgrade() public {</span>
 350 |     | <span class='neutral'>//         vm.prank(recipient);</span>
 351 |     | <span class='neutral'>//         deployedVesting.delegate(ozVotingAdaptor.encodeDelegateCallData(address(deployedVesting)));</span>
 352 |     | <span class='neutral'></span>
 353 |     | <span class='neutral'>//         address newVotingAdaptor = address(new OZVotingAdaptor(address(governor), address(token), factory.owner()));</span>
 354 |     | <span class='neutral'></span>
 355 |     | <span class='neutral'>//         vm.prank(factory.owner());</span>
 356 |     | <span class='neutral'>//         factory.updateVotingAdaptor(newVotingAdaptor);</span>
 357 |     | <span class='neutral'></span>
 358 |     | <span class='neutral'>//         uint256 proposalId = createProposal();</span>
 359 |     | <span class='neutral'>//         uint256 votingBalance = token.getVotes(address(deployedVesting));</span>
 360 |     | <span class='neutral'></span>
 361 |     | <span class='neutral'>//         vm.roll(block.number + 1);</span>
 362 |     | <span class='neutral'></span>
 363 |     | <span class='neutral'>//         vm.prank(recipient);</span>
 364 |     | <span class='neutral'>//         deployedVesting.voteWithReason(</span>
 365 |     | <span class='neutral'>//             ozVotingAdaptor.encodeVoteWithReasonCallData(proposalId, uint8(VoteType.For), &#39;Reason&#39;)</span>
 366 |     | <span class='neutral'>//         );</span>
 367 |     | <span class='neutral'></span>
 368 |     | <span class='neutral'>//         (uint256 againstVotes, uint256 forVotes, uint256 abstainVotes) = governor.proposalVotes(proposalId);</span>
 369 |     | <span class='neutral'></span>
 370 |     | <span class='neutral'>//         assertEq(forVotes, votingBalance);</span>
 371 |     | <span class='neutral'>//         assertEq(againstVotes, 0);</span>
 372 |     | <span class='neutral'>//         assertEq(abstainVotes, 0);</span>
 373 |     | <span class='neutral'>//     }</span>
 374 |     | <span class='neutral'></span>
 375 |     | <span class='neutral'>//     function testVoteWithReasonAdaptorNotSetReverts() public {</span>
 376 |     | <span class='neutral'>//         uint256 proposalId = createProposal();</span>
 377 |     | <span class='neutral'>//         bytes memory params = ozVotingAdaptor.encodeVoteWithReasonCallData(proposalId, uint8(VoteType.For), &#39;Reason&#39;);</span>
 378 |     | <span class='neutral'></span>
 379 |     | <span class='neutral'>//         vm.prank(factory.owner());</span>
 380 |     | <span class='neutral'>//         factory.updateVotingAdaptor(address(0));</span>
 381 |     | <span class='neutral'></span>
 382 |     | <span class='neutral'>//         vm.roll(block.number + 1);</span>
 383 |     | <span class='neutral'></span>
 384 |     | <span class='neutral'>//         vm.prank(recipient);</span>
 385 |     | <span class='neutral'>//         vm.expectRevert(IVestingEscrow.VOTING_ADAPTOR_NOT_SET.selector);</span>
 386 |     | <span class='neutral'>//         deployedVesting.voteWithReason(params);</span>
 387 |     | <span class='neutral'>//     }</span>
 388 |     | <span class='neutral'></span>
 389 |     | <span class='neutral'>//     function testVoteWithReasonFromNonRecipientReverts() public {</span>
 390 |     | <span class='neutral'>//         uint256 proposalId = createProposal();</span>
 391 |     | <span class='neutral'>//         bytes memory params = ozVotingAdaptor.encodeVoteWithReasonCallData(proposalId, uint8(VoteType.For), &#39;Reason&#39;);</span>
 392 |     | <span class='neutral'></span>
 393 |     | <span class='neutral'>//         vm.roll(block.number + 1);</span>
 394 |     | <span class='neutral'></span>
 395 |     | <span class='neutral'>//         vm.prank(RANDOM_GUY);</span>
 396 |     | <span class='neutral'>//         vm.expectRevert(abi.encodeWithSelector(IVestingEscrow.NOT_RECIPIENT.selector, RANDOM_GUY));</span>
 397 |     | <span class='neutral'>//         deployedVesting.voteWithReason(params);</span>
 398 |     | <span class='neutral'>//     }</span>
 399 |     | <span class='neutral'></span>
 400 |     | <span class='neutral'>//     function testLockedUnclaimed() public {</span>
 401 |     | <span class='neutral'>//         assertEq(deployedVesting.locked(), deployedVesting.totalLocked());</span>
 402 |     | <span class='neutral'>//         assertEq(deployedVesting.unclaimed(), 0);</span>
 403 |     | <span class='neutral'></span>
 404 |     | <span class='neutral'>//         vm.warp(endTime);</span>
 405 |     | <span class='neutral'>//         assertEq(deployedVesting.locked(), 0);</span>
 406 |     | <span class='neutral'>//         assertEq(deployedVesting.unclaimed(), deployedVesting.totalLocked());</span>
 407 |     | <span class='neutral'></span>
 408 |     | <span class='neutral'>//         vm.prank(recipient);</span>
 409 |     | <span class='neutral'>//         deployedVesting.claim(recipient, type(uint256).max);</span>
 410 |     | <span class='neutral'>//         assertEq(deployedVesting.unclaimed(), 0);</span>
 411 |     | <span class='neutral'>//     }</span>
 412 |     | <span class='neutral'></span>
 413 |     | <span class='neutral'>//     function testRecoverNonVestedToken() public {</span>
 414 |     | <span class='neutral'>//         ERC20Token token2 = new ERC20Token();</span>
 415 |     | <span class='neutral'></span>
 416 |     | <span class='neutral'>//         token2.mint(recipient, amount);</span>
 417 |     | <span class='neutral'>//         token2.transfer(address(deployedVesting), amount);</span>
 418 |     | <span class='neutral'></span>
 419 |     | <span class='neutral'>//         deployedVesting.recoverERC20(address(token2), amount);</span>
 420 |     | <span class='neutral'>//         assertEq(token2.balanceOf(recipient), amount);</span>
 421 |     | <span class='neutral'>//     }</span>
 422 |     | <span class='neutral'></span>
 423 |     | <span class='neutral'>//     function testRecoverNonVestedTokenWithBadImpl() public {</span>
 424 |     | <span class='neutral'>//         ERC20NoReturnToken token2 = new ERC20NoReturnToken();</span>
 425 |     | <span class='neutral'></span>
 426 |     | <span class='neutral'>//         token2.mint(address(deployedVesting), amount);</span>
 427 |     | <span class='neutral'></span>
 428 |     | <span class='neutral'>//         deployedVesting.recoverERC20(address(token2), amount);</span>
 429 |     | <span class='neutral'>//         assertEq(token2.balanceOf(recipient), amount);</span>
 430 |     | <span class='neutral'>//     }</span>
 431 |     | <span class='neutral'></span>
 432 |     | <span class='neutral'>//     function testRecoverLockedTokens() public {</span>
 433 |     | <span class='neutral'>//         deployedVesting.recoverERC20(address(token), amount);</span>
 434 |     | <span class='neutral'>//         assertEq(token.balanceOf(recipient), 0);</span>
 435 |     | <span class='neutral'>//     }</span>
 436 |     | <span class='neutral'></span>
 437 |     | <span class='neutral'>//     function testRecoverExtraLockedTokens() public {</span>
 438 |     | <span class='neutral'>//         uint256 extra = 10 ** 17;</span>
 439 |     | <span class='neutral'>//         token.mint(address(deployedVesting), extra);</span>
 440 |     | <span class='neutral'></span>
 441 |     | <span class='neutral'>//         deployedVesting.recoverERC20(address(token), amount);</span>
 442 |     | <span class='neutral'>//         assertEq(token.balanceOf(recipient), extra);</span>
 443 |     | <span class='neutral'>//     }</span>
 444 |     | <span class='neutral'></span>
 445 |     | <span class='neutral'>//     function testRecoverExtraLockedTokensPartiallyClaimed() public {</span>
 446 |     | <span class='neutral'>//         uint256 extra = 10 ** 17;</span>
 447 |     | <span class='neutral'>//         uint256 claimAmount = 3 * extra;</span>
 448 |     | <span class='neutral'></span>
 449 |     | <span class='neutral'>//         token.mint(address(deployedVesting), extra);</span>
 450 |     | <span class='neutral'></span>
 451 |     | <span class='neutral'>//         vm.warp(endTime);</span>
 452 |     | <span class='neutral'>//         vm.prank(recipient);</span>
 453 |     | <span class='neutral'>//         deployedVesting.claim(RANDOM_GUY, claimAmount);</span>
 454 |     | <span class='neutral'>//         deployedVesting.recoverERC20(address(token), amount);</span>
 455 |     | <span class='neutral'></span>
 456 |     | <span class='neutral'>//         assertEq(token.balanceOf(recipient), extra);</span>
 457 |     | <span class='neutral'>//         assertEq(token.balanceOf(RANDOM_GUY), claimAmount);</span>
 458 |     | <span class='neutral'>//     }</span>
 459 |     | <span class='neutral'></span>
 460 |     | <span class='neutral'>//     function testRecoverLockedTokensAfterEnd() public {</span>
 461 |     | <span class='neutral'>//         vm.warp(endTime + 1);</span>
 462 |     | <span class='neutral'>//         deployedVesting.recoverERC20(address(token), amount);</span>
 463 |     | <span class='neutral'></span>
 464 |     | <span class='neutral'>//         assertEq(token.balanceOf(recipient), 0);</span>
 465 |     | <span class='neutral'>//         assertEq(deployedVesting.locked(), 0);</span>
 466 |     | <span class='neutral'>//         assertEq(deployedVesting.unclaimed(), amount);</span>
 467 |     | <span class='neutral'>//     }</span>
 468 |     | <span class='neutral'></span>
 469 |     | <span class='neutral'>//     function testRecoverLockedTokensAfterEndPartiallyClaimed() public {</span>
 470 |     | <span class='neutral'>//         vm.warp(endTime + 1);</span>
 471 |     | <span class='neutral'>//         uint256 claimAmount = 10 ** 17;</span>
 472 |     | <span class='neutral'></span>
 473 |     | <span class='neutral'>//         vm.prank(recipient);</span>
 474 |     | <span class='neutral'>//         deployedVesting.claim(RANDOM_GUY, claimAmount);</span>
 475 |     | <span class='neutral'>//         deployedVesting.recoverERC20(address(token), amount);</span>
 476 |     | <span class='neutral'></span>
 477 |     | <span class='neutral'>//         assertEq(token.balanceOf(recipient), 0);</span>
 478 |     | <span class='neutral'>//         assertEq(deployedVesting.locked(), 0);</span>
 479 |     | <span class='neutral'>//         assertEq(deployedVesting.unclaimed(), amount - claimAmount);</span>
 480 |     | <span class='neutral'>//     }</span>
 481 |     | <span class='neutral'></span>
 482 |     | <span class='neutral'>//     function testRecoverEther() public {</span>
 483 |     | <span class='neutral'>//         vm.deal(address(deployedVesting), 1 ether);</span>
 484 |     | <span class='neutral'>//         assertEq(address(deployedVesting).balance, 1 ether);</span>
 485 |     | <span class='neutral'></span>
 486 |     | <span class='neutral'>//         uint256 balanceBefore = recipient.balance;</span>
 487 |     | <span class='neutral'></span>
 488 |     | <span class='neutral'>//         deployedVesting.recoverEther();</span>
 489 |     | <span class='neutral'>//         assertEq(recipient.balance, balanceBefore + 1 ether);</span>
 490 |     | <span class='neutral'>//         assertEq(address(deployedVesting).balance, 0);</span>
 491 |     | <span class='neutral'>//     }</span>
 492 |     | <span class='neutral'></span>
 493 |     | <span class='neutral'>//     function testRecoverExtraAfterRevokeUnvested() public {</span>
 494 |     | <span class='neutral'>//         uint256 extra = 10 ** 17;</span>
 495 |     | <span class='neutral'>//         token.mint(address(deployedVesting), extra);</span>
 496 |     | <span class='neutral'></span>
 497 |     | <span class='neutral'>//         uint256 ownerBalance = token.balanceOf(factory.owner());</span>
 498 |     | <span class='neutral'></span>
 499 |     | <span class='neutral'>//         vm.prank(factory.owner());</span>
 500 |     | <span class='neutral'>//         deployedVesting.revokeUnvested();</span>
 501 |     | <span class='neutral'></span>
 502 |     | <span class='neutral'>//         assertEq(token.balanceOf(factory.owner()), amount + ownerBalance);</span>
 503 |     | <span class='neutral'></span>
 504 |     | <span class='neutral'>//         deployedVesting.recoverERC20(address(token), extra + 1);</span>
 505 |     | <span class='neutral'>//         assertEq(token.balanceOf(recipient), extra);</span>
 506 |     | <span class='neutral'>//     }</span>
 507 |     | <span class='neutral'></span>
 508 |     | <span class='neutral'>//     function testRecoverExtraAfterRevokeUnvestedPartially() public {</span>
 509 |     | <span class='neutral'>//         uint256 extra = 10 ** 17;</span>
 510 |     | <span class='neutral'>//         token.mint(address(deployedVesting), extra);</span>
 511 |     | <span class='neutral'></span>
 512 |     | <span class='neutral'>//         vm.warp(block.timestamp + ((endTime - startTime) / 2));</span>
 513 |     | <span class='neutral'></span>
 514 |     | <span class='neutral'>//         uint256 ownerBalance = token.balanceOf(factory.owner());</span>
 515 |     | <span class='neutral'></span>
 516 |     | <span class='neutral'>//         vm.prank(factory.owner());</span>
 517 |     | <span class='neutral'>//         deployedVesting.revokeUnvested();</span>
 518 |     | <span class='neutral'></span>
 519 |     | <span class='neutral'>//         uint256 vested = (amount * (block.timestamp - startTime)) / (endTime - startTime);</span>
 520 |     | <span class='neutral'>//         uint256 expectedAmount = amount - vested;</span>
 521 |     | <span class='neutral'></span>
 522 |     | <span class='neutral'>//         assertEq(token.balanceOf(factory.owner()), expectedAmount + ownerBalance);</span>
 523 |     | <span class='neutral'></span>
 524 |     | <span class='neutral'>//         deployedVesting.recoverERC20(address(token), extra + 1);</span>
 525 |     | <span class='neutral'>//         assertEq(token.balanceOf(recipient), extra);</span>
 526 |     | <span class='neutral'></span>
 527 |     | <span class='neutral'>//         deployedVesting.claim(recipient, type(uint256).max);</span>
 528 |     | <span class='neutral'>//         assertEq(token.balanceOf(recipient), extra + amount - expectedAmount);</span>
 529 |     | <span class='neutral'>//     }</span>
 530 |     | <span class='neutral'></span>
 531 |     | <span class='neutral'>//     function testRecoverExtraAfterRevokeAll() public {</span>
 532 |     | <span class='neutral'>//         uint256 extra = 10 ** 17;</span>
 533 |     | <span class='neutral'>//         token.mint(address(deployedVesting), extra);</span>
 534 |     | <span class='neutral'></span>
 535 |     | <span class='neutral'>//         vm.warp(block.timestamp + ((endTime - startTime) / 2));</span>
 536 |     | <span class='neutral'></span>
 537 |     | <span class='neutral'>//         uint256 ownerBalance = token.balanceOf(factory.owner());</span>
 538 |     | <span class='neutral'></span>
 539 |     | <span class='neutral'>//         vm.prank(factory.owner());</span>
 540 |     | <span class='neutral'>//         deployedVesting.revokeAll();</span>
 541 |     | <span class='neutral'></span>
 542 |     | <span class='neutral'>//         assertEq(token.balanceOf(factory.owner()), amount + ownerBalance);</span>
 543 |     | <span class='neutral'></span>
 544 |     | <span class='neutral'>//         deployedVesting.recoverERC20(address(token), amount);</span>
 545 |     | <span class='neutral'>//         assertEq(token.balanceOf(recipient), extra);</span>
 546 |     | <span class='neutral'>//     }</span>
 547 |     | <span class='neutral'></span>
 548 |     | <span class='neutral'>//     function testNonOwnerRevokeAllReverts() public {</span>
 549 |     | <span class='neutral'>//         vm.prank(RANDOM_GUY);</span>
 550 |     | <span class='neutral'>//         vm.expectRevert(abi.encodeWithSelector(IVestingEscrow.NOT_OWNER.selector, RANDOM_GUY));</span>
 551 |     | <span class='neutral'>//         deployedVesting.revokeAll();</span>
 552 |     | <span class='neutral'>//     }</span>
 553 |     | <span class='neutral'></span>
 554 |     | <span class='neutral'>//     function testRevokeAllNonFullyRevocableReverts() public {</span>
 555 |     | <span class='neutral'>//         deployVestingEscrow(</span>
 556 |     | <span class='neutral'>//             VestingEscrowConfig({</span>
 557 |     | <span class='neutral'>//                 amount: 1 ether,</span>
 558 |     | <span class='neutral'>//                 recipient: address(this),</span>
 559 |     | <span class='neutral'>//                 vestingDuration: 365 days,</span>
 560 |     | <span class='neutral'>//                 vestingStart: uint40(block.timestamp),</span>
 561 |     | <span class='neutral'>//                 cliffLength: 90 days,</span>
 562 |     | <span class='neutral'>//                 isFullyRevokable: false,</span>
 563 |     | <span class='neutral'>//                 initialDelegateParams: new bytes(0)</span>
 564 |     | <span class='neutral'>//             })</span>
 565 |     | <span class='neutral'>//         );</span>
 566 |     | <span class='neutral'></span>
 567 |     | <span class='neutral'>//         vm.prank(factory.owner());</span>
 568 |     | <span class='neutral'>//         vm.expectRevert(IVestingEscrow.NOT_FULLY_REVOKABLE.selector);</span>
 569 |     | <span class='neutral'>//         deployedVesting.revokeAll();</span>
 570 |     | <span class='neutral'>//     }</span>
 571 |     | <span class='neutral'></span>
 572 |     | <span class='neutral'>//     function testRevokeAllAfterPermanentlyDisablingFullRevocationReverts() public {</span>
 573 |     | <span class='neutral'>//         vm.prank(factory.owner());</span>
 574 |     | <span class='neutral'>//         deployedVesting.permanentlyDisableFullRevocation();</span>
 575 |     | <span class='neutral'></span>
 576 |     | <span class='neutral'>//         vm.prank(factory.owner());</span>
 577 |     | <span class='neutral'>//         vm.expectRevert(IVestingEscrow.NOT_FULLY_REVOKABLE.selector);</span>
 578 |     | <span class='neutral'>//         deployedVesting.revokeAll();</span>
 579 |     | <span class='neutral'>//     }</span>
 580 |     | <span class='neutral'></span>
 581 |     | <span class='neutral'>//     function testRevokeAllTwiceReverts() public {</span>
 582 |     | <span class='neutral'>//         vm.startPrank(factory.owner());</span>
 583 |     | <span class='neutral'>//         deployedVesting.revokeAll();</span>
 584 |     | <span class='neutral'></span>
 585 |     | <span class='neutral'>//         vm.expectRevert(IVestingEscrow.ALREADY_FULLY_REVOKED.selector);</span>
 586 |     | <span class='neutral'>//         deployedVesting.revokeAll();</span>
 587 |     | <span class='neutral'>//     }</span>
 588 |     | <span class='neutral'></span>
 589 |     | <span class='neutral'>//     function testRevokeAll() public {</span>
 590 |     | <span class='neutral'>//         uint256 ownerBalance = token.balanceOf(factory.owner());</span>
 591 |     | <span class='neutral'></span>
 592 |     | <span class='neutral'>//         vm.prank(factory.owner());</span>
 593 |     | <span class='neutral'>//         deployedVesting.revokeAll();</span>
 594 |     | <span class='neutral'></span>
 595 |     | <span class='neutral'>//         assertEq(deployedVesting.disabledAt(), block.timestamp);</span>
 596 |     | <span class='neutral'>//         assertEq(deployedVesting.unclaimed(), 0);</span>
 597 |     | <span class='neutral'>//         assertEq(deployedVesting.locked(), 0);</span>
 598 |     | <span class='neutral'>//         assertEq(token.balanceOf(factory.owner()), amount + ownerBalance);</span>
 599 |     | <span class='neutral'>//     }</span>
 600 |     | <span class='neutral'></span>
 601 |     | <span class='neutral'>//     function testRevokeAllAfterEndTime() public {</span>
 602 |     | <span class='neutral'>//         vm.warp(endTime + 1);</span>
 603 |     | <span class='neutral'></span>
 604 |     | <span class='neutral'>//         uint256 ownerBalance = token.balanceOf(factory.owner());</span>
 605 |     | <span class='neutral'></span>
 606 |     | <span class='neutral'>//         vm.prank(factory.owner());</span>
 607 |     | <span class='neutral'>//         deployedVesting.revokeAll();</span>
 608 |     | <span class='neutral'></span>
 609 |     | <span class='neutral'>//         assertEq(deployedVesting.disabledAt(), block.timestamp);</span>
 610 |     | <span class='neutral'>//         assertEq(deployedVesting.unclaimed(), 0);</span>
 611 |     | <span class='neutral'>//         assertEq(deployedVesting.locked(), 0);</span>
 612 |     | <span class='neutral'>//         assertEq(token.balanceOf(factory.owner()), amount + ownerBalance);</span>
 613 |     | <span class='neutral'>//         assertEq(token.balanceOf(recipient), 0);</span>
 614 |     | <span class='neutral'>//     }</span>
 615 |     | <span class='neutral'></span>
 616 |     | <span class='neutral'>//     function testRevokeAllBeforeStartTime() public {</span>
 617 |     | <span class='neutral'>//         vm.warp(startTime - 1);</span>
 618 |     | <span class='neutral'></span>
 619 |     | <span class='neutral'>//         uint256 ownerBalance = token.balanceOf(factory.owner());</span>
 620 |     | <span class='neutral'></span>
 621 |     | <span class='neutral'>//         vm.prank(factory.owner());</span>
 622 |     | <span class='neutral'>//         deployedVesting.revokeAll();</span>
 623 |     | <span class='neutral'></span>
 624 |     | <span class='neutral'>//         vm.prank(recipient);</span>
 625 |     | <span class='neutral'>//         deployedVesting.claim(recipient, type(uint256).max);</span>
 626 |     | <span class='neutral'></span>
 627 |     | <span class='neutral'>//         assertEq(token.balanceOf(recipient), 0);</span>
 628 |     | <span class='neutral'>//         assertEq(token.balanceOf(factory.owner()), amount + ownerBalance);</span>
 629 |     | <span class='neutral'>//     }</span>
 630 |     | <span class='neutral'></span>
 631 |     | <span class='neutral'>//     function testClaimAfterRevokeAll() public {</span>
 632 |     | <span class='neutral'>//         uint256 ownerBalance = token.balanceOf(factory.owner());</span>
 633 |     | <span class='neutral'></span>
 634 |     | <span class='neutral'>//         vm.prank(factory.owner());</span>
 635 |     | <span class='neutral'>//         deployedVesting.revokeAll();</span>
 636 |     | <span class='neutral'></span>
 637 |     | <span class='neutral'>//         vm.warp(endTime);</span>
 638 |     | <span class='neutral'></span>
 639 |     | <span class='neutral'>//         vm.prank(recipient);</span>
 640 |     | <span class='neutral'>//         deployedVesting.claim(recipient, type(uint256).max);</span>
 641 |     | <span class='neutral'></span>
 642 |     | <span class='neutral'>//         assertEq(deployedVesting.unclaimed(), 0);</span>
 643 |     | <span class='neutral'>//         assertEq(token.balanceOf(recipient), 0);</span>
 644 |     | <span class='neutral'>//         assertEq(token.balanceOf(factory.owner()), amount + ownerBalance);</span>
 645 |     | <span class='neutral'>//     }</span>
 646 |     | <span class='neutral'></span>
 647 |     | <span class='neutral'>//     function testRevokeAllAfterPartialClaim() public {</span>
 648 |     | <span class='neutral'>//         vm.warp(startTime + 10 days);</span>
 649 |     | <span class='neutral'></span>
 650 |     | <span class='neutral'>//         vm.prank(recipient);</span>
 651 |     | <span class='neutral'>//         uint256 claimAmount = deployedVesting.claim(recipient, type(uint256).max);</span>
 652 |     | <span class='neutral'></span>
 653 |     | <span class='neutral'>//         vm.warp(endTime);</span>
 654 |     | <span class='neutral'></span>
 655 |     | <span class='neutral'>//         uint256 ownerBalance = token.balanceOf(factory.owner());</span>
 656 |     | <span class='neutral'></span>
 657 |     | <span class='neutral'>//         vm.prank(factory.owner());</span>
 658 |     | <span class='neutral'>//         deployedVesting.revokeAll();</span>
 659 |     | <span class='neutral'></span>
 660 |     | <span class='neutral'>//         assertEq(deployedVesting.unclaimed(), 0);</span>
 661 |     | <span class='neutral'></span>
 662 |     | <span class='neutral'>//         assertEq(token.balanceOf(recipient), claimAmount);</span>
 663 |     | <span class='neutral'>//         assertEq(token.balanceOf(factory.owner()), amount - claimAmount + ownerBalance);</span>
 664 |     | <span class='neutral'>//     }</span>
 665 |     | <span class='neutral'></span>
 666 |     | <span class='neutral'>//     function testRevokeAllAfterRevokeUnvested() public {</span>
 667 |     | <span class='neutral'>//         vm.warp(block.timestamp + ((endTime - startTime) / 2));</span>
 668 |     | <span class='neutral'></span>
 669 |     | <span class='neutral'>//         uint256 ownerBalance = token.balanceOf(factory.owner());</span>
 670 |     | <span class='neutral'></span>
 671 |     | <span class='neutral'>//         vm.prank(factory.owner());</span>
 672 |     | <span class='neutral'>//         deployedVesting.revokeUnvested();</span>
 673 |     | <span class='neutral'></span>
 674 |     | <span class='neutral'>//         uint256 expectedAmount = (amount * (block.timestamp - startTime)) / (endTime - startTime);</span>
 675 |     | <span class='neutral'></span>
 676 |     | <span class='neutral'>//         assertEq(token.balanceOf(factory.owner()), amount - expectedAmount + ownerBalance);</span>
 677 |     | <span class='neutral'></span>
 678 |     | <span class='neutral'>//         vm.prank(factory.owner());</span>
 679 |     | <span class='neutral'>//         deployedVesting.revokeAll();</span>
 680 |     | <span class='neutral'></span>
 681 |     | <span class='neutral'>//         assertEq(token.balanceOf(factory.owner()), amount + ownerBalance);</span>
 682 |     | <span class='neutral'>//     }</span>
 683 |     | <span class='neutral'></span>
 684 |     | <span class='neutral'>//     function testRevokeAllAfterRevokeUnvestedAndClaim() public {</span>
 685 |     | <span class='neutral'>//         vm.warp(endTime);</span>
 686 |     | <span class='neutral'></span>
 687 |     | <span class='neutral'>//         vm.prank(recipient);</span>
 688 |     | <span class='neutral'>//         deployedVesting.claim(recipient, type(uint256).max);</span>
 689 |     | <span class='neutral'></span>
 690 |     | <span class='neutral'>//         vm.prank(factory.owner());</span>
 691 |     | <span class='neutral'>//         vm.expectRevert(IVestingEscrow.NOTHING_TO_REVOKE.selector);</span>
 692 |     | <span class='neutral'>//         deployedVesting.revokeAll();</span>
 693 |     | <span class='neutral'>//     }</span>
 694 |     | <span class='neutral'></span>
 695 |     | <span class='neutral'>//     function testRevokeUnvestedNonOwnerOrManagerReverts() public {</span>
 696 |     | <span class='neutral'>//         vm.prank(RANDOM_GUY);</span>
 697 |     | <span class='neutral'>//         vm.expectRevert(abi.encodeWithSelector(IVestingEscrow.NOT_OWNER_OR_MANAGER.selector, RANDOM_GUY));</span>
 698 |     | <span class='neutral'>//         deployedVesting.revokeUnvested();</span>
 699 |     | <span class='neutral'>//     }</span>
 700 |     | <span class='neutral'></span>
 701 |     | <span class='neutral'>//     function testNonOwnerPermanentlyDisableFullRevocationReverts() public {</span>
 702 |     | <span class='neutral'>//         vm.prank(RANDOM_GUY);</span>
 703 |     | <span class='neutral'>//         vm.expectRevert(abi.encodeWithSelector(IVestingEscrow.NOT_OWNER.selector, RANDOM_GUY));</span>
 704 |     | <span class='neutral'>//         deployedVesting.permanentlyDisableFullRevocation();</span>
 705 |     | <span class='neutral'>//     }</span>
 706 |     | <span class='neutral'></span>
 707 |     | <span class='neutral'>//     function testDisabledAtIsInitiallyEndTime() public {</span>
 708 |     | <span class='neutral'>//         assertEq(deployedVesting.disabledAt(), endTime);</span>
 709 |     | <span class='neutral'>//     }</span>
 710 |     | <span class='neutral'></span>
 711 |     | <span class='neutral'>//     function testRevokeUnvested() public {</span>
 712 |     | <span class='neutral'>//         uint256 ownerBalance = token.balanceOf(factory.owner());</span>
 713 |     | <span class='neutral'></span>
 714 |     | <span class='neutral'>//         vm.prank(factory.owner());</span>
 715 |     | <span class='neutral'>//         deployedVesting.revokeUnvested();</span>
 716 |     | <span class='neutral'></span>
 717 |     | <span class='neutral'>//         assertEq(deployedVesting.disabledAt(), block.timestamp);</span>
 718 |     | <span class='neutral'>//         assertEq(deployedVesting.locked(), 0);</span>
 719 |     | <span class='neutral'>//         assertEq(token.balanceOf(factory.owner()), amount + ownerBalance);</span>
 720 |     | <span class='neutral'>//     }</span>
 721 |     | <span class='neutral'></span>
 722 |     | <span class='neutral'>//     function testRevokeUnvestedFromManager() public {</span>
 723 |     | <span class='neutral'>//         uint256 ownerBalance = token.balanceOf(factory.owner());</span>
 724 |     | <span class='neutral'></span>
 725 |     | <span class='neutral'>//         vm.prank(factory.manager());</span>
 726 |     | <span class='neutral'>//         deployedVesting.revokeUnvested();</span>
 727 |     | <span class='neutral'></span>
 728 |     | <span class='neutral'>//         assertEq(deployedVesting.disabledAt(), block.timestamp);</span>
 729 |     | <span class='neutral'>//         assertEq(deployedVesting.locked(), 0);</span>
 730 |     | <span class='neutral'>//         assertEq(token.balanceOf(factory.owner()), amount + ownerBalance);</span>
 731 |     | <span class='neutral'>//     }</span>
 732 |     | <span class='neutral'></span>
 733 |     | <span class='neutral'>//     function testRevokeUnvestedAfterEndTime() public {</span>
 734 |     | <span class='neutral'>//         vm.warp(endTime + 1);</span>
 735 |     | <span class='neutral'></span>
 736 |     | <span class='neutral'>//         uint256 ownerBalance = token.balanceOf(factory.owner());</span>
 737 |     | <span class='neutral'></span>
 738 |     | <span class='neutral'>//         vm.prank(factory.owner());</span>
 739 |     | <span class='neutral'>//         vm.expectRevert(IVestingEscrow.NOTHING_TO_REVOKE.selector);</span>
 740 |     | <span class='neutral'>//         deployedVesting.revokeUnvested();</span>
 741 |     | <span class='neutral'></span>
 742 |     | <span class='neutral'>//         vm.prank(recipient);</span>
 743 |     | <span class='neutral'>//         deployedVesting.claim(recipient, type(uint256).max);</span>
 744 |     | <span class='neutral'></span>
 745 |     | <span class='neutral'>//         assertEq(token.balanceOf(recipient), amount);</span>
 746 |     | <span class='neutral'>//         assertEq(token.balanceOf(factory.owner()), ownerBalance);</span>
 747 |     | <span class='neutral'>//     }</span>
 748 |     | <span class='neutral'></span>
 749 |     | <span class='neutral'>//     function testRevokeUnvestedBeforeStartTime() public {</span>
 750 |     | <span class='neutral'>//         vm.warp(startTime - 1);</span>
 751 |     | <span class='neutral'></span>
 752 |     | <span class='neutral'>//         uint256 ownerBalance = token.balanceOf(factory.owner());</span>
 753 |     | <span class='neutral'></span>
 754 |     | <span class='neutral'>//         vm.prank(factory.owner());</span>
 755 |     | <span class='neutral'>//         deployedVesting.revokeUnvested();</span>
 756 |     | <span class='neutral'></span>
 757 |     | <span class='neutral'>//         vm.warp(endTime);</span>
 758 |     | <span class='neutral'></span>
 759 |     | <span class='neutral'>//         vm.prank(recipient);</span>
 760 |     | <span class='neutral'>//         deployedVesting.claim(recipient, type(uint256).max);</span>
 761 |     | <span class='neutral'></span>
 762 |     | <span class='neutral'>//         assertEq(token.balanceOf(recipient), 0);</span>
 763 |     | <span class='neutral'>//         assertEq(token.balanceOf(factory.owner()), deployedVesting.totalLocked() + ownerBalance);</span>
 764 |     | <span class='neutral'>//     }</span>
 765 |     | <span class='neutral'></span>
 766 |     | <span class='neutral'>//     function testRevokeUnvestedPartiallyUnclaimed() public {</span>
 767 |     | <span class='neutral'>//         vm.warp(startTime + 100 days);</span>
 768 |     | <span class='neutral'></span>
 769 |     | <span class='neutral'>//         uint256 ownerBalance = token.balanceOf(factory.owner());</span>
 770 |     | <span class='neutral'></span>
 771 |     | <span class='neutral'>//         vm.prank(factory.owner());</span>
 772 |     | <span class='neutral'>//         deployedVesting.revokeUnvested();</span>
 773 |     | <span class='neutral'></span>
 774 |     | <span class='neutral'>//         vm.prank(recipient);</span>
 775 |     | <span class='neutral'>//         deployedVesting.claim(recipient, amount);</span>
 776 |     | <span class='neutral'></span>
 777 |     | <span class='neutral'>//         uint256 expectedAmount = (amount * (block.timestamp - startTime)) / (endTime - startTime);</span>
 778 |     | <span class='neutral'></span>
 779 |     | <span class='neutral'>//         assertEq(token.balanceOf(recipient), expectedAmount);</span>
 780 |     | <span class='neutral'>//         assertEq(token.balanceOf(factory.owner()), deployedVesting.totalLocked() - expectedAmount + ownerBalance);</span>
 781 |     | <span class='neutral'>//     }</span>
 782 |     | <span class='neutral'></span>
 783 |     | <span class='neutral'>//     function testRevokeUnvestedPartiallyClaimed() public {</span>
 784 |     | <span class='neutral'>//         vm.warp(startTime + 100 days);</span>
 785 |     | <span class='neutral'></span>
 786 |     | <span class='neutral'>//         vm.prank(recipient);</span>
 787 |     | <span class='neutral'>//         uint256 claimAmount = deployedVesting.claim(recipient, type(uint256).max);</span>
 788 |     | <span class='neutral'>//         uint256 ownerBalance = token.balanceOf(factory.owner());</span>
 789 |     | <span class='neutral'></span>
 790 |     | <span class='neutral'>//         vm.prank(factory.owner());</span>
 791 |     | <span class='neutral'>//         deployedVesting.revokeUnvested();</span>
 792 |     | <span class='neutral'></span>
 793 |     | <span class='neutral'>//         assertEq(token.balanceOf(recipient), claimAmount);</span>
 794 |     | <span class='neutral'>//         assertEq(token.balanceOf(factory.owner()), amount - claimAmount + ownerBalance);</span>
 795 |     | <span class='neutral'>//     }</span>
 796 |     | <span class='neutral'>// }</span>
 797 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/test/VestingEscrowFactory.t.sol</b>
<code>
  1 |     | <span class='neutral'>// // SPDX-License-Identifier: GPL-3.0</span>
  2 |     | <span class='neutral'>// pragma solidity 0.8.23;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>// import {TestUtil} from &#39;test/lib/TestUtil.sol&#39;;</span>
  5 |     | <span class='neutral'>// import {ERC20Token} from &#39;test/lib/ERC20Token.sol&#39;;</span>
  6 |     | <span class='neutral'></span>
  7 |     | <span class='neutral'>// contract VestingEscrowFactoryTest is TestUtil {</span>
  8 |     | <span class='neutral'>//     function setUp() public {</span>
  9 |     | <span class='neutral'>//         setUpProtocol(ProtocolConfig({owner: address(1), manager: address(2)}));</span>
 10 |     | <span class='neutral'>//         deployVestingEscrow(</span>
 11 |     | <span class='neutral'>//             VestingEscrowConfig({</span>
 12 |     | <span class='neutral'>//                 amount: 1 ether,</span>
 13 |     | <span class='neutral'>//                 recipient: address(this),</span>
 14 |     | <span class='neutral'>//                 vestingDuration: 365 days,</span>
 15 |     | <span class='neutral'>//                 vestingStart: uint40(block.timestamp),</span>
 16 |     | <span class='neutral'>//                 cliffLength: 90 days,</span>
 17 |     | <span class='neutral'>//                 isFullyRevokable: true,</span>
 18 |     | <span class='neutral'>//                 initialDelegateParams: new bytes(0)</span>
 19 |     | <span class='neutral'>//             })</span>
 20 |     | <span class='neutral'>//         );</span>
 21 |     | <span class='neutral'>//     }</span>
 22 |     | <span class='neutral'></span>
 23 |     | <span class='neutral'>//     function testRecoverERC20() public {</span>
 24 |     | <span class='neutral'>//         ERC20Token token2 = new ERC20Token();</span>
 25 |     | <span class='neutral'>//         address _owner = factory.owner();</span>
 26 |     | <span class='neutral'></span>
 27 |     | <span class='neutral'>//         token2.mint(address(factory), amount);</span>
 28 |     | <span class='neutral'></span>
 29 |     | <span class='neutral'>//         uint256 ownerBalance = token2.balanceOf(_owner);</span>
 30 |     | <span class='neutral'></span>
 31 |     | <span class='neutral'>//         factory.recoverERC20(address(token2), amount);</span>
 32 |     | <span class='neutral'></span>
 33 |     | <span class='neutral'>//         assertEq(token2.balanceOf(_owner), amount + ownerBalance);</span>
 34 |     | <span class='neutral'>//         assertEq(token2.balanceOf(address(factory)), 0);</span>
 35 |     | <span class='neutral'>//     }</span>
 36 |     | <span class='neutral'></span>
 37 |     | <span class='neutral'>//     function testRecoverEther() public {</span>
 38 |     | <span class='neutral'>//         vm.deal(address(factory), 1 ether);</span>
 39 |     | <span class='neutral'>//         assertEq(address(factory).balance, 1 ether);</span>
 40 |     | <span class='neutral'></span>
 41 |     | <span class='neutral'>//         address _owner = factory.owner();</span>
 42 |     | <span class='neutral'>//         uint256 ownerBalance = address(_owner).balance;</span>
 43 |     | <span class='neutral'></span>
 44 |     | <span class='neutral'>//         factory.recoverEther();</span>
 45 |     | <span class='neutral'></span>
 46 |     | <span class='neutral'>//         assertEq(address(_owner).balance, ownerBalance + 1 ether);</span>
 47 |     | <span class='neutral'>//         assertEq(address(factory).balance, 0);</span>
 48 |     | <span class='neutral'>//     }</span>
 49 |     | <span class='neutral'></span>
 50 |     | <span class='neutral'>//     function testSendEtherReverts() public {</span>
 51 |     | <span class='neutral'>//         vm.deal(address(factory), 1 ether);</span>
 52 |     | <span class='neutral'>//         assertEq(address(factory).balance, 1 ether);</span>
 53 |     | <span class='neutral'></span>
 54 |     | <span class='neutral'>//         vm.prank(RANDOM_GUY);</span>
 55 |     | <span class='neutral'>//         (bool success,) = address(factory).call{value: 1 ether}(new bytes(0));</span>
 56 |     | <span class='neutral'>//         assertEq(success, false);</span>
 57 |     | <span class='neutral'>//     }</span>
 58 |     | <span class='neutral'></span>
 59 |     | <span class='neutral'>//     function testUpdateVotingAdaptorFromNonOwnerReverts() public {</span>
 60 |     | <span class='neutral'>//         vm.prank(RANDOM_GUY);</span>
 61 |     | <span class='neutral'>//         vm.expectRevert();</span>
 62 |     | <span class='neutral'>//         factory.updateVotingAdaptor(address(1));</span>
 63 |     | <span class='neutral'>//     }</span>
 64 |     | <span class='neutral'></span>
 65 |     | <span class='neutral'>//     function testChangeManagerFromNonOwnerReverts() public {</span>
 66 |     | <span class='neutral'>//         vm.prank(RANDOM_GUY);</span>
 67 |     | <span class='neutral'>//         vm.expectRevert();</span>
 68 |     | <span class='neutral'>//         factory.changeManager(address(1));</span>
 69 |     | <span class='neutral'>//     }</span>
 70 |     | <span class='neutral'>// }</span>
 71 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/test/lib/ERC20NoReturnToken.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: GPL-3.0</span>
  2 |     | <span class='neutral'>pragma solidity 0.8.23;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>import {ERC20} from &#39;@openzeppelin/contracts/token/ERC20/ERC20.sol&#39;;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='unexecuted'>contract ERC20NoReturnToken is ERC20 {</span>
  7 |     | <span class='unexecuted'>    constructor() ERC20(&#39;ERC20NoReturnToken&#39;, &#39;ERC20NR&#39;) {}</span>
  8 |     | <span class='neutral'></span>
  9 |     | <span class='unexecuted'>    function transfer(address to, uint256 amount) public override returns (bool) {</span>
 10 |     | <span class='unexecuted'>        super.transfer(to, amount);</span>
 11 |     | <span class='neutral'>        assembly {</span>
 12 |     | <span class='neutral'>            return(0, 0)</span>
 13 |     | <span class='neutral'>        }</span>
 14 |     | <span class='neutral'>    }</span>
 15 |     | <span class='neutral'></span>
 16 |     | <span class='unexecuted'>    function transferFrom(address from, address to, uint256 amount) public override returns (bool) {</span>
 17 |     | <span class='unexecuted'>        super.transferFrom(from, to, amount);</span>
 18 |     | <span class='neutral'>        assembly {</span>
 19 |     | <span class='neutral'>            return(0, 0)</span>
 20 |     | <span class='neutral'>        }</span>
 21 |     | <span class='neutral'>    }</span>
 22 |     | <span class='neutral'></span>
 23 |     | <span class='unexecuted'>    function approve(address spender, uint256 amount) public override returns (bool) {</span>
 24 |     | <span class='unexecuted'>        super.approve(spender, amount);</span>
 25 |     | <span class='neutral'>        assembly {</span>
 26 |     | <span class='neutral'>            return(0, 0)</span>
 27 |     | <span class='neutral'>        }</span>
 28 |     | <span class='neutral'>    }</span>
 29 |     | <span class='neutral'></span>
 30 |     | <span class='unexecuted'>    function mint(address to, uint256 amount) external {</span>
 31 |     | <span class='unexecuted'>        _mint(to, amount);</span>
 32 |     | <span class='neutral'>    }</span>
 33 |     | <span class='neutral'>}</span>
 34 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/test/lib/ERC20Token.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: GPL-3.0</span>
  2 |     | <span class='neutral'>pragma solidity 0.8.23;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>import {ERC20} from &#39;@openzeppelin/contracts/token/ERC20/ERC20.sol&#39;;</span>
  5 |     | <span class='neutral'></span>
  6 |     | <span class='unexecuted'>contract ERC20Token is ERC20 {</span>
  7 |     | <span class='unexecuted'>    constructor() ERC20(&#39;ERC20Token&#39;, &#39;ERC20&#39;) {}</span>
  8 |     | <span class='neutral'></span>
  9 |     | <span class='unexecuted'>    function mint(address to, uint256 amount) external {</span>
 10 |     | <span class='unexecuted'>        _mint(to, amount);</span>
 11 |     | <span class='neutral'>    }</span>
 12 |     | <span class='neutral'>}</span>
 13 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/test/lib/GovernorVotesMock.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: GPL-3.0</span>
  2 |     | <span class='neutral'>pragma solidity 0.8.23;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>import {Governor} from &#39;@openzeppelin/contracts/governance/Governor.sol&#39;;</span>
  5 |     | <span class='neutral'>import {GovernorVotes} from &#39;@openzeppelin/contracts/governance/extensions/GovernorVotes.sol&#39;;</span>
  6 |     | <span class='neutral'>import {GovernorCountingSimple} from &#39;@openzeppelin/contracts/governance/extensions/GovernorCountingSimple.sol&#39;;</span>
  7 |     | <span class='neutral'>import {IVotes} from &#39;@openzeppelin/contracts/governance/utils/IVotes.sol&#39;;</span>
  8 |     | <span class='neutral'></span>
  9 |     | <span class='unexecuted'>contract GovernorVotesMock is GovernorVotes, GovernorCountingSimple {</span>
 10 |     | <span class='unexecuted'>    constructor(address _votingToken) GovernorVotes(IVotes(_votingToken)) Governor(&#39;MockGovernor&#39;) {}</span>
 11 |     | <span class='neutral'></span>
 12 |     | <span class='unexecuted'>    function quorum(uint256) public pure override returns (uint256) {</span>
 13 |     | <span class='neutral'>        return 0;</span>
 14 |     | <span class='neutral'>    }</span>
 15 |     | <span class='neutral'></span>
 16 |     | <span class='unexecuted'>    function votingDelay() public pure override returns (uint256) {</span>
 17 |     | <span class='neutral'>        return 0;</span>
 18 |     | <span class='neutral'>    }</span>
 19 |     | <span class='neutral'></span>
 20 |     | <span class='unexecuted'>    function votingPeriod() public pure override returns (uint256) {</span>
 21 |     | <span class='unexecuted'>        return 16;</span>
 22 |     | <span class='neutral'>    }</span>
 23 |     | <span class='neutral'>}</span>
 24 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/test/lib/OZVotingToken.sol</b>
<code>
  1 |     | <span class='neutral'>// SPDX-License-Identifier: GPL-3.0</span>
  2 |     | <span class='neutral'>pragma solidity 0.8.23;</span>
  3 |     | <span class='neutral'></span>
  4 |     | <span class='neutral'>import {ERC20} from &#39;@openzeppelin/contracts/token/ERC20/ERC20.sol&#39;;</span>
  5 |     | <span class='neutral'>import {ERC20Votes} from &#39;@openzeppelin/contracts/token/ERC20/extensions/ERC20Votes.sol&#39;;</span>
  6 |     | <span class='neutral'>import {ERC20Permit} from &#39;@openzeppelin/contracts/token/ERC20/extensions/ERC20Permit.sol&#39;;</span>
  7 |     | <span class='neutral'></span>
  8 |     | <span class='unexecuted'>contract OZVotingToken is ERC20, ERC20Permit, ERC20Votes {</span>
  9 |     | <span class='unexecuted'>    constructor() ERC20(&#39;OZVotingToken&#39;, &#39;OZ&#39;) ERC20Permit(&#39;OZ&#39;) {}</span>
 10 |     | <span class='neutral'></span>
 11 |     | <span class='unexecuted'>    function mint(address to, uint256 amount) external {</span>
 12 |     | <span class='unexecuted'>        _mint(to, amount);</span>
 13 |     | <span class='neutral'>    }</span>
 14 |     | <span class='neutral'></span>
 15 |     | <span class='neutral'>    // The functions below are overrides required by Solidity.</span>
 16 |     | <span class='neutral'></span>
 17 |     | <span class='unexecuted'>    function _afterTokenTransfer(address from, address to, uint256 amount) internal override(ERC20, ERC20Votes) {</span>
 18 |     | <span class='unexecuted'>        super._afterTokenTransfer(from, to, amount);</span>
 19 |     | <span class='neutral'>    }</span>
 20 |     | <span class='neutral'></span>
 21 |     | <span class='unexecuted'>    function _mint(address to, uint256 amount) internal override(ERC20, ERC20Votes) {</span>
 22 |     | <span class='unexecuted'>        super._mint(to, amount);</span>
 23 |     | <span class='neutral'>    }</span>
 24 |     | <span class='neutral'></span>
 25 |     | <span class='neutral'>    function _burn(address account, uint256 amount) internal override(ERC20, ERC20Votes) {</span>
 26 |     | <span class='neutral'>        super._burn(account, amount);</span>
 27 |     | <span class='neutral'>    }</span>
 28 |     | <span class='neutral'>}</span>
 29 |     | <span class='neutral'></span>

</code>
<br />

<b>/mnt/f/Projects/audits/rio-vesting-escrow/test/lib/TestUtil.sol</b>
<code>
   1 |     | <span class='neutral'>// // SPDX-License-Identifier: GPL-3.0</span>
   2 |     | <span class='neutral'>// pragma solidity 0.8.23;</span>
   3 |     | <span class='neutral'></span>
   4 |     | <span class='neutral'>// import {Test} from &#39;forge-std/Test.sol&#39;;</span>
   5 |     | <span class='neutral'>// import {OZVotingAdaptor} from &#39;src/adaptors/OZVotingAdaptor.sol&#39;;</span>
   6 |     | <span class='neutral'>// import {VestingEscrowFactory} from &#39;src/VestingEscrowFactory.sol&#39;;</span>
   7 |     | <span class='neutral'>// import {GovernorVotesMock} from &#39;test/lib/GovernorVotesMock.sol&#39;;</span>
   8 |     | <span class='neutral'>// import {OZVotingToken} from &#39;test/lib/OZVotingToken.sol&#39;;</span>
   9 |     | <span class='neutral'>// import {VestingEscrow} from &#39;src/VestingEscrow.sol&#39;;</span>
  10 |     | <span class='neutral'></span>
  11 |     | <span class='neutral'>// contract TestUtil is Test {</span>
  12 |     | <span class='neutral'>//     struct ProtocolConfig {</span>
  13 |     | <span class='neutral'>//         address owner;</span>
  14 |     | <span class='neutral'>//         address manager;</span>
  15 |     | <span class='neutral'>//     }</span>
  16 |     | <span class='neutral'></span>
  17 |     | <span class='neutral'>//     struct VestingEscrowConfig {</span>
  18 |     | <span class='neutral'>//         uint256 amount;</span>
  19 |     | <span class='neutral'>//         address recipient;</span>
  20 |     | <span class='neutral'>//         uint40 vestingDuration;</span>
  21 |     | <span class='neutral'>//         uint40 vestingStart;</span>
  22 |     | <span class='neutral'>//         uint40 cliffLength;</span>
  23 |     | <span class='neutral'>//         bool isFullyRevokable;</span>
  24 |     | <span class='neutral'>//         bytes initialDelegateParams;</span>
  25 |     | <span class='neutral'>//     }</span>
  26 |     | <span class='neutral'></span>
  27 |     | <span class='neutral'>//     enum VoteType {</span>
  28 |     | <span class='neutral'>//         Against,</span>
  29 |     | <span class='neutral'>//         For,</span>
  30 |     | <span class='neutral'>//         Abstain</span>
  31 |     | <span class='neutral'>//     }</span>
  32 |     | <span class='neutral'></span>
  33 |     | <span class='neutral'>//     address public constant RANDOM_GUY = address(0x123);</span>
  34 |     | <span class='neutral'></span>
  35 |     | <span class='neutral'>//     VestingEscrowFactory public factory;</span>
  36 |     | <span class='neutral'>//     OZVotingAdaptor public ozVotingAdaptor;</span>
  37 |     | <span class='neutral'></span>
  38 |     | <span class='neutral'>//     GovernorVotesMock public governor;</span>
  39 |     | <span class='neutral'>//     OZVotingToken public token;</span>
  40 |     | <span class='neutral'></span>
  41 |     | <span class='neutral'>//     VestingEscrow public deployedVesting;</span>
  42 |     | <span class='neutral'></span>
  43 |     | <span class='neutral'>//     uint256 public amount;</span>
  44 |     | <span class='neutral'>//     address public recipient;</span>
  45 |     | <span class='neutral'>//     uint40 public startTime;</span>
  46 |     | <span class='neutral'>//     uint40 public endTime;</span>
  47 |     | <span class='neutral'>//     uint40 public cliffLength;</span>
  48 |     | <span class='neutral'>//     bool public isFullyRevokable;</span>
  49 |     | <span class='neutral'>//     bytes public initialDelegateParams;</span>
  50 |     | <span class='neutral'></span>
  51 |     | <span class='neutral'>//     function setUpProtocol(ProtocolConfig memory config) public {</span>
  52 |     | <span class='neutral'>//         token = new OZVotingToken();</span>
  53 |     | <span class='neutral'>//         governor = new GovernorVotesMock(address(token));</span>
  54 |     | <span class='neutral'>//         ozVotingAdaptor = new OZVotingAdaptor(address(governor), address(token), config.owner);</span>
  55 |     | <span class='neutral'>//         factory = new VestingEscrowFactory(</span>
  56 |     | <span class='neutral'>//             address(new VestingEscrow()), address(token), config.owner, config.manager, address(ozVotingAdaptor)</span>
  57 |     | <span class='neutral'>//         );</span>
  58 |     | <span class='neutral'></span>
  59 |     | <span class='neutral'>//         vm.deal(RANDOM_GUY, 100 ether);</span>
  60 |     | <span class='neutral'>//     }</span>
  61 |     | <span class='neutral'></span>
  62 |     | <span class='neutral'>//     function deployVestingEscrow(VestingEscrowConfig memory config) public {</span>
  63 |     | <span class='neutral'>//         amount = config.amount;</span>
  64 |     | <span class='neutral'>//         recipient = config.recipient;</span>
  65 |     | <span class='neutral'>//         startTime = config.vestingStart;</span>
  66 |     | <span class='neutral'>//         endTime = config.vestingStart + config.vestingDuration;</span>
  67 |     | <span class='neutral'>//         cliffLength = config.cliffLength;</span>
  68 |     | <span class='neutral'>//         isFullyRevokable = config.isFullyRevokable;</span>
  69 |     | <span class='neutral'>//         initialDelegateParams = config.initialDelegateParams;</span>
  70 |     | <span class='neutral'></span>
  71 |     | <span class='neutral'>//         vm.startPrank(recipient);</span>
  72 |     | <span class='neutral'>//         token.mint(recipient, amount);</span>
  73 |     | <span class='neutral'>//         token.approve(address(factory), type(uint256).max);</span>
  74 |     | <span class='neutral'>//         deployedVesting = VestingEscrow(</span>
  75 |     | <span class='neutral'>//             factory.deployVestingContract(</span>
  76 |     | <span class='neutral'>//                 amount,</span>
  77 |     | <span class='neutral'>//                 recipient,</span>
  78 |     | <span class='neutral'>//                 config.vestingDuration,</span>
  79 |     | <span class='neutral'>//                 startTime,</span>
  80 |     | <span class='neutral'>//                 cliffLength,</span>
  81 |     | <span class='neutral'>//                 isFullyRevokable,</span>
  82 |     | <span class='neutral'>//                 initialDelegateParams</span>
  83 |     | <span class='neutral'>//             )</span>
  84 |     | <span class='neutral'>//         );</span>
  85 |     | <span class='neutral'>//         vm.stopPrank();</span>
  86 |     | <span class='neutral'>//     }</span>
  87 |     | <span class='neutral'></span>
  88 |     | <span class='neutral'>//     function createProposal() public returns (uint256) {</span>
  89 |     | <span class='neutral'>//         address[] memory targets = new address[](1);</span>
  90 |     | <span class='neutral'>//         targets[0] = address(0xdead);</span>
  91 |     | <span class='neutral'></span>
  92 |     | <span class='neutral'>//         uint256[] memory values = new uint256[](1);</span>
  93 |     | <span class='neutral'>//         values[0] = 0;</span>
  94 |     | <span class='neutral'></span>
  95 |     | <span class='neutral'>//         bytes[] memory calldatas = new bytes[](1);</span>
  96 |     | <span class='neutral'>//         string memory description = &#39;Test Proposal&#39;;</span>
  97 |     | <span class='neutral'></span>
  98 |     | <span class='neutral'>//         return governor.propose(targets, values, calldatas, description);</span>
  99 |     | <span class='neutral'>//     }</span>
 100 |     | <span class='neutral'></span>
 101 |     | <span class='neutral'>//     receive() external payable {}</span>
 102 |     | <span class='neutral'>// }</span>
 103 |     | <span class='neutral'></span>

</code>
<br />

