# Counting `totalBattles` twice in `RankedBattle.updateBattleRecord()`

For offchain bot/game server, `RankedBattle.updateBattleRecord()` need to called twice for each battle. One for initiator and one for opponent.

If initiator win, game server will call `updateBattleRecord()` with won report and `initiatorBool == true`.
And opponent lose, game server will call `updateBattleRecord()` with lose report and `initiatorBool == false`.
Winner get their points increase and loser get their points decrease.

After these 2 calls, `totalBattles` will be increased by 2. It supposed to be increased by 1.

## Impact

Wrong total ranked `totalBattles` count.

## Proof of Concept

<https://github.com/code-423n4/2024-02-ai-arena/blob/f2952187a8afc44ee6adc28769657717b498b7d4/src/RankedBattle.sol#L345-L348>

```js
        if (initiatorBool) {
            _voltageManagerInstance.spendVoltage(fighterOwner, VOLTAGE_COST);
            //@ totalBattle should be increased by 1 here
        }
        totalBattles += 1;//@audit M counting totalBattles twice
```

## Tools Used

## Recommended Mitigation Steps

Only count battle when user spend energy.

```js
        if (initiatorBool) {
            _voltageManagerInstance.spendVoltage(fighterOwner, VOLTAGE_COST);
            totalBattles += 1;
        }
```
