# User can predict and control `FighterFarm.reRoll()` DNA to get maximum attribute and rarity

`FighterFarm.reRoll()` is part of income for project. Any DNA manipulation to prevent further reroll is an issue.

## Impact

NFT DNA reroll can be manipulated to get maximum attribute and rarity.
Bypassing `maxRerollsAllowed` limit and cost.

## Proof of Concept

reroll DNA using `msg.sender`,`tokenId`,`numRerolls` as hash
`uint256 dna = uint256(keccak256(abi.encode(msg.sender, tokenId, numRerolls[tokenId])));`

All 3 components is predictable. NFT can be transfer away. So `msg.sender` can be anything that user generate.

## Tools Used

<https://github.com/code-423n4/2024-02-ai-arena/blob/f2952187a8afc44ee6adc28769657717b498b7d4/src/FighterFarm.sol#L379>

## Recommended Mitigation Steps

Use `tokenId` and `numRerolls` only if do not want user to control reroll process.
`uint256 dna = uint256(keccak256(abi.encode(tokenId, numRerolls[tokenId])));`
